<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-514 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-514</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-514</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-15.html">extraction-schema-15</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how language models encode, represent, or utilize spatial knowledge, procedural knowledge, or object-relational knowledge for embodied planning, navigation, or manipulation tasks, particularly when the model operates without direct sensory input.</div>
                <p><strong>Paper ID:</strong> paper-7cfa5c97164129ce3630511f639040d28db1d4b7</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/7cfa5c97164129ce3630511f639040d28db1d4b7" target="_blank">FiLM: Visual Reasoning with a General Conditioning Layer</a></p>
                <p><strong>Paper Venue:</strong> AAAI Conference on Artificial Intelligence</p>
                <p><strong>Paper TL;DR:</strong> It is shown that FiLM layers are highly effective for visual reasoning - answering image-related questions which require a multi-step, high-level process - a task which has proven difficult for standard deep learning methods that do not explicitly model reasoning.</p>
                <p><strong>Paper Abstract:</strong> 
 
 We introduce a general-purpose conditioning method for neural networks called FiLM: Feature-wise Linear Modulation. FiLM layers influence neural network computation via a simple, feature-wise affine transformation based on conditioning information. We show that FiLM layers are highly effective for visual reasoning - answering image-related questions which require a multi-step, high-level process - a task which has proven difficult for standard deep learning methods that do not explicitly model reasoning. Specifically, we show on visual reasoning tasks that FiLM layers 1) halve state-of-the-art error for the CLEVR benchmark, 2) modulate features in a coherent manner, 3) are robust to ablations and architectural modifications, and 4) generalize well to challenging, new data from few examples or even zero-shot.
 
</p>
                <p><strong>Cost:</strong> 0.014</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <div class="extraction-instance-container" id="e514.0">
                <h3 class="extraction-instance">Extracted Data Instance 0 (e514.0)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how language models encode, represent, or utilize spatial knowledge, procedural knowledge, or object-relational knowledge for embodied planning, navigation, or manipulation tasks, particularly when the model operates without direct sensory input.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>FiLM</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Feature-wise Linear Modulation</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A conditioning layer that applies a language-conditioned, per-feature affine transform (gamma, beta) to intermediate neural network feature maps, enabling language to selectively scale and shift visual features to perform multi-step visual reasoning.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>CNN+GRU+FiLM</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td>Question encoder: GRU (4096 hidden units) over 200-dim learned word embeddings that outputs FiLM parameters (gamma, beta) per ResBlock; Visual pipeline: CNN / ResBlocks (128 feature maps) whose intermediate feature maps are modulated feature-wise by FiLM layers. Trained end-to-end on image-question-answer triplets (optionally using pre-trained ResNet features).</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>CLEVR visual reasoning (visual question answering)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Synthetic VQA benchmark where an agent must answer multi-step compositional questions about 3D-rendered scenes containing objects with shape, color, size, and material attributes; questions include counting, attribute queries, comparisons, and spatial relations.</td>
                        </tr>
                        <tr>
                            <td><strong>task_type</strong></td>
                            <td>multi-step reasoning / visual question answering</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_type</strong></td>
                            <td>spatial + object-relational</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_source</strong></td>
                            <td>end-to-end supervised training on image-question-answer triplets (CLEVR); optionally pre-trained image features (ResNet) for visual pipeline</td>
                        </tr>
                        <tr>
                            <td><strong>has_direct_sensory_input</strong></td>
                            <td>True</td>
                        </tr>
                        <tr>
                            <td><strong>elicitation_method</strong></td>
                            <td>end-to-end supervised learning; the linguistic input is encoded by GRU to generate FiLM parameters that modulate visual features at inference</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_representation</strong></td>
                            <td>language-conditioned, per-feature affine parameters (gamma, beta) applied to CNN feature maps (implicit in weights and FiLM parameter outputs); spatial information emerges via modulated activation maps and appended coordinate feature maps</td>
                        </tr>
                        <tr>
                            <td><strong>performance_metric</strong></td>
                            <td>accuracy (%) on CLEVR answer prediction</td>
                        </tr>
                        <tr>
                            <td><strong>performance_result</strong></td>
                            <td>Overall accuracy: 97.7% (CNN+GRU+FiLM, best model). Per-type examples: Count 94.3%, Exist 99.1%, Compare Numbers 96.8%, Query Attribute 99.1%, Compare Attribute 99.1%.</td>
                        </tr>
                        <tr>
                            <td><strong>success_patterns</strong></td>
                            <td>Successfully localizes answer-relevant regions via modulation (visualizations show globally-pooled activations focused on question-relevant objects), handles counting, attribute queries, comparisons, and relational reasoning between objects; models generalize well to human-posed questions after fine-tuning and to compositional generalization better than many baselines.</td>
                        </tr>
                        <tr>
                            <td><strong>failure_patterns</strong></td>
                            <td>Memorization of attribute-shape co-occurrences in CoGenT (bias e.g., cubes not cyan) limits zero-shot generalization across swapped attribute palettes; some errors occur when FiLM fails to localize all query-referenced objects; catastrophic forgetting after fine-tuning on new condition.</td>
                        </tr>
                        <tr>
                            <td><strong>baseline_comparison</strong></td>
                            <td>Prior methods: CNN+LSTM+RN 95.5% overall, PG+EE (program supervision) up to 96.9% (with large program data), CNN+LSTM+SA ~76.6%, humans 92.6% (reported). FiLM (97.7%) outperforms these baselines when trained from image-question-answer only.</td>
                        </tr>
                        <tr>
                            <td><strong>ablation_results</strong></td>
                            <td>Gamma and Beta: removing beta (beta=0) -> 96.9% (drop ~0.8); fixing gamma=1 -> 95.9% (drop ~1.8). Test-time replacement of gamma with training mean causes 65.4% accuracy drop, while replacing beta with mean causes only 1.0% drop (gamma is critical). Restricting gamma (sigmoid to (0,1) or tanh to (-1,1) or exp to (0,∞)) hurts performance. Removing all FiLM layers (no FiLM in ResBlocks 1-4) collapses performance to 21.4%. Moving FiLM placements yields modest variation; a single FiLM layer still attains high performance (~93.5% with 1 ResBlock, best model with 4 ResBlocks ~97.4%).</td>
                        </tr>
                        <tr>
                            <td><strong>key_findings</strong></td>
                            <td>Language is encoded as compact, continuous FiLM parameter vectors (gamma,beta) that modulate visual feature maps to produce spatial and relational reasoning without an explicit, learned spatial attention mechanism; spatial localization emerges indirectly from feature modulation; gamma (multiplicative scaling) is the primary carrier of conditioning signal and can shut off or invert feature maps, enabling selective feature gating; FiLM parameter vectors exhibit functionally meaningful structure (clustering by low- vs high-level reasoning tasks) and support linear manipulations for limited zero-shot compositionality.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'FiLM: Visual Reasoning with a General Conditioning Layer', 'publication_date_yy_mm': '2017-09'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e514.1">
                <h3 class="extraction-instance">Extracted Data Instance 1 (e514.1)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how language models encode, represent, or utilize spatial knowledge, procedural knowledge, or object-relational knowledge for embodied planning, navigation, or manipulation tasks, particularly when the model operates without direct sensory input.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>FiLM generator (language-to-(γ,β))</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>FiLM generator (GRU language encoder projecting to FiLM parameters)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A language pipeline (GRU) that encodes a question into a fixed embedding and projects that embedding to per-layer gamma and beta vectors which condition the visual network's feature maps.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>GRU-based FiLM generator</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td>GRU with 4096 hidden units consuming 200-dim learned word embeddings; final GRU hidden state is linearly projected to predict gamma and beta vectors for each FiLM layer (per ResBlock). The generator provides the conditioning signal for the FiLM-ed visual pipeline.</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>CLEVR visual reasoning (parameter generation component)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Generates conditioning parameters from natural-language questions so the visual pipeline can modulate feature maps and answer questions about images.</td>
                        </tr>
                        <tr>
                            <td><strong>task_type</strong></td>
                            <td>instruction encoding / conditioning for visual reasoning</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_type</strong></td>
                            <td>object-relational + spatial (encoded into conditioning vectors)</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_source</strong></td>
                            <td>learned from supervision via training on CLEVR (question-answer pairs with images); linguistic patterns in training data</td>
                        </tr>
                        <tr>
                            <td><strong>has_direct_sensory_input</strong></td>
                            <td>False</td>
                        </tr>
                        <tr>
                            <td><strong>elicitation_method</strong></td>
                            <td>encoding by GRU followed by projection to (gamma,beta); can be used directly (inference) or combined arithmetically (zero-shot manipulation)</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_representation</strong></td>
                            <td>compact dense vectors (gamma,beta) that implicitly represent task directives (e.g. filter color, relate right) and modulate visual features; these vectors are stored implicitly in encoder weights and output activations at inference</td>
                        </tr>
                        <tr>
                            <td><strong>performance_metric</strong></td>
                            <td>downstream VQA accuracy when used to condition visual network</td>
                        </tr>
                        <tr>
                            <td><strong>performance_result</strong></td>
                            <td>When used as designed, supports the full FiLM model achieving 97.7% on CLEVR. Ablations show altering generator outputs (e.g., replacing gamma with mean) greatly degrades performance (65.4% drop).</td>
                        </tr>
                        <tr>
                            <td><strong>success_patterns</strong></td>
                            <td>Generator learns to produce distinct parameter vectors for different low-level and high-level question functions (t-SNE shows clustering by reasoning subtask), enabling different processing pathways in the visual network across FiLM layers (low-level discrimination earlier, higher-level grouping later).</td>
                        </tr>
                        <tr>
                            <td><strong>failure_patterns</strong></td>
                            <td>Generator outputs can reflect dataset biases (leading to memorization of attribute-shape co-occurrences) limiting zero-shot generalization across attribute swaps unless supplemented by parameter arithmetic or fine-tuning.</td>
                        </tr>
                        <tr>
                            <td><strong>baseline_comparison</strong></td>
                            <td>No explicit baseline generator in this work; compared overall against architectures that fuse language via concatenation/attention (CNN+LSTM, SA), where FiLM generator conditioning outperforms those fusion methods.</td>
                        </tr>
                        <tr>
                            <td><strong>ablation_results</strong></td>
                            <td>Fine-tuning only the FiLM generator on CLEVR-Humans yields strong adaptation without updating visual pipeline; parameter replacement (mean gamma) at test-time shows gamma outputs are essential. Linear combinations of generator outputs can produce meaningful compositional behaviors for some zero-shot queries.</td>
                        </tr>
                        <tr>
                            <td><strong>key_findings</strong></td>
                            <td>Language-conditioned parameter vectors can compactly encode procedural and relational directives that reconfigure a visual network's computations; these vectors support hierarchical decomposition of reasoning when applied at multiple depths and can be manipulated linearly for limited compositional generalization.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'FiLM: Visual Reasoning with a General Conditioning Layer', 'publication_date_yy_mm': '2017-09'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e514.2">
                <h3 class="extraction-instance">Extracted Data Instance 2 (e514.2)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how language models encode, represent, or utilize spatial knowledge, procedural knowledge, or object-relational knowledge for embodied planning, navigation, or manipulation tasks, particularly when the model operates without direct sensory input.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>FiLM parameter arithmetic (zero-shot)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Linear combination of FiLM parameters for zero-shot compositional generalization</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A method that composes new (gamma,beta) FiLM parameter vectors by linear arithmetic over parameter vectors of related questions (e.g., A_blue_sphere + B_brown_cube - C_brown_sphere) to answer unseen attribute combinations in zero-shot.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>FiLM parameter arithmetic technique</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td>Compute target FiLM parameters by linear combination of FiLM parameters from three related questions (analogy-like: q1 + q2 - q3) and use those parameters to modulate the visual network at inference for zero-shot queries.</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>CLEVR-CoGenT zero-shot compositional generalization</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Test generalization to Condition B (where color palettes for shapes are swapped) when trained on Condition A; evaluate model's ability to answer questions about unseen shape-color combos without fine-tuning.</td>
                        </tr>
                        <tr>
                            <td><strong>task_type</strong></td>
                            <td>zero-shot compositional generalization (visual reasoning)</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_type</strong></td>
                            <td>object-relational + compositional (attribute composition)</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_source</strong></td>
                            <td>FiLM parameter vectors produced by the trained FiLM generator on known questions (no additional training on target combinations)</td>
                        </tr>
                        <tr>
                            <td><strong>has_direct_sensory_input</strong></td>
                            <td>True</td>
                        </tr>
                        <tr>
                            <td><strong>elicitation_method</strong></td>
                            <td>parameter-space arithmetic (deterministic linear combination) applied to FiLM gamma/beta vectors produced by language encoder</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_representation</strong></td>
                            <td>linear structure in FiLM parameter space (gamma,beta vectors) such that arithmetic operations correspond to composing concepts</td>
                        </tr>
                        <tr>
                            <td><strong>performance_metric</strong></td>
                            <td>accuracy (%) on CLEVR-CoGenT Condition B (zero-shot subset of questions where arithmetic applies)</td>
                        </tr>
                        <tr>
                            <td><strong>performance_result</strong></td>
                            <td>Applying parameter arithmetic to applicable subset (~1/3 of B questions) improved overall Condition B accuracy by 3.2% for the evaluated FiLM models; for the applicable subset accuracy rose from 71.5% to 80.7%.</td>
                        </tr>
                        <tr>
                            <td><strong>success_patterns</strong></td>
                            <td>Worked for questions where compositional decomposition is straightforward (e.g., swapping color or shape attributes) and where FiLM parameter vectors are disentangled along those concept axes.</td>
                        </tr>
                        <tr>
                            <td><strong>failure_patterns</strong></td>
                            <td>Only applicable to ~1/3 of questions; limited by degree of disentanglement in parameter space and dataset biases; outside these cases the arithmetic did not apply or produced negligible gains.</td>
                        </tr>
                        <tr>
                            <td><strong>baseline_comparison</strong></td>
                            <td>Compared to direct trained-on-A evaluation on B (no fine-tuning): arithmetic method gave a +3.2% overall gain (on subset higher gains). Fine-tuning on B still yields larger improvements but causes catastrophic forgetting of A.</td>
                        </tr>
                        <tr>
                            <td><strong>ablation_results</strong></td>
                            <td>Not an ablation per se, but authors note negligible difference between arithmetic and direct predicted FiLM parameters after fine-tuning; arithmetic effect limited but demonstrates parameter-space manipulability.</td>
                        </tr>
                        <tr>
                            <td><strong>key_findings</strong></td>
                            <td>FiLM parameter vectors exhibit linear, semantically meaningful structure enabling analogy-like composition in parameter space for a subset of compositional queries; this provides a concrete mechanism by which language-conditioned parameters can encode and compose object-relational concepts without modifying the visual network.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'FiLM: Visual Reasoning with a General Conditioning Layer', 'publication_date_yy_mm': '2017-09'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e514.3">
                <h3 class="extraction-instance">Extracted Data Instance 3 (e514.3)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how language models encode, represent, or utilize spatial knowledge, procedural knowledge, or object-relational knowledge for embodied planning, navigation, or manipulation tasks, particularly when the model operates without direct sensory input.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Coordinate feature maps (positional encoding)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Concatenated relative x/y coordinate feature maps</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Two extra feature maps containing scaled relative x and y coordinates (from -1 to 1) concatenated to image features at multiple stages to facilitate spatial reasoning.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>coordinate maps + FiLM-ed CNN</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td>At each ResBlock input (and classifier input), two constant feature maps encoding normalized x and y positions are concatenated to visual features so the network has access to spatial position cues.</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>CLEVR spatial reasoning</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Provide explicit per-location spatial position encodings to help the model answer spatial relation questions (e.g., left/right, farthest/rightmost).</td>
                        </tr>
                        <tr>
                            <td><strong>task_type</strong></td>
                            <td>spatial reasoning / relational queries</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_type</strong></td>
                            <td>spatial</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_source</strong></td>
                            <td>engineered positional encodings concatenated to CNN features (not learned from language alone)</td>
                        </tr>
                        <tr>
                            <td><strong>has_direct_sensory_input</strong></td>
                            <td>True</td>
                        </tr>
                        <tr>
                            <td><strong>elicitation_method</strong></td>
                            <td>concatenation of coordinate maps to convolutional features before FiLM modulation</td>
                        </tr>
                        <tr>
                            <td><strong>knowledge_representation</strong></td>
                            <td>explicit continuous spatial coordinates per feature-map location (two channels: x and y), combined with modulated feature activations</td>
                        </tr>
                        <tr>
                            <td><strong>performance_metric</strong></td>
                            <td>accuracy (%) on spatial question types and overall CLEVR accuracy</td>
                        </tr>
                        <tr>
                            <td><strong>performance_result</strong></td>
                            <td>In the reported best models, coordinate maps were used and overall accuracy reached 97.7%; removing coordinate maps but using only 1x1 convs without cross-location communication still attained 95.3%, indicating some spatial reasoning can emerge without explicit coordinate maps.</td>
                        </tr>
                        <tr>
                            <td><strong>success_patterns</strong></td>
                            <td>Coordinate maps help facilitate spatial reasoning; FiLM models with coordinate maps more easily localize and answer questions about relative positions and superlatives.</td>
                        </tr>
                        <tr>
                            <td><strong>failure_patterns</strong></td>
                            <td>Even without coordinate maps, FiLM achieves high accuracy, indicating coordinate maps are helpful but not strictly necessary; models can still exploit spatial information present in convolutional features.</td>
                        </tr>
                        <tr>
                            <td><strong>baseline_comparison</strong></td>
                            <td>Ablation: 1x1 convs without coordinate maps achieved 95.3% (still high), indicating coordinate maps provide modest benefit but FiLM can induce spatial localization indirectly.</td>
                        </tr>
                        <tr>
                            <td><strong>ablation_results</strong></td>
                            <td>Model trained with only 1x1 convolutions and without coordinate maps (and global max-pool) still achieved 95.3% accuracy, showing spatial reasoning can be derived from per-location features after FiLM modulation; however, in general coordinate maps were included for best performance.</td>
                        </tr>
                        <tr>
                            <td><strong>key_findings</strong></td>
                            <td>Explicit per-location coordinate encodings help FiLM perform spatial reasoning, but the core mechanism (feature-wise modulation by language) can indirectly create spatial selectivity from per-location visual features even when explicit coordinates are omitted.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'FiLM: Visual Reasoning with a General Conditioning Layer', 'publication_date_yy_mm': '2017-09'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>Modulating early visual processing by language <em>(Rating: 2)</em></li>
                <li>A simple neural network module for relational reasoning <em>(Rating: 2)</em></li>
                <li>Inferring and executing programs for visual reasoning <em>(Rating: 2)</em></li>
                <li>Learning to reason: End-to-end module networks for visual question answering <em>(Rating: 2)</em></li>
                <li>Visual interaction networks <em>(Rating: 1)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-514",
    "paper_id": "paper-7cfa5c97164129ce3630511f639040d28db1d4b7",
    "extraction_schema_id": "extraction-schema-15",
    "extracted_data": [
        {
            "name_short": "FiLM",
            "name_full": "Feature-wise Linear Modulation",
            "brief_description": "A conditioning layer that applies a language-conditioned, per-feature affine transform (gamma, beta) to intermediate neural network feature maps, enabling language to selectively scale and shift visual features to perform multi-step visual reasoning.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "CNN+GRU+FiLM",
            "model_size": null,
            "model_description": "Question encoder: GRU (4096 hidden units) over 200-dim learned word embeddings that outputs FiLM parameters (gamma, beta) per ResBlock; Visual pipeline: CNN / ResBlocks (128 feature maps) whose intermediate feature maps are modulated feature-wise by FiLM layers. Trained end-to-end on image-question-answer triplets (optionally using pre-trained ResNet features).",
            "task_name": "CLEVR visual reasoning (visual question answering)",
            "task_description": "Synthetic VQA benchmark where an agent must answer multi-step compositional questions about 3D-rendered scenes containing objects with shape, color, size, and material attributes; questions include counting, attribute queries, comparisons, and spatial relations.",
            "task_type": "multi-step reasoning / visual question answering",
            "knowledge_type": "spatial + object-relational",
            "knowledge_source": "end-to-end supervised training on image-question-answer triplets (CLEVR); optionally pre-trained image features (ResNet) for visual pipeline",
            "has_direct_sensory_input": true,
            "elicitation_method": "end-to-end supervised learning; the linguistic input is encoded by GRU to generate FiLM parameters that modulate visual features at inference",
            "knowledge_representation": "language-conditioned, per-feature affine parameters (gamma, beta) applied to CNN feature maps (implicit in weights and FiLM parameter outputs); spatial information emerges via modulated activation maps and appended coordinate feature maps",
            "performance_metric": "accuracy (%) on CLEVR answer prediction",
            "performance_result": "Overall accuracy: 97.7% (CNN+GRU+FiLM, best model). Per-type examples: Count 94.3%, Exist 99.1%, Compare Numbers 96.8%, Query Attribute 99.1%, Compare Attribute 99.1%.",
            "success_patterns": "Successfully localizes answer-relevant regions via modulation (visualizations show globally-pooled activations focused on question-relevant objects), handles counting, attribute queries, comparisons, and relational reasoning between objects; models generalize well to human-posed questions after fine-tuning and to compositional generalization better than many baselines.",
            "failure_patterns": "Memorization of attribute-shape co-occurrences in CoGenT (bias e.g., cubes not cyan) limits zero-shot generalization across swapped attribute palettes; some errors occur when FiLM fails to localize all query-referenced objects; catastrophic forgetting after fine-tuning on new condition.",
            "baseline_comparison": "Prior methods: CNN+LSTM+RN 95.5% overall, PG+EE (program supervision) up to 96.9% (with large program data), CNN+LSTM+SA ~76.6%, humans 92.6% (reported). FiLM (97.7%) outperforms these baselines when trained from image-question-answer only.",
            "ablation_results": "Gamma and Beta: removing beta (beta=0) -&gt; 96.9% (drop ~0.8); fixing gamma=1 -&gt; 95.9% (drop ~1.8). Test-time replacement of gamma with training mean causes 65.4% accuracy drop, while replacing beta with mean causes only 1.0% drop (gamma is critical). Restricting gamma (sigmoid to (0,1) or tanh to (-1,1) or exp to (0,∞)) hurts performance. Removing all FiLM layers (no FiLM in ResBlocks 1-4) collapses performance to 21.4%. Moving FiLM placements yields modest variation; a single FiLM layer still attains high performance (~93.5% with 1 ResBlock, best model with 4 ResBlocks ~97.4%).",
            "key_findings": "Language is encoded as compact, continuous FiLM parameter vectors (gamma,beta) that modulate visual feature maps to produce spatial and relational reasoning without an explicit, learned spatial attention mechanism; spatial localization emerges indirectly from feature modulation; gamma (multiplicative scaling) is the primary carrier of conditioning signal and can shut off or invert feature maps, enabling selective feature gating; FiLM parameter vectors exhibit functionally meaningful structure (clustering by low- vs high-level reasoning tasks) and support linear manipulations for limited zero-shot compositionality.",
            "uuid": "e514.0",
            "source_info": {
                "paper_title": "FiLM: Visual Reasoning with a General Conditioning Layer",
                "publication_date_yy_mm": "2017-09"
            }
        },
        {
            "name_short": "FiLM generator (language-to-(γ,β))",
            "name_full": "FiLM generator (GRU language encoder projecting to FiLM parameters)",
            "brief_description": "A language pipeline (GRU) that encodes a question into a fixed embedding and projects that embedding to per-layer gamma and beta vectors which condition the visual network's feature maps.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "GRU-based FiLM generator",
            "model_size": null,
            "model_description": "GRU with 4096 hidden units consuming 200-dim learned word embeddings; final GRU hidden state is linearly projected to predict gamma and beta vectors for each FiLM layer (per ResBlock). The generator provides the conditioning signal for the FiLM-ed visual pipeline.",
            "task_name": "CLEVR visual reasoning (parameter generation component)",
            "task_description": "Generates conditioning parameters from natural-language questions so the visual pipeline can modulate feature maps and answer questions about images.",
            "task_type": "instruction encoding / conditioning for visual reasoning",
            "knowledge_type": "object-relational + spatial (encoded into conditioning vectors)",
            "knowledge_source": "learned from supervision via training on CLEVR (question-answer pairs with images); linguistic patterns in training data",
            "has_direct_sensory_input": false,
            "elicitation_method": "encoding by GRU followed by projection to (gamma,beta); can be used directly (inference) or combined arithmetically (zero-shot manipulation)",
            "knowledge_representation": "compact dense vectors (gamma,beta) that implicitly represent task directives (e.g. filter color, relate right) and modulate visual features; these vectors are stored implicitly in encoder weights and output activations at inference",
            "performance_metric": "downstream VQA accuracy when used to condition visual network",
            "performance_result": "When used as designed, supports the full FiLM model achieving 97.7% on CLEVR. Ablations show altering generator outputs (e.g., replacing gamma with mean) greatly degrades performance (65.4% drop).",
            "success_patterns": "Generator learns to produce distinct parameter vectors for different low-level and high-level question functions (t-SNE shows clustering by reasoning subtask), enabling different processing pathways in the visual network across FiLM layers (low-level discrimination earlier, higher-level grouping later).",
            "failure_patterns": "Generator outputs can reflect dataset biases (leading to memorization of attribute-shape co-occurrences) limiting zero-shot generalization across attribute swaps unless supplemented by parameter arithmetic or fine-tuning.",
            "baseline_comparison": "No explicit baseline generator in this work; compared overall against architectures that fuse language via concatenation/attention (CNN+LSTM, SA), where FiLM generator conditioning outperforms those fusion methods.",
            "ablation_results": "Fine-tuning only the FiLM generator on CLEVR-Humans yields strong adaptation without updating visual pipeline; parameter replacement (mean gamma) at test-time shows gamma outputs are essential. Linear combinations of generator outputs can produce meaningful compositional behaviors for some zero-shot queries.",
            "key_findings": "Language-conditioned parameter vectors can compactly encode procedural and relational directives that reconfigure a visual network's computations; these vectors support hierarchical decomposition of reasoning when applied at multiple depths and can be manipulated linearly for limited compositional generalization.",
            "uuid": "e514.1",
            "source_info": {
                "paper_title": "FiLM: Visual Reasoning with a General Conditioning Layer",
                "publication_date_yy_mm": "2017-09"
            }
        },
        {
            "name_short": "FiLM parameter arithmetic (zero-shot)",
            "name_full": "Linear combination of FiLM parameters for zero-shot compositional generalization",
            "brief_description": "A method that composes new (gamma,beta) FiLM parameter vectors by linear arithmetic over parameter vectors of related questions (e.g., A_blue_sphere + B_brown_cube - C_brown_sphere) to answer unseen attribute combinations in zero-shot.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "FiLM parameter arithmetic technique",
            "model_size": null,
            "model_description": "Compute target FiLM parameters by linear combination of FiLM parameters from three related questions (analogy-like: q1 + q2 - q3) and use those parameters to modulate the visual network at inference for zero-shot queries.",
            "task_name": "CLEVR-CoGenT zero-shot compositional generalization",
            "task_description": "Test generalization to Condition B (where color palettes for shapes are swapped) when trained on Condition A; evaluate model's ability to answer questions about unseen shape-color combos without fine-tuning.",
            "task_type": "zero-shot compositional generalization (visual reasoning)",
            "knowledge_type": "object-relational + compositional (attribute composition)",
            "knowledge_source": "FiLM parameter vectors produced by the trained FiLM generator on known questions (no additional training on target combinations)",
            "has_direct_sensory_input": true,
            "elicitation_method": "parameter-space arithmetic (deterministic linear combination) applied to FiLM gamma/beta vectors produced by language encoder",
            "knowledge_representation": "linear structure in FiLM parameter space (gamma,beta vectors) such that arithmetic operations correspond to composing concepts",
            "performance_metric": "accuracy (%) on CLEVR-CoGenT Condition B (zero-shot subset of questions where arithmetic applies)",
            "performance_result": "Applying parameter arithmetic to applicable subset (~1/3 of B questions) improved overall Condition B accuracy by 3.2% for the evaluated FiLM models; for the applicable subset accuracy rose from 71.5% to 80.7%.",
            "success_patterns": "Worked for questions where compositional decomposition is straightforward (e.g., swapping color or shape attributes) and where FiLM parameter vectors are disentangled along those concept axes.",
            "failure_patterns": "Only applicable to ~1/3 of questions; limited by degree of disentanglement in parameter space and dataset biases; outside these cases the arithmetic did not apply or produced negligible gains.",
            "baseline_comparison": "Compared to direct trained-on-A evaluation on B (no fine-tuning): arithmetic method gave a +3.2% overall gain (on subset higher gains). Fine-tuning on B still yields larger improvements but causes catastrophic forgetting of A.",
            "ablation_results": "Not an ablation per se, but authors note negligible difference between arithmetic and direct predicted FiLM parameters after fine-tuning; arithmetic effect limited but demonstrates parameter-space manipulability.",
            "key_findings": "FiLM parameter vectors exhibit linear, semantically meaningful structure enabling analogy-like composition in parameter space for a subset of compositional queries; this provides a concrete mechanism by which language-conditioned parameters can encode and compose object-relational concepts without modifying the visual network.",
            "uuid": "e514.2",
            "source_info": {
                "paper_title": "FiLM: Visual Reasoning with a General Conditioning Layer",
                "publication_date_yy_mm": "2017-09"
            }
        },
        {
            "name_short": "Coordinate feature maps (positional encoding)",
            "name_full": "Concatenated relative x/y coordinate feature maps",
            "brief_description": "Two extra feature maps containing scaled relative x and y coordinates (from -1 to 1) concatenated to image features at multiple stages to facilitate spatial reasoning.",
            "citation_title": "",
            "mention_or_use": "use",
            "model_name": "coordinate maps + FiLM-ed CNN",
            "model_size": null,
            "model_description": "At each ResBlock input (and classifier input), two constant feature maps encoding normalized x and y positions are concatenated to visual features so the network has access to spatial position cues.",
            "task_name": "CLEVR spatial reasoning",
            "task_description": "Provide explicit per-location spatial position encodings to help the model answer spatial relation questions (e.g., left/right, farthest/rightmost).",
            "task_type": "spatial reasoning / relational queries",
            "knowledge_type": "spatial",
            "knowledge_source": "engineered positional encodings concatenated to CNN features (not learned from language alone)",
            "has_direct_sensory_input": true,
            "elicitation_method": "concatenation of coordinate maps to convolutional features before FiLM modulation",
            "knowledge_representation": "explicit continuous spatial coordinates per feature-map location (two channels: x and y), combined with modulated feature activations",
            "performance_metric": "accuracy (%) on spatial question types and overall CLEVR accuracy",
            "performance_result": "In the reported best models, coordinate maps were used and overall accuracy reached 97.7%; removing coordinate maps but using only 1x1 convs without cross-location communication still attained 95.3%, indicating some spatial reasoning can emerge without explicit coordinate maps.",
            "success_patterns": "Coordinate maps help facilitate spatial reasoning; FiLM models with coordinate maps more easily localize and answer questions about relative positions and superlatives.",
            "failure_patterns": "Even without coordinate maps, FiLM achieves high accuracy, indicating coordinate maps are helpful but not strictly necessary; models can still exploit spatial information present in convolutional features.",
            "baseline_comparison": "Ablation: 1x1 convs without coordinate maps achieved 95.3% (still high), indicating coordinate maps provide modest benefit but FiLM can induce spatial localization indirectly.",
            "ablation_results": "Model trained with only 1x1 convolutions and without coordinate maps (and global max-pool) still achieved 95.3% accuracy, showing spatial reasoning can be derived from per-location features after FiLM modulation; however, in general coordinate maps were included for best performance.",
            "key_findings": "Explicit per-location coordinate encodings help FiLM perform spatial reasoning, but the core mechanism (feature-wise modulation by language) can indirectly create spatial selectivity from per-location visual features even when explicit coordinates are omitted.",
            "uuid": "e514.3",
            "source_info": {
                "paper_title": "FiLM: Visual Reasoning with a General Conditioning Layer",
                "publication_date_yy_mm": "2017-09"
            }
        }
    ],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "Modulating early visual processing by language",
            "rating": 2
        },
        {
            "paper_title": "A simple neural network module for relational reasoning",
            "rating": 2
        },
        {
            "paper_title": "Inferring and executing programs for visual reasoning",
            "rating": 2
        },
        {
            "paper_title": "Learning to reason: End-to-end module networks for visual question answering",
            "rating": 2
        },
        {
            "paper_title": "Visual interaction networks",
            "rating": 1
        }
    ],
    "cost": 0.013882,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>FiLM: Visual Reasoning with a General Conditioning Layer</h1>
<p>Ethan Perez, ${ }^{1,2}$ Florian Strub, ${ }^{4}$ Harm de Vries, ${ }^{1}$ Vincent Dumoulin, ${ }^{1}$ Aaron Courville ${ }^{1,3}$<br>${ }^{1}$ MILA, Université de Montréal, ${ }^{2}$ Rice University, ${ }^{3}$ CIFAR Fellow,<br>${ }^{4}$ Univ. Lille, CNRS, Centrale Lille, Inria, UMR 9189 CRIStAL France<br>ethanperez@rice.edu, florian.strub@inria.fr, mail@harmdevries.com, {dumouliv,courvila}@iro.umontreal.ca</p>
<h4>Abstract</h4>
<p>We introduce a general-purpose conditioning method for neural networks called FiLM: Feature-wise Linear Modulation. FiLM layers influence neural network computation via a simple, feature-wise affine transformation based on conditioning information. We show that FiLM layers are highly effective for visual reasoning - answering image-related questions which require a multi-step, high-level process - a task which has proven difficult for standard deep learning methods that do not explicitly model reasoning. Specifically, we show on visual reasoning tasks that FiLM layers 1) halve state-of-theart error for the CLEVR benchmark, 2) modulate features in a coherent manner, 3) are robust to ablations and architectural modifications, and 4) generalize well to challenging, new data from few examples or even zero-shot.</p>
<h2>1 Introduction</h2>
<p>The ability to reason about everyday visual input is a fundamental building block of human intelligence. Some have argued that for artificial agents to learn this complex, structured process, it is necessary to build in aspects of reasoning, such as compositionality (Hu et al. 2017; Johnson et al. 2017b) or relational computation (Santoro et al. 2017). However, if a model made from general-purpose components could learn to visually reason, such an architecture would likely be more widely applicable across domains.</p>
<p>To understand if such a general-purpose architecture exists, we take advantage of the recently proposed CLEVR dataset (Johnson et al. 2017a) that tests visual reasoning via question answering. Examples from CLEVR are shown in Figure 1. Visual question answering, the general task of asking questions about images, has its own line of datasets (Malinowski and Fritz 2014; Geman et al. 2015; Antol et al. 2015) which generally focus on asking a diverse set of simpler questions on images, often answerable in a single glance. From these datasets, a number of effective, generalpurpose deep learning models have emerged for visual question answering (Malinowski, Rohrbach, and Fritz 2015; Yang et al. 2016; Lu et al. 2016; Anderson et al. 2017). However, tests on CLEVR show that these general deep learning approaches struggle to learn structured, multi-step reasoning (Johnson et al. 2017a). In particular, these methods tend</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup><img alt="img-0.jpeg" src="img-0.jpeg" />
(a) Q: What number of cylinders are small purple things or yellow rubber things? A: 2
<img alt="img-1.jpeg" src="img-1.jpeg" />
(b) Q: What color is the other object that is the same shape as the large brown matte thing? A: Brown</p>
<p>Figure 1: CLEVR examples and FiLM model answers.
to exploit biases in the data rather than capture complex underlying structure behind reasoning (Goyal et al. 2017).</p>
<p>In this work, we show that a general model architecture can achieve strong visual reasoning with a method we introduce as FiLM: Feature-wise Linear Modulation. A FiLM layer carries out a simple, feature-wise affine transformation on a neural network's intermediate features, conditioned on an arbitrary input. In the case of visual reasoning, FiLM layers enable a Recurrent Neural Network (RNN) over an input question to influence Convolutional Neural Network (CNN) computation over an image. This process adaptively and radically alters the CNN's behavior as a function of the input question, allowing the overall model to carry out a variety of reasoning tasks, ranging from counting to comparing, for example. FiLM can be thought of as a generalization of Conditional Normalization, which has proven highly successful for image stylization (Dumoulin, Shlens, and Kudlur 2017; Ghiasi et al. 2017; Huang and Belongie 2017), speech recognition (Kim, Song, and Bengio 2017), and visual question answering (de Vries et al. 2017), demonstrating FiLM's broad applicability.</p>
<p>In this paper, which expands upon a shorter report (Perez et al. 2017), our key contribution is that we show FiLM is a strong conditioning method by showing the following on visual reasoning tasks:</p>
<ol>
<li>FiLM models achieve state-of-the-art across a variety of visual reasoning tasks, often by significant margins.</li>
<li>FiLM operates in a coherent manner. It learns a complex, underlying structure and manipulates the conditioned network's features in a selective manner. It also enables the</li>
</ol>
<p>CNN to properly localize question-referenced objects.
3. FiLM is robust; many FiLM model ablations still outperform prior state-of-the-art. Notably, we find there is no close link between normalization and the success of a conditioned affine transformation, a previously untouched assumption. Thus, we relax the conditions under which this method can be applied.
4. FiLM models learn from little data to generalize to more complex and/or substantially different data than seen during training. We also introduce a novel FiLM-based zeroshot generalization method that further improves and validates FiLM's generalization capabilities.</p>
<h2>2 Method</h2>
<p>Our model processes the question-image input using FiLM, illustrated in Figure 2. We start by explaining FiLM and then describe our particular model for visual reasoning.</p>
<h3>2.1 Feature-wise Linear Modulation</h3>
<p>FiLM learns to adaptively influence the output of a neural network by applying an affine transformation, or FiLM, to the network's intermediate features, based on some input. More formally, FiLM learns functions $f$ and $h$ which output $\gamma_{i, c}$ and $\beta_{i, c}$ as a function of input $\boldsymbol{x}_{\boldsymbol{i}}$ :</p>
<p>$$
\gamma_{i, c}=f_{c}\left(\boldsymbol{x}<em c="c" i_="i,">{i}\right) \quad \beta</em>\right)
$$}=h_{c}\left(\boldsymbol{x}_{i</p>
<p>where $\gamma_{i, c}$ and $\beta_{i, c}$ modulate a neural network's activations $\boldsymbol{F}_{i, c}$, whose subscripts refer to the $i^{t h}$ input's $c^{t h}$ feature or feature map, via a feature-wise affine transformation:</p>
<p>$$
F i L M\left(\boldsymbol{F}<em c="c" i_="i,">{i, c} \mid \gamma</em>}, \beta_{i, c}\right)=\gamma_{i, c} \boldsymbol{F<em c="c" i_="i,">{i, c}+\beta</em>
$$</p>
<p>$f$ and $h$ can be arbitrary functions such as neural networks. Modulation of a target neural network's processing can be based on the same input to that neural network or some other input, as in the case of multi-modal or conditional tasks. For CNNs, $f$ and $h$ thus modulate the per-feature-map distribution of activations based on $\boldsymbol{x}_{\boldsymbol{i}}$, agnostic to spatial location.</p>
<p>In practice, it is easier to refer to $f$ and $h$ as a single function that outputs one $(\boldsymbol{\gamma}, \boldsymbol{\beta})$ vector, since, for example, it is often beneficial to share parameters across $f$ and $h$ for more efficient learning. We refer to this single function as the FiLM generator. We also refer to the network to which FiLM layers are applied as the Feature-wise Linearly Modulated network, the FiLM-ed network.</p>
<p>FiLM layers empower the FiLM generator to manipulate feature maps of a target, FiLM-ed network by scaling them up or down, negating them, shutting them off, selectively thresholding them (when followed by a ReLU), and more. Each feature map is conditioned independently, giving the FiLM generator moderately fine-grained control over activations at each FiLM layer.</p>
<p>As FiLM only requires two parameters per modulated feature map, it is a scalable and computationally efficient conditioning method. In particular, FiLM has a computational cost that does not scale with the image resolution.
<img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 2: A single FiLM layer for a CNN. The dot signifies a Hadamard product. Various combinations of $\gamma$ and $\beta$ can modulate individual feature maps in a variety of ways.</p>
<h3>2.2 Model</h3>
<p>Our FiLM model consists of a FiLM-generating linguistic pipeline and a FiLM-ed visual pipeline as depicted in Figure 3. The FiLM generator processes a question $\boldsymbol{x}<em i_="i,">{\boldsymbol{i}}$ using a Gated Recurrent Unit (GRU) network (Chung et al. 2014) with 4096 hidden units that takes in learned, 200dimensional word embeddings. The final GRU hidden state is a question embedding, from which the model predicts $\left(\boldsymbol{\gamma}</em>$ residual block via affine projection.}^{n}, \boldsymbol{\beta}_{i,}^{n}\right)$ for each $n^{t h</p>
<p>The visual pipeline extracts $12814 \times 14$ image feature maps from a resized, $224 \times 224$ image input using either a CNN trained from scratch or a fixed, pre-trained feature extractor with a learned layer of $3 \times 3$ convolutions. The CNN trained from scratch consists of 4 layers with $1284 \times$ 4 kernels each, ReLU activations, and batch normalization, similar to prior work on CLEVR (Santoro et al. 2017). The fixed feature extractor outputs the conv4 layer of a ResNet101 (He et al. 2016) pre-trained on ImageNet (Russakovsky et al. 2015) to match prior work on CLEVR (Johnson et al. 2017a; 2017b). Image features are processed by several 4 for our model - FiLM-ed residual blocks (ResBlocks) with 128 feature maps and a final classifier. The classifier consists of a $1 \times 1$ convolution to 512 feature maps, global max-pooling, and a two-layer MLP with 1024 hidden units that outputs a softmax distribution over final answers.</p>
<p>Each FiLM-ed ResBlock starts with a $1 \times 1$ convolution followed by one $3 \times 3$ convolution with an architecture as depicted in Figure 3. We turn the parameters of batch normalization layers that immediately precede FiLM layers off. Drawing from prior work on CLEVR (Hu et al. 2017; Santoro et al. 2017) and visual reasoning (Watters et al. 2017), we concatenate two coordinate feature maps indicating relative x and y spatial position (scaled from -1 to 1) with the image features, each ResBlock's input, and the classifier's input to facilitate spatial reasoning.</p>
<p>We train our model end-to-end from scratch with</p>
<p><img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Figure 3: The FiLM generator (left), FiLM-ed network (middle), and residual block architecture (right) of our model.</p>
<p>Adam (Kingma and Ba 2015) (learning rate $3 e^{-4}$ ), weight decay $\left(1 e^{-5}\right)$, batch size 64 , and batch normalization and ReLU throughout FiLM-ed network. Our model uses only image-question-answer triplets from the training set without data augmentation. We employ early stopping based on validation accuracy, training for 80 epochs maximum. Empirically, we found FiLM had a large capacity, so many architectural and hyperparameter choices were for added regularization.</p>
<p>We stress that our model relies solely on feature-wise affine conditioning to use question information influence the visual pipeline behavior to answer questions. This approach differs from classical visual question answering pipelines which fuse image and language information into a single embedding via element-wise product, concatenation, attention, and/or more advanced methods (Yang et al. 2016; Lu et al. 2016; Anderson et al. 2017).</p>
<h2>3 Related Work</h2>
<p>FiLM can be viewed as a generalization of Conditional Normalization (CN) methods. CN replaces the parameters of the feature-wise affine transformation typical in normalization layers, as introduced originally (Ioffe and Szegedy 2015), with a learned function of some conditioning information. Various forms of CN have proven highly effective across a number of domains: Conditional Instance Norm (Dumoulin, Shlens, and Kudlur 2017; Ghiasi et al. 2017) and Adaptive Instance Norm (Huang and Belongie 2017) for image stylization, Dynamic Layer Norm for speech recognition (Kim, Song, and Bengio 2017), and Conditional Batch Norm for general visual question answering on complex scenes such as VQA and GuessWhat?! (de Vries et al. 2017). This work complements our own, as we seek to show that feature-wise affine conditioning is effective for multi-step reasoning and
understand the underlying mechanism behind its success.
Notably, prior work in CN has not examined whether the affine transformation must be placed directly after normalization. Rather, prior work includes normalization in the method name for instructive purposes or due to implementation details. We investigate the connection between FiLM and normalization, finding it not strictly necessary for the affine transformation to occur directly after normalization. Thus, we provide a unified framework for all of these methods through FiLM, as well as a normalization-free relaxation of this approach which can be more broadly applied.</p>
<p>Beyond CN, there are many connections between FiLM and other conditioning methods. A common approach, used for example in Conditional DCGANs (Radford, Metz, and Chintala 2016), is to concatenate constant feature maps of conditioning information with convolutional layer input. Though not as parameter efficient, this method simply results in a feature-wise conditional bias. Likewise, concatenating conditioning information with fully-connected layer input amounts to a feature-wise conditional bias. Other approaches such as WaveNet (van den Oord et al. 2016a) and Conditional PixelCNN (van den Oord et al. 2016b) directly add a conditional feature-wise bias. These approaches are equivalent to FiLM with $\gamma=1$, which we compare FiLM to in the Experiments section. In reinforcement learning, an alternate formulation of FiLM has been used to train one game-conditioned deep Q-network to play ten Atari games (Kirkpatrick et al. 2017), though FiLM was neither the focus of this work nor analyzed as a major component.</p>
<p>Other methods gate an input's features as a function of that same input, rather than a separate conditioning input. These methods include LSTMs for sequence modeling (Hochreiter and Schmidhuber 1997), Convolutional Sequence to Sequence for machine translation (Gehring et al. 2017), and even the ImageNet 2017 winning model, Squeeze and Excitation Networks (Hu, Shen, and Sun 2017). This approach amounts to a feature-wise, conditional scaling, restricted to between 0 and 1, while FiLM consists of both scaling and shifting, each unrestricted. In the Experiments section, we show the effect of restricting FiLM's scaling to between 0 and 1 for visual reasoning. We find it noteworthy that this general approach of feature modulation is effective across a variety of settings and architectures.</p>
<p>There are even broader links between FiLM and other methods. For example, FiLM can be viewed as using one network to generate parameters of another network, making it a form of hypernetwork (Ha, Dai, and Le 2016). Also, FiLM has potential ties with conditional computation and mixture of experts methods, where specialized network subparts are active on a per-example basis (Jordan and Jacobs 1994; Eigen, Ranzato, and Sutskever 2014; Shazeer et al. 2017); we later provide evidence that FiLM learns to selectively highlight or suppress feature maps based on conditioning information. Those methods select at a sub-network level while FiLM selects at a feature map level.</p>
<p>In the domain of visual reasoning, one leading method is the Program Generator + Execution Engine model (Johnson et al. 2017b). This approach consists of a sequence-to-sequence Program Generator, which takes in a question</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th style="text-align: center;">Overall</th>
<th style="text-align: center;">Count</th>
<th style="text-align: center;">Exist</th>
<th style="text-align: center;">Compare <br> Numbers</th>
<th style="text-align: center;">Query <br> Attribute</th>
<th style="text-align: center;">Compare <br> Attribute</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Human (Johnson et al. 2017b)</td>
<td style="text-align: center;">92.6</td>
<td style="text-align: center;">86.7</td>
<td style="text-align: center;">96.6</td>
<td style="text-align: center;">86.5</td>
<td style="text-align: center;">95.0</td>
<td style="text-align: center;">96.0</td>
</tr>
<tr>
<td style="text-align: left;">Q-type baseline (Johnson et al. 2017b)</td>
<td style="text-align: center;">41.8</td>
<td style="text-align: center;">34.6</td>
<td style="text-align: center;">50.2</td>
<td style="text-align: center;">51.0</td>
<td style="text-align: center;">36.0</td>
<td style="text-align: center;">51.3</td>
</tr>
<tr>
<td style="text-align: left;">LSTM (Johnson et al. 2017b)</td>
<td style="text-align: center;">46.8</td>
<td style="text-align: center;">41.7</td>
<td style="text-align: center;">61.1</td>
<td style="text-align: center;">69.8</td>
<td style="text-align: center;">36.8</td>
<td style="text-align: center;">51.8</td>
</tr>
<tr>
<td style="text-align: left;">CNN+LSTM (Johnson et al. 2017b)</td>
<td style="text-align: center;">52.3</td>
<td style="text-align: center;">43.7</td>
<td style="text-align: center;">65.2</td>
<td style="text-align: center;">67.1</td>
<td style="text-align: center;">49.3</td>
<td style="text-align: center;">53.0</td>
</tr>
<tr>
<td style="text-align: left;">CNN+LSTM+SA (Santoro et al. 2017)</td>
<td style="text-align: center;">76.6</td>
<td style="text-align: center;">64.4</td>
<td style="text-align: center;">82.7</td>
<td style="text-align: center;">77.4</td>
<td style="text-align: center;">82.6</td>
<td style="text-align: center;">75.4</td>
</tr>
<tr>
<td style="text-align: left;">N2NMN* (Hu et al. 2017)</td>
<td style="text-align: center;">83.7</td>
<td style="text-align: center;">68.5</td>
<td style="text-align: center;">85.7</td>
<td style="text-align: center;">84.9</td>
<td style="text-align: center;">90.0</td>
<td style="text-align: center;">88.7</td>
</tr>
<tr>
<td style="text-align: left;">PG+EE (9K prog.)* (Johnson et al. 2017b)</td>
<td style="text-align: center;">88.6</td>
<td style="text-align: center;">79.7</td>
<td style="text-align: center;">89.7</td>
<td style="text-align: center;">79.1</td>
<td style="text-align: center;">92.6</td>
<td style="text-align: center;">96.0</td>
</tr>
<tr>
<td style="text-align: left;">PG+EE (700K prog.)* (Johnson et al. 2017b)</td>
<td style="text-align: center;">96.9</td>
<td style="text-align: center;">92.7</td>
<td style="text-align: center;">97.1</td>
<td style="text-align: center;">$\mathbf{9 8 . 7}$</td>
<td style="text-align: center;">98.1</td>
<td style="text-align: center;">98.9</td>
</tr>
<tr>
<td style="text-align: left;">CNN+LSTM+RN $\dagger \ddagger$ (Santoro et al. 2017)</td>
<td style="text-align: center;">95.5</td>
<td style="text-align: center;">90.1</td>
<td style="text-align: center;">97.8</td>
<td style="text-align: center;">93.6</td>
<td style="text-align: center;">97.9</td>
<td style="text-align: center;">97.1</td>
</tr>
<tr>
<td style="text-align: left;">CNN+GRU+FiLM</td>
<td style="text-align: center;">$\mathbf{9 7 . 7}$</td>
<td style="text-align: center;">$\mathbf{9 4 . 3}$</td>
<td style="text-align: center;">99.1</td>
<td style="text-align: center;">96.8</td>
<td style="text-align: center;">99.1</td>
<td style="text-align: center;">99.1</td>
</tr>
<tr>
<td style="text-align: left;">CNN+GRU+FiLM $\ddagger$</td>
<td style="text-align: center;">97.6</td>
<td style="text-align: center;">$\mathbf{9 4 . 3}$</td>
<td style="text-align: center;">$\mathbf{9 9 . 3}$</td>
<td style="text-align: center;">93.4</td>
<td style="text-align: center;">$\mathbf{9 9 . 3}$</td>
<td style="text-align: center;">$\mathbf{9 9 . 3}$</td>
</tr>
</tbody>
</table>
<p>Table 1: CLEVR accuracy (overall and per-question-type) by baselines, competing methods, and FiLM. (*) denotes use of extra supervision via program labels. ( $\dagger$ ) denotes use of data augmentation. ( $\ddagger$ ) denotes training from raw pixels.
and outputs a sequence corresponding to a tree of composable neural modules, each of which is a two or three layer residual block. This tree of neural modules is assembled to form the Execution Engine that then predicts an answer from the image. This modular approach is part of a line of neural module network methods (Andreas et al. 2016a; 2016b; Hu et al. 2017), of which End-to-End Module Networks (Hu et al. 2017) have also been tested on visual reasoning. These models use strong priors by explicitly modeling the compositional nature of reasoning and by training with additional program labels, i.e. ground-truth step-by-step instructions on how to correctly answer a question. End-to-End Module Networks further build in model biases via per-module, hand-crafted neural architectures for specific functions. Our approach learns directly from visual and textual input without additional cues or a specialized architecture.</p>
<p>Relation Networks (RNs) are another leading approach for visual reasoning (Santoro et al. 2017). RNs succeed by explicitly building in a comparison-based prior. RNs use an MLP to carry out pairwise comparisons over each location of extracted convolutional features over an image, including LSTM-extracted question features as input to this MLP. RNs then element-wise sum over the resulting comparison vectors to form another vector from which a final classifier predicts the answer. We note that RNs have a computational cost that scales quadratically in spatial resolution, while FiLM's cost is independent of spatial resolution. Notably, since RNs concatenate question features with MLP input, a form of feature-wise conditional biasing as explained earlier, their conditioning approach is related to FiLM.</p>
<h2>4 Experiments</h2>
<p>First, we test our model on visual reasoning with the CLEVR task and use trained FiLM models to analyze what FiLM learns. Second, we explore how well our model generalizes to more challenging questions with the CLEVR-Humans task. Finally, we examine how FiLM performs in fewshot and zero-shot generalization settings using the CLEVR Compositional Generalization Test. Our code is available at https://github.com/ethanjperez/film.</p>
<h3>4.1 CLEVR Task</h3>
<p>CLEVR is a synthetic dataset of 700K (image, question, answer, program) tuples (Johnson et al. 2017a). Images contain 3D-rendered objects of various shapes, materials, colors, and sizes. Questions are multi-step and compositional in nature, as shown in Figure 1. They range from counting questions ("How many green objects have the same size as the green metallic block?") to comparison questions ("Are there fewer tiny yellow cylinders than yellow metal cubes?") and can be 40+ words long. Answers are each one word from a set of 28 possible answers. Programs are an additional supervisory signal consisting of step-by-step instructions, such as filter_shape [cube], relate [right], and count, on how to answer the question.</p>
<p>Baselines We compare against the following methods, discussed in detail in the Related Work section:</p>
<ul>
<li>Q-type baseline: Predicts based on a question's category.</li>
<li>LSTM: Predicts using only the question.</li>
<li>CNN+LSTM: MLP prediction over CNN-extracted image features and LSTM-extracted question features.</li>
<li>Stacked Attention Networks (CNN+LSTM+SA): Linear prediction over CNN-extracted image feature and LSTM-extracted question features combined via two rounds of soft spatial attention (Yang et al. 2016).</li>
<li>End-to-End Module Networks (N2NMN) and Program Generator + Execution Engine (PG+EE): Methods in which separate neural networks learn separate subfunctions and are assembled into a question-dependent structure (Hu et al. 2017; Johnson et al. 2017b).</li>
<li>Relation Networks (CNN+LSTM+RN): An approach which builds in pairwise comparisons over spatial locations to explicitly model reasoning's relational nature (Santoro et al. 2017).</li>
</ul>
<p>Results FiLM achieves a new overall state-of-the-art on CLEVR, as shown in Table 1, outperforming humans and previous methods, including those using explicit models of reasoning, program supervision, and/or data augmentation.</p>
<p><img alt="img-4.jpeg" src="img-4.jpeg" /></p>
<p>Figure 4: Visualizations of the distribution of locations which the model uses for its globally max-pooled features which its final MLP predicts from. FiLM correctly localizes the answer-referenced object (top) or all question-referenced objects (bottom), but not as accurately when it answers incorrectly (rightmost bottom). Questions and images used match (Johnson et al. 2017b).</p>
<p>For methods not using extra supervision, FiLM roughly halves state-of-the-art error (from $4.5 \%$ to $2.3 \%$ ). Note that using pre-trained image features as input can be viewed as a form of data augmentation in itself but that FiLM performs equally well using raw pixel inputs. Interestingly, the raw pixel model seems to perform better on lower-level questions (i.e. querying and comparing attributes) while the image features model seems to perform better on higher-level questions (i.e. compare numbers of objects).</p>
<h3>4.2 What Do FiLM Layers Learn?</h3>
<p>To understand how FiLM visually reasons, we visualize activations to observe the net result of FiLM layers. We also use histograms and t-SNE (van der Maaten and Hinton 2008) to find patterns in the learned FiLM $\gamma$ and $\beta$ themselves.</p>
<p>Activation Visualizations Figure 4 visualizes the distribution of locations responsible for the globally-pooled features which the MLP in the model's final classifier uses to predict answers. These images reveal that the FiLM model predicts using features of areas near answer-related or question-related objects, as the high CLEVR accuracy also suggests. This finding highlights that appropriate feature modulation indirectly results in spatial modulation, as regions with question-relevant features will have large activations while other regions will not. This observation might explain why FiLM outperforms Stacked Attention, the next best method not explicitly built for reasoning, so significantly ( $21 \%$ ); FiLM appears to carry many of spatial attention's benefits, while also influencing feature representation.</p>
<p>Figure 4 also suggests that the FiLM-ed network carries out reasoning throughout its pipeline. In the top example, the FiLM-ed network has localized the answer-referenced object alone before the MLP classifier. In the bottom example, the FiLM-ed network retains, for the MLP classifier, features on objects that are not referred to by the answer but are referred to by the question. The latter example provides ev-
<img alt="img-5.jpeg" src="img-5.jpeg" /></p>
<p>Figure 5: Histograms of $\gamma_{i, c}$ (left) and $\beta_{i, c}$ (right) values over all FiLM layers, calculated over the validation set.
idence that the final MLP itself carries out some reasoning, using FiLM to extract relevant features for its reasoning.
FiLM Parameter Histograms To analyze at a lower level how FiLM uses the question to condition the visual pipeline, we plot $\gamma$ and $\beta$ values predicted over the validation set, as shown in Figure 5. $\gamma$ and $\beta$ values take advantage of a sizable range, varying from -15 to 19 and from -9 to 16 , respectively. $\gamma$ values show a sharp peak at 0 , showing that FiLM learns to use the question to shut off or significantly suppress whole feature maps. Simultaneously, FiLM learns to upregulate a much more selective set of other feature maps with high magnitude $\gamma$ values. Furthermore, a large fraction $(36 \%)$ of $\gamma$ values are negative; since our model uses a ReLU after FiLM, $\gamma&lt;0$ can cause a significantly different set of activations to pass the ReLU to downstream layers than $\gamma&gt;0$. Also, $76 \%$ of $\beta$ values are negative, suggesting that FiLM also uses $\beta$ to be selective about which activations pass the ReLU. We show later that FiLM's success is largely architecture-agnostic, but examining a particular model gives insight into the influence FiLM learns to exert in a specific case. Together, these findings suggest that FiLM learns to selectively upregulate, downregulate, and shut off feature maps based on conditioning information.
FiLM Parameters t-SNE Plot In Figure 6, we visualize FiLM parameter vectors $(\boldsymbol{\gamma}, \boldsymbol{\beta})$ for 3,000 random valida-</p>
<p><img alt="img-6.jpeg" src="img-6.jpeg" /></p>
<p>Figure 6: t-SNE plots of $(\gamma, \boldsymbol{\beta})$ of the first (left) and last (right) FiLM layers of a 6-FiLM layer Network. FiLM parameters cluster by low-level reasoning functions in the first layer and by high-level reasoning functions in the last layer.
tion points with t-SNE. We analyze the deeper, 6-ResBlock version of our model, which has a similar validation accuracy as our 4-ResBlock model, to better examine how FiLM layers in different layers of a hierarchy behave. First and last layer FiLM $(\boldsymbol{\gamma}, \boldsymbol{\beta})$ are grouped by the low-level and high-level reasoning functions necessary to answer CLEVR questions, respectively. For example, FiLM parameters for equal_color and query_color are close for the first layer but apart for the last layer. The same is true for shape, size and material questions. Conversely, equal_shape, equal_size, and equal_material FiLM parameters are grouped in the last layer but split in the first layer - likewise for other high level groupings such as integer comparison and querying. These findings suggest that FiLM layers learn a sort of function-based modularity without an architectural prior. Simply with end-to-end training, FiLM learns to handle not only different types of questions differently, but also different types of question sub-parts differently; the FiLM model works from low-level to high-level processes as is the proper approach. For models with fewer FiLM layers, such patterns also appear, but less clearly; these models must begin higher level reasoning sooner.</p>
<h3>4.3 Ablations</h3>
<p>Using the validation set, we conduct an ablation study on our best model to understand how FiLM learns visual reasoning. We show results for test time ablations in Figure 7, for architectural ablations in Table 2, and for varied model depths in Table 3. Without hyperparameter tuning, most architectural ablations and model depths outperform prior state-of-the-art on training from only image-question-answer triplets, supporting FiLM's overall robustness. Table 3 also shows using the validation set that our results are statistically significant.
Effect of $\gamma$ and $\beta$ To test the effect of $\gamma$ and $\boldsymbol{\beta}$ separately, we trained one model with a constant $\gamma=\mathbf{1}$ and another with $\boldsymbol{\beta}=\mathbf{0}$. With these models, we find a $1.5 \%$ and $.5 \%$ accuracy drop, respectively; FiLM can learn to condition the CNN for visual reasoning through either biasing or scaling alone, albeit not as well as conditioning both together. This
<img alt="img-7.jpeg" src="img-7.jpeg" /></p>
<p>Figure 7: An analysis of how robust FiLM parameters are to noise at test time. The horizontal lines correspond to setting $\gamma$ or $\beta$ to their respective training set mean values.
result also suggests that $\gamma$ is more important than $\boldsymbol{\beta}$.
To further compare the importance of $\gamma$ and $\boldsymbol{\beta}$, we run a series of test time ablations (Figure 7) on our best, fullytrained model. First, we replace $\boldsymbol{\beta}$ with the mean $\boldsymbol{\beta}$ across the training set. This ablation in effect removes all conditioning information from $\boldsymbol{\beta}$ parameters during test time, from a model trained to use both $\gamma$ and $\boldsymbol{\beta}$. Here, we find that accuracy only drops by $1.0 \%$, while the same procedure on $\gamma$ results in a $65.4 \%$ drop. This large difference suggests that, in practice, FiLM largely conditions through $\gamma$ rather than $\boldsymbol{\beta}$. Next, we analyze performance as we add increasingly more Gaussian noise to the best model's FiLM parameters at test time. Noise in gamma hurts performance significantly more, showing FiLM's higher sensitivity to changes in $\gamma$ than in $\boldsymbol{\beta}$ and corroborating the relatively greater importance of $\gamma$.</p>
<p>Restricting $\gamma$ To understand what aspect of $\gamma$ is most effective, we train a model that limits $\gamma$ to $(0,1)$ using sigmoid, as many models which use feature-wise, multiplicative gating do. Likewise, we also limit $\gamma$ to $(-1,1)$ using tanh. Both restrictions hurt performance, roughly as much as removing conditioning from $\gamma$ entirely by training with $\gamma=\mathbf{1}$. Thus, FiLM's ability to scale features by large magnitudes appears to contribute to its success. Limiting $\gamma$ to</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th style="text-align: left;">Overall</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Restricted $\gamma$ or $\boldsymbol{\beta}$</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">FiLM with $\boldsymbol{\beta}:=\mathbf{0}$</td>
<td style="text-align: left;">96.9</td>
</tr>
<tr>
<td style="text-align: left;">FiLM with $\gamma:=\mathbf{1}$</td>
<td style="text-align: left;">95.9</td>
</tr>
<tr>
<td style="text-align: left;">FiLM with $\gamma:=\sigma(\gamma)$</td>
<td style="text-align: left;">95.9</td>
</tr>
<tr>
<td style="text-align: left;">FiLM with $\gamma:=\tanh (\gamma)$</td>
<td style="text-align: left;">96.3</td>
</tr>
<tr>
<td style="text-align: left;">FiLM with $\gamma:=\exp (\gamma)$</td>
<td style="text-align: left;">96.3</td>
</tr>
<tr>
<td style="text-align: left;">Moving FiLM within ResBlock</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">FiLM after residual connection</td>
<td style="text-align: left;">96.6</td>
</tr>
<tr>
<td style="text-align: left;">FiLM after ResBlock ReLU-2</td>
<td style="text-align: left;">97.7</td>
</tr>
<tr>
<td style="text-align: left;">FiLM after ResBlock Conv-2</td>
<td style="text-align: left;">97.1</td>
</tr>
<tr>
<td style="text-align: left;">FiLM before ResBlock Conv-1</td>
<td style="text-align: left;">95.0</td>
</tr>
<tr>
<td style="text-align: left;">Removing FiLM from ResBlocks</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">No FiLM in ResBlock 4</td>
<td style="text-align: left;">96.8</td>
</tr>
<tr>
<td style="text-align: left;">No FiLM in ResBlock 3-4</td>
<td style="text-align: left;">96.5</td>
</tr>
<tr>
<td style="text-align: left;">No FiLM in ResBlock 2-4</td>
<td style="text-align: left;">97.3</td>
</tr>
<tr>
<td style="text-align: left;">No FiLM in ResBlock 1-4</td>
<td style="text-align: left;">21.4</td>
</tr>
<tr>
<td style="text-align: left;">Miscellaneous</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">$1 \times 1$ conv only, with no coord. maps</td>
<td style="text-align: left;">95.3</td>
</tr>
<tr>
<td style="text-align: left;">No residual connection</td>
<td style="text-align: left;">94.0</td>
</tr>
<tr>
<td style="text-align: left;">No batch normalization</td>
<td style="text-align: left;">93.7</td>
</tr>
<tr>
<td style="text-align: left;">Replace image features with raw pixels</td>
<td style="text-align: left;">97.6</td>
</tr>
<tr>
<td style="text-align: left;">Best Architecture</td>
<td style="text-align: left;">$97.4 \pm .4$</td>
</tr>
</tbody>
</table>
<p>Table 2: CLEVR val accuracy for ablations, trained with the best architecture with only specified changes. We report the standard deviation of the best model accuracy over 5 runs.
$(0, \infty)$ with exp also hurts performance, validating the value of FiLM's capacity to negate and zero out feature maps.</p>
<p>Conditional Normalization We perform an ablation study on the placement of FiLM to evaluate the relationship between normalization and FiLM that Conditional Normalization approaches assume. Unfortunately, it is difficult to accurately decouple the effect of FiLM from normalization by simply training our corresponding model without normalization, as normalization significantly accelerates, regularizes, and improves neural network learning (Ioffe and Szegedy 2015), but we include these results for completeness. However, we find no substantial performance drop when moving FiLM layers to different parts of our model's ResBlocks; we even reach the upper end of the best model's performance range when placing FiLM after the post-normalization ReLU in the ResBlocks. Thus, we decouple the name from normalization for clarity regarding where the fundamental effectiveness of the method comes from. By demonstrating this conditioning mechanism is not closely connected to normalization, we open the doors to applications other settings in which normalization is less common, such as RNNs and reinforcement learning, which are promising directions for future work with FiLM.</p>
<p>Repetitive Conditioning To understand the contribution of repetitive conditioning towards FiLM model success, we train FiLM models with successively fewer FiLM layers. Models with fewer FiLM layers, even a single FiLM layer,</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th style="text-align: right;">Overall</th>
<th style="text-align: left;">Model</th>
<th style="text-align: right;">Overall</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1 ResBlock</td>
<td style="text-align: right;">93.5</td>
<td style="text-align: left;">6 ResBlocks</td>
<td style="text-align: right;">97.7</td>
</tr>
<tr>
<td style="text-align: left;">2 ResBlocks</td>
<td style="text-align: right;">97.1</td>
<td style="text-align: left;">7 ResBlocks</td>
<td style="text-align: right;">97.4</td>
</tr>
<tr>
<td style="text-align: left;">3 ResBlocks</td>
<td style="text-align: right;">96.7</td>
<td style="text-align: left;">8 ResBlocks</td>
<td style="text-align: right;">97.6</td>
</tr>
<tr>
<td style="text-align: left;">4 ResBlocks</td>
<td style="text-align: right;">$97.4 \pm .4$</td>
<td style="text-align: left;">12 ResBlocks</td>
<td style="text-align: right;">96.9</td>
</tr>
<tr>
<td style="text-align: left;">5 ResBlocks</td>
<td style="text-align: right;">97.4</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p>Table 3: CLEVR val accuracy by FiLM model depth.
do not deviate far from the best model's performance, revealing that the model can reason and answer diverse questions successfully by modulating features even just once. This observation highlights the capacity of even one FiLM layer. Perhaps one FiLM layer can pass enough question information to the CNN to enable it to carry out reasoning later in the network, in place of the more hierarchical conditioning deeper FiLM models appear to use. We leave more in-depth investigation of this matter for future work.</p>
<p>Spatial Reasoning To examine how FiLM models approach spatial reasoning, we train a version of our best model architecture, from image features, with only $1 \times 1$ convolutions and without feeding coordinate feature maps indicating relative spatial position to the model. Due to the global max-pooling near the end of the model, this model cannot transfer information across spatial positions. Notably, this model still achieves a high $95.3 \%$ accuracy, indicating that FiLM models are able to reason about space simply from the spatial information contained in a single location of fixed image features.</p>
<p>Residual Connection Removing the residual connection causes one of the larger accuracy drops. Since there is a global max-pooling operation near the end of the network, this finding suggests that the best model learns to primarily use features of locations that are repeatedly important throughout lower and higher levels of reasoning to make its final decision. The higher accuracies for models with FiLM modulating features inside residual connections rather than outside residual connections supports this hypothesis.</p>
<p>Model Depth Table 3 shows model performance by the number of ResBlocks. FiLM is robust to varying depth but less so with only 1 ResBlock, backing the earlier theory that the FiLM-ed network reasons throughout its pipeline.</p>
<h3>4.4 CLEVR-Humans: Human-Posed Questions</h3>
<p>To assess how well visual reasoning models generalize to more realistic, complex, and free-form questions, the CLEVR-Humans dataset was introduced (Johnson et al. 2017b). This dataset contains human-posed questions on CLEVR images along with their corresponding answers. The number of samples is limited - 18 K for training, 7 K for validation, and 7 K for testing. The questions were collected from Amazon Mechanical Turk workers prompted to ask questions that were likely hard for a smart robot to answer. As a result, CLEVR-Humans questions use more diverse vocabulary and complex concepts.</p>
<p><img alt="img-8.jpeg" src="img-8.jpeg" /></p>
<p>Q: What object is the color of grass? A: Cylinder
<img alt="img-9.jpeg" src="img-9.jpeg" /></p>
<p>Q: Which shape objects are partially obscured from view? A: Sphere
<img alt="img-10.jpeg" src="img-10.jpeg" /></p>
<p>Q: What color is the matte object farthest to the right? A: Brown
<img alt="img-11.jpeg" src="img-11.jpeg" /></p>
<p>Q: If all cubical objects were removed what shaped objects would there be the most of? A: Sphere (P: Rubber)</p>
<p>Figure 8: Examples from CLEVR-Humans, which introduces new words (underlined) and concepts. After fine-tuning on CLEVR-Humans, a CLEVR-trained model can now reason about obstruction, superlatives, and reflections but still struggles with hypothetical scenarios (rightmost). It also has learned human preference to primarily identify objects by shape (leftmost).</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th style="text-align: center;">Train <br> CLEVR</th>
<th style="text-align: center;">Train CLEVR, <br> fine-tune human</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">LSTM</td>
<td style="text-align: center;">27.5</td>
<td style="text-align: center;">36.5</td>
</tr>
<tr>
<td style="text-align: left;">CNN+LSTM</td>
<td style="text-align: center;">37.7</td>
<td style="text-align: center;">43.2</td>
</tr>
<tr>
<td style="text-align: left;">CNN+LSTM+SA+MLP</td>
<td style="text-align: center;">50.4</td>
<td style="text-align: center;">57.6</td>
</tr>
<tr>
<td style="text-align: left;">PG+EE (18K prog.)</td>
<td style="text-align: center;">54.0</td>
<td style="text-align: center;">66.6</td>
</tr>
<tr>
<td style="text-align: left;">CNN+GRU+FiLM</td>
<td style="text-align: center;">$\mathbf{5 6 . 6}$</td>
<td style="text-align: center;">$\mathbf{7 5 . 9}$</td>
</tr>
</tbody>
</table>
<p>Table 4: CLEVR-Humans test accuracy, before (left) and after (right) fine-tuning on CLEVR-Humans data</p>
<p>Method To test FiLM on CLEVR-Humans, we take our best CLEVR-trained FiLM model and fine-tune its FiLMgenerating linguistic pipeline alone on CLEVR-Humans. Similar to prior work (Johnson et al. 2017b), we do not update the visual pipeline on CLEVR-Humans to mitigate overfitting to the small training set.</p>
<p>Results Our model achieves state-of-the-art generalization to CLEVR-Humans, both before and after fine-tuning, as shown in Table 4, indicating that FiLM is well-suited to handle more complex and diverse questions. Figure 8 shows examples from CLEVR-Humans with FiLM model answers. Before fine-tuning, FiLM outperforms prior methods by a smaller margin. After fine-tuning, FiLM reaches a considerably improved final accuracy. In particular, the gain in accuracy made by FiLM upon fine-tuning is more than $50 \%$ greater than those made by other models; FiLM adapts dataefficiently using the small CLEVR-Humans dataset.</p>
<p>Notably, FiLM surpasses the prior state-of-the-art method, Program Generator + Execution Engine (PG+EE), after fine-tuning by $9.3 \%$. Prior work on PG+EEs explains that this neural module network method struggles on questions which cannot be well approximated with the model's module inventory (Johnson et al. 2017b). In contrast, FiLM has the freedom to modulate existing feature maps, a fairly flexible and fine-grained operation, in novel ways to reason about new concepts. These results thus provide some evidence for the benefits of FiLM's general nature.
<img alt="img-12.jpeg" src="img-12.jpeg" /></p>
<p>Figure 9: CoGenT results. FiLM ValB accuracy reported on ValB without the 30K fine-tuning samples (Figure). Accuracy before and after fine-tuning on 30K of ValB (Table).</p>
<h3>4.5 CLEVR Compositional Generalization Test</h3>
<p>To test how well models learn compositional concepts that generalize, CLEVR-CoGenT was introduced (Johnson et al. 2017a). This dataset is synthesized in the same way as CLEVR but contains two conditions: in Condition A, all cubes are gray, blue, brown, or yellow and all cylinders are red, green, purple, or cyan; in Condition B, cubes and cylinders swap color palettes. Both conditions contain spheres of all colors. CLEVR-CoGenT thus indicates how a model answers CLEVR questions: by memorizing combinations of traits or by learning disentangled or general representations.</p>
<p>Results We train our best model architecture on Condition A and report accuracies on Conditions A and B, before and after fine-tuning on B, in Figure 9. Our results indicate FiLM surpasses other visual reasoning models at learning general concepts. FiLM learns better compositional generalization even than PG+EE, which explicitly models compositionality and is trained with program-level supervision that specifically includes filtering colors and filtering shapes.</p>
<p>Sample Efficiency and Catastrophic Forgetting We show sample efficiency and forgetting curves in Figure 9. FiLM achieves prior state-of-the-art accuracy with $1 / 3$ as much fine-tuning data. However, our FiLM model still suffers from catastrophic forgetting after fine-tuning.</p>
<p>Zero-Shot Generalization FiLM's accuracy on Condition A is much higher than on B, suggesting FiLM has memorized attribute combinations to an extent. For example, the model learns a bias that cubes are not cyan, as learning this training set bias helps minimize training loss.</p>
<p>To overcome this bias, we develop a novel FiLM-based zero-shot generalization method. Inspired by word embedding manipulations, e.g. "King" - "Man" + "Woman" = "Queen" (Mikolov et al. 2013), we test if linear manipulation extends to reasoning with FiLM. We compute $(\boldsymbol{\gamma}, \boldsymbol{\beta})$ for "How many cyan cubes are there?" via the linear combination of questions in the FiLM parameter space: "How many cyan spheres are there?" + "How many brown cubes are there?" - "How many brown spheres are there?". With this $(\boldsymbol{\gamma}, \boldsymbol{\beta})$, our model can correctly count cyan cubes. We show another example of this method in Figure 10.</p>
<p>We evaluate this method on validation B, using a parser to automatically generate the right combination of questions. We test previously reported CLEVR-CoGenT FiLM models with this method and show results in Figure 9. With this method, there is a $3.2 \%$ overall accuracy gain when training on A and testing for zero-shot generalization on B. Yet this method could only be applied to $1 / 3$ of questions in B. For these questions, model accuracy starts at $71.5 \%$ and jumps to $80.7 \%$. Before fine-tuning on B, the accuracy between zero-shot and original approaches on A is identical, likewise for B after fine-tuning. We note that difference in the predicted FiLM parameters between these two methods is negligible, likely causing the similar performance.</p>
<p>We achieve these improvements without specifically training our model for zero-shot generalization. Our method simply allows FiLM to take advantage of any concept disentanglement in the CNN after training. We also observe that convex combinations of the FiLM parameters - i.e. between "How many cyan things are there?" and "How many brown things are there?" - often monotonically interpolates the predicted answer between the answers to endpoint questions. These results highlight, to a limited extent, the flexibility of FiLM parameters for meaningful manipulations.</p>
<p>As implemented, this method has many limitations. However, approaches from word embeddings, representation learning, and zero-shot learning can be applied to directly optimize $(\boldsymbol{\gamma}, \boldsymbol{\beta})$ for analogy-making (Bordes et al. 2013; Guu, Miller, and Liang 2015; Oh et al. 2017). The FiLM-ed network could directly train with this procedure via backpropagation. A learned model could also replace the parser. We find such avenues promising for future work.</p>
<h2>5 Conclusion</h2>
<p>We show that a model can achieve strong visual reasoning using general-purpose Feature-wise Linear Modulation layers. By efficiently manipulating a neural network's intermediate features in a selective and meaningful manner using
<img alt="img-13.jpeg" src="img-13.jpeg" /></p>
<p>Figure 10: A CLEVR-CoGenT example. The combination of concepts "blue" and "cylinder" is not in the training set. Our zero-shot method computes the original question's FiLM parameters via linear combination of three other questions' FiLM parameters: (1) + (2) - (3). This method corrects our model's answer from "rubber" to "metal".</p>
<p>FiLM layers, a RNN can effectively use language to modulate a CNN to carry out diverse and multi-step reasoning tasks over an image. Our ablation study suggests that FiLM is resilient to architectural modifications, test time ablations, and even restrictions on FiLM layers themselves. Notably, we provide evidence that FiLM's success is not closely connected with normalization as previously assumed. Thus, we open the door for applications of this approach to settings where normalization is less common, such as RNNs and reinforcement learning. Our findings also suggest that FiLM models can generalize better, more sample efficiently, and even zero-shot to foreign or more challenging data. Overall, the results of our investigation of FiLM in the case of visual reasoning complement broader literature that demonstrates the success of FiLM-like techniques across many domains, supporting the case for FiLM's strength not simply within a single domain but as a general, versatile approach.</p>
<h2>6 Acknowledgements</h2>
<p>We thank the developers of PyTorch (pytorch.org) and (Johnson et al. 2017b) for open-source code which our implementation was based off. We thank Mohammad Pezeshki, Dzmitry Bahdanau, Yoshua Bengio, Nando de Freitas, Hugo Larochelle, Laurens van der Maaten, Joseph Cohen, Joelle Pineau, Olivier Pietquin, Jérémie Mary, César Laurent, Chin-Wei Huang, Layla Asri, Max Smith, and James Ough for helpful discussions and Justin Johnson for CLEVR test evaluations. We thank NVIDIA for donating a DGX-1 computer used in this work. We also acknowledge FRQNT through the CHIST-ERA IGLU project and CPER Nord-Pas de Calais/FEDER DATA Advanced data science and technologies 2015-2020 for funding our work. Lastly, we thank acronymcreator.net for the acronym FiLM.</p>
<h2>References</h2>
<p>Anderson, P.; He, X.; Buehler, C.; Teney, D.; Johnson, M.; Gould, S.; and Zhang, L. 2017. Bottom-up and top-down attention for image captioning and vqa. In VQA Workshop at CVPR.
Andreas, J.; Marcus, R.; Darrell, T.; and Klein, D. 2016a. Learn-</p>
<p>ing to compose neural networks for question answering. In NAACL.
Andreas, J.; Rohrbach, M.; Darrell, T.; and Klein, D. 2016b. Neural module networks. In CVPR.
Antol, S.; Agrawal, A.; Lu, J.; Mitchell, M.; Batra, D.; Zitnick, C. L.; and Parikh, D. 2015. VQA: Visual Question Answering. In ICCV.
Bordes, A.; Usunier, N.; Garcia-Duran, A.; Weston, J.; and Yakhnenko, O. 2013. Translating embeddings for modeling multi-relational data. In Burges, C. J. C.; Bottou, L.; Welling, M.; Ghahramani, Z.; and Weinberger, K. Q., eds., NIPS. Curran Associates, Inc. 2787-2795.
Chung, J.; Gülçehre, Ç.; Cho, K.; and Bengio, Y. 2014. Empirical evaluation of gated recurrent neural networks on sequence modeling. In Deep Learning Workshop at NIPS.
de Vries, H.; Strub, F.; Mary, J.; Larochelle, H.; Pietquin, O.; and Courville, A. C. 2017. Modulating early visual processing by language. In NIPS.
Dumoulin, V.; Shlens, J.; and Kudlur, M. 2017. A learned representation for artistic style. In $I C L R$.
Eigen, D.; Ranzato, M.; and Sutskever, I. 2014. Learning factored representations in a deep mixture of experts. In ICLR Workshops.
Gehring, J.; Auli, M.; Grangier, D.; Yarats, D.; and Dauphin, Y. N. 2017. Convolutional sequence to sequence learning. In ICML.
Geman, D.; Geman, S.; Hallonquist, N.; and Younes, L. 2015. Visual turing test for computer vision systems. volume 112, 36183623. National Acad Sciences.</p>
<p>Ghiasi, G.; Lee, H.; Kudlur, M.; Dumoulin, V.; and Shlens, J. 2017. Exploring the structure of a real-time, arbitrary neural artistic stylization network. CoRR abs/1705.06830.
Goyal, Y.; Khot, T.; Summers-Stay, D.; Batra, D.; and Parikh, D. 2017. Making the V in VQA matter: Elevating the role of image understanding in Visual Question Answering. In CVPR.
Guu, K.; Miller, J.; and Liang, P. 2015. Traversing knowledge graphs in vector space. In EMNLP.
Ha, D.; Dai, A.; and Le, Q. 2016. Hypernetworks. In ICLR.
He, K.; Zhang, X.; Ren, S.; and Sun, J. 2016. Deep residual learning for image recognition. In CVPR.
Hochreiter, S., and Schmidhuber, J. 1997. Long short-term memory. Neural Comput. 9(8):1735-1780.
Hu, R.; Andreas, J.; Rohrbach, M.; Darrell, T.; and Saenko, K. 2017. Learning to reason: End-to-end module networks for visual question answering. In ICCV.
Hu, J.; Shen, L.; and Sun, G. 2017. Squeeze-and-Excitation Networks. In ILSVRC 2017 Workshop at CVPR.
Huang, X., and Belongie, S. 2017. Arbitrary style transfer in real-time with adaptive instance normalization. In ICCV.
Ioffe, S., and Szegedy, C. 2015. Batch normalization: Accelerating deep network training by reducing internal covariate shift. In ICML.
Johnson, J.; Hariharan, B.; van der Maaten, L.; Fei-Fei, L.; Zitnick, C. L.; and Girshick, R. B. 2017a. CLEVR: A diagnostic dataset for compositional language and elementary visual reasoning. In CVPR.
Johnson, J.; Hariharan, B.; van der Maaten, L.; Hoffman, J.; Li, F.; Zitnick, C. L.; and Girshick, R. B. 2017b. Inferring and executing programs for visual reasoning. In ICCV.</p>
<p>Jordan, M. I., and Jacobs, R. A. 1994. Hierarchical mixtures of experts and the em algorithm. Neural Comput. 6(2):181-214.
Kim, T.; Song, I.; and Bengio, Y. 2017. Dynamic layer normalization for adaptive neural acoustic modeling in speech recognition. In InterSpeech.
Kingma, D. P., and Ba, J. 2015. Adam: A method for stochastic optimization. In ICLR.
Kirkpatrick, J.; Pascanu, R.; Rabinowitz, N.; Veness, J.; Desjardins, G.; Rusu, A. A.; Milan, K.; Quan, J.; Ramalho, T.; Grabska-Barwinska, A.; Hassabis, D.; Clopath, C.; Kumaran, D.; and Hadsell, R. 2017. Overcoming catastrophic forgetting in neural networks. National Academy of Sciences 114(13):3521-3526.
Lu, J.; Yang, J.; Batra, D.; and Parikh, D. 2016. Hierarchical question-image co-attention for visual question answering. In NIPS.
Malinowski, M., and Fritz, M. 2014. A multi-world approach to question answering about real-world scenes based on uncertain input. In NIPS.
Malinowski, M.; Rohrbach, M.; and Fritz, M. 2015. Ask your neurons: A neural-based approach to answering questions about images. In ICCV.
Mikolov, T.; Sutskever, I.; Chen, K.; Corrado, G. S.; and Dean, J. 2013. Distributed representations of words and phrases and their compositionality. In NIPS.
Oh, J.; Singh, S.; Lee, H.; and Kholi, P. 2017. Zero-shot task generalization with multi-task deep reinforcement learning. In ICML.
Perez, E.; de Vries, H.; Strub, F.; Dumoulin, V.; and Courville, A. C. 2017. Learning visual reasoning without strong priors. In MLSLP Workshop at ICML.
Radford, A.; Metz, L.; and Chintala, S. 2016. Unsupervised representation learning with deep convolutional generative adversarial networks. In ICLR.
Russakovsky, O.; Deng, J.; Su, H.; Krause, J.; Satheesh, S.; Ma, S.; Huang, Z.; Karpathy, A.; Khosla, A.; Bernstein, M. S.; Berg, A. C.; and Li, F. 2015. Imagenet large scale visual recognition challenge. IJCV 115(3):211-252.
Santoro, A.; Raposo, D.; Barrett, D. G.; Malinowski, M.; Pascanu, R.; Battaglia, P.; and Lillicrap, T. 2017. A simple neural network module for relational reasoning. CoRR abs/1706.01427.
Shazeer, N.; Mirhoseini, A.; Maziarz, K.; Davis, A.; Le, Q.; Hinton, G.; and Dean, J. 2017. Outrageously large neural networks: The sparsely-gated mixture-of-experts layer. In ICLR.
van den Oord, A.; Dieleman, S.; Zen, H.; Simonyan, K.; Vinyals, O.; Graves, A.; Kalchbrenner, N.; Senior, A.; and Kavukcuoglu, K. 2016a. Wavenet: A generative model for raw audio. CoRR $a b s / 1609.03499$.
van den Oord, A.; Kalchbrenner, N.; Espeholt, L.; Vinyals, O.; Graves, A.; and Kavukcuoglu, K. 2016b. Conditional image generation with pixelcnn decoders. In NIPS.
van der Maaten, L., and Hinton, G. 2008. Visualizing data using t-sne. JMLR 9(Nov):2579-2605.
Watters, N.; Tacchetti, A.; Weber, T.; Pascanu, R.; Battaglia, P.; and Zoran, D. 2017. Visual interaction networks. CoRR $a b s / 1706.01433$.
Yang, Z.; He, X.; Gao, J.; Deng, L.; and Smola, A. J. 2016. Stacked attention networks for image question answering. In CVPR.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>Copyright (c) 2018, Association for the Advancement of Artificial Intelligence (www.aaai.org). All rights reserved.&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>