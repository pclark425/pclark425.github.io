<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-1515 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-1515</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-1515</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-29.html">extraction-schema-29</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of simulators used for training models or agents on scientific reasoning tasks (especially in thermodynamics, circuits, or biology), including details about simulator fidelity levels and transfer performance to real-world or different contexts.</div>
                <p><strong>Paper ID:</strong> paper-93742e37b100a8f53e8689e65c57b8a39fa5943c</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/93742e37b100a8f53e8689e65c57b8a39fa5943c" target="_blank">NeuralSim: Augmenting Differentiable Simulators with Neural Networks</a></p>
                <p><strong>Paper Venue:</strong> IEEE International Conference on Robotics and Automation</p>
                <p><strong>Paper TL;DR:</strong> Through extensive experiments, the ability of the hybrid simulator to learn complex dynamics involving frictional contacts from real data, as well as match known models of viscous friction, is demonstrated, and an approach for automatically discovering useful augmentations is presented.</p>
                <p><strong>Paper Abstract:</strong> Differentiable simulators provide an avenue for closing the sim-to-real gap by enabling the use of efficient, gradient-based optimization algorithms to find the simulation parameters that best fit the observed sensor readings. Nonetheless, these analytical models can only predict the dynamical behavior of systems for which they have been designed. In this work, we study the augmentation of a novel differentiable rigid-body physics engine via neural networks that is able to learn nonlinear relationships between dynamic quantities and can thus model effects not accounted for in traditional simulators. Such augmentations require less data to train and generalize better compared to entirely data-driven models. Through extensive experiments, we demonstrate the ability of our hybrid simulator to learn complex dynamics involving frictional contacts from real data, as well as match known models of viscous friction, and present an approach for automatically discovering useful augmentations. We show that, besides benefiting dynamics modeling, inserting neural networks can accelerate model-based control architectures. We observe a ten-fold speedup when replacing the QP solver inside a model-predictive gait controller for quadruped robots with a neural network, allowing us to significantly improve control delays as we demonstrate in real-hardware experiments. We publish code, additional results and videos from our experiments on our project webpage at https://sites.google.com/usc.edu/neuralsim.</p>
                <p><strong>Cost:</strong> 0.013</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <div class="extraction-instance-container" id="e1515.0">
                <h3 class="extraction-instance">Extracted Data Instance 0 (e1515.0)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of simulators used for training models or agents on scientific reasoning tasks (especially in thermodynamics, circuits, or biology), including details about simulator fidelity levels and transfer performance to real-world or different contexts.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>TDS</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Tiny Differentiable Simulator</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>An open-source C++ differentiable rigid-body simulator developed in this work that implements articulated-body dynamics and multiple contact models, and allows neural-network 'augmentations' at arbitrary points in the simulation graph with end-to-end automatic differentiation.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>simulator_name</strong></td>
                            <td>Tiny Differentiable Simulator (TDS)</td>
                        </tr>
                        <tr>
                            <td><strong>simulator_description</strong></td>
                            <td>Implements articulated rigid-body dynamics via the Articulated Body Algorithm, semi-implicit Euler integration, two contact models (an impulse-level NCP solver using a Projected Gauss–Seidel style solver with Coulomb friction, and a penalty-based Hunt–Crossley spring-damper contact with nonlinear friction), Baumgarte stabilization and CFM regularization; agnostic linear algebra backend and supports multiple AD frameworks (CppAD, CppADCodeGen, Stan Math, Jet). Permits insertion of neural-network augmentations (neural scalars) that receive arbitrary simulator variables as inputs and are trained end-to-end through trajectories.</td>
                        </tr>
                        <tr>
                            <td><strong>scientific_domain</strong></td>
                            <td>mechanics / rigid-body dynamics (with applications to contact/friction and augmented fluid-drag modeling)</td>
                        </tr>
                        <tr>
                            <td><strong>fidelity_level</strong></td>
                            <td>Medium-to-high fidelity for articulated rigid-body dynamics and contact modeling (accurate joint/inertia/Coriolis/gravity computation and both impulse-level and penalty contact formulations); does not natively simulate full fluid dynamics (Navier–Stokes) — fluid/viscous effects are modeled via learned augmentations.</td>
                        </tr>
                        <tr>
                            <td><strong>fidelity_characteristics</strong></td>
                            <td>Includes: Articulated Body Algorithm (exact rigid-body dynamics), Coulomb friction in NCP solver, Hunt–Crossley penalty contact option, Baumgarte stabilization, Constraint Force Mixing regularization, semi-implicit Euler integrator, discrete time-stepping, and exact/compiled gradients via AD/codegen. Omits native continuum fluid modelling (viscous drag is not analytic but can be learned), no explicit Navier–Stokes, timestep details not fixed in text.</td>
                        </tr>
                        <tr>
                            <td><strong>model_or_agent_name</strong></td>
                            <td>Neural augmentation networks; neural network imitating the MPC QP solver (NN controller)</td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td>Feed-forward MLP residual networks inserted into simulator state computations (example augmentation networks: ~1637 parameters for swimmer), and a fully-connected MLP policy with two hidden layers of 192 nodes (ELU activations) trained to imitate QP solver outputs (41-dim input → 12 joint torques).</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_task</strong></td>
                            <td>Learn unmodeled dynamical effects (e.g., frictional contact corrections, viscous drag / passive forces) to improve long-horizon state prediction and close sim-to-real gap; and imitate an MPC QP solver to produce contact forces/torques for quadruped locomotion.</td>
                        </tr>
                        <tr>
                            <td><strong>training_performance</strong></td>
                            <td>Qualitative: Hybrid (analytical + NN) needed far less data than a fully data-driven LSTM (orders-of-magnitude less) for the swimmer experiment; augmentation networks trained on first 200 timesteps of 10 trajectories produced more accurate rollouts to 900 timesteps than an LSTM. QP-imitation dataset: 10k simulated state transitions; NN inference time 0.2 ms (vs 2 ms for original QP solver). No scalar numeric loss values for training reported in main text.</td>
                        </tr>
                        <tr>
                            <td><strong>transfer_target</strong></td>
                            <td>Real-world data / hardware: (1) Real planar pushing trajectories from the MCube push dataset (used to fit friction corrections and evaluate pose prediction), (2) Real Unitree A1 quadruped robot (NN controller trained in simulation then deployed on hardware).</td>
                        </tr>
                        <tr>
                            <td><strong>transfer_performance</strong></td>
                            <td>Pushing: Augmented simulator produced object pose trajectories that closely matched real-world ground truth (qualitative plots show closer fit vs unaugmented). Quadruped: NN controller produced successful in-place trotting on real Unitree A1 but exhibited a sim-to-real gap (slightly lower torso height); control frequency increased from 160 Hz to 300 Hz due to faster inference. No precise numeric accuracy metrics for pose error on real robot reported in text.</td>
                        </tr>
                        <tr>
                            <td><strong>compares_fidelity_levels</strong></td>
                            <td>True</td>
                        </tr>
                        <tr>
                            <td><strong>fidelity_comparison_results</strong></td>
                            <td>The paper compares (a) unaugmented analytical simulator (equivalent to vacuum swimmer / no viscous forces), (b) fully data-driven models (LSTM), and (c) the hybrid analytical+NN approach. The hybrid approach outperformed the purely data-driven model in low-data regimes and for long-horizon rollouts, and outperformed the unaugmented analytic model on tasks involving unmodeled effects (friction, drag). Authors report orders-of-magnitude less data required and better long-term predictive accuracy for hybrid models.</td>
                        </tr>
                        <tr>
                            <td><strong>minimal_fidelity_discussion</strong></td>
                            <td>Authors argue that augmenting an analytical rigid-body simulator with small, targeted neural augmentations can be sufficient to capture effects (e.g., viscous drag, joint friction) that would otherwise require higher-fidelity simulation, implying that full fluid simulation is not strictly necessary when augmentation is used; however, they do not provide a quantitative threshold for 'minimum fidelity.' They emphasize finding minimally invasive augmentations (sparse inputs) rather than increasing raw simulator fidelity.</td>
                        </tr>
                        <tr>
                            <td><strong>failure_cases</strong></td>
                            <td>Unaugmented analytical simulator failed to reproduce viscous drag effects (swimmer in 'vacuum' diverged from ground truth) and produced significant pose error in pushing experiments when not augmented. The NN controller trained purely in simulation exhibited a sim-to-real gap on hardware (lower torso height) despite successful trotting — indicating remaining mismatch between simulator-trained policy and real robot.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'NeuralSim: Augmenting Differentiable Simulators with Neural Networks', 'publication_date_yy_mm': '2020-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e1515.1">
                <h3 class="extraction-instance">Extracted Data Instance 1 (e1515.1)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of simulators used for training models or agents on scientific reasoning tasks (especially in thermodynamics, circuits, or biology), including details about simulator fidelity levels and transfer performance to real-world or different contexts.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>MuJoCo</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Mujoco: A physics engine for model-based control</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A well-known rigid-body physics engine used in the paper as the source of ground-truth trajectories for a swimmer interacting with viscous media (different densities/viscosities).</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Mujoco: A physics engine for model-based control</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>simulator_name</strong></td>
                            <td>MuJoCo</td>
                        </tr>
                        <tr>
                            <td><strong>simulator_description</strong></td>
                            <td>Commercial/academic rigid-body simulator designed for model-based control that supports articulated mechanisms and configurable environmental effects; used here to simulate a multi-link swimmer whose links (capsules) interact with ambient fluid parameterized by viscosity and density.</td>
                        </tr>
                        <tr>
                            <td><strong>scientific_domain</strong></td>
                            <td>mechanics / fluid-augmented rigid-body dynamics (fluid dynamics approximations in swimmer experiment)</td>
                        </tr>
                        <tr>
                            <td><strong>fidelity_level</strong></td>
                            <td>High-fidelity rigid-body simulation for control tasks with capability to approximate ambient fluid effects for the swimmer experiment; treated in the paper as ground-truth for training hybrid models.</td>
                        </tr>
                        <tr>
                            <td><strong>fidelity_characteristics</strong></td>
                            <td>Models articulated bodies, contacts, and (in the experiment setup) ambient fluid drag/damping parameterized by density and viscosity (Table II lists viscosities/densities for air and water). Time-step and solver specifics not enumerated in the main text; used to generate exact trajectories for supervised training.</td>
                        </tr>
                        <tr>
                            <td><strong>model_or_agent_name</strong></td>
                            <td>MuJoCo-generated ground-truth trajectories (used as target data)</td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_task</strong></td>
                            <td>Provide high-fidelity reference trajectories of a swimmer in viscous media so the hybrid differentiable simulator can learn passive viscous forces and generalize beyond training horizon.</td>
                        </tr>
                        <tr>
                            <td><strong>training_performance</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>transfer_target</strong></td>
                            <td>TDS hybrid simulator training (MuJoCo data used as supervised target to fit NN augmentations)</td>
                        </tr>
                        <tr>
                            <td><strong>transfer_performance</strong></td>
                            <td>Hybrid simulator trained on MuJoCo ground-truth (200 timesteps × 10 trajectories) produced more accurate long-term rollouts (900 timesteps) than a fully data-driven LSTM trained on the same data; exact numeric errors are not provided.</td>
                        </tr>
                        <tr>
                            <td><strong>compares_fidelity_levels</strong></td>
                            <td>False</td>
                        </tr>
                        <tr>
                            <td><strong>fidelity_comparison_results</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>minimal_fidelity_discussion</strong></td>
                            <td>MuJoCo was used as the trusted high-fidelity source for swimmer trajectories; the paper uses MuJoCo outputs to show that learning augmentations in a differentiable rigid-body simulator can match behaviors generated by a simulator with ambient-fluid modeling. No explicit claim about minimal required fidelity of MuJoCo itself.</td>
                        </tr>
                        <tr>
                            <td><strong>failure_cases</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'NeuralSim: Augmenting Differentiable Simulators with Neural Networks', 'publication_date_yy_mm': '2020-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>More than a million ways to be pushed. a high-fidelity experimental dataset of planar pushing <em>(Rating: 2)</em></li>
                <li>Mujoco: A physics engine for model-based control <em>(Rating: 2)</em></li>
                <li>Augmenting Physical Simulators with Stochastic Neural Networks: Case Study of Planar Pushing and Bouncing <em>(Rating: 2)</em></li>
                <li>Sim-to-real transfer with neural-augmented robot simulation <em>(Rating: 2)</em></li>
                <li>Learning agile and dynamic motor skills for legged robots <em>(Rating: 2)</em></li>
                <li>gradSim: Differentiable simulation for system identification and visuomotor control <em>(Rating: 2)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-1515",
    "paper_id": "paper-93742e37b100a8f53e8689e65c57b8a39fa5943c",
    "extraction_schema_id": "extraction-schema-29",
    "extracted_data": [
        {
            "name_short": "TDS",
            "name_full": "Tiny Differentiable Simulator",
            "brief_description": "An open-source C++ differentiable rigid-body simulator developed in this work that implements articulated-body dynamics and multiple contact models, and allows neural-network 'augmentations' at arbitrary points in the simulation graph with end-to-end automatic differentiation.",
            "citation_title": "here",
            "mention_or_use": "use",
            "simulator_name": "Tiny Differentiable Simulator (TDS)",
            "simulator_description": "Implements articulated rigid-body dynamics via the Articulated Body Algorithm, semi-implicit Euler integration, two contact models (an impulse-level NCP solver using a Projected Gauss–Seidel style solver with Coulomb friction, and a penalty-based Hunt–Crossley spring-damper contact with nonlinear friction), Baumgarte stabilization and CFM regularization; agnostic linear algebra backend and supports multiple AD frameworks (CppAD, CppADCodeGen, Stan Math, Jet). Permits insertion of neural-network augmentations (neural scalars) that receive arbitrary simulator variables as inputs and are trained end-to-end through trajectories.",
            "scientific_domain": "mechanics / rigid-body dynamics (with applications to contact/friction and augmented fluid-drag modeling)",
            "fidelity_level": "Medium-to-high fidelity for articulated rigid-body dynamics and contact modeling (accurate joint/inertia/Coriolis/gravity computation and both impulse-level and penalty contact formulations); does not natively simulate full fluid dynamics (Navier–Stokes) — fluid/viscous effects are modeled via learned augmentations.",
            "fidelity_characteristics": "Includes: Articulated Body Algorithm (exact rigid-body dynamics), Coulomb friction in NCP solver, Hunt–Crossley penalty contact option, Baumgarte stabilization, Constraint Force Mixing regularization, semi-implicit Euler integrator, discrete time-stepping, and exact/compiled gradients via AD/codegen. Omits native continuum fluid modelling (viscous drag is not analytic but can be learned), no explicit Navier–Stokes, timestep details not fixed in text.",
            "model_or_agent_name": "Neural augmentation networks; neural network imitating the MPC QP solver (NN controller)",
            "model_description": "Feed-forward MLP residual networks inserted into simulator state computations (example augmentation networks: ~1637 parameters for swimmer), and a fully-connected MLP policy with two hidden layers of 192 nodes (ELU activations) trained to imitate QP solver outputs (41-dim input → 12 joint torques).",
            "reasoning_task": "Learn unmodeled dynamical effects (e.g., frictional contact corrections, viscous drag / passive forces) to improve long-horizon state prediction and close sim-to-real gap; and imitate an MPC QP solver to produce contact forces/torques for quadruped locomotion.",
            "training_performance": "Qualitative: Hybrid (analytical + NN) needed far less data than a fully data-driven LSTM (orders-of-magnitude less) for the swimmer experiment; augmentation networks trained on first 200 timesteps of 10 trajectories produced more accurate rollouts to 900 timesteps than an LSTM. QP-imitation dataset: 10k simulated state transitions; NN inference time 0.2 ms (vs 2 ms for original QP solver). No scalar numeric loss values for training reported in main text.",
            "transfer_target": "Real-world data / hardware: (1) Real planar pushing trajectories from the MCube push dataset (used to fit friction corrections and evaluate pose prediction), (2) Real Unitree A1 quadruped robot (NN controller trained in simulation then deployed on hardware).",
            "transfer_performance": "Pushing: Augmented simulator produced object pose trajectories that closely matched real-world ground truth (qualitative plots show closer fit vs unaugmented). Quadruped: NN controller produced successful in-place trotting on real Unitree A1 but exhibited a sim-to-real gap (slightly lower torso height); control frequency increased from 160 Hz to 300 Hz due to faster inference. No precise numeric accuracy metrics for pose error on real robot reported in text.",
            "compares_fidelity_levels": true,
            "fidelity_comparison_results": "The paper compares (a) unaugmented analytical simulator (equivalent to vacuum swimmer / no viscous forces), (b) fully data-driven models (LSTM), and (c) the hybrid analytical+NN approach. The hybrid approach outperformed the purely data-driven model in low-data regimes and for long-horizon rollouts, and outperformed the unaugmented analytic model on tasks involving unmodeled effects (friction, drag). Authors report orders-of-magnitude less data required and better long-term predictive accuracy for hybrid models.",
            "minimal_fidelity_discussion": "Authors argue that augmenting an analytical rigid-body simulator with small, targeted neural augmentations can be sufficient to capture effects (e.g., viscous drag, joint friction) that would otherwise require higher-fidelity simulation, implying that full fluid simulation is not strictly necessary when augmentation is used; however, they do not provide a quantitative threshold for 'minimum fidelity.' They emphasize finding minimally invasive augmentations (sparse inputs) rather than increasing raw simulator fidelity.",
            "failure_cases": "Unaugmented analytical simulator failed to reproduce viscous drag effects (swimmer in 'vacuum' diverged from ground truth) and produced significant pose error in pushing experiments when not augmented. The NN controller trained purely in simulation exhibited a sim-to-real gap on hardware (lower torso height) despite successful trotting — indicating remaining mismatch between simulator-trained policy and real robot.",
            "uuid": "e1515.0",
            "source_info": {
                "paper_title": "NeuralSim: Augmenting Differentiable Simulators with Neural Networks",
                "publication_date_yy_mm": "2020-11"
            }
        },
        {
            "name_short": "MuJoCo",
            "name_full": "Mujoco: A physics engine for model-based control",
            "brief_description": "A well-known rigid-body physics engine used in the paper as the source of ground-truth trajectories for a swimmer interacting with viscous media (different densities/viscosities).",
            "citation_title": "Mujoco: A physics engine for model-based control",
            "mention_or_use": "use",
            "simulator_name": "MuJoCo",
            "simulator_description": "Commercial/academic rigid-body simulator designed for model-based control that supports articulated mechanisms and configurable environmental effects; used here to simulate a multi-link swimmer whose links (capsules) interact with ambient fluid parameterized by viscosity and density.",
            "scientific_domain": "mechanics / fluid-augmented rigid-body dynamics (fluid dynamics approximations in swimmer experiment)",
            "fidelity_level": "High-fidelity rigid-body simulation for control tasks with capability to approximate ambient fluid effects for the swimmer experiment; treated in the paper as ground-truth for training hybrid models.",
            "fidelity_characteristics": "Models articulated bodies, contacts, and (in the experiment setup) ambient fluid drag/damping parameterized by density and viscosity (Table II lists viscosities/densities for air and water). Time-step and solver specifics not enumerated in the main text; used to generate exact trajectories for supervised training.",
            "model_or_agent_name": "MuJoCo-generated ground-truth trajectories (used as target data)",
            "model_description": null,
            "reasoning_task": "Provide high-fidelity reference trajectories of a swimmer in viscous media so the hybrid differentiable simulator can learn passive viscous forces and generalize beyond training horizon.",
            "training_performance": null,
            "transfer_target": "TDS hybrid simulator training (MuJoCo data used as supervised target to fit NN augmentations)",
            "transfer_performance": "Hybrid simulator trained on MuJoCo ground-truth (200 timesteps × 10 trajectories) produced more accurate long-term rollouts (900 timesteps) than a fully data-driven LSTM trained on the same data; exact numeric errors are not provided.",
            "compares_fidelity_levels": false,
            "fidelity_comparison_results": null,
            "minimal_fidelity_discussion": "MuJoCo was used as the trusted high-fidelity source for swimmer trajectories; the paper uses MuJoCo outputs to show that learning augmentations in a differentiable rigid-body simulator can match behaviors generated by a simulator with ambient-fluid modeling. No explicit claim about minimal required fidelity of MuJoCo itself.",
            "failure_cases": null,
            "uuid": "e1515.1",
            "source_info": {
                "paper_title": "NeuralSim: Augmenting Differentiable Simulators with Neural Networks",
                "publication_date_yy_mm": "2020-11"
            }
        }
    ],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "More than a million ways to be pushed. a high-fidelity experimental dataset of planar pushing",
            "rating": 2
        },
        {
            "paper_title": "Mujoco: A physics engine for model-based control",
            "rating": 2
        },
        {
            "paper_title": "Augmenting Physical Simulators with Stochastic Neural Networks: Case Study of Planar Pushing and Bouncing",
            "rating": 2
        },
        {
            "paper_title": "Sim-to-real transfer with neural-augmented robot simulation",
            "rating": 2
        },
        {
            "paper_title": "Learning agile and dynamic motor skills for legged robots",
            "rating": 2
        },
        {
            "paper_title": "gradSim: Differentiable simulation for system identification and visuomotor control",
            "rating": 2
        }
    ],
    "cost": 0.012992249999999999,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>NeuralSim: Augmenting Differentiable Simulators with Neural Networks</h1>
<p>Eric Heiden<em>1, David Millard</em>1, Erwin Coumans2, Yizhou Sheng1, Gaurav S. Sukhatme1,3</p>
<h4>Abstract</h4>
<p>Differentiable simulators provide an avenue for closing the sim-to-real gap by enabling the use of efficient, gradient-based optimization algorithms to find the simulation parameters that best fit the observed sensor readings. Nonetheless, these analytical models can only predict the dynamical behavior of systems for which they have been designed. In this work, we study the augmentation of a novel differentiable rigid-body physics engine via neural networks that is able to learn nonlinear relationships between dynamic quantities and can thus model effects not accounted for in traditional simulators. Such augmentations require less data to train and generalize better compared to entirely data-driven models. Through extensive experiments, we demonstrate the ability of our hybrid simulator to learn complex dynamics involving frictional contacts from real data, as well as match known models of viscous friction, and present an approach for automatically discovering useful augmentations. We show that, besides benefiting dynamics modeling, inserting neural networks can accelerate model-based control architectures. We observe a ten-fold speedup when replacing the QP solver inside a model-predictive gait controller for quadruped robots with a neural network, allowing us to significantly improve control delays as we demonstrate in real-hardware experiments. We publish code, additional results and videos from our experiments on our project webpage at https://sites.google.com/usc.edu/neuralsim.</p>
<h2>I. INTRODUCTION</h2>
<p>Physics engines enable the accurate prediction of dynamical behavior of systems for which an analytical model has been implemented. Given such models, Bayesian estimation approaches [1] can be used to find the simulation parameters that best fit the real-world observations of the given system. While the estimation of simulation parameters for traditional simulators via black-box optimization or likelihood-free inference algorithms often requires a large number of training data and model evaluations, differentiable simulators allow the use of gradient-based optimizers that can significantly improve the speed of parameter inference approaches [2].</p>
<p>Nonetheless, a sim-to-real gap remains for most systems we use in the real world. For example, in typical simulations used in robotics, the robot is assumed to be an articulated mechanism with perfectly rigid links, even though they actually bend under heavy loads. Motions are often optimized</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup><img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Fig. 1: Top: Snapshots from a few seconds of the locomotion trajectories generated by the QP-based model-predictive controller (first row) and the neural network controller imitating the QP solver (second row) in our differentiable simulator running the Laikago quadruped. Bottom: modelpredictive control using the neural network (third row) and OSQP (fourth row) running on a real Unitree A1 robot.
without accounting for air resistance. In this work, we focus on overcoming such errors due to unmodeled effects by implementing a differentiable rigid-body simulator that is enriched by fine-grained data-driven models.</p>
<p>Instead of learning the error correction between the simulated and the measured states, as is done in residual physics models, our augmentations are embedded inside the physics engine. They depend on physically meaningful quantities and actively influence the dynamics by modulating forces and other state variables in the simulation. Thanks to the end-toend differentiability of our simulator, we can efficiently train such neural networks via gradient-based optimization.</p>
<p>Our experiments demonstrate that the hybrid simulation approach, where data-driven models augment an analytical physics engine at a fine-grained level, outperforms deep learning baselines in training efficiency and generalizability. The hybrid simulator is able to learn a model for the drag forces for a swimmer mechanism in a viscous medium with orders of magnitude less data compared to a sequence learning model. When unrolled beyond the time steps of the training regime, the augmented simulator significantly outperforms the baselines in prediction accuracy. Such capability is further beneficial to closing the sim-to-real gap. We present results for planar pushing where the contact friction model is enriched by neural networks to closely match the observed motion of an object being pushed in the real world. Leveraging techniques from sparse regression,</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">Analytical</th>
<th style="text-align: center;">Data-driven</th>
<th style="text-align: center;">End-to-end $\nabla$</th>
<th style="text-align: center;">Hybrid</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Physics engine [3], [4], [5]</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Residual physics [6], [7], [8], [9]</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">$\checkmark$</td>
</tr>
<tr>
<td style="text-align: left;">Learned physics [10], [11], [12], [13]</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Differentiable simulators [14], [15], [16], [17], [18], [19], [2]</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Our approach</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
</tr>
</tbody>
</table>
<p>TABLE I: Comparison of dynamics modeling approaches (selected works) along the axes of analytical and data-driven modeling, end-to-end differentiability, and hybrid approaches.
we can identify which inputs to the data-driven models are the most relevant, giving the opportunity to discover places where to insert such neural augmentations.</p>
<p>Besides reducing the modeling error or learning entirely unmodeled effects, introducing neural networks to the computation pipeline can have computational benefits. In realrobot experiments on a Unitree A1 quadruped we show that when the quadratic programming (QP) solver of a modelpredictive gait controller is replaced by a neural network, the inference time can be reduced by an order of magnitude.</p>
<p>We release our novel, open-source physics engine, Tiny Differentiable Simulator (TDS) ${ }^{1}$, which implements articulated rigid-body dynamics and contact models, and supports various methods of automatic differentiation to compute gradients w.r.t. any quantity inside the engine.</p>
<h2>II. Related Work</h2>
<p>Various methods have been proposed to learn system dynamics from time series data of real systems (see Table I and Figure 2 left). Early works include Locally Weighted Regression [20] and Forward Models [21]. Modern "intuitive physics" models often use deep graph neural networks to discover constraints between particles or bodies ([11], [22], [23], [24], [25], [26], [12], [27]). Physics-based machine learning approaches introduce a physics-informed inductive bias to the problem of learning models for dynamical systems from data [28], [29], [30], [31], [32], [33]. We propose a general-purpose hybrid simulation approach that combines analytical models of dynamical systems with data-driven residual models that learn parts of the dynamics unaccounted for by the analytical simulation models.</p>
<p>Originating from traditional physics engines (examples include [3], [4], [5]), differentiable simulators have been introduced that leverage automatic, symbolic or implicit differentiation to calculate parameter gradients through the analytical Newton-Euler equations and contact models for rigid-body dynamics [14], [16], [17], [34], [35], [36], [18], [37], [38]. Simulations for other physical processes, such as light propagation [39], [40] and continuum mechanics [41], [42], [15], [19], [2] have been made differentiable as well.</p>
<p>Residual physics models [8], [7], [6], [9] augment physics engines with learned models to reduce the sim-to-real gap. Most of them introduce residual learning applied from the outside to the predicted state of the physics engine, while we propose a more fine-grained approach, similar to [6], where data-driven models are introduced only at some parts</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup>in the simulator. While in [6] the network for actuator dynamics is trained through supervised learning, our end-toend differentiable model allows backpropagation of gradients from high-level states to any part of the computation graph, including neural network weights, so that these parameters can be optimized efficiently, for example from end-effector trajectories.</p>
<h2>III. APPROACH</h2>
<p>Our simulator implements the Articulated Body Algorithm (ABA) [43] to compute the forward dynamics (FD) for articulated rigid-body mechanisms. Given joint positions $\mathbf{q}$, velocities $\dot{\mathbf{q}}$, torques $\tau$ in generalized coordinates, and external forces $\mathbf{f}_{\text {ext }}$, ABA calculates the joint accelerations $\ddot{\mathbf{q}}$. We use semi-implicit Euler integration to advance the system dynamics in time. We support two types of contact models: an impulse-level solver that uses a form of the Projected Gauss Seidel algorithm [44], [45] to solve a nonlinear complementarity problem (NCP) to compute contact impulses for multiple simultaneous points of contact, and a penalty-based contact model that computes joint forces individually per contact point via the Hunt-Crossley [46] nonlinear spring-damper system. In addition to the contact normal force, the NCP-based model resolves lateral friction following Coulomb's law, whereas the spring-based model implements a nonlinear friction force model following Brown et al. [47].</p>
<p>Each link $i$ in a rigid-body system has a mass value $m_{i}$, an inertia tensor $\mathbf{I}<em i="i">{i} \in \mathbb{R}^{6 \times 6}$, and a center of mass $\mathbf{h}</em>} \in \mathbb{R}^{6 \times 6}$. Each corresponding $n_{d}$ degree of freedom joint $i$ between link $i$ and its parent $\lambda(i)$ has a spring stiffness coefficient $k_{i}$, a damping coefficient $d_{i}$, a transformation from its axis to its parent ${ }^{\lambda(i)} \mathbf{X<em i="i">{i} \in \mathbb{S E}(3)$, and a motion subspace matrix $\mathbf{S}</em>$.} \in \mathbb{R}^{6 \times n_{d}</p>
<p>For problems involving $n_{c}$ possible contacts, each possible pair $j$ of contacts has a friction coefficient $\mu_{j} \in \mathbb{R}$ describing the shape of the Coulomb friction cone. Additionally, to maintain contact constraints during dynamics integration, we use Baumgarte stabilization [48] with parameters $\alpha_{j}, \beta_{j} \in \mathbb{R}$. To soften the shape of the contact NCP, we use Constraint Force Mixing (CFM), a regularization technique with parameters $\mathbf{R}<em c="c">{j} \in \mathbb{R}^{n</em>$.}</p>
<p>$$
\theta_{A M}=\left{m_{i}, \mathbf{I}<em i="i">{i}, \mathbf{h}</em>},{ }^{\lambda(i)} \mathbf{X<em i="i">{i}, \mathbf{S}</em>\right}<em j="j">{i} \cup\left{\mu</em>}, \alpha_{j}, \beta_{j}, \mathbf{R<em j="j">{j}\right}</em>
$$</p>
<p>are the analytical model parameters of the system, which have an understandable and physically relevant effect on the computed dynamics. Any of the parameters in $\theta_{A M}$ may be measurable with certainty a priori, or can be optimized as</p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Fig. 2: <em>Left:</em> comparison of various model architectures (cf. Anurag et al. [7]). <em>Right:</em> augmentation of differentiable simulators with our proposed neural scalar type where variable <em>e</em> becomes a combination of an analytical model <em>φ</em>(·,·) with inputs <em>a</em> and <em>b</em>, and a neural network whose inputs are <em>a</em>, <em>c</em>, and <em>d</em>.</p>
<p><img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Fig. 3: Exemplar architecture of our hybrid simulator where a neural network learns passive forces <em>τ</em> given joint velocities <strong>q̂</strong> (MLP biases and joint positions <strong>q</strong> are not shown).</p>
<p>part of a system identification problem according to some data-driven loss function.</p>
<p>With these parameters, we view the dynamics of the system as</p>
<p>$$
\boldsymbol{\tau} = \mathbf{H}<em AM="AM">{\theta</em>}}(\mathbf{q}) \ddot{\mathbf{q}} + \mathbf{C<em AM="AM">{\theta</em>}}(\mathbf{q}, \dot{\mathbf{q}}) + \mathbf{g<em AM="AM">{\theta</em>
$$}}(\mathbf{q}) \tag{1</p>
<p>where <strong>H</strong><em>θ<sub>AM</sub></em> computes the generalized inertia matrix of the system, <strong>C</strong><em>θ<sub>AM</sub></em> computes nonlinear Coriolis and centrifugal effects, and <strong>g</strong><em>θ<sub>AM</sub></em> describes passive forces and forces due to gravity.</p>
<h3><em>A. Hybrid Simulation</em></h3>
<p>Even if the best-fitting analytical model parameters have been determined, rigid-body dynamics alone often does not exactly predict the motion of mechanisms in the real world. To address this, we propose a technique for hybrid simulation that leverages differentiable physics models and neural networks to allow the efficient reduction of the simulation-to-reality gap. By enabling any part of the simulation to be replaced or augmented by neural networks with parameters <em>θ<sub>NN</sub></em>, we can learn unmodeled effects from data which the analytical models do not account for.</p>
<p>Our physics engine allows any variable participating in the simulation to be augmented by neural networks that accept input connections from any other variable. In the simulation code, such <em>neural scalars</em> (Figure 2 right) are assigned a unique name, so that in a separate experiment code a "neural blueprint" is defined that declares the neural network architectures and sets the network weights.</p>
<p><img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Fig. 4: Comparison of system identification results from local optimization (left) and the parallel basin hopping strategy (right), where the grid cells indicate the initial parameters from which the optimization was started. The link lengths of a double pendulum are the two simulation parameters to be estimated from joint position trajectories. The true parameters are 3 and 4 (indicated by a star), and the colors indicate the <em>l</em>2 distance between the ground truth and the parameters obtained after optimization (darker shade indicates lower error).</p>
<h3><em>B. Overcoming Local Minima</em></h3>
<p>For problems involving nonlinear or discontinuous systems, such as rigid-body mechanisms undergoing contact, our strategy yields highly nonlinear loss landscape which is fraught with local minima. As such, we employ global optimization strategies, such as the parallel basin hopping strategy [49] and population-based techniques from the Pagmo library [50]. These global approaches run a gradient-based optimizer, such as L-BFGS in our case, locally in each individual thread. After each evolution of a population of local optimizers, the best solutions are combined and mutated so that in the next evolution each optimizer starts from a newly generated parameter vector. As can be seen in Figure 4, a system identification problem as basic as estimating the link lengths of a double pendulum from a trajectory of joint positions, results in a complex loss landscape where a purely local optimizer often only finds suboptimal parameters (left). Parallel Basin Hopping (right), on the other hand, restarts multiple local optimizers with an initial value around the currently best found solution, thereby overcoming poor local minima in the loss landscape.</p>
<h3><em>C. Implementation Details</em></h3>
<p>We implement our physics engine <em>Tiny Differentiable Simulator</em> (TDS) in C++ while keeping the computations agnostic to the implementation of linear algebra structures and operations. Via template meta-programming, various</p>
<p><img alt="img-4.jpeg" src="img-4.jpeg" /></p>
<p>Fig. 5: Runtime comparison of finite differences (blue) against the various automatic differentiation frameworks supported by our physics engine. Note the log scale for the time (in seconds).</p>
<p>Math libraries, such as Eigen [51] and Enoki [52] are supported without requiring changes to the experiment code. Mechanisms can be imported into TDS from Universal Robot Description Format (URDF) files.</p>
<p>To compute gradients, we currently support the following third-party automatic differentiation (AD) frameworks: the "Jet" implementation from the Ceres solver [53] that evaluates the partial derivatives for multiple parameters in forward mode, as well as the libraries Stan Math [54], CppAD [55], and CppADCodeGen [56] that support both forward- and reverse-mode AD. We supply operators for taking gradients through conditionals such that these constructs can be traced by the tape recording mechanism in CppAD. We further exploit code generation not only to compile the gradient pass but to additionally speed up the regular simulation and loss evaluation by compiling models to non-allocating C code.</p>
<p>In our benchmark shown in Figure 5, we compare the gradient computation runtimes (excluding compilation time for CppADCodeGen) on evaluating a 175-parameter neural network, simulating 5000 steps of a 5-link pendulum falling on the ground via the NCP contact model, and simulating 500 steps of a double pendulum without contact. Similar to Giftthaler et al. [14], we observe orders of magnitude in speed-up by leveraging CppADCodeGen to precompile the gradient pass of the cost function that rolls out the system with the current parameters and computes the loss.</p>
<h2>IV. EXPERIMENTAL RESULTS</h2>
<h3>A. Friction Dynamics in Planar Pushing</h3>
<p>Combining a differentiable physics engine with learned, data-driven models can help reduce the simulation-to-reality gap. Based on the Push Dataset released by the MCube lab [57], we demonstrate how an analytical contact model can be augmented by neural networks to predict complex frictional contact dynamics.</p>
<p>The dataset contains a variety of planar shapes that are pushed by a robot arm equipped with a cylindrical tip on different types of surface materials. Numerous trajectories of planar pushes with different velocities and accelerations have been recorded, from which we select trajectories with constant velocity. We model the contact between the tip and the object via the NCP-based contact solver (section III). For the ground, we use a nonlinear spring-damper contact</p>
<p><img alt="img-5.jpeg" src="img-5.jpeg" /></p>
<p>Fig. 6: <em>Left:</em> example setup for the push experiment (subsection IV-A) where the rounded object is pushed by the black cylindrical tip at a constant velocity on a plywood surface. Without tuning the analytical physics engine, a deviation between the pose of the object in the real world (green) and in the simulator (metallic) becomes apparent. <em>Right:</em> predefined contact points (red dots) for one of the shapes in the push dataset.</p>
<table>
<thead>
<tr>
<th>Medium</th>
<th>Dynamic Viscosity µ [Pa·s]</th>
<th>Density ρ [kg / m³]</th>
</tr>
</thead>
<tbody>
<tr>
<td>Vacuum</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>Water (5 °C)</td>
<td>0.001518</td>
<td>1000</td>
</tr>
<tr>
<td>Water (25 °C)</td>
<td>0.00089</td>
<td>997</td>
</tr>
<tr>
<td>Air (25 °C)</td>
<td>0.00001849</td>
<td>1.184</td>
</tr>
</tbody>
</table>
<p>TABLE II: Physical properties of media used in the swimmer experiment.</p>
<p>Model that computes the contact forces at predefined contact points for each of the shapes. We pre-processed each shape to add contact points along a uniform grid with a resolution of 2 cm (Figure 6 right). Since the NCP-based contact model involves solving a nonlinear complementarity problem, we found the force-level contact model easier to augment by neural networks in this scenario since the normal and friction forces are computed independently for each contact point.</p>
<p>As shown in Figure 6 (left), even when these two contact models and their analytical parameters (e.g., friction coefficient, Baumgarte stabilization gains, etc.) have been tuned over a variety of demonstrated trajectories, a significant error between the ground truth and simulated pose of the object remains. By augmenting the lateral 2D friction force of the object being pushed, we achieve a significantly closer match to the real-world ground truth (cf. Figure 7). The neural network inputs are given by the object's current pose, its velocity, as well as the normal and the penetration depth at the point of contact between the tip and the object. Such contact-related variables are influenced by the friction force correction that the neural network provides. Unique to our differentiable simulation approach is the ability to compute gradients for the neural network weights from the trajectories of the object poses compared against the ground truth, since the influence of the friction force on the object pose becomes apparent only after the forward dynamics equations have been applied and integrated.</p>
<h3>B. Passive Frictional Forces for Articulated Systems</h3>
<p>While in the previous experiment an existing contact model has been enriched by neural networks to compute more realistic friction forces, in this experiment we investigate how such augmentation can learn entirely new phenomena which were not accounted for in the analytical model. Given simulated trajectories of a multi-link robot</p>
<p><img alt="img-6.jpeg" src="img-6.jpeg" /></p>
<p>Fig. 7: Trajectories of pushing an ellipsoid object from our hybrid simulator (blue) and the non-augmented rigid-body simulation (orange) compared against the real-world ground truth from the MCube push dataset [57]. The shaded ellipsoids indicate the final object poses.</p>
<p><img alt="img-7.jpeg" src="img-7.jpeg" /></p>
<p>Fig. 8: <em>Left:</em> Model of a swimmer in MuJoCo with five revolute joints connecting its links simulated as capsules interacting with ambient fluid. <em>Right:</em> Evolution of the cost function during the training of the neural-augmented simulator for the swimmer in different media.</p>
<p>Swimming through an unidentified viscous medium (Figure 8), the augmentation is supposed to learn a model for the passive forces that describe the effects of viscous friction and damping encountered in the fluid. Since the passive forces exerted by a viscous medium are dependent on the angle of attack of each link, as well as the velocity, we add a neural augmentation to τ, ψθ(q, ḋ), analogous to Figure 3.</p>
<p>Using our hybrid physics engine, and given a set of generalized control forces <em>u</em>, we integrate Equation 1 to form a trajectory $\tilde{T} = {\hat{\mathbf{q}}^i, \hat{\hat{\mathbf{q}}}_i}$<em>, and compute an MSE loss L(T, T) against </em>T*, a ground truth trajectory of generalized states and velocities recorded using the MuJoCo [4] simulator. We are able to compute exact gradients ∇θL end-to-end through the entire trajectory, given the differentiable nature of our simulator, integrator, and function approximator.</p>
<p>We train the hybrid simulator under different ground-truth inputs. We consider water at 5 °C and 25 °C temperature, plus air at 25 °C, as media, which have different properties for dynamic viscosity and density (see Table II).</p>
<p>Leveraging the mechanical structure of problems aids in long-term physically relevant predictive power, especially in the extremely sparse data regimes common in learning for robotics. As shown in Figure 9, our approach, trained end-to-end on the initial 200 timesteps of 10 trajectories of a 2-link swimmer moving in water at 25 °C, exhibits more accurate long-term rollout prediction over 900 timesteps than a deep long short-term memory (LSTM) network. In this experiment, the augmentation networks for TDS have 1637 trainable parameters, while the LSTM has 1900.</p>
<h3><em>C. Discovering Neural Augmentations</em></h3>
<p>In our previous experiments we carefully selected which simulation quantities to augment by neural networks. While it is expected that air resistance and friction result in passive forces that need to be applied to the simulated mechanism, it is often difficult to foresee which dynamical quantities actually influence the dynamics of the observed system. Since we aim to find minimally invasive data-driven models, we focus on neural network augmentations that have the least possible effect while achieving the goal of high predictive accuracy and generalizability. Inspired by Sparse Input Neural Networks (SPINN) [58], we adapt the sparse-group lasso [59] penalty for the cost function:</p>
<p>$$\mathcal{L} = \sum_{t} ||f_{\theta}(s_t - 1) - s_t^*(1/2 + \kappa ||\theta_{[1]} ||<em _1_="[1]">1 + \lambda ||\theta</em>$$} ||_2^2,\tag{2</p>
<p>given weighting coefficients κ, λ &gt; 0, where <em>f</em>θ(<em>s</em><sub><em>t</em>−1<em>) is the state predicted by the hybrid simulator given the previous simulation state </em>s<em><sub></em>t<em>−1} (consisting of q, ḋ), </em>s<em><sub></em>t<em></sub> is the state from the observed system, θ<sub>[1]</sub> are the network weights of the first layer, and θ<sub>[1]</sub> are the weights of the upper layers. Such cost function sparsifies the input weights so that the augmentation depends on only a small subset of physical quantities, which is desirable when simpler models are to be found that potentially overfit less to the training data while maintaining high accuracy (Occam's razor). In addition, the </em>L*2 loss on the weights from the upper network layers penalizes the overall contribution of the neural augmentation to the predicted dynamics since we only want to augment the simulation where the analytical model is unable to match the real system.</p>
<p>We demonstrate the approach on a double pendulum system that is modeled as a frictionless mechanism in our analytical physics engine. The reference system, on the other hand, is assumed to exhibit joint friction, i.e., a force proportional to and opposed to the joint velocity. As expected, compared to a fully learned dynamics model, our hybrid simulator outperforms the baselines significantly (Figure 10). As shown on the right, convergence is achieved while requiring orders of magnitude less training samples. At the same time, the resulting neural network augmentation converges to weights that clearly show that the joint velocity ḋ<em><sup>i</sup></em> influences the residual joint force τ<sup>i</sup> that explains the observed effects of joint friction in joint <em>i</em> (Figure 10 left).</p>
<h3><em>D. Imitation Learning from MPC</em></h3>
<p>Starting from a rigid-body simulation and augmenting it by neural networks has shown significant improvements in closing the sim-to-real gap and learning entirely new effects, such as viscous friction that has not been modeled analytically. In our final experiment, we investigate how the use of learned models can benefit a control pipeline for a quadruped robot. We simulate a Laikago quadruped</p>
<p><img alt="img-8.jpeg" src="img-8.jpeg" /></p>
<p>Fig. 9: Trajectory of positions <strong>q</strong> and velocities <strong>q̇</strong> of a swimmer in water at 25 °C temperature actuated by random control inputs. In a low-data regime, our approach (orange) generates accurate predictions, even past the training cutoff (vertical black bar), while an entirely data-driven model (green) regresses to the mean. The behavior of the unaugmented analytical model, which corresponds to a swimmer in vacuum, is shown for comparison.</p>
<p><img alt="img-9.jpeg" src="img-9.jpeg" /></p>
<p>Fig. 10: <em>Left:</em> Neural augmentation for a double pendulum that learns joint damping. Given the fully connected neural network (top), after 15 optimization steps using the sparse group lasso cost function (Equation 2) (bottom), the input layer (light green) is sparsified to only the relevant quantities that influence the dynamics of the observed system. <em>Right:</em> Final mean squared error (MSE) on test data after training a feed-forward neural network and our hybrid physics engine.</p>
<p>robot and use a model-predictive controller (MPC) to generate walking gaits. The MPC implements [60] and uses a quadratic programming (QP) solver leveraging the OSQP library [61] that computes the desired contact forces at the feet, given the current measured state of the robot (center of mass (COM), linear and angular velocity, COM estimated position (roll, pitch and yaw), foot contact state as well as the desired COM position and velocity). The swing feet are controlled using PD position control, while the stance feet are torque-controlled using the QP solver to satisfy the motion constraints. This controller has been open-sourced as part of the quadruped animal motion imitation project [62]<sup>2</sup>.</p>
<p>We train a neural network policy to imitate the QP solver, taking the same system state as inputs, and predicting the contact forces at the feet which are provided to the IK solver and PD controller. As training dataset we recorded 10k state transitions generated by the QP solver, using random linear and angular MPC control targets of the motion of the torso. We choose a fully connected neural network with 41-dimensional input and two hidden layers of 192 nodes that outputs the 12 joint torques, all using ELU activation [63].</p>
<p>The neural network controller is able to produce extensive walking gaits in simulation for the Laikago robot, and in-place trotting gaits on a real Unitree A1 quadruped (see Figure 1). The learned QP solver is an order of magnitude faster than the original QP solver (0.2 ms inference time versus 2 ms on an AMD 3090 Ryzen CPU).</p>
<p>Thanks to improved performance, the control frequency increased from 160 Hz to 300 Hz. Since the model was trained using data only acquired in simulation, there is some sim-to-real gap, causing the robot to trot with a slightly lower torso height. In future work, we plan to leverage our end-to-end differentiable simulator to fine-tune the policy while closing the simulation-to-reality gap from real-world sensor measurements. Furthermore, the use of differentiable simulators, such as in [64], to train data-driven models with faster inference times is an exciting direction to speed up conventional physics engines.</p>
<h2>V. CONCLUSION</h2>
<p>We presented a differentiable simulator for articulated rigid-body dynamics that allows the insertion of neural networks at any point in the computation graph. Such neural augmentation can learn dynamical effects that the analytical model does not account for, while requiring significantly less training data from the real system. Our experiments demonstrate benefits for sim-to-real transfer, for example in planar pushing where, contrary to the given model, the friction force depends not only on the objects velocity but also on its position on the surface. Effects that have not been present altogether in the rigid-body simulator, such as drag forces due to fluid viscosity, can also be learned from demonstration. Throughout our experiments, the efficient computation of gradients that our implemented simulator facilitates, has considerably sped up the training process. Furthermore, replacing conventional components, such as the QP-based controller in our quadruped locomotion experiments, has resulted in an order of magnitude computation speed-up.</p>
<p>In future work we plan to investigate how physically meaningful constraints, such as the law of conservation of energy, can be incorporated into the training of the neural networks. We will further our preliminary investigation of discovering neural network connections and the viability of such techniques on real-world systems, where hybrid simulation can play a key role in model-based control.</p>
<p><sup>2</sup>The implementation of the QP-based MPC is available open-source at <a href="https://github.com/google-research/motion_imitation">https://github.com/google-research/motion_imitation</a></p>
<h2>ACKNOWLEDGMENTS</h2>
<p>We thank Carolina Parada and Ken Caluwaerts for their helpful feedback and suggestions.</p>
<h2>REFERENCES</h2>
<p>[1] F. Ramos, R. C. Possas, and D. Fox, "BayesSim: adaptive domain randomization via probabilistic inference for robotics simulators," Robotics: Science and Systems, 2019.
[2] J. K. Murthy, M. Macklin, F. Golemo, V. Voleti, L. Petrini, M. Weiss, B. Considine, J. Parent-Lévesque, K. Xie, K. Erleben, L. Paull, F. Shkurtı, D. Noworuszczahrai, and S. Fidler, "gradSim: Differentiable simulation for system identification and visuomotor control," in International Conference on Learning Representations, 2021. [Online]. Available: https://openreview.net/forum?id=c.E8kFWfhp0
[3] E. Coumans and Y. Bai, "Pybullet, a python module for physics simulation for games, robotics and machine learning," 2016-2020. [Online]. Available: http://pybullet.org
[4] E. Todorov, T. Erez, and Y. Tassa, "Mujoco: A physics engine for model-based control," in 2012 IEEE/RSJ International Conference on Intelligent Robots and Systems. IEEE, 2012, pp. 5026-5033.
[5] J. Lee, M. X. Grey, S. Ha, T. Kunz, S. Jain, Y. Ye, S. S. Srinivasa, M. Stilman, and C. K. Liu, "Dart: Dynamic animation and robotics toolkit," Journal of Open Source Software, vol. 3, no. 22, p. 500, 2018. [Online]. Available: https://doi.org/10.21105/joss. 00500
[6] J. Hwangbo, J. Lee, A. Dosovitskiy, D. Bellicoso, V. Tsounis, V. Koltun, and M. Hutter, "Learning agile and dynamic motor skills for legged robots," Science Robotics, vol. 4, no. 26, p. eaau5872, 2019.
[7] A. Ajay, J. Wu, N. Fazeli, M. Bauza, L. P. Kaelbling, J. B. Tenenbaum, and A. Rodriguez, "Augmenting Physical Simulators with Stochastic Neural Networks: Case Study of Planar Pushing and Bouncing," in IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS), 2018.
[8] A. Zeng, S. Song, J. Lee, A. Rodriguez, and T. Funkhouser, "Tossingbot: Learning to throw arbitrary objects with residual physics," 2019.
[9] F. Golemo, A. A. Taiga, A. Courville, and P.-Y. Oudeyer, "Sim-to-real transfer with neural-augmented robot simulation," in Proceedings of The 2nd Conference on Robot Learning, ser. Proceedings of Machine Learning Research, A. Billard, A. Dragan, J. Peters, and J. Morimoto, Eds., vol. 87. PMLR, 29-31 Oct 2018, pp. 817-828. [Online]. Available: http://proceedings.mlr.press/v87/golemo18a.html
[10] A. Sanchez-Gonzalez, J. Godwin, T. Pfaff, R. Ying, J. Leskovec, and P. W. Battaglia, "Learning to simulate complex physics with graph networks," arXiv preprint arXiv:2002.09405, 2020.
[11] P. Battaglia, R. Pascanu, M. Lai, D. J. Rezende, et al., "Interaction networks for learning about objects, relations and physics," in Advances in Neural Information Processing Systems, 2016, pp. 4502-4510.
[12] Y. Li, J. Wu, R. Tedrake, J. B. Tenenbaum, and A. Torralba, "Learning particle dynamics for manipulating rigid bodies, deformable objects, and fluids," in International Conference on Learning Representations, 2019. [Online]. Available: https://openreview.net/forum?id=xJgbSu09Ym
[13] Y. Jiang and C. K. Liu, "Data-augmented contact model for rigid body simulation," CoRR, vol. abs/1803.04019, 2018. [Online]. Available: http://arxiv.org/abs/1803.04019
[14] M. Giftthaler, M. Neunert, M. Stäuble, M. Frigerio, C. Semini, and J. Buchli, "Automatic differentiation of rigid body dynamics for optimal control and estimation," Advanced Robotics, vol. 31, no. 22, pp. 1225-1237, 2017.
[15] Y. Hu, L. Anderson, T.-M. Li, Q. Sun, N. Carr, J. Ragan-Kelley, and F. Durand, "DiffTaichi: Differentiable programming for physical simulation," ICLR, 2020.
[16] J. Carpenter and N. Mansard, "Analytical derivatives of rigid body dynamics algorithms," in Robotics: Science and Systems, 2018.
[17] F. de Avila Belbute-Peres, K. Smith, K. Allen, J. Tenenbaum, and J. Z. Kolter, "End-to-end differentiable physics for learning and control," in Advances in Neural Information Processing Systems 31, S. Bengio, H. Wallach, H. Larochelle, K. Grauman, N. CesaBianchi, and R. Garnett, Eds. Curran Associates, Inc., 2018, pp. 7178-7189. [Online]. Available: http://papers.nips.cc/paper/ 7948-end-to-end-differentiable-physics-for-learning-and-control.pdf
[18] M. Geilinger, D. Hahn, J. Zehnder, M. Bächer, B. Thomaszewski, and S. Coros, "ADD: Analytically differentiable dynamics for multi-body systems with frictional contact," 2020.
[19] Y.-L. Qiao, J. Liang, V. Koltun, and M. C. Lin, "Scalable differentiable physics for learning and control," in ICML, 2020.
[20] S. Schaal and C. G. Atkeson, "Robot juggling: implementation of memory-based learning," IEEE Control Systems Magazine, vol. 14, no. 1, pp. 57-71, 1994.
[21] A. W. Moore, "Fast, robust adaptive control by learning only forward models," in Proceedings of the 4th International Conference on Neural Information Processing Systems, ser. NIPS'91. San Francisco, CA, USA: Morgan Kaufmann Publishers Inc., 1991, p. 571-578.
[22] Z. Xu, J. Wu, A. Zeng, J. B. Tenenbaum, and S. Song, "DensePhysNet: Learning dense physical object representations via multi-step dynamic interactions," Robotics: Science and Systems, June 2019.
[23] S. He, Y. Li, Y. Feng, S. Ho, S. Ravanbakhsh, W. Chen, and B. Póczos, "Learning to predict the cosmological structure formation," Proceedings of the National Academy of Sciences of the United States of America, vol. 116, no. 28, pp. 11825-11832, July 2019.
[24] M. Raissi, H. Babaee, and P. Givi, "Deep learning of turbulent scalar mixing," Tech. Rep., 2018.
[25] D. Mrowca, C. Zhuang, E. Wang, N. Haber, L. Fei-Fei, J. B. Tenenbaum, and D. L. K. Yamins, "Flexible neural representation for physics prediction," Advances in Neural Information Processing Systems, June 2018.
[26] T. Q. Chen, Y. Rubanova, J. Bettencourt, and D. K. Duvenaud, "Neural ordinary differential equations," in Advances in Neural Information Processing Systems, 2018, pp. 6571-6583.
[27] A. Sanchez-Gonzalez, J. Godwin, T. Pfaff, R. Ying, J. Leskovec, and P. W. Battaglia, "Learning to simulate complex physics with graph networks," 2020.
[28] R. T. Q. Chen, Y. Rubanova, J. Bettencourt, and D. K. Duvenaud, "Neural ordinary differential equations," in Advances in Neural Information Processing Systems 31, S. Bengio, H. Wallach, H. Larochelle, K. Grauman, N. Cesa-Bianchi, and R. Garnett, Eds. Curran Associates, Inc., 2018, pp. 6571-6583. [Online]. Available: http: //papers.nips.cc/paper/7892-neural-ordinary-differential-equations.pdf
[29] Z. Long, Y. Lu, X. Ma, and B. Dong, "Pde-net: Learning pdes from data," in International Conference on Machine Learning, 2018, pp. 3208-3216.
[30] M. Raissi, P. Perdikaris, and G. E. Karniadakis, "Physics-informed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations," Journal of Computational Physics, vol. 378, pp. 686-707, 2019.
[31] M. Lutter, C. Ritter, and J. Peters, "Deep Lagrangian networks: Using physics as model prior for deep learning," arXiv preprint arXiv:1907.04490, 2019.
[32] S. Greydanus, M. Dzamba, and J. Yosinski, "Hamiltonian neural networks," in Advances in Neural Information Processing Systems 32, H. Wallach, H. Larochelle, A. Beygelzimer, F. d'Alché-Buc, E. Fox, and R. Garnett, Eds. Curran Associates, Inc., 2019, pp. 15379-15389. [Online]. Available: http://papers.nips.cc/paper/ 9672-hamiltonian-neural-networks.pdf
[33] G. Sutanto, A. Wang, Y. Lin, M. Mukadam, G. Sukhatme, A. Rai, and F. Meier, "Encoding physical constraints in differentiable Newton-Euler algorithm," ser. Proceedings of Machine Learning Research, A. M. Bayen, A. Jadbabaie, G. Pappas, P. A. Parrilo, B. Recht, C. Tomlin, and M. Zeilinger, Eds., vol. 120. The Cloud: PMLR, 10-11 Jun 2020, pp. 804-813. [Online]. Available: http://proceedings.mlr.press/v120/sutanto20a.html
[34] T. Koolen and R. Deits, "Julia for robotics: simulation and realtime control in a high-level programming language," in International Conference on Robotics and Automation, 052019.
[35] E. Heiden, D. Millard, H. Zhang, and G. S. Sukhatme, "Interactive differentiable simulation," CoRR, vol. abs/1905.10706, 2019. [Online]. Available: http://arxiv.org/abs/1905.10706
[36] E. Heiden, D. Millard, and G. S. Sukhatme, "Real2sim transfer using differentiable physics," R:SS Workshop on Closing the Reality Gap in Sim2real Transfer for Robotic Manipulation, 2019.
[37] Q. Lelidec, J. Kalevatykh, I. Laptev, C. Schmid, and J. Carpentier, "Differentiable simulation for physical system identification," IEEE Robotics and Automation Letters, pp. 1-1, 2021.
[38] M. Lutter, J. Silberbauer, J. Watson, and J. Peters, "Differentiable physics models for real-world offline model-based reinforcement learning," 2020.
[39] M. Nimier-David, D. Vicini, T. Zeltner, and W. Jakob, "Mitsuba 2: A retargetable forward and inverse renderer," Transactions on Graphics (Proceedings of SIGGRAPH Asia), vol. 38, no. 6, Nov. 2019.</p>
<p>[40] E. Heiden, Z. Liu, R. K. Ramachandran, and G. S. Sukhatme, "Physics-based simulation of continuous-wave LIDAR for localization, calibration and tracking," in International Conference on Robotics and Automation (ICRA). IEEE, 2020.
[41] Y. Hu, J. Liu, A. Spielberg, J. B. Tenenbaum, W. T. Freeman, J. Wu, D. Rus, and W. Matusik, "Chainqueen: A real-time differentiable physical simulator for soft robotics," Proceedings of IEEE International Conference on Robotics and Automation (ICRA), 2019.
[42] J. Liang, M. Lin, and V. Koltun, "Differentiable cloth simulation for inverse problems," in Advances in Neural Information Processing Systems, 2019, pp. 771-780.
[43] R. Featherstone, Rigid Body Dynamics Algorithms. Berlin, Heidelberg: Springer-Verlag, 2007.
[44] D. Stewart and J. C. Trinkle, "An implicit time-stepping scheme for rigid body dynamics with coulomb friction," in Proceedings 2000 ICRA. Millennium Conference. IEEE International Conference on Robotics and Automation. Symposia Proceedings (Cat. No. 00CH37065), vol. 1. IEEE, 2000, pp. 162-169.
[45] P. C. Horak and J. C. Trinkle, "On the similarities and differences among contact models in robot simulation," IEEE Robotics and Automation Letters, vol. 4, no. 2, pp. 493-499, 2019.
[46] K. H. Hunt and F. R. E. Crossley, "Coefficient of restitution interpreted as damping in vibroimpact," 1975.
[47] P. Brown and J. McPhee, "A 3d ellipsoidal volumetric foot-ground contact model for forward dynamics," Multibody System Dynamics, vol. 42, no. 4, pp. 447-467, 2018.
[48] J. Baumgarte, "Stabilization of constraints and integrals of motion in dynamical systems," Computer methods in applied mechanics and engineering, vol. 1, no. 1, pp. 1-16, 1972.
[49] S. L. McCarty, L. M. Burke, and M. McGuire, "Parallel monotonic basin hopping for low thrust trajectory optimization," in 2018 Space Flight Mechanics Meeting, 2018, p. 1452.
[50] F. Biscani and D. Izzo, "A parallel global multiobjective framework for optimization: pagmo," Journal of Open Source Software, vol. 5, no. 53, p. 2338, 2020. [Online]. Available: https://doi.org/10.21105/joss. 02338
[51] G. Guennebaud, B. Jacob, et al., "Eigen v3," http://eigen.tuxfamily.org, 2010.
[52] W. Jakob, "Enoki: structured vectorization and differentiation on modern processor architectures," 2019, https://github.com/mitsubarenderer/enoki.
[53] S. Agarwal, K. Mierle, and Others, "Ceres solver," http://ceres-solver. org.
[54] B. Carpenter, M. D. Hoffman, M. Brubaker, D. Lee, P. Li, and M. Betancourt, "The Stan math library: Reverse-mode automatic differentiation in c++," arXiv preprint arXiv:1509.07164, 2015.
[55] B. Bell, "CppAD: a package for C++ algorithmic differentiation," http://www.coin-or.org/CppAD, 2020.
[56] J. R. Leal and B. Bell, "joaoleal/CppADCodeGen: CppAD 2017," July 2017. [Online]. Available: https://doi.org/10.5281/zenodo. 836832
[57] K.-T. Yu, M. Bauza, N. Fazeli, and A. Rodriguez, "More than a million ways to be pushed. a high-fidelity experimental dataset of planar pushing," in 2016 IEEE/RSJ international conference on intelligent robots and systems (IROS). IEEE, 2016, pp. 30-37.
[58] J. Feng and N. Simon, "Sparse-input neural networks for highdimensional nonparametric regression and classification," 2019.
[59] N. Simon, J. Friedman, T. Hastie, and R. Tibshirani, "A sparse-group lasso," Journal of computational and graphical statistics, vol. 22, no. 2, pp. 231-245, 2013.
[60] D. Kim, J. D. Carlo, B. Katz, G. Bledt, and S. Kim, "Highly dynamic quadruped locomotion via whole-body impulse control and model predictive control," 2019.
[61] B. Stellato, G. Banjac, P. Goulart, A. Bemporad, and S. Boyd, "OSQP: an operator splitting solver for quadratic programs," Mathematical Programming Computation, vol. 12, no. 4, pp. 637-672, 2020. [Online]. Available: https://doi.org/10.1007/s12532-020-00179-2
[62] X. B. Peng, E. Coumans, T. Zhang, T.-W. E. Lee, J. Tan, and S. Levine, "Learning agile robotic locomotion skills by imitating animals," in Robotics: Science and Systems, 072020.
[63] D.-A. Clevert, T. Unterthiner, and S. Hochreiter, "Fast and accurate deep network learning by exponential linear units (elus)," 2016.
[64] K. Um, Y. Fei, R. Brand, P. Holl, and N. Thuerey, "Solver-in-theLoop: Learning from Differentiable Physics to Interact with Iterative PDE-Solvers," arXiv preprint arXiv:2007.00016, 2020.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{1}$ Open-source release of TDS: https://github.com/ google-research/tiny-differentiable-simulator&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>