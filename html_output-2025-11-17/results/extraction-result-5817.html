<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-5817 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-5817</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-5817</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-116.html">extraction-schema-116</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <p><strong>Paper ID:</strong> paper-0a94fbb5e1c93513523f00e75d672ef4553861f9</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/0a94fbb5e1c93513523f00e75d672ef4553861f9" target="_blank">Can Large Language Models Infer Causation from Correlation?</a></p>
                <p><strong>Paper Venue:</strong> International Conference on Learning Representations</p>
                <p><strong>Paper TL;DR:</strong> This work proposes the first benchmark dataset to test the pure causal inference skills of large language models (LLMs), and formulates a novel task Corr2Cause, which takes a set of correlational statements and determines the causal relationship between the variables.</p>
                <p><strong>Paper Abstract:</strong> Causal inference is one of the hallmarks of human intelligence. While the field of CausalNLP has attracted much interest in the recent years, existing causal inference datasets in NLP primarily rely on discovering causality from empirical knowledge (e.g., commonsense knowledge). In this work, we propose the first benchmark dataset to test the pure causal inference skills of large language models (LLMs). Specifically, we formulate a novel task Corr2Cause, which takes a set of correlational statements and determines the causal relationship between the variables. We curate a large-scale dataset of more than 200K samples, on which we evaluate seventeen existing LLMs. Through our experiments, we identify a key shortcoming of LLMs in terms of their causal inference skills, and show that these models achieve almost close to random performance on the task. This shortcoming is somewhat mitigated when we try to re-purpose LLMs for this skill via finetuning, but we find that these models still fail to generalize -- they can only perform causal inference in in-distribution settings when variable names and textual expressions used in the queries are similar to those in the training set, but fail in out-of-distribution settings generated by perturbing these queries. Corr2Cause is a challenging task for LLMs, and would be helpful in guiding future research on improving LLMs' pure reasoning skills and generalizability. Our data is at https://huggingface.co/datasets/causalnlp/corr2cause. Our code is at https://github.com/causalNLP/corr2cause.</p>
                <p><strong>Cost:</strong> 0.017</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <div class="extraction-instance-container" id="e5817.0">
                <h3 class="extraction-instance">Extracted Data Instance 0 (e5817.0)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Zero-shot plain prompt</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Zero-shot plain Yes/No prompt (Question: [premise] ... Can we deduct the following: [hypothesis]?)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Default zero-shot prompt format used to query autoregressive LLMs, asking a binary Yes/No answer given a premise and hypothesis; used as baseline for CORR2CAUSE zero-shot evaluation.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>GPT-3.5</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>CORR2CAUSE (correlation-to-causation inference)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Decide whether a natural-language hypothesis about a causal relation logically follows from a verbalized set of statistical (correlational/conditional-independence) statements.</td>
                        </tr>
                        <tr>
                            <td><strong>problem_format</strong></td>
                            <td>Zero-shot prompt: "Question: [premise]\nCan we deduct the following: [hypothesis]? Just answer \"Yes\" or \"No.\"\nAnswer:" (temperature=0 for API calls).</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_format</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>F1: 21.69; precision: 17.79; recall: 27.78; accuracy: 69.46 (GPT-3.5, plain zero-shot)</td>
                        </tr>
                        <tr>
                            <td><strong>performance_comparison</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_direction</strong></td>
                            <td>no clear strong performance (poor baseline)</td>
                        </tr>
                        <tr>
                            <td><strong>explanation_or_hypothesis</strong></td>
                            <td>Zero-shot plain prompts lead to very low performance on pure causal-inference tasks, indicating LLMs do not reliably perform formal causal reasoning from correlational statements without further adaptation.</td>
                        </tr>
                        <tr>
                            <td><strong>counterexample_or_null_result</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Can Large Language Models Infer Causation from Correlation?', 'publication_date_yy_mm': '2023-06'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e5817.1">
                <h3 class="extraction-instance">Extracted Data Instance 1 (e5817.1)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Enhanced prompt (system + few-shot + CoT)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Enhanced prompt with system instruction, a pair of few-shot examples, and chain-of-thought ("Let's think step by step.")</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A prompt-optimization strategy combining a system-level role, two few-shot examples (one positive, one negative), and a chain-of-thought trigger to encourage stepwise reasoning.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>GPT-3.5</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>CORR2CAUSE (correlation-to-causation inference)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Same as above; tests whether richer prompting elicits better causal reasoning in LLMs.</td>
                        </tr>
                        <tr>
                            <td><strong>problem_format</strong></td>
                            <td>Enhanced query: include system prompt (e.g., "You are a highly intelligent question-answering bot with profound knowledge of causal inference."), include two few-shot examples (one entailment/one non-entailment), and append chain-of-thought cue "Let's think step by step."</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_format</strong></td>
                            <td>Compared against plain zero-shot Yes/No prompt</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>F1: 25.44; precision: 17.29; recall: 48.11; accuracy: 52.01 (GPT-3.5, enhanced prompt)</td>
                        </tr>
                        <tr>
                            <td><strong>performance_comparison</strong></td>
                            <td>Plain zero-shot: F1 21.69 (GPT-3.5); enhanced prompt F1 25.44</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_size</strong></td>
                            <td>+3.75 F1 (absolute) for GPT-3.5 when using enhanced prompt vs. plain zero-shot</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_direction</strong></td>
                            <td>improved</td>
                        </tr>
                        <tr>
                            <td><strong>explanation_or_hypothesis</strong></td>
                            <td>Adding a system instruction, few-shot examples, and chain-of-thought partly helps the model produce better answers (modest F1 gain), but the improvement is small and the model still struggles with the underlying formal causal reasoning.</td>
                        </tr>
                        <tr>
                            <td><strong>counterexample_or_null_result</strong></td>
                            <td>Despite these prompt improvements, overall performance remains low and models still fail on many cases; prompt optimization did not make the task reliably solvable zero-shot.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Can Large Language Models Infer Causation from Correlation?', 'publication_date_yy_mm': '2023-06'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e5817.2">
                <h3 class="extraction-instance">Extracted Data Instance 2 (e5817.2)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Finetuning (supervised)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Finetuning LLMs on CORR2CAUSE training data (supervised adaptation)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Supervised finetuning of models on the CORR2CAUSE dataset yields large in-distribution performance gains but may not confer robust, out-of-distribution causal reasoning.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>RoBERTa-Large MNLI (finetuned)</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>CORR2CAUSE (correlation-to-causation inference)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>The same binary entailment-style decision, but models are finetuned on the task training split.</td>
                        </tr>
                        <tr>
                            <td><strong>problem_format</strong></td>
                            <td>Supervised fine-tuning: standard classification/entailment training on CORR2CAUSE (training set of ~205k samples), then evaluate on original test set.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_format</strong></td>
                            <td>Zero-shot / off-the-shelf performance of same-model family (RoBERTa MNLI zero-shot) and other zero-shot LLMs</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>F1: 94.74; precision: 92.24; recall: 97.37; accuracy: 98.35 (RoBERTa-Large MNLI finetuned on CORR2CAUSE, original i.i.d. test)</td>
                        </tr>
                        <tr>
                            <td><strong>performance_comparison</strong></td>
                            <td>RoBERTa MNLI (off-the-shelf): F1 22.79 (zero-shot). Finetuning effect: large in-distribution gain (~+71.95 F1).</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_size</strong></td>
                            <td>+71.95 F1 (RoBERTa-Large MNLI finetuned vs. same off-the-shelf model)</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_direction</strong></td>
                            <td>improved (large)</td>
                        </tr>
                        <tr>
                            <td><strong>explanation_or_hypothesis</strong></td>
                            <td>Finetuning allows models to pick up dataset-specific patterns and templates, enabling near-perfect i.i.d. performance; however, this likely reflects learning of surface cues/templates rather than robust formal causal reasoning.</td>
                        </tr>
                        <tr>
                            <td><strong>counterexample_or_null_result</strong></td>
                            <td>Finetuned models fail in out-of-distribution settings (see paraphrase and variable-refactorization robustness tests), indicating the performance gain is not robust generalization of causal reasoning.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Can Large Language Models Infer Causation from Correlation?', 'publication_date_yy_mm': '2023-06'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e5817.3">
                <h3 class="extraction-instance">Extracted Data Instance 3 (e5817.3)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Paraphrasing perturbation</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Paraphrased-hypothesis robustness test (semantic paraphrase of hypothesis templates)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Adversarial test that paraphrases hypothesis verbalizations to break reliance on specific lexical templates; used to test OOD robustness of finetuned models.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Finetuned models (various; aggregated behavior)</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>CORR2CAUSE (robustness/paraphrase evaluation)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Inference on a perturbed test set where hypothesis templates are replaced by semantically equivalent paraphrases to detect reliance on lexical templates.</td>
                        </tr>
                        <tr>
                            <td><strong>problem_format</strong></td>
                            <td>Inference only on paraphrased-hypothesis test set (no retraining); models are finetuned on original training data but evaluated on paraphrases.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_format</strong></td>
                            <td>Original (i.i.d.) test vs. paraphrased test</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>Across finetuned models, performance drops substantially on paraphrased test sets (examples: many finetuned models' F1 scores drop by large margins; aggregate maximum observed drop up to 39.29 F1).</td>
                        </tr>
                        <tr>
                            <td><strong>performance_comparison</strong></td>
                            <td>Original i.i.d. F1 (example RoBERTa-Large MNLI): 94.74 -> paraphrased F1: substantial drop (varies by model; paraphrase sensitivity highest among several finetuned models).</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_size</strong></td>
                            <td>- up to 39.29 F1 (maximum observed paraphrase-induced drop across tested finetuned models)</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_direction</strong></td>
                            <td>reduced</td>
                        </tr>
                        <tr>
                            <td><strong>explanation_or_hypothesis</strong></td>
                            <td>Paraphrasing breaks learned surface/formulation cues (n-gram patterns) that models exploit; therefore, strong i.i.d. performance often reflects template memorization rather than robust reasoning.</td>
                        </tr>
                        <tr>
                            <td><strong>counterexample_or_null_result</strong></td>
                            <td>Some classes and models are more robust than others at the paraphrase test (fine-grained differences exist), but large, sometimes catastrophic, drops occur for multiple models.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Can Large Language Models Infer Causation from Correlation?', 'publication_date_yy_mm': '2023-06'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e5817.4">
                <h3 class="extraction-instance">Extracted Data Instance 4 (e5817.4)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Variable refactorization perturbation</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Variable-name refactorization robustness test (reverse alphabet / rename variables)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Adversarial test that systematically refactors variable names (e.g., A,B,C -> Z,Y,X) to break spurious correlations tied to particular variable tokens and templates.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>RoBERTa-Large MNLI (finetuned) and other finetuned models</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>CORR2CAUSE (robustness/variable-refactorization evaluation)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Inference on a perturbed test set where variable identifiers are consistently renamed to detect dependence on particular variable tokens.</td>
                        </tr>
                        <tr>
                            <td><strong>problem_format</strong></td>
                            <td>Inference only on variable-refactorized test set (no retraining); models finetuned on original training data evaluated on refactored variables.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_format</strong></td>
                            <td>Original (i.i.d.) test vs. variable-refactorized test</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>Example: RoBERTa-Large MNLI finetuned original F1 94.74 -> variable-refactorized F1 67.87 (reported maintained F1 for this model). Across models, some experienced drops up to 62.30 F1.</td>
                        </tr>
                        <tr>
                            <td><strong>performance_comparison</strong></td>
                            <td>Original i.i.d. F1 (RoBERTa-Large MNLI): 94.74; after variable refactorization: 67.87.</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_size</strong></td>
                            <td>-26.87 F1 for RoBERTa-Large MNLI; up to -62.30 F1 observed across models (maximum observed drop).</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_direction</strong></td>
                            <td>reduced</td>
                        </tr>
                        <tr>
                            <td><strong>explanation_or_hypothesis</strong></td>
                            <td>Models learn spurious associations between variable names / position-specific tokens and labels; renaming variables breaks these spurious cues, revealing lack of robust conceptual generalization.</td>
                        </tr>
                        <tr>
                            <td><strong>counterexample_or_null_result</strong></td>
                            <td>RoBERTa-Large MNLI was relatively more robust to variable refactorization than to paraphrasing (it maintained a reasonably high F1 of 67.87), indicating robustness depends on the particular spurious cue exploited.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Can Large Language Models Infer Causation from Correlation?', 'publication_date_yy_mm': '2023-06'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e5817.5">
                <h3 class="extraction-instance">Extracted Data Instance 5 (e5817.5)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Spurious lexical cues (PMI analysis)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Spurious lexical/template cues revealed by PMI between n-grams and labels</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Analysis showing that short lexical n-grams (e.g., "a cause", "a direct", or tokens tied to particular variable names) have high PMI with labels, indicating models could exploit these superficial cues.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Finetuned models (various, analysis applies broadly)</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>CORR2CAUSE (analysis of learned cues)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Statistical analysis (PMI) of n-grams (<=4 tokens) in premise/hypothesis and their association with labels to detect dataset-language artifacts.</td>
                        </tr>
                        <tr>
                            <td><strong>problem_format</strong></td>
                            <td>Not an evaluation format per se but a dataset / analysis procedure: compute PMI between labels and n-grams to identify high-association tokens/phrases.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_format</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>N/A (analysis): top n-grams with largest PMI differences include "a cause", "a direct", and tokens related to particular variable names (e.g., "for D", "for E").</td>
                        </tr>
                        <tr>
                            <td><strong>performance_comparison</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_direction</strong></td>
                            <td>n/a (diagnostic)</td>
                        </tr>
                        <tr>
                            <td><strong>explanation_or_hypothesis</strong></td>
                            <td>High-PMI n-grams indicate that models can rely on simple lexical patterns to predict labels; paraphrasing or variable renaming breaks these correlations and causes performance to drop.</td>
                        </tr>
                        <tr>
                            <td><strong>counterexample_or_null_result</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Can Large Language Models Infer Causation from Correlation?', 'publication_date_yy_mm': '2023-06'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>Language models are few-shot learners <em>(Rating: 2)</em></li>
                <li>Training language models to follow instructions with human feedback <em>(Rating: 2)</em></li>
                <li>TextAttack: A framework for adversarial attacks, data augmentation, and adversarial training in NLP <em>(Rating: 2)</em></li>
                <li>Causal parrots: Large language models may talk causality but are not causal <em>(Rating: 2)</em></li>
                <li>Is BERT really robust? A strong baseline for natural language attack on text classification and entailment <em>(Rating: 2)</em></li>
                <li>Probing for correlations of causal facts: Large language models and causality <em>(Rating: 1)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-5817",
    "paper_id": "paper-0a94fbb5e1c93513523f00e75d672ef4553861f9",
    "extraction_schema_id": "extraction-schema-116",
    "extracted_data": [
        {
            "name_short": "Zero-shot plain prompt",
            "name_full": "Zero-shot plain Yes/No prompt (Question: [premise] ... Can we deduct the following: [hypothesis]?)",
            "brief_description": "Default zero-shot prompt format used to query autoregressive LLMs, asking a binary Yes/No answer given a premise and hypothesis; used as baseline for CORR2CAUSE zero-shot evaluation.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "GPT-3.5",
            "model_size": null,
            "task_name": "CORR2CAUSE (correlation-to-causation inference)",
            "task_description": "Decide whether a natural-language hypothesis about a causal relation logically follows from a verbalized set of statistical (correlational/conditional-independence) statements.",
            "problem_format": "Zero-shot prompt: \"Question: [premise]\\nCan we deduct the following: [hypothesis]? Just answer \\\"Yes\\\" or \\\"No.\\\"\\nAnswer:\" (temperature=0 for API calls).",
            "comparison_format": null,
            "performance": "F1: 21.69; precision: 17.79; recall: 27.78; accuracy: 69.46 (GPT-3.5, plain zero-shot)",
            "performance_comparison": null,
            "format_effect_size": null,
            "format_effect_direction": "no clear strong performance (poor baseline)",
            "explanation_or_hypothesis": "Zero-shot plain prompts lead to very low performance on pure causal-inference tasks, indicating LLMs do not reliably perform formal causal reasoning from correlational statements without further adaptation.",
            "counterexample_or_null_result": null,
            "uuid": "e5817.0",
            "source_info": {
                "paper_title": "Can Large Language Models Infer Causation from Correlation?",
                "publication_date_yy_mm": "2023-06"
            }
        },
        {
            "name_short": "Enhanced prompt (system + few-shot + CoT)",
            "name_full": "Enhanced prompt with system instruction, a pair of few-shot examples, and chain-of-thought (\"Let's think step by step.\")",
            "brief_description": "A prompt-optimization strategy combining a system-level role, two few-shot examples (one positive, one negative), and a chain-of-thought trigger to encourage stepwise reasoning.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "GPT-3.5",
            "model_size": null,
            "task_name": "CORR2CAUSE (correlation-to-causation inference)",
            "task_description": "Same as above; tests whether richer prompting elicits better causal reasoning in LLMs.",
            "problem_format": "Enhanced query: include system prompt (e.g., \"You are a highly intelligent question-answering bot with profound knowledge of causal inference.\"), include two few-shot examples (one entailment/one non-entailment), and append chain-of-thought cue \"Let's think step by step.\"",
            "comparison_format": "Compared against plain zero-shot Yes/No prompt",
            "performance": "F1: 25.44; precision: 17.29; recall: 48.11; accuracy: 52.01 (GPT-3.5, enhanced prompt)",
            "performance_comparison": "Plain zero-shot: F1 21.69 (GPT-3.5); enhanced prompt F1 25.44",
            "format_effect_size": "+3.75 F1 (absolute) for GPT-3.5 when using enhanced prompt vs. plain zero-shot",
            "format_effect_direction": "improved",
            "explanation_or_hypothesis": "Adding a system instruction, few-shot examples, and chain-of-thought partly helps the model produce better answers (modest F1 gain), but the improvement is small and the model still struggles with the underlying formal causal reasoning.",
            "counterexample_or_null_result": "Despite these prompt improvements, overall performance remains low and models still fail on many cases; prompt optimization did not make the task reliably solvable zero-shot.",
            "uuid": "e5817.1",
            "source_info": {
                "paper_title": "Can Large Language Models Infer Causation from Correlation?",
                "publication_date_yy_mm": "2023-06"
            }
        },
        {
            "name_short": "Finetuning (supervised)",
            "name_full": "Finetuning LLMs on CORR2CAUSE training data (supervised adaptation)",
            "brief_description": "Supervised finetuning of models on the CORR2CAUSE dataset yields large in-distribution performance gains but may not confer robust, out-of-distribution causal reasoning.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "RoBERTa-Large MNLI (finetuned)",
            "model_size": null,
            "task_name": "CORR2CAUSE (correlation-to-causation inference)",
            "task_description": "The same binary entailment-style decision, but models are finetuned on the task training split.",
            "problem_format": "Supervised fine-tuning: standard classification/entailment training on CORR2CAUSE (training set of ~205k samples), then evaluate on original test set.",
            "comparison_format": "Zero-shot / off-the-shelf performance of same-model family (RoBERTa MNLI zero-shot) and other zero-shot LLMs",
            "performance": "F1: 94.74; precision: 92.24; recall: 97.37; accuracy: 98.35 (RoBERTa-Large MNLI finetuned on CORR2CAUSE, original i.i.d. test)",
            "performance_comparison": "RoBERTa MNLI (off-the-shelf): F1 22.79 (zero-shot). Finetuning effect: large in-distribution gain (~+71.95 F1).",
            "format_effect_size": "+71.95 F1 (RoBERTa-Large MNLI finetuned vs. same off-the-shelf model)",
            "format_effect_direction": "improved (large)",
            "explanation_or_hypothesis": "Finetuning allows models to pick up dataset-specific patterns and templates, enabling near-perfect i.i.d. performance; however, this likely reflects learning of surface cues/templates rather than robust formal causal reasoning.",
            "counterexample_or_null_result": "Finetuned models fail in out-of-distribution settings (see paraphrase and variable-refactorization robustness tests), indicating the performance gain is not robust generalization of causal reasoning.",
            "uuid": "e5817.2",
            "source_info": {
                "paper_title": "Can Large Language Models Infer Causation from Correlation?",
                "publication_date_yy_mm": "2023-06"
            }
        },
        {
            "name_short": "Paraphrasing perturbation",
            "name_full": "Paraphrased-hypothesis robustness test (semantic paraphrase of hypothesis templates)",
            "brief_description": "Adversarial test that paraphrases hypothesis verbalizations to break reliance on specific lexical templates; used to test OOD robustness of finetuned models.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "Finetuned models (various; aggregated behavior)",
            "model_size": null,
            "task_name": "CORR2CAUSE (robustness/paraphrase evaluation)",
            "task_description": "Inference on a perturbed test set where hypothesis templates are replaced by semantically equivalent paraphrases to detect reliance on lexical templates.",
            "problem_format": "Inference only on paraphrased-hypothesis test set (no retraining); models are finetuned on original training data but evaluated on paraphrases.",
            "comparison_format": "Original (i.i.d.) test vs. paraphrased test",
            "performance": "Across finetuned models, performance drops substantially on paraphrased test sets (examples: many finetuned models' F1 scores drop by large margins; aggregate maximum observed drop up to 39.29 F1).",
            "performance_comparison": "Original i.i.d. F1 (example RoBERTa-Large MNLI): 94.74 -&gt; paraphrased F1: substantial drop (varies by model; paraphrase sensitivity highest among several finetuned models).",
            "format_effect_size": "- up to 39.29 F1 (maximum observed paraphrase-induced drop across tested finetuned models)",
            "format_effect_direction": "reduced",
            "explanation_or_hypothesis": "Paraphrasing breaks learned surface/formulation cues (n-gram patterns) that models exploit; therefore, strong i.i.d. performance often reflects template memorization rather than robust reasoning.",
            "counterexample_or_null_result": "Some classes and models are more robust than others at the paraphrase test (fine-grained differences exist), but large, sometimes catastrophic, drops occur for multiple models.",
            "uuid": "e5817.3",
            "source_info": {
                "paper_title": "Can Large Language Models Infer Causation from Correlation?",
                "publication_date_yy_mm": "2023-06"
            }
        },
        {
            "name_short": "Variable refactorization perturbation",
            "name_full": "Variable-name refactorization robustness test (reverse alphabet / rename variables)",
            "brief_description": "Adversarial test that systematically refactors variable names (e.g., A,B,C -&gt; Z,Y,X) to break spurious correlations tied to particular variable tokens and templates.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "RoBERTa-Large MNLI (finetuned) and other finetuned models",
            "model_size": null,
            "task_name": "CORR2CAUSE (robustness/variable-refactorization evaluation)",
            "task_description": "Inference on a perturbed test set where variable identifiers are consistently renamed to detect dependence on particular variable tokens.",
            "problem_format": "Inference only on variable-refactorized test set (no retraining); models finetuned on original training data evaluated on refactored variables.",
            "comparison_format": "Original (i.i.d.) test vs. variable-refactorized test",
            "performance": "Example: RoBERTa-Large MNLI finetuned original F1 94.74 -&gt; variable-refactorized F1 67.87 (reported maintained F1 for this model). Across models, some experienced drops up to 62.30 F1.",
            "performance_comparison": "Original i.i.d. F1 (RoBERTa-Large MNLI): 94.74; after variable refactorization: 67.87.",
            "format_effect_size": "-26.87 F1 for RoBERTa-Large MNLI; up to -62.30 F1 observed across models (maximum observed drop).",
            "format_effect_direction": "reduced",
            "explanation_or_hypothesis": "Models learn spurious associations between variable names / position-specific tokens and labels; renaming variables breaks these spurious cues, revealing lack of robust conceptual generalization.",
            "counterexample_or_null_result": "RoBERTa-Large MNLI was relatively more robust to variable refactorization than to paraphrasing (it maintained a reasonably high F1 of 67.87), indicating robustness depends on the particular spurious cue exploited.",
            "uuid": "e5817.4",
            "source_info": {
                "paper_title": "Can Large Language Models Infer Causation from Correlation?",
                "publication_date_yy_mm": "2023-06"
            }
        },
        {
            "name_short": "Spurious lexical cues (PMI analysis)",
            "name_full": "Spurious lexical/template cues revealed by PMI between n-grams and labels",
            "brief_description": "Analysis showing that short lexical n-grams (e.g., \"a cause\", \"a direct\", or tokens tied to particular variable names) have high PMI with labels, indicating models could exploit these superficial cues.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "Finetuned models (various, analysis applies broadly)",
            "model_size": null,
            "task_name": "CORR2CAUSE (analysis of learned cues)",
            "task_description": "Statistical analysis (PMI) of n-grams (&lt;=4 tokens) in premise/hypothesis and their association with labels to detect dataset-language artifacts.",
            "problem_format": "Not an evaluation format per se but a dataset / analysis procedure: compute PMI between labels and n-grams to identify high-association tokens/phrases.",
            "comparison_format": null,
            "performance": "N/A (analysis): top n-grams with largest PMI differences include \"a cause\", \"a direct\", and tokens related to particular variable names (e.g., \"for D\", \"for E\").",
            "performance_comparison": null,
            "format_effect_size": null,
            "format_effect_direction": "n/a (diagnostic)",
            "explanation_or_hypothesis": "High-PMI n-grams indicate that models can rely on simple lexical patterns to predict labels; paraphrasing or variable renaming breaks these correlations and causes performance to drop.",
            "counterexample_or_null_result": null,
            "uuid": "e5817.5",
            "source_info": {
                "paper_title": "Can Large Language Models Infer Causation from Correlation?",
                "publication_date_yy_mm": "2023-06"
            }
        }
    ],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "Language models are few-shot learners",
            "rating": 2
        },
        {
            "paper_title": "Training language models to follow instructions with human feedback",
            "rating": 2
        },
        {
            "paper_title": "TextAttack: A framework for adversarial attacks, data augmentation, and adversarial training in NLP",
            "rating": 2
        },
        {
            "paper_title": "Causal parrots: Large language models may talk causality but are not causal",
            "rating": 2
        },
        {
            "paper_title": "Is BERT really robust? A strong baseline for natural language attack on text classification and entailment",
            "rating": 2
        },
        {
            "paper_title": "Probing for correlations of causal facts: Large language models and causality",
            "rating": 1
        }
    ],
    "cost": 0.01746975,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>Can Large Language Models Infer CAUSATION FROM CORRELATION?</h1>
<p>Zhijing Jin ${ }^{1,2, \text {, }}$ Jiarui Liu ${ }^{3, *}$ Zhiheng Lyu ${ }^{4}$ Spencer Poff ${ }^{5}$<br>Mrinmaya Sachan ${ }^{2}$ Rada Mihalcea ${ }^{6}$ Mona Diab ${ }^{3,2, \dagger}$ Bernhard Schlkopf ${ }^{1, \dagger}$<br>${ }^{1}$ Max Planck Institute for Intelligent Systems, Tbingen, Germany ${ }^{2}$ ETH Zrich<br>${ }^{3}$ LTI, CMU ${ }^{4}$ University of Hong Kong ${ }^{5}$ Meta AI ${ }^{6}$ University of Michigan<br>jinzhi@ethz.ch jiarui@cmu.edu zhihenglyu.cs@gmail.com</p>
<h4>Abstract</h4>
<p>Causal inference is one of the hallmarks of human intelligence. While the field of Causal NLP has attracted much interest in the recent years, existing causal inference datasets in NLP primarily rely on discovering causality from empirical knowledge (e.g., commonsense knowledge). In this work, we propose the first benchmark dataset to test the pure causal inference skills of large language models (LLMs). Specifically, we formulate a novel task CORR2CAUSE, which takes a set of correlational statements and determines the causal relationship between the variables. We curate a large-scale dataset of more than 200K samples, on which we evaluate seventeen existing LLMs. Through our experiments, we identify a key shortcoming of LLMs in terms of their causal inference skills, and show that these models achieve almost close to random performance on the task. This shortcoming is somewhat mitigated when we try to re-purpose LLMs for this skill via finetuning, but we find that these models still fail to generalize - they can only perform causal inference in in-distribution settings when variable names and textual expressions used in the queries are similar to those in the training set, but fail in out-of-distribution settings generated by perturbing these queries. CORR2CAUSE is a challenging task for LLMs, and can be helpful in guiding future research on improving LLMs' pure reasoning skills and generalizability. ${ }^{1}$</p>
<h2>1 INTRODUCTION</h2>
<p>Causal inference, i.e., the ability to establish the correct causal relationships between variables or events, is fundamental to human intelligence. There are two distinct ways this causal inference capability can be acquired: one through empirical knowledge, e.g., we know from common sense that touching a hot stove will get us burned; the other through pure causal reasoning, as causality can be formally argued and reasoned about using known procedures and rules from causal inference (Spirtes et al., 2000; Pearl, 2009; Peters et al., 2017). One example is that we have the a priori knowledge that the correlation between A and B does not necessarily imply causality. This is a formal rule that holds true regardless of the realizations of the variables A and B.</p>
<p>With the rise of large language models (LLMs) (Radford et al., 2019; Devlin et al., 2019; Ouyang et al., 2022; Zhang et al., 2022; OpenAI, 2023, inter alia), a crucial research question is whether they can do causal reasoning well. Recent studies have pointed out that LLMs are "causal parrots," which recite the causal knowledge in the training data (Zeevi et al., 2023). Moreover, the vast majority of studies frame causal reasoning as a skill to navigate around empirical knowledge (Gordon et al., 2012; Sap et al., 2019a;b; Qin et al., 2019; Bhagavatula et al., 2020), and also treat LLMs as a knowledge base when evaluating its causal skills (Kcman et al., 2023; Tu et al., 2023; Xie et al., 2023). However, all the above lines of research frame causality as empirical knowledge, thus relying heavily on the quality and the coverage of the training data, overlooking the great potential of the formal causal reasoning skills to process correlational information to causal conclusions.</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p><img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1: Illustration of the motivation behind our task and dataset.</p>
<p>Drawing inspirations from technical studies on causal discovery (Spirtes et al., 2000; Spirtes \&amp; Zhang, 2016; Glymour et al., 2019), we formulate a novel task for NLP, correlation-to-causation inference (CORR2CAUSE), which is an important skill for LLMs. Imagine the scenario in Figure 1, where the training corpus does not tediously cover every causal relation, but more pervasively talk about correlations, such as which events tend to co-occur. Learning a good CORR2CAUSE skill can enable LLMs to draw causal relations behind the mere correlational information on the surface. For example, several decades ago, there might be an observation that female university students tend to perform better, but behind the correlational statistics is the causal graph that female students have to achieve extra good performance to get into universities as the first place.</p>
<p>To this end, we collect the CORR2CAUSE dataset, the first dataset to test the pure causal reasoning abilities of LLMs. All the questions in this dataset are centered around testing when it is valid or invalid to infer causation from correlation. To systematically compose this dataset, we ground our generalization process in the formal framework of causal discovery (Spirtes et al., 1993; 2000; Glymour et al., 2016; Spirtes \&amp; Zhang, 2016), which provides rules about how to deduce causal relations among variables given their statistical correlation in the observational data. We generate more than 200 K data points, and label a correlation-causation statement pair as valid if and only if there is a bijective mapping between the statistical correlation and the underlying causality.</p>
<p>Based on our CORR2CAUSE dataset with 200K samples, we investigate two main research questions: (1) How well do existing LLMs perform on this task? (2) Can existing LLMs be re-trained or re-purposed on this task and obtain robust causal inference skills? Through extensive experiments, we show empirically that none of the 17 existing LLMs we investigate perform well on this pure causal inference task. We also show that although LLMs can demonstrate better performance after being finetuned on the data, the causal inference skills attained by them are not robust. In summary, our contributions are as follows:</p>
<ol>
<li>We propose the novel task of CORR2CAUSE, to probe an aspect of LLM's reasoning ability, pure causal inference;</li>
<li>We compose a dataset of over 200K samples, using insights from causal discovery;</li>
<li>We evaluate the performance of 17 LLMs on our dataset, finding that all of them perform poorly, close to the random baseline;</li>
<li>We further explored whether LLMs can learn the skill through finetuning, and find that LLMs fail to robustly acquire this skill in out-of-distribution settings. Finally, we suggest future work to explore more ways to enhance the pure causal inference skill in LLMs.</li>
</ol>
<h1>2 Preliminaries: Causal Inference</h1>
<h3>2.1 Directed Graphical Causal Models (DGCMs)</h3>
<p>A directed graphical causal model (DGCM) is a commonly used representation to express the causal relations among a set of variables. Given a set of $N$ variables $\boldsymbol{X}=\left{X_{1}, \ldots, X_{N}\right}$, we can encode the causal relations among them using a directed graph $\mathcal{G}:=(\boldsymbol{X}, \boldsymbol{E})$, where $\boldsymbol{E}$ is the set of directed edges. Each edge $e_{i, j} \in \boldsymbol{E}$ represents a causal link $X_{i} \rightarrow X_{j}$, meaning that $X_{i}$ is a direct cause of $X_{j}$. In the context of this work, we take the common assumption of directed acyclic graphs (DAGs), which most causal discovery methods use (Glymour et al., 2019), as graphs with cycles can make the causal discovery process arbitrarily hard.</p>
<p>Following the graph-theoretic terminology, we use an analogy of the ancestry tree to denote the relations between two variables. For example, we call $X_{i}$ as a parent of $X_{j}$ if there is a directed edge $X_{i} \rightarrow X_{j}$ in the graph, and, thus, $X_{j}$ is a child of $X_{i}$. Similarly, we denote $X_{i}$ as an ancestor of $X_{j}$ if there exists a directed path from $X_{i}$ to $X_{j}$, and, thus, $X_{j}$ is a descendent of $X_{i}$. Note that a parent is a special case of an ancestor where the directed path has a length of 1 .</p>
<p>For convenience, we also introduce the notions for some special three-variable relations. Given two variables $X_{i}$ and $X_{j}$, we call a third variable $X_{k}$ a confounder (i.e., common cause) if $X_{k}$ is a parent of both $X_{i}$ and $X_{j}$; a collider (i.e., common effect) if $X_{k}$ is a child of both $X_{i}$ and $X_{j}$; and a mediator if $X_{k}$ is both a child of $X_{i}$, and a parent of $X_{j}$.</p>
<h1>2.2 D-Separation and Markov Property</h1>
<p>D-Separation D-separation (Pearl, 1988) is a fundamental concept in graphical models used to determine whether two sets of nodes $\boldsymbol{X}$ and $\boldsymbol{Y}$ in a DAG $\mathcal{G}$ are conditionally independent given a third set of nodes $\boldsymbol{Z}$, where the three sets are disjoint. We say that $\boldsymbol{X}$ and $\boldsymbol{Y}$ are d-separated by $\boldsymbol{Z}$ if all paths between any node in $\boldsymbol{X}$ and any node in $\boldsymbol{Y}$ are blocked by the conditioning set $\boldsymbol{Z}$. A path between $\boldsymbol{X}$ and $\boldsymbol{Y}$ is blocked by $\boldsymbol{Z}$ if there exists a node $A \in \boldsymbol{Z}$ which satisfies one of the following conditions: $A$ is the parent node in a fork structure on the path (i.e., $\cdot \leftarrow A \rightarrow \cdot$ ); $A$ is the mediator node in a chain structure on the path (i.e., $\cdot \rightarrow A \rightarrow \cdot$ ); or in any collider structure on the path (i.e., $\cdot \rightarrow A \leftarrow \cdot), \boldsymbol{Z}$ does not contain $A$ or its descendants.</p>
<p>Markov Property The Markov property in a DAG $\mathcal{G}$ states that each node $X_{i}$ is conditionally independent of its non-descendants given its parents, namely $X_{i} \Perp \operatorname{NonDe}\left(X_{i}\right) \mid \mathbf{P a}\left(X_{i}\right)$, where $\operatorname{NonDe}\left(X_{i}\right)$ denotes the non-descendants of $X_{i}$ excluding itself, and $\operatorname{Pa}\left(X_{i}\right)$ denotes the parents of $X_{i}$. Using the Markov property, we can factorize the joint distribution of all the nodes in the graph into $P\left(X_{1}, \ldots, X_{N}\right)=\prod_{i=1}^{N} P\left(X_{i} \mid \mathbf{P A}\left(X_{i}\right)\right)$. To infer the causal graph from probability distributions, a common assumption is faithfulness, namely the validity to infer all the d-separation sets in the graph from the independence relations in the probability distribution. In our work, we also take this broadly taken assumption which holds for most real-world scenarios.</p>
<p>Markov Equivalence of Graphs We denote two DAGs as Markov equivalent if they induce the same joint distribution $P(\boldsymbol{X})$. The set of DAGs that are Markov equivalent to each other is called a Markov equivalence class (MEC). Causal graphs in the same MEC can be easily identified since they have the same skeleton (i.e., undirected edges) and V-structures (i.e., structures in the form of $A \rightarrow B \leftarrow C$ where $A$ and $C$ are not connected).</p>
<p>Obviously, there is a one-to-many mapping (i.e., surjection) between the causal graph and statistical distribution. Namely, each causal graph sufficiently determines a statistical distribution, but from a statistical distribution, we cannot necessarily induce a unique causal graph. This is why we say "correlation does not necessarily mean causation".</p>
<h3>2.3 CAUSAL DISCOVERY</h3>
<p>Causal discovery aims to learn the causal relations by analyzing statistical properties in the observational data (Spirtes et al., 1993; 2000; Glymour et al., 2016; Spirtes \&amp; Zhang, 2016; Glymour et al., 2019). It can be achieved through constraint-based methods (Spirtes et al., 2000), score-based methods (Chickering, 2002), or other methods taking advantage of the functional causal models (Shimizu et al., 2006; Hoyer et al., 2008; Zhang \&amp; Hyvrinen, 2009).</p>
<p>To fit for the spirit of this paper to infer from correlation (expressed in natural language) to causation, we base our dataset design on the widely-used Peter-Clark (PC) algorithm (Spirtes et al., 2000). The PC algorithm is based on the principles of conditional independence and the causal Markov assumption, which allows it to efficiently identify causal relationships among variables in a given dataset. The algorithm first starts with a fully connected undirected graph among all the variables. Then it removes the edge between two variables if there is an unconditional or conditional independence relationship between them. Afterwards, it orients the directed edges whenever there is a V-structure. And finally, it iteratively checks the direction of the other edges until the entire causal graph is consistent with all the statistical correlations.</p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 2: Pipeline of the data construction process.</p>
<h1>3 DATASET CONSTRUCTION</h1>
<p>We introduce the construction of our dataset in this section. We start with our task formulation for CORR2CAUSE, and then briefly give an overview of the data generation process, followed by detailed descriptions of each step. We conclude the section with the overall statistics of the dataset.</p>
<h3>3.1 TASK FORMULATION</h3>
<p>Given a set of $N$ variables $\boldsymbol{X}=\left{X_{1}, \ldots, X_{N}\right}$, we have a statement $\boldsymbol{s}$ about all the correlations among the variables, and a hypothesis $\boldsymbol{h}$ describing the causal relation $r$ between the pair of variables $X_{i}$ and $X_{j}$. The task is to learn a function $f:(\boldsymbol{s}, \boldsymbol{h}) \mapsto v$ which maps the correlation statement $\boldsymbol{s}$ and the causal relation hypothesis $\boldsymbol{h}$ to their validity $v \in{0,1}$, which takes the value 0 if this inference is invalid, and the value 1 if this inference is valid.</p>
<h3>3.2 OVERVIEW OF THE DATA GENERATION PROCESS</h3>
<p>We base the construction our dataset on several concepts of causal inference, including the DGCM, d-separation, and MECs, as introduced in Section 2.</p>
<p>As in the overview of our data generation process in Figure 2, we first choose the number $N$ of variables (Step 1) and generate all the unique DGCMs with $N$ nodes (Step 2), which we will introduce in the Section 3.3. Then we collect all the d-separation sets from these graphs to identify MECs (Step 3) in Section 3.4. Then, in Step 4, we create the formal form of data in Section 3.5. For each correspondence of the MEC to causal graphs, we compose the correlation statement based on the statistical relations in the MEC, and hypothesize a causal relation between two variables, and produce the validity $v=1$ if the hypothesis is a shared property of all causal graphs in the MEC, and $v=0$ if the hypothesis is not necessarily true for all the MEC graphs. Finally, we introduce the verbalization process in Section 3.6.</p>
<h3>3.3 CONSTRUCTING THE GRAPHS WITH ISOMORPHISM CHECKS</h3>
<p>The first step of the data generation is to compose the causal graphs, as in Step 1 and 2 of Figure 2. For a set of $N$ variables $\boldsymbol{X}=\left{X_{1}, \ldots, X_{N}\right}$, there are $N(N-1)$ possible directed edges, since each node can link to any node other than itself. To remove cycles in the graph, we make the nodes in topological order, which only allows edges $X_{i} \rightarrow X_{j}$, where $i&lt;j$. We achieve this by limiting the adjacency matrix of the graph to only having non-zero values above the diagonal, resulting in $N(N-1) / 2$ possible directed edges for the DAGs.</p>
<p>At the first glance, for $N$ nodes, there should be $2^{N(N-1) / 2}$ possible DAGs (i.e., the power set of all edges). However, there could be isomorphic graphs in this set. To avoid this, we perform a graph</p>
<table>
<thead>
<tr>
<th style="text-align: center;"># Nodes</th>
<th style="text-align: center;"># Unique DAGs</th>
<th style="text-align: center;"># Edges/DAG</th>
<th style="text-align: center;"># MECs</th>
<th style="text-align: center;"># DAGs/MEC</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2 out of 2</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1.0</td>
</tr>
<tr>
<td style="text-align: center;">3</td>
<td style="text-align: center;">6 out of $2^{3}$</td>
<td style="text-align: center;">1.67</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">1.2</td>
</tr>
<tr>
<td style="text-align: center;">4</td>
<td style="text-align: center;">31 out of $2^{6}$</td>
<td style="text-align: center;">3.48</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">1.55</td>
</tr>
<tr>
<td style="text-align: center;">5</td>
<td style="text-align: center;">302 out of $2^{10}$</td>
<td style="text-align: center;">5.89</td>
<td style="text-align: center;">142</td>
<td style="text-align: center;">2.13</td>
</tr>
<tr>
<td style="text-align: center;">6</td>
<td style="text-align: center;">5,984 out of $2^{15}$</td>
<td style="text-align: center;">8.77</td>
<td style="text-align: center;">2,207</td>
<td style="text-align: center;">2.71</td>
</tr>
<tr>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">6,325</td>
<td style="text-align: center;">8.60</td>
<td style="text-align: center;">2,376</td>
<td style="text-align: center;">2.66</td>
</tr>
</tbody>
</table>
<p>Table 1: Statistics about the source causal graphs in our dataset. Given the number of nodes, we report the number of unique DAGs, average number of edges per DAG, number of MECs, and average number of DAGs per MEC.
isomorphism check (McKay \&amp; Piperno, 2014), and reduce the set so that only unique DAGs are retained, and we show their statistics in Table 1. Although we can handle large graphs, we mostly focus on smaller graphs that can still lead to a reasonably sized dataset, so we empirically set $N=6$, but future work can use our open-sourced codes to extend to more nodes.</p>
<h1>3.4 PROGRAMMATICALLY GENERATING THE D-SEPARATION SETS</h1>
<p>Based on the set of unique DAGs, we then programmatically generate the d-separation sets by graph theoretical conditions, as in Step 3 of Figure 2. To realize this step, we code an efficient graph-theoretic algorithm to check for all the chain, fork, and collider structures to automatically identify the set of nodes that d-separate each pair of nodes. Using the d-separation sets and the faithfulness assumption, we form the statistical correlations as follows. For each pair of nodes, they are conditionally independent given the variables in the d-separation set. If the d-separation set is empty, then the two nodes are unconditionally independent. If no d-separation set can be found for the two nodes, then they are directly correlated.</p>
<p>Moreover, using the d-separation sets, we are able to cluster causal graphs to MECs. We achieve it by tracing the mapping between the causal graphs and the set of statistical correlations, and backtracking the graphs with the same d-separation sets to group them in the same MEC. We show in Table 1 that each MEC contains on average 2.66 DAGs.</p>
<h3>3.5 COMPOSING THE HYPOTHESES AND LABEL</h3>
<p>After generating the set of correlations based on the d-separation sets, we now generate the causal hypotheses. For the causal relation $r$, we focus on six common causal relations between two nodes introduced in Section 2.1: Is-Parent, Is-Child, Is-Ancestor (excluding the parents), Is-Descendant (excluding the children), Has-Confounder (i.e., there exists a confounder, or common cause, of the two nodes), and Has-Collider (i.e., there exists a collider, or common effect, of the two nodes). In this way, the set of hypotheses contains all six meaningful causal relations between every pair of variables, resulting in a total size of $6 \cdot N(N-1) / 2=3 N(N-1)$ hypotheses for a graph with $N$ variables.</p>
<p>To generate the ground-truth validity label, we start from the correlation sets in Step 3, then look up all the causal graphs in the same MEC corresponding to the given set of correlations, and check the necessity of the hypothesized causal relation. If the causal relationship proposed in the hypothesis is valid for all causal graphs within the MEC, then we generate the validity $v=1$; otherwise, we generate $v=0$. A special case of valid samples is that when the size of the MEC is 1 , then there is a bijective mapping between the causal graph and the d-separation sets, so any hypothesis stating the causal properties of that unique causal graph is valid.</p>
<h3>3.6 VERbALIZING INTO LANGUAGE</h3>
<p>Finally, as in the last step of Figure 2, we convert all the information above to text data for our CORR2CAUSE task. For the correlation statement, we verbalize the set of correlations in Step 3 into a natural language statement $s$. When two variables cannot be d-separated, i.e., $A \not \Delta B$, then we describe them as " $A$ correlates with $B$ " since they are directly correlated and cannot be independent by any condition. And if two variables have a valid d-separation set $\boldsymbol{C}$, then we describe them as " $A$ is independent of $B$ given $\boldsymbol{C}$." In the special case when the d-separation set is empty, we directly say " $A$ is independent of $B$." In addition, we disambiguate the setting by starting the correlation statement with the setup of a closed system of the given variables, and no hidden variables: "Suppose there is a closed system of $N$ variables, A, B, $\ldots$ All the statistical relations among these $N$ variables are as follows:". Finally, to verbalize the hypothesis, we feed the causal relation triplet $\left(X_{i}, r, X_{j}\right)$</p>
<table>
<thead>
<tr>
<th>Causal Relation</th>
<th>Hypothesis Template</th>
</tr>
</thead>
<tbody>
<tr>
<td>Is-Parent</td>
<td>{Var i} directly causes {Var j}.</td>
</tr>
<tr>
<td>Is-Ancestor</td>
<td>{Var i} causes something else which causes {Var j}.</td>
</tr>
<tr>
<td>Is-Child</td>
<td>{Var j} directly causes {Var i}.</td>
</tr>
<tr>
<td>Is-Descendant</td>
<td>{Var j} is a cause for {Var i}, but not a direct one.</td>
</tr>
<tr>
<td>Has-Collider</td>
<td>There exists at least one collider (i.e., common effect) of {Var i} and {Var j}.</td>
</tr>
<tr>
<td>Has-Confounder</td>
<td>There exists at least one confounder (i.e., common cause) of {Var i} and {Var j}.</td>
</tr>
</tbody>
</table>
<p>Table 2: Templates for each causal relation in the hypothesis. We use {Var i} and {Var j} as placeholders for the two variables.
into their hypothesis templates in Table 2. For example, we turn the triplet ( $A$, Is-Parent, $B$ ) into " $A$ directly causes $B$ ", as in the example of Figure 2.</p>
<h1>3.7 Statistics of the Resulting Data</h1>
<p>We show the statistics of our CORR2CAUSE dataset in Table 3. Overall, our dataset contains 207,972 samples, where $18.57 \%$ of the samples have the positive label (i.e., with validity $=1$ ). The average length of the premise is 424.11 tokens, and hypothesis 10.83 tokens. We split the data into 205,734 training samples, 1,076 development and 1,162 test samples. ${ }^{2}$ Since the main purpose of the dataset is to benchmark the performance of LLMs, we prioritize the test and development sets to have a comprehensive coverage over all sizes of graphs. Specifically, we iterate through the subset of our data for each $N$, and split it entirely for only the test and development sets if the data is less than 1 K , which is the case for $N=2$ and 3 . For the other subsets that are larger, we randomly sample up to 1 K or $10 \%$ of the data, whichever is smaller, to the test and development sets. We set the cap to be 1 K in order to form a reasonable computation budget, since many LLMs are expensive to query in the inference mode. Aside from the test and valid sets, all the rest of the data goes into the training set.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: right;">Overall</th>
<th style="text-align: right;">Statistics by the Number of Nodes $N$</th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
<th style="text-align: right;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">$N=2$</td>
<td style="text-align: right;">$N=3$</td>
<td style="text-align: right;">$N=4$</td>
<td style="text-align: right;">$N=5$</td>
<td style="text-align: right;">$N=6$</td>
</tr>
<tr>
<td style="text-align: left;"># Samples</td>
<td style="text-align: right;">207,972</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">720</td>
<td style="text-align: right;">8,520</td>
<td style="text-align: right;">198,630</td>
</tr>
<tr>
<td style="text-align: left;"># Test</td>
<td style="text-align: right;">1,162</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">514</td>
<td style="text-align: right;">522</td>
</tr>
<tr>
<td style="text-align: left;"># Dev</td>
<td style="text-align: right;">1,076</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">482</td>
<td style="text-align: right;">474</td>
</tr>
<tr>
<td style="text-align: left;"># Train</td>
<td style="text-align: right;">205,734</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">576</td>
<td style="text-align: right;">7,524</td>
<td style="text-align: right;">197,634</td>
</tr>
<tr>
<td style="text-align: left;"># Tokens/Premise</td>
<td style="text-align: right;">424.11</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">52.0</td>
<td style="text-align: right;">104.0</td>
<td style="text-align: right;">212.61</td>
<td style="text-align: right;">434.54</td>
</tr>
<tr>
<td style="text-align: left;"># Tokens/Hypothesis</td>
<td style="text-align: right;">10.83</td>
<td style="text-align: right;">10.83</td>
<td style="text-align: right;">10.83</td>
<td style="text-align: right;">10.83</td>
<td style="text-align: right;">10.83</td>
<td style="text-align: right;">10.83</td>
</tr>
<tr>
<td style="text-align: left;">\% Positive Labels</td>
<td style="text-align: right;">18.57</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">7.50</td>
<td style="text-align: right;">13.01</td>
<td style="text-align: right;">18.85</td>
</tr>
<tr>
<td style="text-align: left;">Vocab Size</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">61</td>
</tr>
</tbody>
</table>
<p>Table 3: Statistics of our CORR2CAUSE dataset, and by subsets. We report the total number of samples (# Samples); splits of the test (# Test), developement (# Dev) and training sets (# Train); number of tokens per premise (# Tokens/Premise) and hypothesis (# Tokens/Hypothesis); percentage of the positive labels (\% Positive Labels), and vocabulary size by the number of unique tokens (Vocab Size). Note that the number of unique graphs and MECs are in Table 1.</p>
<h2>4 EXPERIMENTS</h2>
<h3>4.1 EXPERIMENTAL SETUP</h3>
<p>We set up a diverse list of LLMs for the experiments on our CORR2CAUSE dataset. To test existing LLMs, we first include six commonly used BERT-based NLI models in the transformers library (Wolf et al., 2020): BERT (Devlin et al., 2019), RoBERTa (Liu et al., 2019), BART (Lewis et al., 2020), DeBERTa (He et al., 2021), DistilBERT (Sanh et al., 2019), and DistilBART (Shleifer \&amp; Rush, 2020). Apart from these BERT-based NLI models, we also evaluate the general-purpose autoregressive LLMs based on GPT (Radford et al., 2019): GPT-3 Ada, Babbage, Curie, Davinci (Brown et al., 2020); its instruction-tuned versions (Ouyang et al., 2022), text-davinci-001, text-davinci-002, and text-davinci-003; and GPT-3.5 (i.e., ChatGPT), and the latest GPT-4 (OpenAI, 2023) by April 2023,</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">F1</th>
<th style="text-align: center;">Precision</th>
<th style="text-align: center;">Recall</th>
<th style="text-align: center;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Random Baselines</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Always Majority</td>
<td style="text-align: center;">0.0</td>
<td style="text-align: center;">0.0</td>
<td style="text-align: center;">0.0</td>
<td style="text-align: center;">84.77</td>
</tr>
<tr>
<td style="text-align: left;">Random (Proportional)</td>
<td style="text-align: center;">13.5</td>
<td style="text-align: center;">12.53</td>
<td style="text-align: center;">14.62</td>
<td style="text-align: center;">71.46</td>
</tr>
<tr>
<td style="text-align: left;">Random (Uniform)</td>
<td style="text-align: center;">$\underline{20.38}$</td>
<td style="text-align: center;">15.11</td>
<td style="text-align: center;">31.29</td>
<td style="text-align: center;">62.78</td>
</tr>
<tr>
<td style="text-align: left;">BERT-Based Models</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">BERT MNLI</td>
<td style="text-align: center;">2.82</td>
<td style="text-align: center;">7.23</td>
<td style="text-align: center;">1.75</td>
<td style="text-align: center;">81.61</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa MNLI</td>
<td style="text-align: center;">22.79</td>
<td style="text-align: center;">34.73</td>
<td style="text-align: center;">16.96</td>
<td style="text-align: center;">82.50</td>
</tr>
<tr>
<td style="text-align: left;">DeBERTa MNLI</td>
<td style="text-align: center;">14.52</td>
<td style="text-align: center;">14.71</td>
<td style="text-align: center;">14.33</td>
<td style="text-align: center;">74.31</td>
</tr>
<tr>
<td style="text-align: left;">DistilBERT MNLI</td>
<td style="text-align: center;">20.70</td>
<td style="text-align: center;">24.12</td>
<td style="text-align: center;">18.13</td>
<td style="text-align: center;">78.85</td>
</tr>
<tr>
<td style="text-align: left;">DistilBART MNLI</td>
<td style="text-align: center;">26.74</td>
<td style="text-align: center;">15.92</td>
<td style="text-align: center;">83.63</td>
<td style="text-align: center;">30.23</td>
</tr>
<tr>
<td style="text-align: left;">BART MNLI</td>
<td style="text-align: center;">$\underline{\mathbf{3 3 . 3 8}}$</td>
<td style="text-align: center;">31.59</td>
<td style="text-align: center;">35.38</td>
<td style="text-align: center;">78.50</td>
</tr>
<tr>
<td style="text-align: left;">LLaMa-Based Models</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">LLaMa-7B</td>
<td style="text-align: center;">26.81</td>
<td style="text-align: center;">15.50</td>
<td style="text-align: center;">99.42</td>
<td style="text-align: center;">17.36</td>
</tr>
<tr>
<td style="text-align: left;">Alpaca-7B</td>
<td style="text-align: center;">$\underline{27.37}$</td>
<td style="text-align: center;">15.93</td>
<td style="text-align: center;">97.37</td>
<td style="text-align: center;">21.33</td>
</tr>
<tr>
<td style="text-align: left;">GPT-Based Models</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Ada</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">84.77</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Babbage</td>
<td style="text-align: center;">27.45</td>
<td style="text-align: center;">15.96</td>
<td style="text-align: center;">97.95</td>
<td style="text-align: center;">21.15</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Curie</td>
<td style="text-align: center;">26.43</td>
<td style="text-align: center;">15.23</td>
<td style="text-align: center;">100.00</td>
<td style="text-align: center;">15.23</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Davinci</td>
<td style="text-align: center;">27.82</td>
<td style="text-align: center;">16.57</td>
<td style="text-align: center;">86.55</td>
<td style="text-align: center;">31.61</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Instruct (text-davinci-001)</td>
<td style="text-align: center;">17.99</td>
<td style="text-align: center;">11.84</td>
<td style="text-align: center;">37.43</td>
<td style="text-align: center;">48.04</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Instruct (text-davinci-002)</td>
<td style="text-align: center;">21.87</td>
<td style="text-align: center;">13.46</td>
<td style="text-align: center;">58.19</td>
<td style="text-align: center;">36.69</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Instruct (text-davinci-003)</td>
<td style="text-align: center;">15.72</td>
<td style="text-align: center;">13.4</td>
<td style="text-align: center;">19.01</td>
<td style="text-align: center;">68.97</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3.5</td>
<td style="text-align: center;">21.69</td>
<td style="text-align: center;">17.79</td>
<td style="text-align: center;">27.78</td>
<td style="text-align: center;">69.46</td>
</tr>
<tr>
<td style="text-align: left;">GPT-4</td>
<td style="text-align: center;">$\underline{29.08}$</td>
<td style="text-align: center;">20.92</td>
<td style="text-align: center;">47.66</td>
<td style="text-align: center;">64.60</td>
</tr>
</tbody>
</table>
<p>Table 4: Overall performance. We report F1 (main metric), precision, recall and accuracy. For the main metric, F1 score, we use the bold font to highlight the overall best performance, and underline to highlight the best performance within each category of models.
using the OpenAI API (https://openai.com/api/) with temperature 0 . We also evaluate the recent, more efficient models, LLaMa (Touvron et al., 2023) and Alpaca (Taori et al., 2023).</p>
<p>When inspecting the behavior of finetuned models, we adopt a large set of models, including GPTbased models (GPT-3 Ada, Babbage, Curie, and Davinci) using the OpenAI finetuning API for classification at https://platform.openai.com/docs/guides/fine-tuning, open-sourced decoder-only models (GPT2, GPT2-Large, GPT2-XL, LLaMA-7B, and LLaMA2-7B), BERT-based models from scratch (BERT-Base, BERT-Large, RoBERTa-Base, and RoBERTa-Large), and BERTBased NLI models (BERT-Base MNLI, BERT-Large MNLI, RoBERTa-Base MNLI, and RoBERTaLarge MNLI) using the transformers library (Wolf et al., 2020). See training details in Appendix A.</p>
<p>For the random baselines, we provide "always majority" to predict the majority class $100 \%$ of the time, "random (uniform)" to uniformly sample a label (i.e., $50 \%$ for each), and "random (proportional)" to sample a label from a Bernouli distribution proportional to the development set label distribution.</p>
<h1>4.2 The Corr2Cause Skill in Existing LLMs</h1>
<p>We show the performance of seventeen LLMs in Table 4. We can see that pure causal inference is a very challenging task across all existing LLMs. Among all the LLMs, the best performance is $33.38 \%$ F1 by BART MNLI, which is even higher than the latest GPT-based model, GPT-4. Notably, many models are worse than random guess, which means that they totally fail at this pure causal inference task. The observation still holds for few-shot chain-of-thought prompts tested in Appendix G.</p>
<h3>4.3 Finetuned Performance</h3>
<p>Next, we address the question: Can we re-purpose LLMs to learn this task? The experimental results in Table 5a of 17 models finetuned on our CORr2CAUSE seem very strong at first sight. Most models see a substantial increase, among which the finetuned BERT-based NLI models demonstrate the strongest performance. The best-performing one, RoBERTa-Large MNLI, achieves $94.74 \%$ F1 score on this task, as well as very high precision, recall and accuracy scores.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">F1</th>
<th style="text-align: center;">Precision</th>
<th style="text-align: center;">Recall</th>
<th style="text-align: center;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Finetuned GPT-Based Models Using OpenAI API</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Ada</td>
<td style="text-align: center;">79.85</td>
<td style="text-align: center;">70.47</td>
<td style="text-align: center;">92.11</td>
<td style="text-align: center;">92.92</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Babbage</td>
<td style="text-align: center;">78.19</td>
<td style="text-align: center;">69.98</td>
<td style="text-align: center;">88.60</td>
<td style="text-align: center;">92.48</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Curie</td>
<td style="text-align: center;">81.23</td>
<td style="text-align: center;">75.00</td>
<td style="text-align: center;">88.60</td>
<td style="text-align: center;">93.77</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3 Davinci</td>
<td style="text-align: center;">85.52</td>
<td style="text-align: center;">80.26</td>
<td style="text-align: center;">91.52</td>
<td style="text-align: center;">95.28</td>
</tr>
<tr>
<td style="text-align: left;">Finetuned Open-Sourced Decoder-Only Models</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">GPT2</td>
<td style="text-align: center;">89.18</td>
<td style="text-align: center;">88.03</td>
<td style="text-align: center;">90.35</td>
<td style="text-align: center;">96.66</td>
</tr>
<tr>
<td style="text-align: left;">GPT2-Large</td>
<td style="text-align: center;">94.29</td>
<td style="text-align: center;">92.18</td>
<td style="text-align: center;">96.49</td>
<td style="text-align: center;">98.22</td>
</tr>
<tr>
<td style="text-align: left;">GPT2-XL</td>
<td style="text-align: center;">94.30</td>
<td style="text-align: center;">91.94</td>
<td style="text-align: center;">96.78</td>
<td style="text-align: center;">98.22</td>
</tr>
<tr>
<td style="text-align: left;">LLaMA-7B</td>
<td style="text-align: center;">$\overline{91.98}$</td>
<td style="text-align: center;">88.62</td>
<td style="text-align: center;">95.61</td>
<td style="text-align: center;">97.46</td>
</tr>
<tr>
<td style="text-align: left;">LLaMA2-7B</td>
<td style="text-align: center;">92.92</td>
<td style="text-align: center;">90.11</td>
<td style="text-align: center;">95.91</td>
<td style="text-align: center;">97.77</td>
</tr>
<tr>
<td style="text-align: left;">Finetuned BERT-Based Models</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">BERT-Base</td>
<td style="text-align: center;">69.29</td>
<td style="text-align: center;">54.42</td>
<td style="text-align: center;">95.32</td>
<td style="text-align: center;">87.13</td>
</tr>
<tr>
<td style="text-align: left;">BERT-Large</td>
<td style="text-align: center;">85.26</td>
<td style="text-align: center;">77.51</td>
<td style="text-align: center;">94.74</td>
<td style="text-align: center;">95.01</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa-Base</td>
<td style="text-align: center;">87.60</td>
<td style="text-align: center;">78.47</td>
<td style="text-align: center;">99.12</td>
<td style="text-align: center;">95.73</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa-Large</td>
<td style="text-align: center;">89.10</td>
<td style="text-align: center;">82.54</td>
<td style="text-align: center;">96.78</td>
<td style="text-align: center;">96.39</td>
</tr>
<tr>
<td style="text-align: left;">Finetuned BERT-Based NLI Models</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">BERT-Base MNLI</td>
<td style="text-align: center;">89.88</td>
<td style="text-align: center;">85.49</td>
<td style="text-align: center;">94.74</td>
<td style="text-align: center;">86.51</td>
</tr>
<tr>
<td style="text-align: left;">BERT-Large MNLI</td>
<td style="text-align: center;">90.19</td>
<td style="text-align: center;">84.44</td>
<td style="text-align: center;">96.78</td>
<td style="text-align: center;">96.79</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa-Base MNLI</td>
<td style="text-align: center;">94.27</td>
<td style="text-align: center;">90.35</td>
<td style="text-align: center;">98.54</td>
<td style="text-align: center;">98.17</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa-Large MNLI</td>
<td style="text-align: center;">$\underline{94.74}$</td>
<td style="text-align: center;">92.24</td>
<td style="text-align: center;">97.37</td>
<td style="text-align: center;">98.35</td>
</tr>
</tbody>
</table>
<p>(a) Performance of finetuned models on the original test set.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">F1 (Paraph.)</th>
<th style="text-align: left;">F1 (Var. Ref.)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">61.73</td>
<td style="text-align: left;">41.57</td>
</tr>
<tr>
<td style="text-align: left;">62.34</td>
<td style="text-align: left;">43.28</td>
</tr>
<tr>
<td style="text-align: left;">64.93</td>
<td style="text-align: left;">45.32</td>
</tr>
<tr>
<td style="text-align: left;">65.01</td>
<td style="text-align: left;">46.96</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align: left;">56.76</th>
<th style="text-align: left;">31.70</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">55.95</td>
<td style="text-align: left;">31.99</td>
</tr>
<tr>
<td style="text-align: left;">60.32</td>
<td style="text-align: left;">43.95</td>
</tr>
<tr>
<td style="text-align: left;">56.41</td>
<td style="text-align: left;">53.92</td>
</tr>
<tr>
<td style="text-align: left;">52.24</td>
<td style="text-align: left;">49.47</td>
</tr>
</tbody>
</table>
<p>61.13
63.64
65.58
65.05
35.20
58.54
53.12
60.20</p>
<table>
<thead>
<tr>
<th style="text-align: left;">65.56</th>
<th style="text-align: left;">31.50</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">67.24</td>
<td style="text-align: left;">52.04</td>
</tr>
<tr>
<td style="text-align: left;">57.42</td>
<td style="text-align: left;">62.83</td>
</tr>
<tr>
<td style="text-align: left;">55.45</td>
<td style="text-align: left;">67.87</td>
</tr>
</tbody>
</table>
<p>(b) F1 scores of finetuned models on the perturbed test sets by paraphrasing (Paraph.) and variable refactorization (Var. Ref.).</p>
<p>Table 5: Performance of finetuned models on the original test set and perturbed test sets.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Relation Type</th>
<th style="text-align: right;">F1</th>
<th style="text-align: right;">Precision</th>
<th style="text-align: right;">Recall</th>
<th style="text-align: right;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Is-Parent</td>
<td style="text-align: right;">96.18</td>
<td style="text-align: right;">95.45</td>
<td style="text-align: right;">96.92</td>
<td style="text-align: right;">98.67</td>
</tr>
<tr>
<td style="text-align: left;">Is-Ancestor</td>
<td style="text-align: right;">93.94</td>
<td style="text-align: right;">93.94</td>
<td style="text-align: right;">93.94</td>
<td style="text-align: right;">98.93</td>
</tr>
<tr>
<td style="text-align: left;">Is-Child</td>
<td style="text-align: right;">95.73</td>
<td style="text-align: right;">94.92</td>
<td style="text-align: right;">96.56</td>
<td style="text-align: right;">98.67</td>
</tr>
<tr>
<td style="text-align: left;">Is-Descendant</td>
<td style="text-align: right;">96.55</td>
<td style="text-align: right;">93.33</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">99.47</td>
</tr>
<tr>
<td style="text-align: left;">Has-Collider</td>
<td style="text-align: right;">92.19</td>
<td style="text-align: right;">87.41</td>
<td style="text-align: right;">97.52</td>
<td style="text-align: right;">94.64</td>
</tr>
<tr>
<td style="text-align: left;">Has-Confounder</td>
<td style="text-align: right;">98.67</td>
<td style="text-align: right;">97.37</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">99.73</td>
</tr>
</tbody>
</table>
<p>(a) Fine-grained performance of RoBERTa-Large by causal relation type on the original test set.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">F1</th>
<th style="text-align: center;">Precision</th>
<th style="text-align: center;">Recall</th>
<th style="text-align: center;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">74.80</td>
<td style="text-align: center;">79.31</td>
<td style="text-align: center;">70.77</td>
<td style="text-align: center;">91.73</td>
</tr>
<tr>
<td style="text-align: left;">45.45</td>
<td style="text-align: center;">90.91</td>
<td style="text-align: center;">30.30</td>
<td style="text-align: center;">93.60</td>
</tr>
<tr>
<td style="text-align: left;">73.39</td>
<td style="text-align: center;">78.43</td>
<td style="text-align: center;">68.97</td>
<td style="text-align: center;">92.27</td>
</tr>
<tr>
<td style="text-align: left;">29.41</td>
<td style="text-align: center;">83.33</td>
<td style="text-align: center;">17.86</td>
<td style="text-align: center;">93.60</td>
</tr>
<tr>
<td style="text-align: left;">70.70</td>
<td style="text-align: center;">75.00</td>
<td style="text-align: center;">66.90</td>
<td style="text-align: center;">82.04</td>
</tr>
<tr>
<td style="text-align: left;">70.42</td>
<td style="text-align: center;">73.53</td>
<td style="text-align: center;">67.57</td>
<td style="text-align: center;">94.37</td>
</tr>
</tbody>
</table>
<p>(b) Its fine-grained performance by relation type after variable refactorization.</p>
<p>Table 6: Fine-grained analysis of the best-performing model, RoBERTa-Large MNLI.</p>
<h1>4.4 Fine-Grained Performance by Causal Relation</h1>
<p>In addition to the overall results mentioned above, we conduct a fine-grained analysis to check the performance of the strongest finetuned model, RoBERTa-Large MNLI, by our six causal relation types. As in Table 6a, the model is very good at judging relations such as Is-Parent, Is-Descendant and Has-Confounder, all with more than $96 \%$ F1 scores, whereas it is several points weaker on the Has-Collider relations. This could be due to that the collider relation is the most special type, requiring identification of the V-structure based on both the unconditional independence based on the two variables only and correlations whenever conditioned on a common descendant. We also conduct error analysis for non-finetuned models in Appendix F.</p>
<h3>4.5 Robustness Analysis</h3>
<p>Looking at the very high performance of the finetuned models, we raise the next question: Did the models really robustly learn the causal inference skills?</p>
<p>Two Robustness Tests We design two simple robustness tests: (1) paraphrasing, and (2) variable refactorization. For (1) paraphrasing, we simply paraphrase the hypothesis by changing the text template for each causal relation to some semantically-equivalent alternatives in Appendix C. For (2) variable refactorization, we reverse the alphabet of the variable names, namely flipping A, B, C, to Z, $\mathrm{Y}, \mathrm{X}$ and so on. The inspiration behind the two robustness tests comes from the spurious correlation analysis described in Appendix E.</p>
<p>Specifically, we adopt the common setup of text adversarial attack (Morris et al., 2020; Jin et al., 2020) to preserve the training set and keep the same saved models, but run the inference on the perturbed test set. In this way, we separate the possibilities of the models only overfitting on the training data vs. mastering the reasoning skills.</p>
<p>Results after Perturbation We can see from Table 5b that all the models drop drastically, by up to 39.29 on the paraphrased test set, and up to 62.30 after variable refactorization. The best-performing model, RoBERTa-Large MNLI, is especially sensitive towards paraphrasing, demonstrating the most drop among all models; however, it is the most robust against the variable refactorization, maintaining a high F1 score of 67.87. We conduct fine-grained analysis for RoBERTa-Large MNLI under perturbation in Table 6b. We can see the the main source of the performance drop of the model comes from the two classes, Is-Ancestor (decreasing to $45.45 \%$ ) and Is-Descendant (decreasing to $29.41 \%$ ), while the other classes stay relatively robust, keeping their F1 scores over $70 \%$.</p>
<p>From this analysis, we make the following suggestions to future studies testing this CORR2CAUSE skill of LLMs. First, it is safe to use it as a test set to benchmark existing LLMs' performance, since the data we generate is out-of-distribution from the training data of the current LLMs. Then, when testing finetuned models, it is very important to accompany adversarial attack together with the i.i.d. test set. We open-source our perturbed test sets for future work to test the generalizability skill.</p>
<h1>4.6 Extension to Natural Stories</h1>
<p>We envision our CORR2CAUSE dataset to be a foundation for future extensions to various settings, such as instantiating the variables with actual phenomena and situating the story in a more natural setting. For example, the correlation does not imply causation rule can be instantiated with the ice cream sales and swimming pool attendance as the two variables, and argue that ice cream sales does not necessarily affect swimming pool attendance, because their correlation could be due to a third variable, such as hot weather. We provide a case study for how to instantiate the symbolic expressions in our dataset to more natural stories, and find that LLMs such as GPT-4 can generate realistic, daily life stories that has foreseeably broad applications. See more details in Appendix B.</p>
<h2>5 Related Work</h2>
<p>Existing Causal Reasoning Tasks A large body of existing research of causal reasoning in NLP focuses on leveraging empirical knowledge to do tasks such as inferring the cause and effect of why an agent perform certain tasks (Sap et al., 2019a), the motivation and emotional reaction in a social context (Sap et al., 2019b), how people achieve a given goal with a set of concrete steps (Zhang et al., 2020), the development of a story given a different beginning (Qin et al., 2019), and how in general LLMs serve as a knowledge base of cause and effect (Willig et al., 2023; Kcman et al., 2023). In contrast, our CORR2CAUSE task focuses on the pure causal inference skill of models, which is a knowledge-dependent reasoning skill based on formally correct rules from causal inference.</p>
<p>Existing Logical and Inference Tasks Another related area of literature is logical and inference tasks, of which a well-established one is natural language inference (NLI), to identify the semantic relationship between a pair of sentences (MacCartney \&amp; Manning, 2008; Bowman et al., 2015). NLI datasets mainly focus on the set and paraphrase relations. For example, "a group of boys are playing football" can entail "some guys are playing football," where "boys" are a sub-concept of "guys," and "a group of" and "some" are paraphrases. Recently, there have been increasing efforts to extend the inference task to various logical inference skills such as deductive logic and propaganda techniques (Jin et al., 2022; Alhindi et al., 2022). Our CORR2CAUSE dataset is the first dataset testing the correlation-to-causation inference skill, which is unique of its type.</p>
<h2>6 CONCLUSION</h2>
<p>In this work, we introduced a novel task, CORR2CAUSE, to infer causation from correlation, and collected a large-scale dataset of over 200K samples. We evaluated an extensive list of LLMs on this new task, and showed that off-the-shelf LLMs perform poorly on this task. We also show that it is possible to re-purpose LLMs on this task by finetuning, but future work needs to be aware of the out-of-distribution generalization problem. To avoid the Goodhart's law, we recommend using this dataset to benchmark the pure causal inference skills for LLMs that have not seen this dataset. Given the limited reasoning abilities of current LLMs, and the difficulty of separating actual reasoning from training-corpus-derived knowledge, it is imperative that our community focus on work aiming to accurately disentangle and measure both abilities. We believe the present work is a first such step.</p>
<h1>LIMITATIONS AND Future Work</h1>
<p>We identify several limitations of this work and open future directions: First, in the context of this work, we limit the causal graphs to two to six nodes, but future work can feel free to explore larger graphs. Another aspect is that we do not assume hidden confounders in this inference problem, so we welcome future work to generate an even more challenging dataset to infer the existence of hidden confounders, analogous to the causal discovery algorithm of fast causal inference (FCI) (Spirtes et al., 2000). And also in general, explorations of other causal discovery algorithms are welcomed too. Finally, a lot of motivation behind proposing this task is inspired by the problem of invalid reasoning patterns in our daily reasoning (Jin et al., 2022), which could fertilize the ground for more pervasive spread of fake news. We believe false causal inference is a prevalent type of fallacious beliefs, and welcome future work to connect the idea of this benchmark to more real-world false beliefs based on confusing correlation with causation.</p>
<h2>ACKNOWLEDGMENT</h2>
<p>We thank Riley Goodside for valuable suggestions to improve our prompts to LLMs. We thank Luigi Gresele and Amir Hossein Karimi for their suggestions to help us improve the formulation of our causal discovery questions.</p>
<p>This material is based in part upon work supported by the German Federal Ministry of Education and Research (BMBF): Tbingen AI Center, FKZ: 01IS18039B; by the Machine Learning Cluster of Excellence, EXC number 2064/1 - Project number 390727645; by a National Science Foundation award (#2306372); by a Swiss National Science Foundation award (#201009) and a Responsible AI grant by the Haslerstiftung. Zhijing Jin is supported by PhD fellowships from the Future of Life Institute and Open Philanthropy. We also thank OpenAI for granting Zhijing quota to their API of GPT series through the Researcher Access Program.</p>
<h2>REFERENCES</h2>
<p>Tariq Alhindi, Tuhin Chakrabarty, Elena Musi, and Smaranda Muresan. Multitask instruction-based prompting for fallacy recognition. In Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing, pp. 8172-8187, Abu Dhabi, United Arab Emirates, December 2022. Association for Computational Linguistics. URL https://aclanthology.org/ 2022.emnlp-main. 560.9</p>
<p>Chandra Bhagavatula, Ronan Le Bras, Chaitanya Malaviya, Keisuke Sakaguchi, Ari Holtzman, Hannah Rashkin, Doug Downey, Wen-tau Yih, and Yejin Choi. Abductive commonsense reasoning. In 8th International Conference on Learning Representations, ICLR 2020, Addis Ababa, Ethiopia, April 26-30, 2020. OpenReview.net, 2020. URL https://openreview.net/forum?id= Byg1v1HKDB. 1</p>
<p>Samuel R. Bowman, Gabor Angeli, Christopher Potts, and Christopher D. Manning. A large annotated corpus for learning natural language inference. In Proceedings of the 2015 Conference on Empirical Methods in Natural Language Processing, pp. 632-642, Lisbon, Portugal, September 2015. Association for Computational Linguistics. doi: 10.18653/v1/D15-1075. URL https: //aclanthology.org/D15-1075. 9</p>
<p>Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel Ziegler, Jeffrey Wu, Clemens Winter, Chris Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei. Language models are few-shot learners. In H. Larochelle, M. Ranzato, R. Hadsell, M. F. Balcan, and H. Lin (eds.), Advances in Neural Information Processing Systems, volume 33, pp. 1877-1901. Curran Associates, Inc., 2020. URL https://proceedings.neurips. cc/paper/2020/file/1457c0d6bfcb4967418bfb8ac142f64a-Paper.pdf. 6</p>
<p>David Maxwell Chickering. Optimal structure identification with greedy search. J. Mach. Learn. Res., 3:507-554, 2002. URL http://jmlr.org/papers/v3/chickering02b.html. 3</p>
<p>Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. BERT: Pre-training of deep bidirectional transformers for language understanding. In Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers), pp. 4171-4186, Minneapolis, Minnesota, June 2019. Association for Computational Linguistics. doi: 10.18653/v1/N19-1423. URL https: //aclanthology.org/N19-1423. 1, 6</p>
<p>Clark Glymour, Kun Zhang, and Peter Spirtes. Review of causal discovery methods based on graphical models. Frontiers in Genetics, 10:524, 2019. ISSN 1664-8021. doi: 10.3389/fgene.2019. 00524. URL https://www.frontiersin.org/article/10.3389/fgene.2019. 00524. 2,3</p>
<p>Madelyn Glymour, Judea Pearl, and Nicholas P Jewell. Causal inference in statistics: A primer. John Wiley and Sons, 2016. 2, 3</p>
<p>Andrew Gordon, Zornitsa Kozareva, and Melissa Roemmele. SemEval-2012 task 7: Choice of plausible alternatives: An evaluation of commonsense causal reasoning. In *SEM 2012: The First Joint Conference on Lexical and Computational Semantics - Volume 1: Proceedings of the main conference and the shared task, and Volume 2: Proceedings of the Sixth International Workshop on Semantic Evaluation (SemEval 2012), pp. 394-398, Montral, Canada, 7-8 June 2012. Association for Computational Linguistics. URL https://aclanthology.org/S12-1052. 1</p>
<p>Pengcheng He, Xiaodong Liu, Jianfeng Gao, and Weizhu Chen. Deberta: Decoding-enhanced Bert with disentangled attention. In 9th International Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021. OpenReview.net, 2021. URL https:// openreview.net/forum?id=XPZIaotutsD. 6</p>
<p>Patrik O. Hoyer, Dominik Janzing, Joris M. Mooij, Jonas Peters, and Bernhard Schlkopf. Nonlinear causal discovery with additive noise models. In Daphne Koller, Dale Schuurmans, Yoshua Bengio, and Lon Bottou (eds.), Advances in Neural Information Processing Systems 21, Proceedings of the Twenty-Second Annual Conference on Neural Information Processing Systems, Vancouver, British Columbia, Canada, December 8-11, 2008, pp. 689-696. Curran Associates, Inc., 2008. URL https://proceedings.neurips.cc/paper/2008/hash/ f7664060cc52bc6f3d620bcedc94a4b6-Abstract.html. 3</p>
<p>Di Jin, Zhijing Jin, Joey Tianyi Zhou, and Peter Szolovits. Is BERT really robust? A strong baseline for natural language attack on text classification and entailment. In The Thirty-Fourth AAAI Conference on Artificial Intelligence, AAAI 2020, The Thirty-Second Innovative Applications of Artificial Intelligence Conference, IAAI 2020, The Tenth AAAI Symposium on Educational Advances in Artificial Intelligence, EAAI 2020, New York, NY, USA, February 7-12, 2020, pp. 80188025. AAAI Press, 2020. URL https://aaai.org/ojs/index.php/AAAI/article/ view/6311. 9</p>
<p>Zhijing Jin, Abhinav Lalwani, Tejas Vaidhya, Xiaoyu Shen, Yiwen Ding, Zhiheng Lyu, Mrinmaya Sachan, Rada Mihalcea, and Bernhard Schlkopf. Logical fallacy detection. In Findings of the Association for Computational Linguistics: EMNLP 2022, pp. 7180, -7198, Abu Dhabi, United Arab Emirates, December 2022. Association for Computational Linguistics. URL https://arxiv.org/abs/2202.13758. 9, 10</p>
<p>Emre Kcman, Robert Ness, Amit Sharma, and Chenhao Tan. Causal reasoning and large language models: Opening a new frontier for causality. arXiv preprint arXiv:2305.00050, 2023. 1, 9</p>
<p>Mike Lewis, Yinhan Liu, Naman Goyal, Marjan Ghazvininejad, Abdelrahman Mohamed, Omer Levy, Veselin Stoyanov, and Luke Zettlemoyer. BART: Denoising sequence-to-sequence pre-training for natural language generation, translation, and comprehension. In Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics, pp. 7871-7880, Online, July 2020. Association for Computational Linguistics. doi: 10.18653/v1/2020.acl-main.703. URL https://aclanthology.org/2020.acl-main.703. 6</p>
<p>Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov. RoBERTa: A robustly optimized BERT pretraining approach. CoRR, abs/1907.11692, 2019. URL http://arxiv.org/abs/1907.11692. 6</p>
<p>Bill MacCartney and Christopher D. Manning. Modeling semantic containment and exclusion in natural language inference. In Proceedings of the 22nd International Conference on Computational Linguistics (Coling 2008), pp. 521-528, Manchester, UK, August 2008. Coling 2008 Organizing Committee. URL https://aclanthology.org/C08-1066. 9</p>
<p>Brendan D. McKay and Adolfo Piperno. Practical graph isomorphism, II. J. Symb. Comput., 60: 94-112, 2014. doi: 10.1016/j.jsc.2013.09.003. URL https://doi.org/10.1016/j.jsc. 2013.09.003. 5</p>
<p>John Morris, Eli Lifland, Jin Yong Yoo, Jake Grigsby, Di Jin, and Yanjun Qi. TextAttack: A framework for adversarial attacks, data augmentation, and adversarial training in NLP. In Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing: System Demonstrations, pp. 119-126, Online, October 2020. Association for Computational Linguistics. doi: 10.18653/v1/ 2020.emnlp-demos.16. URL https://aclanthology.org/2020.emnlp-demos.16. 9</p>
<p>OpenAI. GPT-4 technical report. CoRR, abs/2303.08774, 2023. doi: 10.48550/arXiv.2303.08774. URL https://doi.org/10.48550/arXiv.2303.08774. 1, 6</p>
<p>Long Ouyang, Jeff Wu, Xu Jiang, Diogo Almeida, Carroll L. Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda Askell, Peter Welinder, Paul F. Christiano, Jan Leike, and Ryan Lowe. Training language models to follow instructions with human feedback. CoRR, abs/2203.02155, 2022. doi: 10.48550/arXiv.2203.02155. URL https://doi.org/10. 48550/arXiv.2203.02155. 1, 6</p>
<p>Judea Pearl. Probabilistic reasoning in intelligent systems: Networks of plausible inference. Morgan Kaufmann, 1988. 3</p>
<p>Judea Pearl. Causality: Models, reasoning and inference (2nd ed.). Cambridge University Press, 2009. 1</p>
<p>Jonas Peters, Dominik Janzing, and Bernhard Schlkopf. Elements of causal inference: Foundations and learning algorithms. The MIT Press, 2017. URL https://mitpress.mit.edu/ books/elements-causal-inference. 1</p>
<p>Lianhui Qin, Antoine Bosselut, Ari Holtzman, Chandra Bhagavatula, Elizabeth Clark, and Yejin Choi. Counterfactual story reasoning and generation. In Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP), pp. 5043-5053, Hong Kong, China, November 2019. Association for Computational Linguistics. doi: 10.18653/v1/D19-1509. URL https: //aclanthology.org/D19-1509. 1, 9</p>
<p>Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, and Ilya Sutskever. Language models are unsupervised multitask learners. OpenAI Blog, 1(8), 2019. 1, 6</p>
<p>Victor Sanh, Lysandre Debut, Julien Chaumond, and Thomas Wolf. DistilBERT, a distilled version of BERT: Smaller, faster, cheaper and lighter. CoRR, abs/1910.01108, 2019. URL http: //arxiv.org/abs/1910.01108. 6</p>
<p>Maarten Sap, Ronan Le Bras, Emily Allaway, Chandra Bhagavatula, Nicholas Lourie, Hannah Rashkin, Brendan Roof, Noah A. Smith, and Yejin Choi. ATOMIC: an atlas of machine commonsense for if-then reasoning. In The Thirty-Third AAAI Conference on Artificial Intelligence, AAAI 2019, The Thirty-First Innovative Applications of Artificial Intelligence Conference, IAAI 2019, The Ninth AAAI Symposium on Educational Advances in Artificial Intelligence, EAAI 2019, Honolulu, Hawaii, USA, January 27 - February 1, 2019, pp. 3027-3035. AAAI Press, 2019a. doi: 10.1609/aaai.v33i01.33013027. URL https://doi.org/10.1609/aaai.v33i01. 33013027. 1, 9</p>
<p>Maarten Sap, Hannah Rashkin, Derek Chen, Ronan Le Bras, and Yejin Choi. Social iqa: Commonsense reasoning about social interactions. In EMNLP 2019, 2019b. 1, 9</p>
<p>Shohei Shimizu, Patrik O. Hoyer, Aapo Hyvrinen, and Antti J. Kerminen. A linear non-gaussian acyclic model for causal discovery. J. Mach. Learn. Res., 7:2003-2030, 2006. URL http: //jmlr.org/papers/v7/shimizu06a.html. 3</p>
<p>Sam Shleifer and Alexander M. Rush. Pre-trained summarization distillation. CoRR, abs/2010.13002, 2020. URL https://arxiv.org/abs/2010.13002. 6</p>
<p>Peter Spirtes and Kun Zhang. Causal discovery and inference: Concepts and recent methodological advances. In Applied informatics, volume 3, pp. 1-28. SpringerOpen, 2016. 2, 3</p>
<p>Peter Spirtes, Clark Glymour, and Richard Scheines. Causation, prediction, and search. 1993. 2, 3
Peter Spirtes, Clark Glymour, and Richard Scheines. Causation, Prediction, and Search, Second Edition. Adaptive computation and machine learning. MIT Press, 2000. ISBN 978-0-262-19440-2. $1,2,3,10$</p>
<p>Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos Guestrin, Percy Liang, and Tatsunori B. Hashimoto. Stanford alpaca: An instruction-following llama model. https://github.com/tatsu-lab/stanford_alpaca, 2023. 7</p>
<p>Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothe Lacroix, Baptiste Rozire, Naman Goyal, Eric Hambro, Faisal Azhar, Aurlien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume Lample. Llama: Open and efficient foundation language models. CoRR, abs/2302.13971, 2023. doi: 10.48550/arXiv.2302.13971. URL https://doi . org/10.48550/arXiv.2302.13971. 7</p>
<p>Ruibo Tu, Chao Ma, and Cheng Zhang. Causal-discovery performance of chatgpt in the context of neuropathic pain diagnosis. arXiv preprint arXiv:2301.13819, 2023. 1</p>
<p>Moritz Willig, Matej Zeevi, Devendra Singh Dhami, and Kristian Kersting. Probing for correlations of causal facts: Large language models and causality, 2023. URL https://openreview. net/forum?id=UPwzqPOs4-. 9</p>
<p>Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, Remi Louf, Morgan Funtowicz, Joe Davison, Sam Shleifer, Patrick von Platen, Clara Ma, Yacine Jernite, Julien Plu, Canwen Xu, Teven Le Scao, Sylvain Gugger, Mariama Drame, Quentin Lhoest, and Alexander Rush. Transformers: State-of-the-art natural language processing. In Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing: System Demonstrations, pp. 38-45, Online, October 2020. Association for Computational Linguistics. doi: 10.18653/v1/2020.emnlp-demos.6. URL https://aclanthology.org/2020.emnlp-demos.6. 6, 7, 14</p>
<p>Yuxi Xie, Guanzhen Li, and Min-Yen Kan. Echo: Event causality inference via human-centric reasoning. arXiv preprint arXiv:2305.14740, 2023. 1</p>
<p>Matej Zeevi, Moritz Willig, Devendra Singh Dhami, and Kristian Kersting. Causal parrots: Large language models may talk causality but are not causal. arXiv preprint arXiv:2308.13067, 2023. 1</p>
<p>Kun Zhang and Aapo Hyvrinen. Causality discovery with additive disturbances: An informationtheoretical perspective. In Machine Learning and Knowledge Discovery in Databases: European Conference, ECML PKDD 2009, Bled, Slovenia, September 7-11, 2009, Proceedings, Part II 20, pp. 570-585. Springer, 2009. 3</p>
<p>Li Zhang, Qing Lyu, and Chris Callison-Burch. Reasoning about goals, steps, and temporal ordering with WikiHow. In Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP), pp. 4630-4639, Online, November 2020. Association for Computational Linguistics. doi: 10.18653/v1/2020.emnlp-main.374. URL https://aclanthology.org/ 2020.emnlp-main. 374.9</p>
<p>Susan Zhang, Stephen Roller, Naman Goyal, Mikel Artetxe, Moya Chen, Shuohui Chen, Christopher Dewan, Mona T. Diab, Xian Li, Xi Victoria Lin, Todor Mihaylov, Myle Ott, Sam Shleifer, Kurt Shuster, Daniel Simig, Punit Singh Koura, Anjali Sridhar, Tianlu Wang, and Luke Zettlemoyer. OPT: open pre-trained transformer language models. CoRR, abs/2205.01068, 2022. doi: 10.48550/ arXiv.2205.01068. URL https://doi.org/10.48550/arXiv.2205.01068. 1</p>
<h1>A IMPLEMENTATION DETAILS</h1>
<p>When finetuning on our data, for GPT-based models, we use the default settings of the OpenAI finetuning API; and for BERT-based models, we use the transformers library (Wolf et al., 2020) and train the models on a server with an NVIDIA Tesla A100 GPU with 40G of memory. To fit for the GPU memory, we set the batch size to be 8 . We use the validation set to tune the learning rate, which takes value in ${2 \mathrm{e}-6,5 \mathrm{e}-6,1 \mathrm{e}-5,2 \mathrm{e}-5,5 \mathrm{e}-5}$; dropout rate, which takes value in ${0,0.1,0.2$, $0.3}$; and weight decay, which takes value in ${1 \mathrm{e}-4,1 \mathrm{e}-5}$. We train the models until convergence, which is usually around ten epochs.</p>
<p>Prompts When querying the autoregressive LLMs, we formulate the prompt as follows:
Question: [premise]
Can we deduct the following: [hypothesis]? Just answer "Yes" or "No."
Answer:</p>
<h2>B Generating Natural Stories</h2>
<p>To generate the natural stories based on our symbolic expressions, we utilize the state-of-the-art LLM, GPT-4, which is very good at story generation. We design detailed instructions in the prompt, and generate around 200 stories in our case study. We show two examples stories in Table 7, and the report the overall statistics in Table 8.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">Example 1 (Label=Negative)</th>
<th style="text-align: center;">Example 2 (Label=Positive)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Symbolic Form</td>
<td style="text-align: center;">Premise: Suppose there is a closed system of 2 variables, A and B. All the statistical relations among these 2 variables are as follows: A correlates with B. Hypothesis: A directly affects B. Relation between the promise and hypothesis: The premise does not a necessary condition for the hypothesis.</td>
<td style="text-align: center;">Premise: Suppose there is a closed system of 3 variables, A, B and C. All the statistical relations among these 3 variables are as follows: A correlates with C. B correlates with C. However, A is independent of B. Hypothesis: A directly affects C. <br> Relation between the promise and hypothesis: The premise is a necessary condition for the hypothesis. So if the premise is true, the hypothesis must be true.</td>
</tr>
<tr>
<td style="text-align: center;">Natural Story</td>
<td style="text-align: center;">Premise: Suppose there is a closed system of 2 variables, ice cream sales and swimming pool attendance. All the statistical relations among these 2 variables are as follows: ice cream sales correlate with swimming pool attendance. <br> Hypothesis: Ice cream sales directly affect swimming pool attendance. <br> Relation between the premise and hypothesis: The premise does not provide a necessary condition for the hypothesis. The correlation between ice cream sales and swimming pool attendance could be due to a third variable, such as hot weather, which increases both ice cream sales and swimming pool attendance. Therefore, it is not necessarily true that ice cream sales directly affect swimming pool attendance.</td>
<td style="text-align: center;">Premise: Let's consider three factors: eating junk food (A), obesity (C), and watching television (B). There is a correlation between eating junk food and obesity, and between watching television and obesity. However, eating junk food and watching television are independent from each other. Hypothesis: Eating junk food directly affects obesity. <br> Relation between the premise and hypothesis: The premise provides the necessary conditions for the hypothesis. It establishes the independent variables A (eating junk food) and B (watching television) and their correlations with obesity. Given that these are true, it supports the hypothesis that eating junk food directly affects obesity.</td>
</tr>
</tbody>
</table>
<p>Table 7: Examples of natural stories generated based on the symbolic form in our CORR2CAUSE dataset, showing the broad application value of our dataset as the starting point for various verbalizations of the correlation-to-causation inference task.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Test Set Size</th>
<th style="text-align: right;">102</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Dev Set Size</td>
<td style="text-align: right;">102</td>
</tr>
<tr>
<td style="text-align: left;"># Tokens/Premise</td>
<td style="text-align: right;">64.88</td>
</tr>
<tr>
<td style="text-align: left;"># Tokens/Hypothesis</td>
<td style="text-align: right;">13.54</td>
</tr>
<tr>
<td style="text-align: left;"># Tokens/Explanation</td>
<td style="text-align: right;">64.66</td>
</tr>
<tr>
<td style="text-align: left;">\% Positive Labels</td>
<td style="text-align: right;">1.67</td>
</tr>
</tbody>
</table>
<p>Table 8: Statistics of our generated natural stories. We report the number of samples in the test and development sets; number of tokens per premise (# Tokens/Premise), hypothesis (# Tokens/Hypothesis), and explanation (# Tokens/Explanation); and percentage of the positive labels (\% Positive Labels).</p>
<p>For more information, the exact prompt we use is "Here is a causal inference rule: [symbolic form] Please provide a real-world example instantiating this phenomenon. Format it also as "Premise:", "Hypothesis:", and "Relation between the promise and hypothesis:":"</p>
<h1>C TEMPLATES AND PARAPHRASES</h1>
<p>We use the verbalization templates in Table 9 to compose the hypotheses for all six causal relations.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Causal Relation</th>
<th style="text-align: center;">Hypothesis Template</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Is-Parent</td>
<td style="text-align: center;">{Var i} directly causes {Var j}.</td>
</tr>
<tr>
<td style="text-align: center;">Is-Ancestor</td>
<td style="text-align: center;">{Var i} causes something else which causes {Var j}.</td>
</tr>
<tr>
<td style="text-align: center;">Is-Child</td>
<td style="text-align: center;">{Var j} directly causes {Var i}.</td>
</tr>
<tr>
<td style="text-align: center;">Is-Descendant</td>
<td style="text-align: center;">{Var j} is a cause for {Var i}, but not a direct one.</td>
</tr>
<tr>
<td style="text-align: center;">Has-Collider</td>
<td style="text-align: center;">There exists at least one collider (i.e., common effect) of {Var i} and {Var j}.</td>
</tr>
<tr>
<td style="text-align: center;">Has-Confounder</td>
<td style="text-align: center;">There exists at least one confounder (i.e., common cause) of {Var i} and {Var j}.</td>
</tr>
<tr>
<td style="text-align: center;">Paraphrases</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">Is-Parent</td>
<td style="text-align: center;">{Var i} directly affects {Var j}.</td>
</tr>
<tr>
<td style="text-align: center;">Is-Ancestor</td>
<td style="text-align: center;">{Var i} influences {Var j} through some mediator(s).</td>
</tr>
<tr>
<td style="text-align: center;">Is-Child</td>
<td style="text-align: center;">{Var j} directly affects {Var i}.</td>
</tr>
<tr>
<td style="text-align: center;">Is-Descendant</td>
<td style="text-align: center;">{Var j} influences {Var i} through some mediator(s).</td>
</tr>
<tr>
<td style="text-align: center;">Has-Collider</td>
<td style="text-align: center;">{Var i} and {Var j} together cause some other variable(s).</td>
</tr>
<tr>
<td style="text-align: center;">Has-Confounder</td>
<td style="text-align: center;">Some variable(s) cause(s) both {Var i} and {Var j}.</td>
</tr>
</tbody>
</table>
<p>Table 9: Templates and their paraphrases for each causal relation in the hypothesis. We use {Var i} and {Var j} as placeholders for the two variables.</p>
<h2>D Change Log for the Dataset Version Update</h2>
<table>
<thead>
<tr>
<th style="text-align: center;">Two Equivalent Forms</th>
<th style="text-align: center;">Duplication Property</th>
<th style="text-align: center;">De-Duplication Method</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">$\left{\begin{array}{l} \text { Is-Parent( } i, j) \ \text { Is-Child( } j, i) \end{array}\right.$</td>
<td style="text-align: center;">Two exact same strings</td>
<td style="text-align: center;">Keep only one, by forcing $i&lt;j$</td>
</tr>
<tr>
<td style="text-align: center;">$\left{\begin{array}{l} \text { Is-Ancestor( } i, j \text { ) (Original) } \ \text { Is-Descendent( } j, i \text { ) (Original) } \end{array}\right.$</td>
<td style="text-align: center;">Two different strings, but semantically equivalent</td>
<td style="text-align: center;">Randomly sample one out of the two</td>
</tr>
<tr>
<td style="text-align: center;">$\left{\begin{array}{l} \text { Is-Ancestor( } i, j \text { ) (Paraphrased) } \ \text { Is-Descendent( } j, i \text { ) (Paraphrased) } \end{array}\right.$</td>
<td style="text-align: center;">Two exact same strings</td>
<td style="text-align: center;">Keep only one, by forcing $i&lt;j$</td>
</tr>
<tr>
<td style="text-align: center;">$\left{\begin{array}{l} \text { Has-Collider( } i, j) \ \text { Has-Collider( } j, i) \end{array}\right.$</td>
<td style="text-align: center;">Two different strings, but semantically equivalent</td>
<td style="text-align: center;">Randomly sample one out of the two</td>
</tr>
<tr>
<td style="text-align: center;">$\left{\begin{array}{l} \text { Has-Confounder( } i, j) \ \text { Has-Confounder( } j, i \text { ) } \end{array}\right.$</td>
<td style="text-align: center;">Two different strings, but semantically equivalent</td>
<td style="text-align: center;">Randomly sample one out of the two</td>
</tr>
</tbody>
</table>
<p>Table 10: De-duplication methods for the six causal relation types and their verbalizations.</p>
<p>De-Duplication Strategy As mentioned in Section 3.7 in the main paper, our original dataset (v1.0) has duplication due to symmetric relations and verbalizations. We introduce in Table 10 several reasons for why duplicated hypotheses exist in our original data. One typical reason is symmetric relations such as Is-Parent(A, B) and Is-Child(B, A), and, similarly, the paraphrased version of</p>
<p>Is-Ancestor( $\mathrm{A}, \mathrm{B})$ and Is-Descendent(B, A). Another typical reason is the semantic equivalence in the verbalization templates, which applies to the Has-Collider and Has-Confounder relations. For example, the verbalized texts of Has-Collider(A, B) and Collider(B, A) are "There exists at least one collider (i.e., common effect) of ${\mathrm{A}$ and $\mathrm{B}, \mathrm{B}$ and A$}$," respectively, which are semantically-equivalent paraphrases of each other, so we randomly keep one out of the two.</p>
<h1>Resulting Dataset Statistics after De-Duplication</h1>
<p>Since the reason for duplication in the first place is due to symmetry in the causal relation, or verbalization, the resulting new data, CORR2CAUSE v2.0, is exactly a half of the original data. As we reported previously in Table 3 of Section 3.7, the total number of samples cuts down to half, while the label distribution and all other properties are the same. To compose each split, we apply the same de-duplication method for the test, train, and development sets. We notice that some duplicates are across the splits, so we prioritize keeping the test and training sets untouched (to minimally affect the experimental results), and then reduce the development set by removing the cross-split duplicates, namely:</p>
<ul>
<li>test_2.0 = deduplicate(test_1.0)</li>
<li>train_2.0 = deduplicate(train_1.0)</li>
<li>dev_2.0 = deduplicate(dev_1.0) $\backslash{$ test_2.0, train_2.0}</li>
</ul>
<p>We expect minimal or almost no change to the experimental results. In case of the slight possibility that this change in the development set might affect the model selection in the training process, future work can feel free to re-train the models and update the exact performance number.</p>
<h2>E Spurious Correlation Analysis</h2>
<p>The inspirations of our two robustness tests (paraphrasing and variable refactorization) come from our data analysis. We check for spurious correlations in the data by reporting in Table 11 the point-wise mutual information (PMI) between the label and any n-gram with no more than four tokens. In addition, we also report the difference of the PMI with the two labels in the [Diff] column of Table 11, and report the top 10 n-grams.</p>
<p>The design spirit for our robustness test is that if the models' correct judgment relies on exploiting these spurious correlations, then such reliance will be broken in our perturbations.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">N-Gram</th>
<th style="text-align: center;">PMI w/ Non-Ent. Label</th>
<th style="text-align: center;">PMI w/ Ent. Label</th>
<th style="text-align: center;">[Diff]</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">a cause</td>
<td style="text-align: center;">1.692209</td>
<td style="text-align: center;">-1.025611</td>
<td style="text-align: center;">2.717820</td>
</tr>
<tr>
<td style="text-align: left;">a cause for</td>
<td style="text-align: center;">1.663640</td>
<td style="text-align: center;">-0.983790</td>
<td style="text-align: center;">2.647430</td>
</tr>
<tr>
<td style="text-align: left;">A causes</td>
<td style="text-align: center;">1.640679</td>
<td style="text-align: center;">-0.951610</td>
<td style="text-align: center;">2.592289</td>
</tr>
<tr>
<td style="text-align: left;">A causes something</td>
<td style="text-align: center;">1.621820</td>
<td style="text-align: center;">-0.926075</td>
<td style="text-align: center;">2.547895</td>
</tr>
<tr>
<td style="text-align: left;">a direct</td>
<td style="text-align: center;">1.606052</td>
<td style="text-align: center;">-0.905316</td>
<td style="text-align: center;">2.511369</td>
</tr>
<tr>
<td style="text-align: left;">a direct one</td>
<td style="text-align: center;">1.592673</td>
<td style="text-align: center;">-0.888107</td>
<td style="text-align: center;">2.480781</td>
</tr>
<tr>
<td style="text-align: left;">for D</td>
<td style="text-align: center;">1.584826</td>
<td style="text-align: center;">-0.878180</td>
<td style="text-align: center;">2.463006</td>
</tr>
<tr>
<td style="text-align: left;">for D but</td>
<td style="text-align: center;">1.583897</td>
<td style="text-align: center;">-0.877014</td>
<td style="text-align: center;">2.460911</td>
</tr>
<tr>
<td style="text-align: left;">for E</td>
<td style="text-align: center;">1.582980</td>
<td style="text-align: center;">-0.875864</td>
<td style="text-align: center;">2.458844</td>
</tr>
<tr>
<td style="text-align: left;">for E but</td>
<td style="text-align: center;">1.582074</td>
<td style="text-align: center;">-0.874728</td>
<td style="text-align: center;">2.456802</td>
</tr>
</tbody>
</table>
<p>Table 11: PMI between the labels and n-grams. The labels include non-entailment (Non-Ent.) and entailment (Ent.). And the n-grams include all with no more than four words. The [Diff] column shows the absolute value of the difference between the PMIs with two labels. We show the top 10 n-grams with the largest differences of their PMIs with the two classes in the [Diff] column.</p>
<p>We can see that some spurious correlations are rooted in the framing of the hypothesis, such as "a cause (for)", and "a direct (one)" (which we use the paraphrasing task to break), and others are connected to the variable names, such as "for D (but)" and "for E (but)" (which we use the variable refactorization to break).</p>
<h2>F Fine-Grained Error Analysis</h2>
<p>In addition to the fine-grained analysis by causal relation type in Table 6a for fine-tuned models, we also report such error analysis for non-finetuned models in Table 12.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Selected Models</th>
<th style="text-align: left;">Relation Type</th>
<th style="text-align: right;">F1</th>
<th style="text-align: right;">Precision</th>
<th style="text-align: right;">Recall</th>
<th style="text-align: right;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">GPT-3.5</td>
<td style="text-align: left;">All</td>
<td style="text-align: right;">21.69</td>
<td style="text-align: right;">17.79</td>
<td style="text-align: right;">27.78</td>
<td style="text-align: right;">69.46</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3.5</td>
<td style="text-align: left;">Is-Parent</td>
<td style="text-align: right;">8.82</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">4.62</td>
<td style="text-align: right;">83.47</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3.5</td>
<td style="text-align: left;">Is-Ancestor</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">90.67</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3.5</td>
<td style="text-align: left;">Is-Child</td>
<td style="text-align: right;">9.84</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">5.17</td>
<td style="text-align: right;">85.33</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3.5</td>
<td style="text-align: left;">Is-Descendant</td>
<td style="text-align: right;">14.29</td>
<td style="text-align: right;">11.9</td>
<td style="text-align: right;">17.86</td>
<td style="text-align: right;">84</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3.5</td>
<td style="text-align: left;">Has-Collider</td>
<td style="text-align: right;">34.24</td>
<td style="text-align: right;">25.51</td>
<td style="text-align: right;">52.07</td>
<td style="text-align: right;">35.12</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3.5</td>
<td style="text-align: left;">Has-Confounder</td>
<td style="text-align: right;">15.33</td>
<td style="text-align: right;">8.86</td>
<td style="text-align: right;">56.76</td>
<td style="text-align: right;">37.8</td>
</tr>
<tr>
<td style="text-align: left;">GPT-4</td>
<td style="text-align: left;">All</td>
<td style="text-align: right;">29.08</td>
<td style="text-align: right;">20.92</td>
<td style="text-align: right;">47.66</td>
<td style="text-align: right;">64.6</td>
</tr>
<tr>
<td style="text-align: left;">GPT-4</td>
<td style="text-align: left;">Is-Parent</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">82.67</td>
</tr>
<tr>
<td style="text-align: left;">GPT-4</td>
<td style="text-align: left;">Is-Ancestor</td>
<td style="text-align: right;">30.77</td>
<td style="text-align: right;">31.25</td>
<td style="text-align: right;">30.3</td>
<td style="text-align: right;">88</td>
</tr>
<tr>
<td style="text-align: left;">GPT-4</td>
<td style="text-align: left;">Is-Child</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">84.53</td>
</tr>
<tr>
<td style="text-align: left;">GPT-4</td>
<td style="text-align: left;">Is-Descendant</td>
<td style="text-align: right;">26.98</td>
<td style="text-align: right;">17.35</td>
<td style="text-align: right;">60.71</td>
<td style="text-align: right;">75.47</td>
</tr>
<tr>
<td style="text-align: left;">GPT-4</td>
<td style="text-align: left;">Has-Collider</td>
<td style="text-align: right;">44.1</td>
<td style="text-align: right;">30.18</td>
<td style="text-align: right;">81.82</td>
<td style="text-align: right;">32.71</td>
</tr>
<tr>
<td style="text-align: left;">GPT-4</td>
<td style="text-align: left;">Has-Confounder</td>
<td style="text-align: right;">20.67</td>
<td style="text-align: right;">11.53</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">23.86</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa MNLI</td>
<td style="text-align: left;">All</td>
<td style="text-align: right;">22.79</td>
<td style="text-align: right;">34.73</td>
<td style="text-align: right;">16.96</td>
<td style="text-align: right;">82.5</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa MNLI</td>
<td style="text-align: left;">Is-Parent</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">82.67</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa MNLI</td>
<td style="text-align: left;">Is-Ancestor</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">91.2</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa MNLI</td>
<td style="text-align: left;">Is-Child</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">84.53</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa MNLI</td>
<td style="text-align: left;">Is-Descendant</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">92.53</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa MNLI</td>
<td style="text-align: left;">Has-Collider</td>
<td style="text-align: right;">43.45</td>
<td style="text-align: right;">39.73</td>
<td style="text-align: right;">47.93</td>
<td style="text-align: right;">59.52</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa MNLI</td>
<td style="text-align: left;">Has-Confounder</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">84.45</td>
</tr>
</tbody>
</table>
<p>Table 12: Fine-grained evaluation results for some selected non-fine-tuned models.</p>
<p>These results are particularly revealing, showing how off-the-shelf models perform in recognizing specific relations. Specifically, GPT-3.5 cannot recognize ancestor relations, whereas GPT-4 fails at all direct causation recognition with parents and children. And RoBERTa MNLI only did collider relation relatively correctly. Note that, when the F1 score is zero, the accuracy number is a result of always predicting the negative class of that relation.</p>
<h1>G LLM PERFORMANCE OPTIMIZATION</h1>
<p>Since our experiments in Section 4.2 are based on plain, zero-shot prompts, we explore whether better prompting strategies could improve the performance. We enhance the query prompt by incorporating several strategies: (1) Utilizing a system prompt that specifies the model's expertise ("You are a highly intelligent question-answering bot with profound knowledge of causal inference."); (2) Including a pair of few-shot examples, one positive and one negative; (3) Implementing chain-of-thought prompting with "Let's think step by step." to encourage the language model to generate step-by-step reasoning. In Table 13, we present the evaluation results on the relatively affordable model, GPT-3.5, where the optimized prompt leads to a 4-point improvement in F1 over the original performance. However, we can see that despite the deployment of all three strategies, the model continues to struggle with this challenging task.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">F1</th>
<th style="text-align: center;">Precision</th>
<th style="text-align: center;">Recall</th>
<th style="text-align: center;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">GPT-3.5 (plain query; original)</td>
<td style="text-align: center;">21.69</td>
<td style="text-align: center;">17.79</td>
<td style="text-align: center;">27.78</td>
<td style="text-align: center;">69.46</td>
</tr>
<tr>
<td style="text-align: left;">GPT-3.5 (enhanced query)</td>
<td style="text-align: center;">25.44</td>
<td style="text-align: center;">17.29</td>
<td style="text-align: center;">48.11</td>
<td style="text-align: center;">52.01</td>
</tr>
</tbody>
</table>
<p>Table 13: Performance of GPT-3.5 with different queries. We quote the original performance from Table 4.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{2}$ Note for our dataset v2.0: We notice that our original data (v1.0) has duplication due to symmetric relations and verbalizations of the hypothesis. E.g., Is-Parent(A, B) has the exact hypothesis verbalization as Is-Child(B, A). Hence, for our data v2.0, we perform a careful de-duplication, and update the data statistics in Table 3. See more version comparison details in Appendix D. Note that, due to the symmetry, the current version is a random sample half of the size of the original version, so the modeling results in the experiment section roughly hold.&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>