<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-4506 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-4506</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-4506</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-99.html">extraction-schema-99</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of methods, systems, or approaches that use LLMs (or other AI models) to extract, distill, or discover quantitative laws, patterns, relationships, or principles from scientific papers or scholarly literature.</div>
                <p><strong>Paper ID:</strong> paper-bfd2b76998a0521c12903ef5ced517adf70ad2ba</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/bfd2b76998a0521c12903ef5ced517adf70ad2ba" target="_blank">HyenaDNA: Long-Range Genomic Sequence Modeling at Single Nucleotide Resolution</a></p>
                <p><strong>Paper Venue:</strong> Neural Information Processing Systems</p>
                <p><strong>Paper TL;DR:</strong> This work presents HyenaDNA, a genomic foundation model pretrained on the human reference genome with context lengths of up to 1 million tokens at the single nucleotide-level, an up to 500x increase over previous dense attention-based models.</p>
                <p><strong>Paper Abstract:</strong> Genomic (DNA) sequences encode an enormous amount of information for gene regulation and protein synthesis. Similar to natural language models, researchers have proposed foundation models in genomics to learn generalizable features from unlabeled genome data that can then be fine-tuned for downstream tasks such as identifying regulatory elements. Due to the quadratic scaling of attention, previous Transformer-based genomic models have used 512 to 4k tokens as context (<0.001% of the human genome), significantly limiting the modeling of long-range interactions in DNA. In addition, these methods rely on tokenizers to aggregate meaningful DNA units, losing single nucleotide resolution where subtle genetic variations can completely alter protein function via single nucleotide polymorphisms (SNPs). Recently, Hyena, a large language model based on implicit convolutions was shown to match attention in quality while allowing longer context lengths and lower time complexity. Leveraging Hyenas new long-range capabilities, we present HyenaDNA, a genomic foundation model pretrained on the human reference genome with context lengths of up to 1 million tokens at the single nucleotide-level, an up to 500x increase over previous dense attention-based models. HyenaDNA scales sub-quadratically in sequence length (training up to 160x faster than Transformer), uses single nucleotide tokens, and has full global context at each layer. We explore what longer context enables - including the first use of in-context learning in genomics for simple adaptation to novel tasks without updating pretrained model weights. On fine-tuned benchmarks from the Nucleotide Transformer, HyenaDNA reaches state-of-the-art (SotA) on 12 of 17 datasets using a model with orders of magnitude less parameters and pretraining data. On the GenomicBenchmarks, HyenaDNA surpasses SotA on all 8 datasets on average by +9 accuracy points.</p>
                <p><strong>Cost:</strong> 0.006</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <p class="empty-note">No extracted data.</p>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <p class="empty-note">No potentially relevant new papers extracted.</p>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-4506",
    "paper_id": "paper-bfd2b76998a0521c12903ef5ced517adf70ad2ba",
    "extraction_schema_id": "extraction-schema-99",
    "extracted_data": [],
    "potentially_relevant_new_papers": [],
    "cost": 0.00572975,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>HyenaDNA: Long-Range Genomic Sequence Modeling at Single Nucleotide Resolution</h1>
<p>Eric Nguyen ${ }^{<em> , 1}$, Michael Poli ${ }^{</em>}, 1$, Marjan Faizi ${ }^{2, *}$, Armin W. Thomas ${ }^{1}$, Callum Birch Sykes ${ }^{3}$, Michael Wornow ${ }^{1}$, Aman Patel ${ }^{1}$, Clayton Rabideau ${ }^{3}$, Stefano Massaroli ${ }^{4}$, Yoshua Bengio ${ }^{4}$, Stefano Ermon ${ }^{1}$, Stephen A. Baccus ${ }^{1, \dagger}$, Christopher Ré ${ }^{1, \dagger}$</p>
<p>November 15, 2023</p>
<h4>Abstract</h4>
<p>Genomic (DNA) sequences encode an enormous amount of information for gene regulation, protein synthesis, and numerous other cellular properties. Similar to natural language models, researchers have proposed foundation models in genomics to learn generalizable features from unlabeled genome data that can then be fine-tuned for downstream tasks such as identifying regulatory elements. Due to the quadratic scaling of attention, previous Transformer-based genomic models have used 512 to 4 k tokens as context ( $&lt;0.001 \%$ of the human genome), significantly limiting the modeling of long-range interactions in DNA. In addition, these methods rely on tokenizers or fixed k-mers to aggregate meaningful DNA units, losing single nucleotide resolution (i.e. DNA "characters") where subtle genetic variations can completely alter protein function via single nucleotide polymorphisms (SNPs). Recently, Hyena, a large language model based on implicit convolutions was shown to match attention in quality while allowing longer context lengths and lower time complexity. Leveraging Hyena's new long-range capabilities, we present HyenaDNA, a genomic foundation model pretrained on the human reference genome with context lengths of up to 1 million tokens at the single nucleotide-level - an up to 500x increase over previous dense attention-based models. HyenaDNA scales sub-quadratically in sequence length (training up to 160x faster than Transformer), uses single nucleotide tokens, and has full global context at each layer. We explore what longer context enables - including the first use of in-context learning in genomics for simple adaptation to novel tasks without updating pretrained model weights. On a long-range species classification task, HyenaDNA is able to effectively solve the challenge by increasing the context length to 1 M without downsampling. On fine-tuned benchmarks from the Nucleotide Transformer, HyenaDNA reaches state-of-the-art (SotA) on 12 of 18 datasets using a model with orders of magnitude less parameters and pretraining data. ${ }^{1}$ On the GenomicBenchmarks, HyenaDNA surpasses SotA on 7 of 8 datasets on average by +10 accuracy points, and by as much as +20 accuracy points on enhancer identification. Code available at https://github.com/HazyResearch/hyena-dna.</p>
<h2>1 Introduction</h2>
<p>Understanding and learning from DNA sequences has long been a goal of biologists and deep learning researchers, as its "language" encodes instructions essential for all living things (ENCODE Project Consortium, 2020). The mapping from DNA instructions, genotypes, to observable function and traits, phenotypes, remains on-going research effort. Towards this goal, researchers have proposed using foundation models (FMs) in genomics to learn generalizable features from unstructured whole genome data that can then be fine-tuned for a number of tasks including predicting the location and function of genes, identifying regulatory elements, and analyzing the evolution of species (Ji et al., 2021; Dalla-Torre et al., 2023; Gankin et al., 2023; Benegas</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p><img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1.1: HyenaDNA recipe for long-range foundation models in genomics. The HyenaDNA architecture is a simple stack of Hyena operators (Poli et al., 2023) trained using next token prediction. (See Fig. 1.3 for block diagram of architecture). We introduce a new sequence length scheduling technique to stabilize training, and provide a method to leverage the longer context length to adapt to novel tasks without standard fine-tuning by filling the context window with learnable soft prompt tokens.
et al., 2022; Yang et al., 2022; Zvyagin et al., 2022). In contrast to protein sequences, which have had successes in protein language models (Lin et al., 2022; Madani et al., 2023; Meier et al., 2021; Ferruz et al., 2022; Brandes et al., 2022; Rao et al., 2020; Elnaggar et al., 2021), DNA sequences are orders of magnitudes longer (e.g. the human genome is 3.2 B nucleotides) with long-range dependencies and interactions that span over $100 \mathrm{k}+$ nucleotides in length (Avsec et al., 2021). Overcoming the long-range limitations of current generation models could help drive the next wave of innovations in AI-powered drug discovery and therapeutics, and enable genomic FMs to understand and learn in-context whole patient genomes in a personalized way.</p>
<p>Limitations of current models Previous genomic FM approaches have relied on attentionbased Transformers (Ji et al., 2021; Dalla-Torre et al., 2023; Yang et al., 2022; Zvyagin et al., 2022), but face a number of challenges unique to DNA sequences. The attention mechanism scales quadratically in sequence length, with current genomic FMs pretraining on only 512 to 4,096 tokens as context (Ji et al., 2021; Zvyagin et al., 2022; DallaTorre et al., 2023; Zaheer et al., 2020), $&lt;0.001 \%$ of the human genome. Also prevalent is the reliance on fixed k-mers, akin to DNA "words", and tokenizers to aggregate meaningful DNA units. However, single nucleotide alterations represent physical analogs where, for example, single nucleotide polymorphisms (SNPs) and mutations can have a profound impact on biological properties including regulatory activity (Nasser et al., 2021). In contrast, natural language semantics can often be conserved when single character or word changes occur over very long contexts. Therefore, having both long-range context and single nucleotide resolution simultaneously is critical, and remains a particular challenge in genomics.</p>
<p>Toward longer context models Recently, Hyena (Poli et al., 2023), a large language model based on implicit convolutions, was shown to match attention in quality while reducing computational time complexity,</p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 1.3: HyenaDNA block architecture. A Hyena operator is composed of long convolutions and elementwise gate layers. The gates are fed projections of the input using dense layers and short convolutions. The long convolutions are parameterized implicitly via an MLP that produces the convolutional filters. The convolution itself is evaluated using a Fast Fourier Transform convolution with time complexity $\mathcal{O}\left(L \log _{2} L\right)$.
thereby allowing a longer context to be processed. Hyena uses a parameter-efficient global convolutional filter along with a data-controlled gating mechanism, which enables a context-specific operation over every token. Indeed, Hyena showed that for simple associative recall tasks using synthetic data, a shallow 2 layer model could effectively process context lengths at 131 k tokens. We hypothesize that Hyena's core operations can unlock the potential to capture both the long-range and single nucleotide resolution of real genomic sequences over attention-based approaches. To test this, we explore two questions: (i.) Can a convolutional long-context model be used effectively at single nucleotide resolution? (ii.) What new capabilities could long-context genomic foundations models enable?</p>
<p>HyenaDNA The result of our investigation is HyenaDNA, a genomic FM pretrained on the human reference genome at context lengths up to 1 million tokens at single nucleotide resolution - an up to 500x increase over existing genomic FMs using dense-attention. HyenaDNA scales sub-quadratically in sequence length (training up to 160x faster than attention at sequence length 1M), uses single nucleotide tokens, and has a global receptive field at each layer. Our contributions include a "full-stack" recipe for building genomic FMs, including architecture design, a warm-up schedule to speed up training on ultralong sequences, and an efficient downstream adaptation procedure based on soft prompting and in-context learning.</p>
<p>Full-stack genomics modeling We start with a decoder-only Hyena architecture pretrained using next nucleotide (token) prediction. We forego standard aggregating tokenizers, using a single-character tokenizer and a minimal DNA vocabulary of 4 nucleotides (plus special tokens). Training stability becomes an issue at ultralong sequences ( $200 \mathrm{k}+$ ). To overcome this issue, we introduce a sequence length warm-up scheduler that gradually increases sequence length in stages. At sequence length 450 k , training time is reduced by $40 \%$, while boosting accuracy by 7.5 accuracy points on a species classification task. Furthermore, we design downstream adaptation procedures to leverage longer context windows, as simpler and more flexible alternatives to standard fine-tuning in genomics. This includes a novel soft prompt technique where learnable tokens (up to 32 k ) are injected directly into the input sequence itself, enabling competitive downstream results without the need to update a pretrained model.</p>
<p>Genomic downstream tasks We apply our pretrained HyenaDNA models to 29 diverse downstream genomic tasks to showcase its long-range ability as well as fine-grain resolution. On fine-tuned benchmarks</p>
<p>from the Nucleotide Transformer (Dalla-Torre et al., 2023), HyenaDNA achieves state-of-the-art (SotA) on 12 of 18 datasets while using a model with orders of magnitude less parameters and pretraining data (see Tab. 4.2). On the GenomicBenchmarks (Gresova et al., 2022), HyenaDNA surpasses SotA on 7 of 8 datasets on average by +10 accuracy points, and by as much as +20 accuracy points on enhancer function identification. On a novel species classification task, HyenaDNA effectively solves the challenge by increasing the context length to 1 million tokens. In a challenging chromatin profile experiment, a 919-way multi-task, HyenaDNA performs competitively against a larger SotA sparse-attention BigBird Transformer (Zaheer et al., 2020). Finally, we analyze the learned embeddings of a pretrained HyenaDNA model by clustering sequences by biotype (gene or transcription type) and compare the results with existing genomic FMs, showing that HyenaDNA can serve as an effective universal featurizer in genomics.</p>
<h1>2 Preliminaries and Related Work</h1>
<h3>2.1 Transformers and Attention</h3>
<p>Powering many recent foundation models is the attention mechanism. Given a length- $L$ sequence $x \in \mathbb{R}^{L \times D}$, a (single-headed) layer of scaled self-attention (Bahdanau et al., 2014; Vaswani et al., 2017) is a map from $\mathbb{R}^{L \times D}$ to $\mathbb{R}^{L \times D}$ which performs the following operations:</p>
<p>$$
\mathrm{A}(x)=\sigma\left(x \mathrm{~W}<em k="k">{q} \mathrm{~W}</em>
$$}^{\top} x^{\top}\right), \quad y=\mathrm{A}(x) x \mathrm{~W}_{v</p>
<p>where $D$ is the embedding dimension, $\mathrm{W}<em k="k">{q}, \mathrm{~W}</em>\right)$ in sequence length. This allows a global context at high resolution, but limits the size of the context on current hardware.}, \mathrm{~W}_{v} \in \mathbb{R}^{D \times D}$ are learnable linear maps and $\sigma$ indicated rowwise softmax (and optional scaling). Attention computes all pair-wise comparison for every token, and scales as $\mathcal{O}\left(L^{2</p>
<p>Previous methods to reduce the quadratic cost of attention have used specialized methods to approximate full dense attention (Fournier et al., 2021). In sparse attention, elements attend only to a subset of all other positions. Alternatively, linear attention methods construct approximations to $\mathrm{A}(u)$ that can be evaluated in subquadratic time. Both of these classes of methods, however, trade lower time complexity (allowing longer sequences) for loss in expressivity.</p>
<h3>2.2 Long Context Strategies in Genomics</h3>
<p>To achieve longer context, genomic models have relied on two strategies: i. tokenization and ii. dilation and downsampling. Tokenization is a necessary step in masked language modeling (MLM) with bidirectional Transformer architectures (BERT) (Devlin et al., 2018), a common model in genomics. These tokenizers use fixed k-mers (short overlapping sequences of length k ) or frequency-based byte pair encoding (BPE), that attempt to aggregate DNA into meaningful units (Ji et al., 2021; Zaheer et al., 2020). Consequently, these aggregation techniques create large new vocabularies (compared to the natural vocabulary of 4 nucleotides) that are less generalizable (Tay et al., 2021). The second strategy uses dilated convolutions and downsampling, both of which essentially average or skip elements between weights (Fournier et al., 2021). A canonical example is the Enformer, which uses dilation and downsampling to reach context lengths of 100 k nucleotides to predict gene expression tracks (Avsec et al., 2021). Common across tokenization, dilation, and downsampling is the sacrifice of single nucleotide resolution to reach longer context.</p>
<h3>2.3 Large Convolutional Models</h3>
<p>A discrete convolution between an input $x$ of length $L$ and a (learnable) filter $h$ is given by:</p>
<p>$$
y_{t}=(h * x)<em t_prime="t^{\prime">{t}=\sum</em> x
$$}=0}^{L-1} h_{t-t^{\prime}} x_{t^{\prime}} \quad \text { or equivalently } \quad y=\mathrm{T</p>
<p>where $\mathrm{T} \in \mathbb{R}^{L \times L}$ is the Toeplitz matrix corresponding to the convolution. Historically, convolutions have played an important role in deep learning and more broadly signal processing. More recently, it has been</p>
<p>shown that by stacking $k$ long convolution layers, where $k$ is parametrized through a function $\gamma_{\theta}$ i.e. $k:=$ $\gamma_{\theta}(L)$, one can achieve state-of-the-art performance on a variety of benchmarks involving long sequences, for example the Long Range Arena (LRA) (Tay et al., 2020; Gu et al., 2021; Smith et al., 2022; Fu et al., 2023). Different $\gamma_{\theta}$ have been proposed in the literature: state-space models (Gu et al., 2021; Fu et al., 2023), and implicit parametrizations via neural fields (Romero et al., 2021b,a; Poli et al., 2023). On language, the H-family of implicit convolution language models, H3 and Hyena, (Dao et al., 2022b; Poli et al., 2023) used long convolutions and gating to match Transformer performance in $\mathcal{O}\left(L \log _{2} L\right)$ time, notably lower than the $\mathcal{O}\left(L^{2}\right)$ of attention-based models.</p>
<p>HyenaDNA takes inspiration from these approaches, showing that attention-free, long-context causal models can achieve high performance on downstream genomic tasks. These extended long-range capabilities enable us to explore new paradigms in genomics, such as in-context learning to easily adapt to new tasks without updating pretrained models.</p>
<h1>3 HyenaDNA Long-Range Genomic Foundation Models</h1>
<p>In this section, we introduce the HyenaDNA approach to long-range genomic sequence modeling. We start with a description of the model architecture, then discuss sequence length warm-up and soft prompting techniques for downstream adaptation.</p>
<h3>3.1 The HyenaDNA Model</h3>
<p>The HyenaDNA model is a decoder-only, sequence-to-sequence architecture defined by a stack of blocks consisting of a Hyena operator (Poli et al., 2023), followed by a feed-forward neural network (see Fig. 1.3).</p>
<p>Given an input $x \in \mathbb{R}^{L}$ ( $L$ denotes sequence length), a Hyena ${ }^{2}$ operator can be defined as:</p>
<p>$$
\begin{aligned}
&amp; \left(x_{1}, x_{2}, v\right) \mapsto \mathrm{H}\left(x_{1}, x_{2}\right) v \
&amp; \mathrm{H}\left(x_{1}, x_{2}\right)=\mathrm{D}<em 2="2">{x</em>}} \mathrm{~T<em x__1="x_{1">{h} \mathrm{D}</em>
\end{aligned}
$$}</p>
<p>where $x_{1}, x_{2}, v$ are projections of the input, and $\mathrm{T}<em h="h">{h} \in$ $\mathbb{R}^{L \times L}$ is the Toeplitz matrix constructed from a learnable long convolution filter produced as the output of a neural network, $\left(\mathrm{T}</em>\right)<em i-j="i-j">{i j}=h</em>}$. The convolution filter values themselves are obtained through a small neural network $\gamma_{\theta}$ taking as input the time (position) index and optionally positional encodings, $h_{t}=\gamma_{\theta}(t)$, which enable the operator to process very long sequences without growing linearly in the number of parameters. Further, the matrices $\mathrm{D<em 1="1">{x</em>}}, \mathrm{D<em 2="2">{x</em>$ on the diagonals, and evaluated as element-wise gating. The projections are obtained by applying a dense linear layer and short convolution to the input sequence, as shown in Figure 3.1.
Proposition 3.1. A Hyena operator can be evaluated in $\mathcal{O}\left(L \log }} \in \mathbb{R}^{L \times L}$ are constructed with $x_{1}, x_{2<em x__1="x_{1">{2} L\right)$ time.
Efficient evaluation is crucial on settings involving extremely long sequences such as genomics. In the general case where the embedding dimension $D&gt;1$ and $x \in \mathbb{R}^{L \times D}$, the linear projections $\mathrm{W}</em>}}, \mathrm{~W<em 2="2">{x</em>$ are right multiplied to $x$, and $D$ independent Hyena operators are then applied to each dimension.}}, \mathrm{~W}_{v} \in$ $\mathbb{R}^{D \times D</p>
<h3>3.2 Training Long Sequence Models</h3>
<p>Tokenization The subquadratic cost of HyenaDNA in sequence length allows the model to process ultralong sequences directly at the single nucleotide level without the need for frequency-based aggregation tokenizers. This enables fine-grain resolution for both short and long sequences, critical for detecting single nucleotide polymorphisms or mutations and modeling long-range dependencies in gene expression.</p>
<p>We use the natural DNA vocabulary and refer to each nucleotide as a token. The tokens include "A", "G", "C", "T", and "N" (a non-specific nucleotide) and special character tokens for padding, separation, and unknown characters. Tokens are mapped to embedding dimension $D$.</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>Sequence length warm-up for ultralong sequences Directly training on long sequences can affect training stability as the variance in gradient increases (Li et al., 2022). Training on shorter sequences initially (followed by longer sequences) was used by (Press et al., 2020) to train small scale Transformers and reduce training time, while (Li et al., 2022) used sequence length warm-up to address stability on up to 2 k tokens. For ultralong sequences ( $200 \mathrm{k}+$ ), we develop a new warm-up schedule that gradually increases the sequence length in stages to improve both stability and decrease training time.</p>
<p>Our sequence length schedule starts at $L_{1}=64$, then doubles the window at each stage while keeping the global batch size constant. By doing so, iterations at each consecutive stage will include more tokens, ensuring the scheduler can also act as a form of batch size warmup. In Fig. 3.2, we observe sequence length scheduling to be particularly important at sequence lengths greater than 450 k , where at this length training time is reduced by $40 \%$ and improving ultimate accuracy by $7.5 \%$ points for a species classification task described later in section 4.4.3.</p>
<h1>3.3 Downstream Adaptation</h1>
<p>Tuneable prompting for long-context models Prompts have been traditionally used to guide the output of a FM (Liu et al., 2023) by prepending additional context to an input. Expanding on this approach, soft tuneable prompting was introduced to inject learnable tokens (as weights) into the input directly (Lester et al., 2021) as an alternative to model fine-tuning.</p>
<p>With an extended context length $(L)$, we're able to explore new paradigms in adapting FMs after pretraining. Given a downstream task with prompts $x_{p} \in \mathbb{R}^{T}$ and corresponding labels $y_{p}$, we prepend $N \leq L-T$ trainable parameters $\theta$ of dimension $D$ after the embedding step:</p>
<p>$$
x \leftarrow \operatorname{concat}\left[\operatorname{embed}\left(x_{p}\right), \theta\right], \quad x \in \mathbb{R}^{L \times(T+N)}
$$</p>
<p>The resulting sequences $x$ are then processed by the model, and $\theta$ is optimized on a loss function involving the input sequence's label $y_{p}$. Crucially, soft prompting requires utilization of a small subset of prompt and label pairs to optimize $\theta$.</p>
<p>During soft prompting, HyenaDNA only optimizes the parameters of the prompt in the input sequence while keeping all other model parameters fixed. Soft prompting thereby provides a flexible and computationally efficient approach to adapting genomic FMs to new downstream tasks.</p>
<h2>4 Experiments</h2>
<p>In 4.1, we start with pretraining HyenaDNA on the human reference genome (Genome Reference Consortium, 2013). We then evaluate HyenaDNA on existing short-range ( $&lt;5 \mathrm{k}$ nucleotides) downstream benchmarks in 4.2 to assess the performance of single nucleotide resolution. In 4.3, we explore what new capabilities emerge with longer range genomic modeling in the form of in-context learning. Finally, we push the limits of ultralong context performance in 4.4.</p>
<h3>4.1 Pretraining on the Human Genome</h3>
<p>We pretrain HyenaDNA on the human reference genome (Genome Reference Consortium, 2013) using next nucleotide (token) prediction. Starting with a stack of decoder-only Transformer blocks, we swap attention for the Hyena operator, and compare against a baseline Transformer (GPT) with Flash Attention (Dao et al., 2022a). We add gradient checkpointing to HyenaDNA to decrease the memory footprint by 3 x on</p>
<p>longer sequences ( $&gt;160 \mathrm{k}$ ). We then scale HyenaDNA along dimensions of model depth ( 2 to 8 layers), width (128 to 256 dimensions), and sequence length (1024 to 1M). At sequence length 1M, HyenaDNA is 160x faster than its Transformer counterpart as shown in Fig. 4.1.</p>
<p>As shown in Fig. 1.2, we observe that as context length increases, perplexity improves during pretraining. However, this improvement comes at the expense of more training time and tokens. For models too shallow to effectively process longer context, perplexity can begin to degrade (increase), observing inflection points with longer sequences. In this way, increasing context can serve as a novel regularization dimension. For genomic pretraining, we provide the following guidelines. 1. In optimizing for faster training time, shorter context enable lower perplexity to be reached faster. 2. In optimizing for best overall perplexity, longer context allows for lower perplexity at the cost of training on more tokens. See A. 1 for experiment details.</p>
<h3>4.2 Single Nucleotide Resolution</h3>
<p>Our first downstream tasks use short-range genomic sequences $(&lt;5 \mathrm{k})$ aimed at evaluating single nucleotide resolution performance on sequence-level classification using standard fine-tuning.</p>
<p>GenomicBenchmarks We start with the newly released Ge nomicBenchmarks (Gresova et al., 2022), which is comprised of 8 regulatory element classification datasets with sequence lengths of 200-500, and one up to 4,776 . The original baseline model uses a short-range CNN. We fine-tune the pretrained Transformer (GPT) and HyenaDNA from 4.1, both having single nucleotide resolution, as well as the DNABERT model (Ji et al., 2021). HyenaDNA sets a new</p>
<p>Table 4.1: GenomicBenchmarks Top-1 accuracy (\%) for pretrained HyenaDNA, DNABERT and Transformer (GPT from 4.1), and the previous SotA baseline CNN (scratch).</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Dataset</th>
<th style="text-align: center;">CNN</th>
<th style="text-align: center;">DNABERT</th>
<th style="text-align: center;">GPT</th>
<th style="text-align: center;">HyenaDNA</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Mouse Enhancers</td>
<td style="text-align: center;">69.0</td>
<td style="text-align: center;">66.9</td>
<td style="text-align: center;">80.1</td>
<td style="text-align: center;">$\mathbf{8 5 . 1}$</td>
</tr>
<tr>
<td style="text-align: left;">Coding vs Intergenomic</td>
<td style="text-align: center;">87.6</td>
<td style="text-align: center;">$\mathbf{9 2 . 5}$</td>
<td style="text-align: center;">88.8</td>
<td style="text-align: center;">91.3</td>
</tr>
<tr>
<td style="text-align: left;">Human vs Worm</td>
<td style="text-align: center;">93.0</td>
<td style="text-align: center;">96.5</td>
<td style="text-align: center;">95.6</td>
<td style="text-align: center;">$\mathbf{9 6 . 6}$</td>
</tr>
<tr>
<td style="text-align: left;">Human Enhancers Cohn</td>
<td style="text-align: center;">69.5</td>
<td style="text-align: center;">74.0</td>
<td style="text-align: center;">70.5</td>
<td style="text-align: center;">$\mathbf{7 4 . 2}$</td>
</tr>
<tr>
<td style="text-align: left;">Human Enhancers Ensembl</td>
<td style="text-align: center;">68.9</td>
<td style="text-align: center;">85.7</td>
<td style="text-align: center;">83.5</td>
<td style="text-align: center;">$\mathbf{8 9 . 2}$</td>
</tr>
<tr>
<td style="text-align: left;">Human Regulatory</td>
<td style="text-align: center;">93.3</td>
<td style="text-align: center;">88.1</td>
<td style="text-align: center;">91.5</td>
<td style="text-align: center;">$\mathbf{9 3 . 8}$</td>
</tr>
<tr>
<td style="text-align: left;">Human Nontata Promoters</td>
<td style="text-align: center;">84.6</td>
<td style="text-align: center;">85.6</td>
<td style="text-align: center;">87.7</td>
<td style="text-align: center;">$\mathbf{9 6 . 6}$</td>
</tr>
<tr>
<td style="text-align: left;">Human OCR Ensembl</td>
<td style="text-align: center;">68.0</td>
<td style="text-align: center;">75.1</td>
<td style="text-align: center;">73.0</td>
<td style="text-align: center;">$\mathbf{8 0 . 9}$</td>
</tr>
</tbody>
</table>
<p>SotA on 7 of 8 datasets and by up to $20 \%$ points on the human enhancer identification task, as shown in Tab. 4.1. See A. 2 for additional experiment details and ablations.</p>
<p>Nucleotide Transformer Next, we benchmark against 18 datasets from the Nucleotide Transformer (NT) (Dalla-Torre et al., 2023), which includes predicting regulatory elements for enhancers, promoters, epigenetic marks, and splice sites from DNA sequences of length 200-600 nucleotides. We compare against 3 NT base models, which were pretrained using masked language modeling (BERT) and then fine-tuned. The NT models ranged from 500 M to 2.5 B parameters, and pretrained on up to 3202 genomes. All NT models use 6-mer sequences of 1000 tokens long. For HyenaDNA, we attach a linear decoder head and fine-tune a pretrained model, surpassing SotA on 12 of 18 datasets using a model with orders of magnitude less parameters and pretraining data, shown in Tab. 4.2. See A. 2 for additional experiment details and ablations.</p>
<h1>4.3 In-context Learning for Genomic Sequences</h1>
<p>Compared to natural language FMs, which have shown strong success with in-context learning, HyenaDNA's vocabulary is very small. DNA sequences are also less diverse in structure, e.g. there's no concept of labels</p>
<p>or descriptions that follow a DNA sequence. This makes it challenging to perform "pure" in-context learning (relying only on inference), since new concepts such as classification labels would require new symbols. To overcome this limitation and explore the potential for in-context learning in genomics, we make use of two variants of incontext learning: soft prompting and instruction fine-tuning. Each involve a brief tuning phase to introduce the concept of classification using only the existing vocabulary.</p>
<p>Procedure In both variants, we use the GenomicBenchmarks in 4.2, and a HyenaDNA model pretrained on sequence length 160 k from 4.1 .</p>
<p>In the first experiment, we evaluate a soft prompting approach by prepending a sequence of soft tuneable tokens ( 2 to 32 k ) directly in the input sequences. We include a brief tuning phase ( $&lt;20$ epochs), updating the soft tokens only, to provide HyenaDNA with the ability to indicate the target classes. To denote classes, we repurpose HyenaDNA's fixed vocabulary: for binary classification, for example, we indicate the two classes with the letters "A" and "N".</p>
<p>In the second experiment, we evaluate a few-shot learning approach to in-context learning (Brown et al., 2020) by prepending, consecutively, $k$ (2 to 32) demonstrations of each class and its sequence into the prompt. As before, we encode class labels by the use of individual letters of HyenaDNA's existing vocabulary. We additionally perform a brief instruction-tuning period (Wei et al., 2021) for each dataset to familiarize HyenaDNA with this task structure by tuning the pretrained model on a small subset of the dataset.
<img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 4.2: Filling long-context with soft tuneable tokens. HyenaDNA is able to learn new tasks incontext when adding a sequence of tuneable tokens to the input sequences. Longer sequences of tuneable tokens lead to better performance.</p>
<p>Results In Fig. 4.2, HyenaDNA's performance on novel tasks improves as more tuneable tokens are added into the input sequences, and saturates close to baseline performance (Tab. 4.1; with the exception of the Human Regulatory dataset). By contrast, we find that increasing $k$-shot demonstrations to the input does not necessarily improve performance. A higher number of tuning samples is needed before $k$-shot demonstrations start to boost accuracy as shown in Tab. A.1. See A. 3 for experiment details.</p>
<h1>4.4 Ultralong-Range Genomics</h1>
<p>In our final experimental section, we focus on pushing the limits of using long context effectively in genomics. In 4.4.1, we tackle a challenging 919 binary multi-task against a sparseattention baseline. In 4.4.2 we analyze the learned embeddings HyenaDNA and its use in clustering long sequences by functional annotation, and in 4.4.3 we showcase a novel ultralongrange species classification task.</p>
<h3>4.4.1 Chromatin Profile Prediction</h3>
<p>Table 4.3: Chromatin profile prediction Median AUROC computed over three categories: Transcription factor binding profiles (TF), DNase I-hypersensitive sites (DHS) and histone marks (HM).</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Model</th>
<th style="text-align: center;">Params</th>
<th style="text-align: center;">Len</th>
<th style="text-align: center;">AUROC</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">TF</td>
<td style="text-align: center;">DHS</td>
<td style="text-align: center;">HM</td>
</tr>
<tr>
<td style="text-align: center;">DeepSEA</td>
<td style="text-align: center;">40 M</td>
<td style="text-align: center;">1 k</td>
<td style="text-align: center;">95.8</td>
<td style="text-align: center;">92.3</td>
<td style="text-align: center;">85.6</td>
</tr>
<tr>
<td style="text-align: center;">BigBird</td>
<td style="text-align: center;">110 M</td>
<td style="text-align: center;">8 k</td>
<td style="text-align: center;">96.1</td>
<td style="text-align: center;">92.1</td>
<td style="text-align: center;">88.7</td>
</tr>
<tr>
<td style="text-align: center;">HyenaDNA</td>
<td style="text-align: center;">7 M</td>
<td style="text-align: center;">1 k</td>
<td style="text-align: center;">$\mathbf{9 6 . 4}$</td>
<td style="text-align: center;">$\mathbf{9 3 . 0}$</td>
<td style="text-align: center;">86.3</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">3.5 M</td>
<td style="text-align: center;">8 k</td>
<td style="text-align: center;">95.5</td>
<td style="text-align: center;">91.7</td>
<td style="text-align: center;">$\mathbf{8 9 . 3}$</td>
</tr>
</tbody>
</table>
<p>The prediction of chromatin profiles and epigenetic markers from DNA sequences is an important and challenging task to quantify the functional effects of non-coding variants. These variants include single nucleotide changes in DNA that can affect the downstream expression of genes (Zaina et al., 2010). The DeepSEA dataset (Zhou and Troyanskaya, 2015) is compiled from 919 chromatin features including transcription factor (TF) binding profiles, DNase I-hypersensitive sites (DHS) and histone mark (HM) profiles. For a given sequence, the task is to jointly predict 919 labels corresponding to the chromatin profile (similar to peak detection) of a central region of the sequence, indicating the presence of such functional effects. The input also includes flanking regions that provide broader contextual information needed to incorporate long-range interactions. We fine-tune our pretrained HyenaDNA models from 4.1 and perform competitively against a DeepSea CNN and the SotA sparse attention BigBird (Zaheer et al., 2020) baselines using 5-30× fewer parameters. See A. 4 for experiment details.</p>
<h3>4.4.2 Biotype Embeddings</h3>
<p>Sequence embeddings, colored by biotype
<img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Figure 4.3: Embedding visualisation. t-SNE of the embeddings generated by DNABERT, Nucleotide Transformer and HyenaDNA coloured by Ensembl biotype annotations.</p>
<p>Next, we analyze the pretrained embeddings from HyenaDNA and compare them with DNABERT (Ji et al., 2021) and the Nucleotide Transformer (Dalla-Torre et al., 2023). We encode sequences of human genes corresponding to different biological function annotations obtained from the Ensembl dataset known as</p>
<p>biotypes (Cunningham et al., 2022). In cases where the length of the input exceeds the context window of the encoder, the sequence is chunked (by the max length of the encoder) and averaged.</p>
<p>We fit the embeddings using an XGBoost (Chen and Guestrin, 2016) classifier on the 10 most frequent biotypes, and apply t-SNE (Van der Maaten and Hinton, 2008) for visualization. As shown in 4.3, distinct clusterings emerge visually, while quantitatively, HyenaDNA produces the highest F1 score in biotype classification (with a much smaller model), indicating that during pretraining, HyenaDNA learns informative features related to biological function.</p>
<p>Table 4.4: Embedding quality Weighted F1 classification score on 10 biotypes.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Model</th>
<th style="text-align: center;">Params</th>
<th style="text-align: center;">Len</th>
<th style="text-align: center;">F1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">DNABERT</td>
<td style="text-align: center;">110 M</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">64.6</td>
</tr>
<tr>
<td style="text-align: center;">NT</td>
<td style="text-align: center;">500 M</td>
<td style="text-align: center;">6 k</td>
<td style="text-align: center;">66.5</td>
</tr>
<tr>
<td style="text-align: center;">HyenaDNA</td>
<td style="text-align: center;">7 M</td>
<td style="text-align: center;">160 k</td>
<td style="text-align: center;">$\mathbf{7 2 . 0}$</td>
</tr>
</tbody>
</table>
<h1>4.4.3 Species Classification</h1>
<p>The majority of the genome is conserved across species - humans and non-human primates, for example, have $&lt;10 \%$ sequence divergence (Rogers and Gibbs, 2014), making them difficult to discriminate. This allows us to to design an ultralong-range sequence modeling task to test whether a model can determine the source species of a random genetic sequence. To train, we randomly sample DNA sequences from 5 different species, and fine-tune pretrained HyenaDNA and Transformer models from 4.1 to predict the species label. We observe in Tab. 4.5 that both models struggle on shorter sequences of length 1024, but performance improves with longer contexts as the distinct mutational profile of each species becomes more evident. HyenaDNA effectively solves the task by using a context length of 450 k to 1 million, where Transformer cannot due to infeasible training time limitations. See A. 6 for experiment details.</p>
<h2>5 Conclusion</h2>
<p>Summary We presented HyenaDNA, a genomic foundation model pretrained on the human reference genome with context lengths up to 1 million tokens at single nucleotide resolution an up to 500x increase over previous genomic FMs using denseattention. HyenaDNA is able to learn generalizable features that can then be fine-tuned for tasks including identifying regulatory elements and on a 919-way chromatin profile prediction task. We also explored the first use of in-context learning in genomics to enable simpler adaptation to downstream tasks without any updates to pretrained weights.</p>
<p>Limitations and Future Work While demonstrating competitive results and introducing novel capabilities, it is worth noting that HyenaDNA was pretrained on only one human reference genome. Incorporating genomes of multiple humans and species could increase generalizability in learned features and reduce bias. Furthermore, our current focus in this study was exclusively on DNA sequences. Extending our framework to incorporate other biological or chemical sequences, such as proteins and drug molecules, has the potential to unlock multi-modal capabilities similar to those observed in natural language and vision FMs (Radford et al., 2021; Ramesh et al., 2021; Yu et al., 2022).</p>
<p>With respect to model size, HyenaDNA is significantly smaller than previous genomic FMs and was pretrained using up to 8 Nvidia A100 (80GB) GPUs. We expect increasing model size, and compute, may lead to additional long-range capabilities. Notably, with model parallelism, it becomes feasible to extend the context length by orders of magnitude beyond this current work, and leave that open to future research.</p>
<p>Furthermore, beyond discriminative applications, the use of long context models in generative tasks unlocks exciting prospects for the design of synthetic regulatory elements, genes and protein complexes. In</p>
<p>conclusion, the continued advancements of long-range sequence models with single nucleotide resolution hold great promise in driving innovation in genomic research and unraveling the complexities of biological systems.</p>
<h1>Acknowledgments</h1>
<p>We would like to thank Guatam Machiraju, Elliott Epstein, Archis Joglekar, Jared Dunnmon, Nazim Bouatta and Anshul Kundaje for helpful discussion and feedback on earlier drafts, and Together for providing the compute used to train models in this paper. We gratefully acknowledge the support of NIH under No. U54EB020405 (Mobilize), NSF under Nos. CCF1763315 (Beyond Sparsity), CCF1563078 (Volume to Velocity), and 1937301 (RTML); US DEVCOM ARL under No. W911NF-21-2-0251 (Interactive Human-AI Teaming); ONR under No. N000141712266 (Unifying Weak Supervision); ONR N00014-20-1-2480: Understanding and Applying Non-Euclidean Geometry in Machine Learning; N000142012275 (NEPTUNE); NXP, Xilinx, LETI-CEA, Intel, IBM, Microsoft, NEC, Toshiba, TSMC, ARM, Hitachi, BASF, Accenture, Ericsson, Qualcomm, Analog Devices, Google Cloud, Salesforce, Total, the HAI-GCP Cloud Credits for Research program, the Stanford Data Science Initiative (SDSI), Department of Defense (DoD) through the National Defense Science and Engineering Graduate Fellowship (NDSEG) Program, and members of the Stanford DAWN project: Facebook, Google, and VMWare. This work is supported by NSF (1651565), AFOSR (FA95501910024), ARO (W911NF-21-1-0125), ONR, DOE (DE-SC0022222), CZ Biohub, and Sloan Fellowship. The U.S. Government is authorized to reproduce and distribute reprints for Governmental purposes notwithstanding any copyright notation thereon. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views, policies, or endorsements, either expressed or implied, of NIH, ONR, or the U.S. Government.</p>
<h2>References</h2>
<p>Ž. Avsec, V. Agarwal, D. Visentin, J. R. Ledsam, A. Grabska-Barwinska, K. R. Taylor, Y. Assael, J. Jumper, P. Kohli, and D. R. Kelley. Effective gene expression prediction from sequence by integrating long-range interactions. Nature methods, 18(10):1196-1203, 2021.
D. Bahdanau, K. Cho, and Y. Bengio. Neural machine translation by jointly learning to align and translate. arXiv preprint arXiv:1409.0473, 2014.
G. Benegas, S. S. Batra, and Y. S. Song. DNA language models are powerful zero-shot predictors of noncoding variant effects. bioRxiv, pages 2022-08, 2022.
R. Bommasani, D. A. Hudson, E. Adeli, R. Altman, S. Arora, S. von Arx, M. S. Bernstein, J. Bohg, A. Bosselut, E. Brunskill, et al. On the opportunities and risks of foundation models. arXiv preprint arXiv:2108.07258, 2021.
N. Brandes, D. Ofer, Y. Peleg, N. Rappoport, and M. Linial. ProteinBERT: a universal deep-learning model of protein sequence and function. Bioinformatics, 38(8):2102-2110, 2022.
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal, A. Neelakantan, P. Shyam, G. Sastry, A. Askell, et al. Language models are few-shot learners. Advances in neural information processing systems, $33: 1877-1901,2020$.
T. Chen and C. Guestrin. Xgboost: A scalable tree boosting system. In Proceedings of the 22nd acm sigkdd international conference on knowledge discovery and data mining, pages 785-794, 2016.
D. M. Church, V. A. Schneider, T. Graves, K. Auger, F. Cunningham, N. Bouk, H.-C. Chen, R. Agarwala, W. M. McLaren, G. R. Ritchie, et al. Modernizing reference genome assemblies. PLoS biology, 9(7): e1001091, 2011.
F. Cunningham, J. E. Allen, J. Allen, J. Alvarez-Jarreta, M. R. Amode, I. M. Armean, O. Austine-Orimoloye, A. G. Azov, I. Barnes, R. Bennett, et al. Ensembl 2022. Nucleic acids research, 50(D1):D988-D995, 2022.</p>
<p>H. Dalla-Torre, L. Gonzalez, J. Mendoza-Revilla, N. L. Carranza, A. H. Grzywaczewski, F. Oteri, C. Dallago, E. Trop, H. Sirelkhatim, G. Richard, M. Skwark, K. Beguir, M. Lopez, and T. Pierrot. The Nucleotide Transformer: Building and evaluating robust foundation models for human genomics. bioRxiv, 2023.
T. Dao, D. Y. Fu, S. Ermon, A. Rudra, and C. Ré. FlashAttention: Fast and memory-efficient exact attention with IO-awareness. In Advances in Neural Information Processing Systems, 2022a.
T. Dao, D. Y. Fu, K. K. Saab, A. W. Thomas, A. Rudra, and C. Ré. Hungry hungry hippos: Towards language modeling with state space models. arXiv preprint arXiv:2212.14052, 2022b.
J. Devlin, M.-W. Chang, K. Lee, and K. Toutanova. Bert: Pre-training of deep bidirectional transformers for language understanding. arXiv preprint arXiv:1810.04805, 2018.
A. Elnaggar, M. Heinzinger, C. Dallago, G. Rehawi, Y. Wang, L. Jones, T. Gibbs, T. Feher, C. Angerer, M. Steinegger, et al. Prottrans: Toward understanding the language of life through self-supervised learning. IEEE transactions on pattern analysis and machine intelligence, 44(10):7112-7127, 2021.</p>
<p>ENCODE Project Consortium. An integrated encyclopedia of dna elements in the human genome. Nature, 489(7414):57, 2012.</p>
<p>ENCODE Project Consortium. Expanded encyclopaedias of DNA elements in the human and mouse genomes. Nature, 583:699-710, 2020.
N. Ferruz, S. Schmidt, and B. Höcker. ProtGPT2 is a deep unsupervised language model for protein design. Nature communications, 13(1):4348, 2022.
Q. Fournier, G. M. Caron, and D. Aloise. A practical survey on faster and lighter transformers. ACM Computing Surveys, 2021.
D. Y. Fu, E. L. Epstein, E. Nguyen, A. W. Thomas, M. Zhang, T. Dao, A. Rudra, and C. Ré. Simple hardware-efficient long convolutions for sequence modeling. arXiv preprint arXiv:2302.06646, 2023.
D. Gankin, A. Karollus, M. Grosshauser, K. Klemon, J. Hingerl, and J. Gagneur. Species-aware DNA language modeling. bioRxiv, pages 2023-01, 2023.
Q. Geng, R. Yang, and L. Zhang. A deep learning framework for enhancer prediction using word embedding and sequence generation. Biophysical Chemistry, 286:106822, 2022.</p>
<p>Genome Reference Consortium. Genome reference consortium human build 38 (grch38). National Center for Biotechnology Information, 2013. URL https://www.ncbi.nlm.nih.gov/assembly/GCF_ $000001405.26 /$.
K. Gresova, V. Martinek, D. Cechak, P. Simecek, and P. Alexiou. Genomic Benchmarks: A collection of datasets for genomic sequence classification. bioRxiv, 2022.
A. Gu, K. Goel, and C. Ré. Efficiently modeling long sequences with structured state spaces. arXiv preprint arXiv:2111.00396, 2021.
Y. Ji, Z. Zhou, H. Liu, and R. V. Davuluri. DNABERT: pre-trained bidirectional encoder representations from transformers model for DNA-language in genome. Bioinformatics, 37(15):2112-2120, 2021.
W. J. Kent, C. W. Sugnet, T. S. Furey, K. M. Roskin, T. H. Pringle, A. M. Zahler, and D. Haussler. The human genome browser at ucsc. Genome research, 12(6):996-1006, 2002.
B. Lester, R. Al-Rfou, and N. Constant. The power of scale for parameter-efficient prompt tuning. arXiv preprint arXiv:2104.08691, 2021.
C. Li, M. Zhang, and Y. He. The stability-efficiency dilemma: Investigating sequence length warmup for training GPT models. In Advances in Neural Information Processing Systems, 2022.</p>
<p>Z. Lin, H. Akin, R. Rao, B. Hie, Z. Zhu, W. Lu, A. dos Santos Costa, M. Fazel-Zarandi, T. Sercu, S. Candido, et al. Language models of protein sequences at the scale of evolution enable accurate structure prediction. BioRxiv, 2022.
P. Liu, W. Yuan, J. Fu, Z. Jiang, H. Hayashi, and G. Neubig. Pre-train, prompt, and predict: A systematic survey of prompting methods in natural language processing. ACM Computing Surveys, 55(9):1-35, 2023.
A. Madani, B. Krause, E. R. Greene, S. Subramanian, B. P. Mohr, J. M. Holton, J. L. Olmos Jr, C. Xiong, Z. Z. Sun, R. Socher, et al. Large language models generate functional protein sequences across diverse families. Nature Biotechnology, pages 1-8, 2023.
J. Meier, R. Rao, R. Verkuil, J. Liu, T. Sercu, and A. Rives. Language models enable zero-shot prediction of the effects of mutations on protein function. Advances in Neural Information Processing Systems, 34: $29287-29303,2021$.
J. Nasser, D. T. Bergman, C. P. Fulco, P. Guckelberger, B. R. Doughty, T. A. Patwardhan, T. R. Jones, T. H. Nguyen, J. C. Ulirsch, F. Lekschas, K. Mualim, H. M. Natri, E. M. Weeks, G. Munson, M. Kane, H. Y. Kang, A. Cui, J. P. Ray, T. M. Eisenhaure, R. L. Collins, K. Dey, H. Pfister, A. L. Price, C. B. Epstein, A. Kundaje, R. J. Xavier, M. J. Daly, H. Huang, H. K. Finucane, N. Hacohen, E. S. Lander, and J. M. Engreitz. Genome-wide enhancer maps link risk variants to disease genes. Nature, 593:238-243, 2021.
M. Oubounyt, Z. Louadi, H. Tayara, and K. T. Chong. DeePromoter: Robust promoter predictor using deep learning. Frontiers in Genetics, 10, 2019.
T. H. Pham, D. H. Tran, T. B. H. Ho, K. Satou, and G. Valiente. Qualitatively predicting acetylation and methylation areas in DNA sequences. Genome Informatics, 16(2):3-11, 2005.
D. K. Pokholok, C. T. Harbison, S. Levine, F. Lewitter, D. K. Gifford, and R. A. Young. Genome-wide map of nucleosome acetylation and methylation in yeast. Cell, 122(4):517-527, 2005.
M. Poli, S. Massaroli, E. Nguyen, D. Y. Fu, T. Dao, S. Baccus, Y. Bengio, S. Ermon, and C. Ré. Hyena Hierarchy: Towards larger convolutional language models. arXiv preprint arXiv:2302.10866, 2023.
O. Press, N. A. Smith, and M. Lewis. Shortformer: Better language modeling using shorter inputs. arXiv preprint arXiv:2012.15832, 2020.
A. Radford, J. W. Kim, C. Hallacy, A. Ramesh, G. Goh, S. Agarwal, G. Sastry, A. Askell, P. Mishkin, J. Clark, et al. Learning transferable visual models from natural language supervision. In International conference on machine learning, pages 8748-8763. PMLR, 2021.
A. Ramesh, M. Pavlov, G. Goh, S. Gray, C. Voss, A. Radford, M. Chen, and I. Sutskever. Zero-shot text-toimage generation. In International Conference on Machine Learning, pages 8821-8831. PMLR, 2021.
R. Rao, J. Meier, T. Sercu, S. Ovchinnikov, and A. Rives. Transformer protein language models are unsupervised structure learners. Biorxiv, pages 2020-12, 2020.</p>
<p>Roadmap Epigenomics Consortium. Integrative analysis of 111 reference human epigenomes. Nature, 518 (7539):317-330, 2015.
J. Rogers and R. A. Gibbs. Comparative primate genomics: emerging patterns of genome content and dynamics. Nature Reviews Genetics, 15(5):347-359, 2014.
D. W. Romero, R.-J. Bruintjes, J. M. Tomczak, E. J. Bekkers, M. Hoogendoorn, and J. C. van Gemert. Flexconv: Continuous kernel convolutions with differentiable kernel sizes. arXiv preprint arXiv:2110.08059, 2021a.
D. W. Romero, A. Kuzina, E. J. Bekkers, J. M. Tomczak, and M. Hoogendoorn. Ckconv: Continuous kernel convolution for sequential data. arXiv preprint arXiv:2102.02611, 2021b.</p>
<p>N. Scalzitti, A. Kress, R. Orhand, T. Weber, L. Moulinier, A. Jeannin-Girardon, O. Collet, Pierre anf Poch, and J. D. Thompson. Spliceator: multi-species splice site prediction using convolutional neural networks. BMC Bioinformatics, 22(1):1-26, 2021.
J. T. Smith, A. Warrington, and S. W. Linderman. Simplified state space layers for sequence modeling. arXiv preprint arXiv:2208.04933, 2022.
Y. Tay, M. Dehghani, S. Abnar, Y. Shen, D. Bahri, P. Pham, J. Rao, L. Yang, S. Ruder, and D. Metzler. Long range arena: A benchmark for efficient transformers. arXiv preprint arXiv:2011.04006, 2020.
Y. Tay, V. Q. Tran, S. Ruder, J. Gupta, H. W. Chung, D. Bahri, Z. Qin, S. Baumgartner, C. Yu, and D. Metzler. Charformer: Fast character transformers via gradient-based subword tokenization. arXiv preprint arXiv:2106.12672, 2021.
L. Van der Maaten and G. Hinton. Visualizing data using t-sne. Journal of machine learning research, 9(11), 2008 .
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, Ł. Kaiser, and I. Polosukhin. Attention is all you need. Advances in neural information processing systems, 30, 2017.
J. Wei, M. Bosma, V. Y. Zhao, K. Guu, A. W. Yu, B. Lester, N. Du, A. M. Dai, and Q. V. Le. Finetuned language models are zero-shot learners. arXiv preprint arXiv:2109.01652, 2021.
F. Yang, W. Wang, F. Wang, Y. Fang, D. Tang, J. Huang, H. Lu, and J. Yao. scBERT as a large-scale pretrained deep language model for cell type annotation of single-cell RNA-seq data. Nature Machine Intelligence, 4(10):852-866, 2022.
J. Yu, Z. Wang, V. Vasudevan, L. Yeung, M. Seyedhosseini, and Y. Wu. Coca: Contrastive captioners are image-text foundation models. arXiv preprint arXiv:2205.01917, 2022.
M. Zaheer, G. Guruganesh, K. A. Dubey, J. Ainslie, C. Alberti, S. Ontanon, P. Pham, A. Ravula, Q. Wang, L. Yang, et al. Big bird: Transformers for longer sequences. Advances in neural information processing systems, 33:17283-17297, 2020.
S. Zaina, E. L. Pérez-Luque, and G. Lund. Genetics talks to epigenetics? the interplay between sequence variants and chromatin structure. Current genomics, 11(5):359-367, 2010.
J. Zhou and O. G. Troyanskaya. Predicting effects of noncoding variants with deep learning-based sequence model. Nature methods, 12(10):931-934, 2015.
M. Zvyagin, A. Brace, K. Hippe, Y. Deng, B. Zhang, C. O. Bohorquez, A. Clyde, B. Kale, D. Perez-Rivera, H. Ma, et al. GenSLMs: Genome-scale language models reveal SARS-CoV-2 evolutionary dynamics. bioRxiv, pages 2022-10, 2022.</p>
<h1>HyenaDNA</h1>
<h2>Supplementary Material</h2>
<h2>Contents</h2>
<p>1 Introduction ..... 1
2 Preliminaries and Related Work ..... 4
2.1 Transformers and Attention ..... 4
2.2 Long Context Strategies in Genomics ..... 4
2.3 Large Convolutional Models ..... 4
3 HyenaDNA Long-Range Genomic Foundation Models ..... 5
3.1 The HyenaDNA Model ..... 5
3.2 Training Long Sequence Models ..... 5
3.3 Downstream Adaptation ..... 6
4 Experiments ..... 6
4.1 Pretraining on the Human Genome ..... 6
4.2 Single Nucleotide Resolution ..... 7
4.3 In-context Learning for Genomic Sequences ..... 7
4.4 Ultralong-Range Genomics ..... 9
4.4.1 Chromatin Profile Prediction ..... 9
4.4.2 Biotype Embeddings ..... 9
4.4.3 Species Classification ..... 10
5 Conclusion ..... 10
A Appendix: Experimental Details ..... 16
A. 1 Pretraining Details ..... 16
A. 2 Short-Range Genomics Details ..... 16
A.2.1 GenomicBenchmarks experiment ..... 16
A.2.2 Ablations on the GenomicBenchmarks ..... 17
A.2.3 Downstream prediction tasks for Nucleotide Transformer benchmark ..... 18
A.2.4 Ablations on the Nucleotide Transformer benchmarks ..... 19
A. 3 In-Context Learning Details ..... 20
A. 4 Chromatin Profile Details ..... 21
A. 5 Biotype Embeddings Analysis Details ..... 23
A. 6 Long-range Species Classification Details ..... 23</p>
<h1>A Appendix: Experimental Details</h1>
<p>In the following sections we provide further details for each experiment. Across all experiments, we use Pytorch and Pytorch Lightning. We train on a mix of Nvidia GPUs with A100s, V100s, and T4s. Unless otherwise stated, we use a cross entropy loss for our objective. Our repository is made public here: https://github.com/HazyResearch/hyena-dna.</p>
<h2>A. 1 Pretraining Details</h2>
<p>Table A.1: Hyperparameter settings for HyenaDNA pretraining (select models).</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Layers</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">8</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Width</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">256</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">256</td>
<td style="text-align: right;">256</td>
</tr>
<tr>
<td style="text-align: left;">Params (M)</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">6.6</td>
</tr>
<tr>
<td style="text-align: left;">Max seq. len.</td>
<td style="text-align: right;">64 k</td>
<td style="text-align: right;">64 k</td>
<td style="text-align: right;">64 k</td>
<td style="text-align: right;">64 k</td>
<td style="text-align: right;">1 M</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">Optimizer</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">AdamW</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">Optimizer momentum</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">$\beta_{1}, \beta_{2}=0.9,0.999$</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">Learning rate</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">$1.5-6 \mathrm{e}-4$</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">LR Scheduler</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">Cosine decay</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">Batch size</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">64 - 256</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">Global steps</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">$10-20 \mathrm{k}$</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">Weight decay (model)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">Weight decay (Hyena layers)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">Embed dropout</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr>
<td style="text-align: left;">Residual dropout</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p>Data For pretraining, we use a single human reference genome (Genome Reference Consortium, 2013), and leverage the training and validation intervals (start and end) from (Avsec et al., 2021). During training, we sample an interval and obtain a sequence of length $L$ by adjusting the intervals on both ends. For the test set, we use chromosomes 14 and X , exclusively, and sample non-overlapping sequences of length $L$.</p>
<p>Model We design a suite of parameter efficient architectures with depths between 2 and 8 layers, Hyena blocks of Order- $\mathrm{N}=2$, and width 128 to 256 . The MLP expansion factor (reverse bottleneck) is 4 x the width. See Fig. 1.3 for the block architecture of HyenaDNA. The parameter counts range from 400 k to 6.6 M , trained on sequence lengths between 1,024 and 1 M . Tab. A. 1 highlights a representative subset of the models we trained. Note: we use different pretrained model sizes depending on the downstream task to prevent overfitting. When selecting which pretrained model to use for a downstream task, we found that a pretrained sequence length of 2 to 4 x the downstream max sequence length results in the best performance.</p>
<p>Training We pretrain each model for 10-20k global steps. For models trained on longer sequences, this translates to more tokens being used, as each sample contains more tokens. For example, the largest model with context length 1 M was trained on 2 T tokens over 4 weeks. We adjust the "accumulate_grad_batches" argument in Pytorch Lightning to keep the global batch size consistent across models and sequence lengths. See Tab. A. 1 for hyperparameter details.</p>
<p>Training efficiency We compare pretraining compute resources and GPU-hours to reach competitive performance on the short-range tasks for several baselines and HyenaDNA models, shown in Tab. A.2.</p>
<h2>A. 2 Short-Range Genomics Details</h2>
<h2>A.2.1 GenomicBenchmarks experiment</h2>
<p>Data The GenomicBenchmarks (Gresova et al., 2022) includes 8 datasets designed for sequence-level classification tasks that involve predicting regulatory elements, along with one binary species task. The benchmarks</p>
<p>Table A.2: Pretraining GPU \&amp; runtime comparison for short-range models.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">DNABERT</th>
<th style="text-align: center;">Nucleotide Transformer</th>
<th style="text-align: center;">HyenaDNA</th>
<th style="text-align: center;">HyenaDNA</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Params</td>
<td style="text-align: center;">110 M</td>
<td style="text-align: center;">2.5 B</td>
<td style="text-align: center;">436 K</td>
<td style="text-align: center;">1.6 M</td>
</tr>
<tr>
<td style="text-align: left;">GPUs</td>
<td style="text-align: center;">$8-2080$ TI</td>
<td style="text-align: center;">$128-\mathrm{A} 100-80 \mathrm{~GB}$</td>
<td style="text-align: center;">$1-\mathrm{A} 100-40 \mathrm{~GB}$</td>
<td style="text-align: center;">$1-\mathrm{A} 100-40 \mathrm{~GB}$</td>
</tr>
<tr>
<td style="text-align: left;">Wall clock</td>
<td style="text-align: center;">25 days</td>
<td style="text-align: center;">28 days</td>
<td style="text-align: center;">80 mins</td>
<td style="text-align: center;">80 mins</td>
</tr>
<tr>
<td style="text-align: left;">GPU-hrs</td>
<td style="text-align: center;">12,000</td>
<td style="text-align: center;">215,000</td>
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">1.3</td>
</tr>
</tbody>
</table>
<p>provided for the baseline model include two sets of results: one obtained with Pytorch and the other with TensorFlow. Since our code base is implemented in Pytorch, we compare our results with the Pytorch-based benchmarks.</p>
<p>Model Our backbone is a pretrained 2 layer HyenaDNA model with width 128, trained on sequence length 1024. We pool along the sequence dimension to obtain a classification token, and attach a simple linear decoder head. The baseline CNN, as described by (Gresova et al., 2022), uses uses an embedding layer, 3 convolutional layers with number of filters: 16,8 , and 4 . It uses batch norm and max pooling after each convolutional layer, followed by 2 dense layers. It is trained for 10 epochs with batch size 64 . The mode sizes range from 120 k to 520 k , depending on sequence length chosen.</p>
<p>Table A.3: GenomicBenchmarks hyperparameters for HyenaDNA and the baseline Transformer (GPT from 4.1), which uses FlashAttention (Dao et al., 2022a).</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">Transformer</th>
<th style="text-align: center;">HyenaDNA</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Layers</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">Width</td>
<td style="text-align: center;">128</td>
<td style="text-align: center;">128</td>
</tr>
<tr>
<td style="text-align: left;">Parameters</td>
<td style="text-align: center;">529 k</td>
<td style="text-align: center;">436 k</td>
</tr>
<tr>
<td style="text-align: left;">Learning rate</td>
<td style="text-align: center;">$1-6 e^{-4}$</td>
<td style="text-align: center;">$1-6 e^{-4}$</td>
</tr>
<tr>
<td style="text-align: left;">Weight decay (model)</td>
<td style="text-align: center;">$0-0.2$</td>
<td style="text-align: center;">$0-0.2$</td>
</tr>
<tr>
<td style="text-align: left;">Weight decay (Hyena layers)</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: left;">Embed dropout</td>
<td style="text-align: center;">$0-0.2$</td>
<td style="text-align: center;">$0.0-0.3$</td>
</tr>
<tr>
<td style="text-align: left;">Resid dropout</td>
<td style="text-align: center;">$0-0.2$</td>
<td style="text-align: center;">$0-0.3$</td>
</tr>
<tr>
<td style="text-align: left;">Num heads</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">-</td>
</tr>
<tr>
<td style="text-align: left;">Optimizer</td>
<td style="text-align: center;">AdamW</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Optimizer momentum</td>
<td style="text-align: center;">$\beta_{1}, \beta_{2}=0.9,0.999$</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">LR scheduler</td>
<td style="text-align: center;">Cosine decay</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Batch size</td>
<td style="text-align: center;">128 -1024</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Training epoch</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Reverse complement aug.</td>
<td style="text-align: center;">true/false</td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Sequence lengths</td>
<td style="text-align: center;">$200-4800$</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>Training The primary hyperparameters we sweep across include: learning rate, global batch size, dropout, weight decay, and a reverse complement augmentation. See Tab. A. 3 for ranges of hyperparamters used.</p>
<h1>A.2.2 Ablations on the GenomicBenchmarks</h1>
<p>To better understand how specific design choices in the HyenaDNA model effect performance, we perform a series of ablation experiments on the GenomicBenchmarks.</p>
<p>Pretraining: We train HyenaDNA from scratch and compare with the pretrained version. The pretrained models provide mild to moderate gains - likely due to the benchmarks being near saturation already.</p>
<p>Table A.4: GenomicBenchmarks Top-1 accuracy (\%) GPT is the causal Transformer from 4.1, HyenaDNA k-mer uses a 6-mer tokenizer, and HyenaDNA bidirection is a bidirectional version of the Hyena operator.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th style="text-align: center;">GPT</th>
<th style="text-align: center;">GPT</th>
<th style="text-align: center;">HyenaDNA</th>
<th style="text-align: center;">HyenaDNA</th>
<th style="text-align: center;">HyenaDNA <br> k-mer</th>
<th style="text-align: center;">HyenaDNA <br> bidirection</th>
<th style="text-align: center;">DNABERT</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Pretrained</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
</tr>
<tr>
<td style="text-align: left;">Mouse Enhancers</td>
<td style="text-align: center;">79.3</td>
<td style="text-align: center;">79.3</td>
<td style="text-align: center;">84.7</td>
<td style="text-align: center;">$\mathbf{8 5 . 1}$</td>
<td style="text-align: center;">81.8</td>
<td style="text-align: center;">80.6</td>
<td style="text-align: center;">66.9</td>
</tr>
<tr>
<td style="text-align: left;">Coding vs Intergenomic</td>
<td style="text-align: center;">89.3</td>
<td style="text-align: center;">91.2</td>
<td style="text-align: center;">90.9</td>
<td style="text-align: center;">91.3</td>
<td style="text-align: center;">86.7</td>
<td style="text-align: center;">90.3</td>
<td style="text-align: center;">$\mathbf{9 2 . 5}$</td>
</tr>
<tr>
<td style="text-align: left;">Human vs Worm</td>
<td style="text-align: center;">94.8</td>
<td style="text-align: center;">$\mathbf{9 6 . 6}$</td>
<td style="text-align: center;">96.4</td>
<td style="text-align: center;">$\mathbf{9 6 . 6}$</td>
<td style="text-align: center;">92.9</td>
<td style="text-align: center;">95.9</td>
<td style="text-align: center;">96.5</td>
</tr>
<tr>
<td style="text-align: left;">Human Enhancers Cohn</td>
<td style="text-align: center;">67.7</td>
<td style="text-align: center;">72.9</td>
<td style="text-align: center;">72.9</td>
<td style="text-align: center;">$\mathbf{7 4 . 2}$</td>
<td style="text-align: center;">69.8</td>
<td style="text-align: center;">72.1</td>
<td style="text-align: center;">74.0</td>
</tr>
<tr>
<td style="text-align: left;">Human Enhancers Ensembl</td>
<td style="text-align: center;">79.0</td>
<td style="text-align: center;">88.3</td>
<td style="text-align: center;">85.7</td>
<td style="text-align: center;">$\mathbf{8 9 . 2}$</td>
<td style="text-align: center;">88.0</td>
<td style="text-align: center;">85.9</td>
<td style="text-align: center;">85.7</td>
</tr>
<tr>
<td style="text-align: left;">Human Regulatory</td>
<td style="text-align: center;">90.2</td>
<td style="text-align: center;">91.8</td>
<td style="text-align: center;">90.4</td>
<td style="text-align: center;">$\mathbf{9 3 . 8}$</td>
<td style="text-align: center;">90.2</td>
<td style="text-align: center;">89.1</td>
<td style="text-align: center;">88.1</td>
</tr>
<tr>
<td style="text-align: left;">Human Nontata Promoters</td>
<td style="text-align: center;">85.2</td>
<td style="text-align: center;">90.1</td>
<td style="text-align: center;">93.3</td>
<td style="text-align: center;">$\mathbf{9 6 . 6}$</td>
<td style="text-align: center;">83.5</td>
<td style="text-align: center;">88.5</td>
<td style="text-align: center;">85.6</td>
</tr>
<tr>
<td style="text-align: left;">Human OCR Ensembl</td>
<td style="text-align: center;">68.3</td>
<td style="text-align: center;">79.9</td>
<td style="text-align: center;">78.8</td>
<td style="text-align: center;">$\mathbf{8 0 . 9}$</td>
<td style="text-align: center;">70.2</td>
<td style="text-align: center;">75.3</td>
<td style="text-align: center;">75.1</td>
</tr>
</tbody>
</table>
<p>Tokenization: We train HyenaDNA using a k-mer tokenizer $(\mathrm{k}=6)$ to isolate the effect of the single nucleotide tokenizer. The k-mer tokenizer drops performance significantly across on a majority of the datasets (by as much as 10 accuracy points), while boosting one dataset (Human Enhancer Ensembl). Therefore, the single nucleotide tokenization appears to be a significant component of the HyenaDNA model.</p>
<p>Bidirectional: To ablate the impact of using a causal model, we implemented a bidirectional version of HyenaDNA and trained from scratch on the GenomicBenchmarks (i.e. without masked language model pretraining). The bidirectional version degraded performance on 7 of 8 datasets compared to the standard causal HyenaDNA (also from scratch), on average by 3.8 accuracy points.</p>
<p>The bidirectional HyenaDNA was implemented by using a circular FFT convolution. This involved manipulating the padding on the input sequence before performing the FFT convolution. Previously, we zero padded the input on the right side by length $L$ (the sequence length). For bidirectionality, we pad by $1 / 2 L$ on the left and right side of the input, effectively providing a bidirectional receptive field (due to the circular convolution). This is one of many possible ways to implement a bidirectional version of Hyena.</p>
<h1>A.2.3 Downstream prediction tasks for Nucleotide Transformer benchmark</h1>
<p>Following the Nucleotide Transformer (Dalla-Torre et al., 2023), we collected datasets from four different sources (Geng et al., 2022; Pham et al., 2005; Oubounyt et al., 2019; Scalzitti et al., 2021).</p>
<p>Promoter The promoter dataset included TATA-box-containing and TATA-box-lacking promoters. Tasks involved predicting promoters with a TATA-box, identifying promoters lacking a TATA-box, and distinguishing between both promoter categories and non-promoter sequences. The promoter datasets were obtained from the Eukaryotic Promoter Database (EPDnew) ${ }^{3}$ for human and mouse genomes. Promoter sequences were extracted from regions 249 nucleotides upstream and 50 nucleotides downstream of the transcription start sites.</p>
<p>Enhancer For the enhancer prediction task, we used the dataset from (Geng et al., 2022) containing DNA sequences classified into strong enhancers, weak enhancers, and non-enhancers. The tasks involved binary classification to distinguish enhancer sequences from non-enhancer sequences and identify specific enhancer types.</p>
<p>Epigenetic Marks In the epigenetic marks prediction task, we used the dataset from (Pham et al., 2005; Pokholok et al., 2005) to predict nucleosome occupancy and modification states in the yeast genome. In 10 binary classification tasks, the model had to discriminate between DNA regions that were occupied by</p>
<p><sup id="fnref3:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>Table A.5: Hyperparameter ranges used to fine-tune HyenaDNA for all Nucleotide transformer datasets. Exact hyperparameters per dataset can be found in our code repository.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">HyenaDNA</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Layers</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">Width</td>
<td style="text-align: center;">256</td>
</tr>
<tr>
<td style="text-align: left;">Parameters</td>
<td style="text-align: center;">1.6 M</td>
</tr>
<tr>
<td style="text-align: left;">Optimizer</td>
<td style="text-align: center;">AdamW</td>
</tr>
<tr>
<td style="text-align: left;">Optimizer momentum</td>
<td style="text-align: center;">$\beta_{1}, \beta_{2}=0.9,0.999$</td>
</tr>
<tr>
<td style="text-align: left;">Training epoch</td>
<td style="text-align: center;">100</td>
</tr>
<tr>
<td style="text-align: left;">Batch size</td>
<td style="text-align: center;">$256-1024$</td>
</tr>
<tr>
<td style="text-align: left;">Learning rate</td>
<td style="text-align: center;">$2 \mathrm{e}-4$ to $1 \mathrm{e}-3$</td>
</tr>
<tr>
<td style="text-align: left;">LR scheduler</td>
<td style="text-align: center;">Cosine decay</td>
</tr>
<tr>
<td style="text-align: left;">Weight decay (model)</td>
<td style="text-align: center;">$0-0.2$</td>
</tr>
<tr>
<td style="text-align: left;">Weight decay (Hyena layers)</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: left;">Embed dropout</td>
<td style="text-align: center;">$0-0.2$</td>
</tr>
<tr>
<td style="text-align: left;">Resid dropout</td>
<td style="text-align: center;">$0-0.2$</td>
</tr>
<tr>
<td style="text-align: left;">Reverse complement aug.</td>
<td style="text-align: center;">true/false</td>
</tr>
<tr>
<td style="text-align: left;">Sequence lengths</td>
<td style="text-align: center;">$200-600$</td>
</tr>
</tbody>
</table>
<p>histones or not. The 10 tasks varied based on the types of histones investigated, including unmodified histones H3 and H4, as well as histones modified by either acetylation (H3K9ac, H3K14ac) or methylation (H3K4me1, H3K4me2, H3K4me3, H3K36me3, H3K79me3).</p>
<p>Splice Site For the splice site prediction task, DNA sequences from over 100 organisms were used to predict whether the sequences contain donor or acceptor splice sites (Scalzitti et al., 2021). Donor splice sites denote the beginning of an intron and acceptor splice sites the end of an intron. During RNA splicing, these sites are recognized by the spliceosome, a complex molecular machine that enables the removal of introns from the gene.</p>
<p>Preprocessing The Nucleotide Transformer study did not provide their exact train-test splits, except for the enhancer dataset. Therefore, we generated our own train-test splits using a 90:10 ratio. For the promoter dataset, negative samples were not available, and had to be generated following the procedure described by (Oubounyt et al., 2019).</p>
<p>Model \&amp; Training For the architecture, we use a HyenaDNA model with 2 layers and width 256, and trained on sequences of length 1024. We average across the tokens to obtain a single classification token. For each task, we replaced the model head and fine-tuned the weights of the entire model ( 1.6 M parameters). In contrast, the Nucleotide Transformer uses a parameter-efficient fine-tuning technique that introduces new weights and fine-tunes only the newly added weights, while keeping the initial model weights frozen, presumably due to its large size of 500 M to 2.5 B parameters. The corresponding HyenaDNA hyperparameter ranges used for training each task are reported in Table A.5.</p>
<h1>A.2.4 Ablations on the Nucleotide Transformer benchmarks</h1>
<p>We perform additional ablations on the Nucleotide Transformer benchmarks to assess the impact of pretraining, as well as attention vs. HyenaDNA, as shown in shown in Table A.6. We observed that pretraining has a greater effect on the more challenging tasks (and as sequences become longer, shown in A.11). On the more challenging tasks (histone marks, datasets starting with "H"), pretraining boosts HyenaDNA metrics by up to 21 MCC points on H3K4me3. For simpler tasks (with higher baseline scores) such as the splice sites and promoter tasks, the gain was lower ( 0 to 1 accuracy points), as these were already near saturation in performance.</p>
<p>Table A.6: Pretraining \&amp; Attention ablations on the Nucleotide Transformer (NT) benchmarks. The Matthews correlation coefficient (MCC) is used as the performance metric for the enhancer and epigenetic marks dataset, and the F1-score is used for the promoter and splice site dataset.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th style="text-align: center;">NT</th>
<th style="text-align: center;">GPT</th>
<th style="text-align: center;">HyenaDNA</th>
<th style="text-align: center;">HyenaDNA</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Params</td>
<td style="text-align: center;">2.5 B</td>
<td style="text-align: center;">1.6 M</td>
<td style="text-align: center;">1.6 M</td>
<td style="text-align: center;">1.6 M</td>
</tr>
<tr>
<td style="text-align: left;">Pretrain</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
</tr>
<tr>
<td style="text-align: left;">Enhancer</td>
<td style="text-align: center;">58.0</td>
<td style="text-align: center;">59.3</td>
<td style="text-align: center;">$\mathbf{6 2 . 6}$</td>
<td style="text-align: center;">58.6</td>
</tr>
<tr>
<td style="text-align: left;">Enhancer types</td>
<td style="text-align: center;">47.4</td>
<td style="text-align: center;">51.9</td>
<td style="text-align: center;">$\mathbf{5 5 . 7}$</td>
<td style="text-align: center;">48.4</td>
</tr>
<tr>
<td style="text-align: left;">H3</td>
<td style="text-align: center;">81.4</td>
<td style="text-align: center;">75.8</td>
<td style="text-align: center;">$\mathbf{8 1 . 7}$</td>
<td style="text-align: center;">79.9</td>
</tr>
<tr>
<td style="text-align: left;">H3K4me1</td>
<td style="text-align: center;">55.9</td>
<td style="text-align: center;">38.7</td>
<td style="text-align: center;">$\mathbf{5 7 . 1}$</td>
<td style="text-align: center;">43.4</td>
</tr>
<tr>
<td style="text-align: left;">H3K4me2</td>
<td style="text-align: center;">32.6</td>
<td style="text-align: center;">28.8</td>
<td style="text-align: center;">$\mathbf{5 3 . 9}$</td>
<td style="text-align: center;">34.5</td>
</tr>
<tr>
<td style="text-align: left;">H3K4me3</td>
<td style="text-align: center;">42.1</td>
<td style="text-align: center;">28.3</td>
<td style="text-align: center;">$\mathbf{6 1 . 2}$</td>
<td style="text-align: center;">40.2</td>
</tr>
<tr>
<td style="text-align: left;">H3K9ac</td>
<td style="text-align: center;">57.5</td>
<td style="text-align: center;">49.2</td>
<td style="text-align: center;">$\mathbf{6 5 . 1}$</td>
<td style="text-align: center;">52.6</td>
</tr>
<tr>
<td style="text-align: left;">H3K14ac</td>
<td style="text-align: center;">55.0</td>
<td style="text-align: center;">41.6</td>
<td style="text-align: center;">$\mathbf{6 6 . 3}$</td>
<td style="text-align: center;">48.0</td>
</tr>
<tr>
<td style="text-align: left;">H3K36me3</td>
<td style="text-align: center;">63.2</td>
<td style="text-align: center;">47.8</td>
<td style="text-align: center;">$\mathbf{6 5 . 3}$</td>
<td style="text-align: center;">53.4</td>
</tr>
<tr>
<td style="text-align: left;">H3K79me3</td>
<td style="text-align: center;">64.2</td>
<td style="text-align: center;">58.9</td>
<td style="text-align: center;">$\mathbf{7 1 . 6}$</td>
<td style="text-align: center;">59.7</td>
</tr>
<tr>
<td style="text-align: left;">H4</td>
<td style="text-align: center;">$\mathbf{8 2 . 2}$</td>
<td style="text-align: center;">77.7</td>
<td style="text-align: center;">79.6</td>
<td style="text-align: center;">79.1</td>
</tr>
<tr>
<td style="text-align: left;">H4ac</td>
<td style="text-align: center;">50.1</td>
<td style="text-align: center;">36.4</td>
<td style="text-align: center;">$\mathbf{6 3 . 7}$</td>
<td style="text-align: center;">43.5</td>
</tr>
<tr>
<td style="text-align: left;">Promoter all</td>
<td style="text-align: center;">$\mathbf{9 7 . 4}$</td>
<td style="text-align: center;">96.3</td>
<td style="text-align: center;">96.5</td>
<td style="text-align: center;">96.1</td>
</tr>
<tr>
<td style="text-align: left;">Promoter non-TATA</td>
<td style="text-align: center;">$\mathbf{9 7 . 7}$</td>
<td style="text-align: center;">96.6</td>
<td style="text-align: center;">96.6</td>
<td style="text-align: center;">96.5</td>
</tr>
<tr>
<td style="text-align: left;">Promoter TATA</td>
<td style="text-align: center;">96.4</td>
<td style="text-align: center;">96.6</td>
<td style="text-align: center;">$\mathbf{9 6 . 7}$</td>
<td style="text-align: center;">96.1</td>
</tr>
<tr>
<td style="text-align: left;">Splice acceptor</td>
<td style="text-align: center;">$\mathbf{9 9 . 0}$</td>
<td style="text-align: center;">97.6</td>
<td style="text-align: center;">96.6</td>
<td style="text-align: center;">96.6</td>
</tr>
<tr>
<td style="text-align: left;">Splice donor</td>
<td style="text-align: center;">$\mathbf{9 8 . 4}$</td>
<td style="text-align: center;">98.1</td>
<td style="text-align: center;">97.3</td>
<td style="text-align: center;">96.5</td>
</tr>
<tr>
<td style="text-align: left;">Splice all</td>
<td style="text-align: center;">$\mathbf{9 8 . 3}$</td>
<td style="text-align: center;">98.0</td>
<td style="text-align: center;">97.9</td>
<td style="text-align: center;">97.3</td>
</tr>
</tbody>
</table>
<h1>A. 3 In-Context Learning Details</h1>
<p>Background A key premise of foundation models is that they are able to learn new tasks with little to no new training data (Bommasani et al., 2021). Recent advances in language modeling have demonstrated that language foundation models can often adopt the behaviors necessary to perform new tasks in-context (Brown et al., 2020). Here, information about the task that is to be performed, such as examples of respective inputs and targets, are added to the input of the model. By conditioning their prediction on the provided context, language foundation models are generally able to perform the task without any changes to their parameters.</p>
<p>A key challenge for in-context learning with HyenaDNA is its limited vocabulary, which is composed of only a few nucleotides, and does not provide any vocabulary for novel downstream tasks, such as class labels. To explore the potential for in-context learning in genomics, we use two variants of in-context learning, both using a brief tuning phase to introduce HyenaDNA to the concept of classification with its existing vocabulary. As a test bed for this exploration, we use 5 datasets from the GenomicBenchmarks and a HyenaDNA pretrained on sequences of 160 k length sequences.</p>
<p>In the first experiment, we apply a soft prompting approach (Lester et al., 2021) by adding a sequence of tuneable tokens to the input inself. In the second experiment, we explore a few-shot learning approach (Brown et al., 2020) to in-context learning by adding $k$ demonstrations (DNA sequence and its label) for each class of a dataset as input to the model. To indicate classes, we make use of HyenaDNA's existing vocabulary by indicating classes with specific nucleotides. For binary classification, we indicate classes with the nucleotides "A" and "N", while additionally utilising nucleotide "G" for three-way classification. During model tuning, we thereby optimise the same next-nucleotide prediction loss as used during pretraining. See Table A. 7 for an overview of the optimisation settings.</p>
<p>Soft prompting details For each dataset, we prepend a sequence of $n$ (2 to 32 k ) learnable tokens $T_{e} \in$ $\mathbb{R}^{n \times d}$, each of dimension $d$, to the input sequences $X$ of the model: $\left{T_{e}, X, S E P\right}$, where "SEP" indicates the separation token. We optimise these tuneable tokens for a maximum of 20 training epochs on the dataset's training data while keeping all other model parameters fixed. We stop training early if the model's validation loss does not improve for two epochs. After this tuning phase, we evaluate the model's performance on the</p>
<p><img alt="img-4.jpeg" src="img-4.jpeg" /></p>
<p>Figure A.1: Few-shot prompting: HyenaDNA's performance on new tasks generally improves with the number of tuning samples, but is less clear when isolating the number of $k$-shot demonstrations. With less tuning samples, the number of $k$-shot demonstrations do not improve performance. As tuning samples increase, the number of $k$-shot demonstrations start to improve performance.
dataset's full validation data. For an overview of the results of this experiment, see Fig. 4.2 of the main text.</p>
<p>Few-shot prompting details For each dataset, we prepend a set of $k$ ( 0 to 32,0 indicates regular finetuning) examples of each class of a dataset (so-called "shots") to an input sequence:</p>
<p>$$
X: \quad\left{X_{1}, \text { SEP }, Y_{1}, \text { SEP }, X_{2}, \text { SEP }, Y_{2}, \text { SEP }, X, \text { SEP }\right}
$$</p>
<p>where $X_{i}$ indicates an example sequence of class $i$ with label $Y_{i}$ (exemplified for a two-way classification task). We tune the model on $n$ (2 to 256) such $k$-shot samples before evaluating its performance on the dataset's full validation data. For an overview of the results of this experiment, see Fig. A.1.</p>
<p>Table A.7: Optimization settings for in-context learning.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">Soft Prompting</th>
<th style="text-align: center;">Few-shot Prompting</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Optimizer</td>
<td style="text-align: center;">AdamW</td>
<td style="text-align: center;">AdamW</td>
</tr>
<tr>
<td style="text-align: left;">Optimizer momentum $\left(\beta_{1}, \beta_{2}\right)$</td>
<td style="text-align: center;">$0.9,0.999$</td>
<td style="text-align: center;">$0.9,0.999$</td>
</tr>
<tr>
<td style="text-align: left;">Learning Rate</td>
<td style="text-align: center;">0.001</td>
<td style="text-align: center;">0.0001</td>
</tr>
<tr>
<td style="text-align: left;">Batch Size</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">2</td>
</tr>
<tr>
<td style="text-align: left;">Weight Decay (model)</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: left;">Weight Decay (Hyena layers)</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: left;">Resid dropout</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr>
<td style="text-align: left;">Embed dropout</td>
<td style="text-align: center;">0.1</td>
<td style="text-align: center;">0.1</td>
</tr>
<tr>
<td style="text-align: left;">Reverse complement aug.</td>
<td style="text-align: center;">true</td>
<td style="text-align: center;">false</td>
</tr>
<tr>
<td style="text-align: left;">LR-schedule</td>
<td style="text-align: center;">Plateau</td>
<td style="text-align: center;">-</td>
</tr>
</tbody>
</table>
<h1>A. 4 Chromatin Profile Details</h1>
<p>Background Variations in non-coding regions of the genome account for the majority of disease and other trait-associated single-nucleotide polymorphisms (SNPs). For example, whilst not directly altering the sequence of an encoded protein, a SNP in a non-coding region can affect the expression of downstream genes by inducing a change in the epigenetic state (Zaina et al., 2010). Therefore predicting epigenetic markers from a given sequence is an important task in the context of quantifying the functional effects of non-coding variants. Previously DeepSEA (Zhou and Troyanskaya, 2015), a deep convolutional sequence model, has been introduced to predict chromatin features directly from non-coding sequences.</p>
<p>Data The authors of DeepSEA (Zhou and Troyanskaya, 2015) compiled a dataset of 919 chromatin features from (ENCODE Project Consortium, 2012) and (Roadmap Epigenomics Consortium, 2015) including 690 TF binding profiles for 160 different TFs, 125 DHS and 104 HM profiles. The original DeepSEA dataset</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{3}$ https://epd.epfl.ch//index.php&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>