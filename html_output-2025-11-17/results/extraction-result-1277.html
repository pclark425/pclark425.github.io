<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-1277 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-1277</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-1277</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-25.html">extraction-schema-25</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of AI agents using adaptive experimental design methods in unknown or partially observable environments, including the specific adaptation strategies, environment characteristics, and performance results.</div>
                <p><strong>Paper ID:</strong> paper-317cd4522b1f4a6f889743578143bb8823623f8b</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/317cd4522b1f4a6f889743578143bb8823623f8b" target="_blank">VIME: Variational Information Maximizing Exploration</a></p>
                <p><strong>Paper Venue:</strong> Neural Information Processing Systems</p>
                <p><strong>Paper TL;DR:</strong> VIME is introduced, an exploration strategy based on maximization of information gain about the agent's belief of environment dynamics which efficiently handles continuous state and action spaces and can be applied with several different underlying RL algorithms.</p>
                <p><strong>Cost:</strong> 0.012</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <div class="extraction-instance-container" id="e1277.0">
                <h3 class="extraction-instance">Extracted Data Instance 0 (e1277.0)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of AI agents using adaptive experimental design methods in unknown or partially observable environments, including the specific adaptation strategies, environment characteristics, and performance results.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>VIME</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Variational Information Maximizing Exploration</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A curiosity-driven exploration method that gives intrinsic rewards proportional to the information gain (KL divergence) about a Bayesian neural network dynamics model; implemented with variational inference for scalable continuous control.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>agent_name</strong></td>
                            <td>VIME (used with TRPO / REINFORCE / ERWR)</td>
                        </tr>
                        <tr>
                            <td><strong>agent_description</strong></td>
                            <td>A policy-gradient RL agent augmented with an intrinsic reward computed from a Bayesian neural network (BNN) dynamics model. The BNN uses a fully factorized Gaussian variational posterior q(θ;φ) parametrized by (μ,ρ), trained via stochastic gradient variational Bayes (SGVB) and the local reparameterization trick; intrinsic reward per transition is η · D_KL[q(θ;φ_{t+1}) || q(θ;φ_t)] (with normalization), and the agent optimizes total reward r' = r + intrinsic using standard RL optimizers (TRPO, REINFORCE, ERWR).</td>
                        </tr>
                        <tr>
                            <td><strong>adaptive_design_method</strong></td>
                            <td>Information-gain maximization / curiosity-driven exploration via variational Bayesian neural networks</td>
                        </tr>
                        <tr>
                            <td><strong>adaptation_strategy_description</strong></td>
                            <td>The agent maintains a posterior q(θ;φ) over dynamics parameters and periodically updates φ using transitions stored in a replay pool; for each observed (s_t,a_t,s_{t+1}) it computes the KL between updated and previous variational parameters as an intrinsic reward, normalized by recent median KLs, and uses this intrinsic reward added to external reward to bias action selection toward transitions that produce large posterior updates (i.e., high information gain). A second-order (H^{-1}∇) approximation is used to efficiently estimate the KL change for single-step updates.</td>
                        </tr>
                        <tr>
                            <td><strong>environment_name</strong></td>
                            <td>Continuous control benchmarks (MountainCar, CartPoleSwingup, CartPole, DoublePendulum, HalfCheetah, Walker2D, SwimmerGather)</td>
                        </tr>
                        <tr>
                            <td><strong>environment_characteristics</strong></td>
                            <td>Unknown dynamics (learned online), continuous state and action spaces, stochastic transitions (MDP setting), includes sparse-reward tasks and a hierarchical task; some tasks are high-dimensional and require complex locomotion primitives.</td>
                        </tr>
                        <tr>
                            <td><strong>environment_complexity</strong></td>
                            <td>Varies by task; examples from paper: CartPole S∈R^4, A∈R^1; CartPoleSwingup S∈R^4, A∈R^1; DoublePendulum S∈R^8, A∈R^1; MountainCar S∈R^3, A∈R^1; HalfCheetah S∈R^{30}, A∈R^6; Walker2D S∈R^{20}, A∈R^6; SwimmerGather S∈R^{33}, A∈R^2. Episode horizon T=500.</td>
                        </tr>
                        <tr>
                            <td><strong>uses_adaptive_design</strong></td>
                            <td>True</td>
                        </tr>
                        <tr>
                            <td><strong>performance_with_adaptation</strong></td>
                            <td>Qualitatively much better than heuristic exploration: VIME-enabled agents reliably reach goals on sparse-reward tasks where baselines rarely do (e.g., MountainCar goal reached, HalfCheetah forward distance >5 achieved, SwimmerGather learns locomotion primitives); median performance across 10 seeds and interquartile ranges reported in figures show faster learning and higher asymptotic returns for VIME variants. (Paper provides graphical results but no single aggregated numeric scalar in text.)</td>
                        </tr>
                        <tr>
                            <td><strong>performance_without_adaptation</strong></td>
                            <td>Baseline agents using naïve Gaussian control noise or simple ℓ^2 prediction-error intrinsic reward performed poorly on sparse tasks and often failed to reach goals; without VIME many methods almost never reached the goal within the same training runs.</td>
                        </tr>
                        <tr>
                            <td><strong>sample_efficiency</strong></td>
                            <td>Improved sample efficiency relative to baselines: VIME agents converge faster (higher returns in earlier iterations) across multiple tasks and avoid premature convergence in REINFORCE/ERWR; exact sample counts are task-dependent (training batch sizes, replay pool sizes, and number of epochs are reported), but figures show significant reduction in time-to-success compared to baselines using the same data budgets.</td>
                        </tr>
                        <tr>
                            <td><strong>exploration_exploitation_tradeoff</strong></td>
                            <td>Explicit via additive intrinsic reward r' = r + η·KL; η is a tunable positive hyperparameter controlling curiosity strength (higher η ⇒ more exploration; too large η prioritizes exploration over external reward, too small reduces to baseline). Intrinsic KLs are normalized by median KL over recent trajectories to emphasize relative novelty. The policy then optimizes expected discounted r'.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_methods</strong></td>
                            <td>Baselines: Gaussian control noise (action-space noise), ℓ^2 BNN prediction error as intrinsic reward (continuous extension of Stadie et al.), TRPO/REINFORCE/ERWR without VIME, Gaussian noise added to rewards; related mentions: ε-greedy/Boltzmann heuristics, optimism-based and Bayesian RL methods in related work.</td>
                        </tr>
                        <tr>
                            <td><strong>key_results</strong></td>
                            <td>VIME scales information-gain-driven exploration to high-dimensional continuous control by using variational BNNs; it yields substantially better performance on sparse-reward tasks and improves convergence and final performance across several RL algorithms. VIME induces more diffuse state visitation (more efficient exploration) than Gaussian action noise, helps avoid local optima for policy-gradient methods, and enables learning of complex locomotion primitives in hierarchical sparse domains (SwimmerGather) where naïve exploration fails.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_or_failures</strong></td>
                            <td>Requires a variational approximation (fully factorized Gaussian) which may limit posterior fidelity; computational overhead from maintaining/training a BNN and computing KL updates (mitigated via approximations); sensitivity to the η hyperparameter (too high harms extrinsic reward optimization, too low ineffective); in simple environments with well-shaped rewards (e.g., CartPole) improved exploration is unnecessary; no formal regret guarantees in continuous/high-dimensional settings are provided.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'VIME: Variational Information Maximizing Exploration', 'publication_date_yy_mm': '2016-05'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e1277.1">
                <h3 class="extraction-instance">Extracted Data Instance 1 (e1277.1)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of AI agents using adaptive experimental design methods in unknown or partially observable environments, including the specific adaptation strategies, environment characteristics, and performance results.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>L2-pred-error baseline</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>ℓ^2 BNN prediction error intrinsic reward (baseline)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A baseline intrinsic-motivation method that uses the squared prediction error of a learned predictive model as intrinsic reward to encourage exploration.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>agent_name</strong></td>
                            <td>RL with ℓ^2 prediction-error intrinsic reward (baseline)</td>
                        </tr>
                        <tr>
                            <td><strong>agent_description</strong></td>
                            <td>An RL agent (TRPO in experiments) that augments external reward with an intrinsic reward equal to the ℓ^2 prediction error of a forward dynamics model (continuous extension of prior work); the predictive model is trained to minimize squared error and larger errors incentivize visiting states where the model is inaccurate.</td>
                        </tr>
                        <tr>
                            <td><strong>adaptive_design_method</strong></td>
                            <td>Prediction-error-driven intrinsic motivation (model uncertainty proxy)</td>
                        </tr>
                        <tr>
                            <td><strong>adaptation_strategy_description</strong></td>
                            <td>The agent collects transitions, updates the predictive model, and uses instantaneous squared prediction errors on observed transitions as intrinsic reward to bias the policy toward regions with large prediction error (i.e., where the model is poor).</td>
                        </tr>
                        <tr>
                            <td><strong>environment_name</strong></td>
                            <td>Same continuous control benchmarks as VIME (MountainCar, CartPoleSwingup, HalfCheetah, etc.)</td>
                        </tr>
                        <tr>
                            <td><strong>environment_characteristics</strong></td>
                            <td>Unknown dynamics, continuous state/action spaces, includes sparse-reward tasks; same high-dimensional and hierarchical environments as in experiments.</td>
                        </tr>
                        <tr>
                            <td><strong>environment_complexity</strong></td>
                            <td>See VIME entry (same tasks and dimensions).</td>
                        </tr>
                        <tr>
                            <td><strong>uses_adaptive_design</strong></td>
                            <td>True</td>
                        </tr>
                        <tr>
                            <td><strong>performance_with_adaptation</strong></td>
                            <td>Performed poorly on sparse-reward tasks compared to VIME; in experiments ℓ^2 prediction-error intrinsic reward did not enable reliable achievement of sparse goals and generally underperformed VIME.</td>
                        </tr>
                        <tr>
                            <td><strong>performance_without_adaptation</strong></td>
                            <td>When ℓ^2 intrinsic reward was not used (i.e., only Gaussian noise), agents typically performed as poorly or worse; ℓ^2 baseline was not sufficient to solve many sparse tasks.</td>
                        </tr>
                        <tr>
                            <td><strong>sample_efficiency</strong></td>
                            <td>Lower than VIME on sparse tasks; did not produce the same rapid progress toward task goals with the same sample budget.</td>
                        </tr>
                        <tr>
                            <td><strong>exploration_exploitation_tradeoff</strong></td>
                            <td>Exploration encouraged where instantaneous prediction error is high; lacks a principled information-gain normalization and therefore can be less stable or less focused than KL-based intrinsic rewards.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_methods</strong></td>
                            <td>Compared directly to VIME and naïve Gaussian control noise baselines in paper experiments.</td>
                        </tr>
                        <tr>
                            <td><strong>key_results</strong></td>
                            <td>Simple prediction-error intrinsic rewards are insufficient in many sparse continuous control tasks; VIME's information-gain intrinsic reward substantially outperforms ℓ^2 prediction-error baselines.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_or_failures</strong></td>
                            <td>Tends to produce less informative exploration patterns (e.g., may chase outliers or stochastic noise), fails on many sparse and hierarchical tasks where VIME succeeds; lacks the Bayesian posterior-update interpretation that makes VIME robust.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'VIME: Variational Information Maximizing Exploration', 'publication_date_yy_mm': '2016-05'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>Planning to be surprised: Optimal Bayesian exploration in dynamic environments <em>(Rating: 2)</em></li>
                <li>Incentivizing exploration in reinforcement learning with deep predictive models <em>(Rating: 2)</em></li>
                <li>Variational information maximisation for intrinsically motivated reinforcement learning <em>(Rating: 2)</em></li>
                <li>Curious model-building control systems <em>(Rating: 1)</em></li>
                <li>Near-Bayesian exploration in polynomial time <em>(Rating: 1)</em></li>
                <li>Deep exploration via bootstrapped DQN <em>(Rating: 1)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-1277",
    "paper_id": "paper-317cd4522b1f4a6f889743578143bb8823623f8b",
    "extraction_schema_id": "extraction-schema-25",
    "extracted_data": [
        {
            "name_short": "VIME",
            "name_full": "Variational Information Maximizing Exploration",
            "brief_description": "A curiosity-driven exploration method that gives intrinsic rewards proportional to the information gain (KL divergence) about a Bayesian neural network dynamics model; implemented with variational inference for scalable continuous control.",
            "citation_title": "here",
            "mention_or_use": "use",
            "agent_name": "VIME (used with TRPO / REINFORCE / ERWR)",
            "agent_description": "A policy-gradient RL agent augmented with an intrinsic reward computed from a Bayesian neural network (BNN) dynamics model. The BNN uses a fully factorized Gaussian variational posterior q(θ;φ) parametrized by (μ,ρ), trained via stochastic gradient variational Bayes (SGVB) and the local reparameterization trick; intrinsic reward per transition is η · D_KL[q(θ;φ_{t+1}) || q(θ;φ_t)] (with normalization), and the agent optimizes total reward r' = r + intrinsic using standard RL optimizers (TRPO, REINFORCE, ERWR).",
            "adaptive_design_method": "Information-gain maximization / curiosity-driven exploration via variational Bayesian neural networks",
            "adaptation_strategy_description": "The agent maintains a posterior q(θ;φ) over dynamics parameters and periodically updates φ using transitions stored in a replay pool; for each observed (s_t,a_t,s_{t+1}) it computes the KL between updated and previous variational parameters as an intrinsic reward, normalized by recent median KLs, and uses this intrinsic reward added to external reward to bias action selection toward transitions that produce large posterior updates (i.e., high information gain). A second-order (H^{-1}∇) approximation is used to efficiently estimate the KL change for single-step updates.",
            "environment_name": "Continuous control benchmarks (MountainCar, CartPoleSwingup, CartPole, DoublePendulum, HalfCheetah, Walker2D, SwimmerGather)",
            "environment_characteristics": "Unknown dynamics (learned online), continuous state and action spaces, stochastic transitions (MDP setting), includes sparse-reward tasks and a hierarchical task; some tasks are high-dimensional and require complex locomotion primitives.",
            "environment_complexity": "Varies by task; examples from paper: CartPole S∈R^4, A∈R^1; CartPoleSwingup S∈R^4, A∈R^1; DoublePendulum S∈R^8, A∈R^1; MountainCar S∈R^3, A∈R^1; HalfCheetah S∈R^{30}, A∈R^6; Walker2D S∈R^{20}, A∈R^6; SwimmerGather S∈R^{33}, A∈R^2. Episode horizon T=500.",
            "uses_adaptive_design": true,
            "performance_with_adaptation": "Qualitatively much better than heuristic exploration: VIME-enabled agents reliably reach goals on sparse-reward tasks where baselines rarely do (e.g., MountainCar goal reached, HalfCheetah forward distance &gt;5 achieved, SwimmerGather learns locomotion primitives); median performance across 10 seeds and interquartile ranges reported in figures show faster learning and higher asymptotic returns for VIME variants. (Paper provides graphical results but no single aggregated numeric scalar in text.)",
            "performance_without_adaptation": "Baseline agents using naïve Gaussian control noise or simple ℓ^2 prediction-error intrinsic reward performed poorly on sparse tasks and often failed to reach goals; without VIME many methods almost never reached the goal within the same training runs.",
            "sample_efficiency": "Improved sample efficiency relative to baselines: VIME agents converge faster (higher returns in earlier iterations) across multiple tasks and avoid premature convergence in REINFORCE/ERWR; exact sample counts are task-dependent (training batch sizes, replay pool sizes, and number of epochs are reported), but figures show significant reduction in time-to-success compared to baselines using the same data budgets.",
            "exploration_exploitation_tradeoff": "Explicit via additive intrinsic reward r' = r + η·KL; η is a tunable positive hyperparameter controlling curiosity strength (higher η ⇒ more exploration; too large η prioritizes exploration over external reward, too small reduces to baseline). Intrinsic KLs are normalized by median KL over recent trajectories to emphasize relative novelty. The policy then optimizes expected discounted r'.",
            "comparison_methods": "Baselines: Gaussian control noise (action-space noise), ℓ^2 BNN prediction error as intrinsic reward (continuous extension of Stadie et al.), TRPO/REINFORCE/ERWR without VIME, Gaussian noise added to rewards; related mentions: ε-greedy/Boltzmann heuristics, optimism-based and Bayesian RL methods in related work.",
            "key_results": "VIME scales information-gain-driven exploration to high-dimensional continuous control by using variational BNNs; it yields substantially better performance on sparse-reward tasks and improves convergence and final performance across several RL algorithms. VIME induces more diffuse state visitation (more efficient exploration) than Gaussian action noise, helps avoid local optima for policy-gradient methods, and enables learning of complex locomotion primitives in hierarchical sparse domains (SwimmerGather) where naïve exploration fails.",
            "limitations_or_failures": "Requires a variational approximation (fully factorized Gaussian) which may limit posterior fidelity; computational overhead from maintaining/training a BNN and computing KL updates (mitigated via approximations); sensitivity to the η hyperparameter (too high harms extrinsic reward optimization, too low ineffective); in simple environments with well-shaped rewards (e.g., CartPole) improved exploration is unnecessary; no formal regret guarantees in continuous/high-dimensional settings are provided.",
            "uuid": "e1277.0",
            "source_info": {
                "paper_title": "VIME: Variational Information Maximizing Exploration",
                "publication_date_yy_mm": "2016-05"
            }
        },
        {
            "name_short": "L2-pred-error baseline",
            "name_full": "ℓ^2 BNN prediction error intrinsic reward (baseline)",
            "brief_description": "A baseline intrinsic-motivation method that uses the squared prediction error of a learned predictive model as intrinsic reward to encourage exploration.",
            "citation_title": "",
            "mention_or_use": "use",
            "agent_name": "RL with ℓ^2 prediction-error intrinsic reward (baseline)",
            "agent_description": "An RL agent (TRPO in experiments) that augments external reward with an intrinsic reward equal to the ℓ^2 prediction error of a forward dynamics model (continuous extension of prior work); the predictive model is trained to minimize squared error and larger errors incentivize visiting states where the model is inaccurate.",
            "adaptive_design_method": "Prediction-error-driven intrinsic motivation (model uncertainty proxy)",
            "adaptation_strategy_description": "The agent collects transitions, updates the predictive model, and uses instantaneous squared prediction errors on observed transitions as intrinsic reward to bias the policy toward regions with large prediction error (i.e., where the model is poor).",
            "environment_name": "Same continuous control benchmarks as VIME (MountainCar, CartPoleSwingup, HalfCheetah, etc.)",
            "environment_characteristics": "Unknown dynamics, continuous state/action spaces, includes sparse-reward tasks; same high-dimensional and hierarchical environments as in experiments.",
            "environment_complexity": "See VIME entry (same tasks and dimensions).",
            "uses_adaptive_design": true,
            "performance_with_adaptation": "Performed poorly on sparse-reward tasks compared to VIME; in experiments ℓ^2 prediction-error intrinsic reward did not enable reliable achievement of sparse goals and generally underperformed VIME.",
            "performance_without_adaptation": "When ℓ^2 intrinsic reward was not used (i.e., only Gaussian noise), agents typically performed as poorly or worse; ℓ^2 baseline was not sufficient to solve many sparse tasks.",
            "sample_efficiency": "Lower than VIME on sparse tasks; did not produce the same rapid progress toward task goals with the same sample budget.",
            "exploration_exploitation_tradeoff": "Exploration encouraged where instantaneous prediction error is high; lacks a principled information-gain normalization and therefore can be less stable or less focused than KL-based intrinsic rewards.",
            "comparison_methods": "Compared directly to VIME and naïve Gaussian control noise baselines in paper experiments.",
            "key_results": "Simple prediction-error intrinsic rewards are insufficient in many sparse continuous control tasks; VIME's information-gain intrinsic reward substantially outperforms ℓ^2 prediction-error baselines.",
            "limitations_or_failures": "Tends to produce less informative exploration patterns (e.g., may chase outliers or stochastic noise), fails on many sparse and hierarchical tasks where VIME succeeds; lacks the Bayesian posterior-update interpretation that makes VIME robust.",
            "uuid": "e1277.1",
            "source_info": {
                "paper_title": "VIME: Variational Information Maximizing Exploration",
                "publication_date_yy_mm": "2016-05"
            }
        }
    ],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "Planning to be surprised: Optimal Bayesian exploration in dynamic environments",
            "rating": 2
        },
        {
            "paper_title": "Incentivizing exploration in reinforcement learning with deep predictive models",
            "rating": 2
        },
        {
            "paper_title": "Variational information maximisation for intrinsically motivated reinforcement learning",
            "rating": 2
        },
        {
            "paper_title": "Curious model-building control systems",
            "rating": 1
        },
        {
            "paper_title": "Near-Bayesian exploration in polynomial time",
            "rating": 1
        },
        {
            "paper_title": "Deep exploration via bootstrapped DQN",
            "rating": 1
        }
    ],
    "cost": 0.01197975,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>VIME: Variational Information Maximizing Exploration</h1>
<p>Rein Houthooft ${ }^{\S 1 \mathrm{~T}}$, Xi Chen ${ }^{\mathrm{TI}}$, Yan Duan ${ }^{\mathrm{TI}}$, John Schulman ${ }^{\mathrm{TI}}$, Filip De Turck ${ }^{\S}$, Pieter Abbeel ${ }^{\mathrm{TI}}$<br>${ }^{\text {T }}$ UC Berkeley, Department of Electrical Engineering and Computer Sciences<br>${ }^{\S}$ Ghent University - imec, Department of Information Technology<br>${ }^{\text {I }}$ OpenAI</p>
<h4>Abstract</h4>
<p>Scalable and effective exploration remains a key challenge in reinforcement learning (RL). While there are methods with optimality guarantees in the setting of discrete state and action spaces, these methods cannot be applied in high-dimensional deep RL scenarios. As such, most contemporary RL relies on simple heuristics such as $\epsilon$-greedy exploration or adding Gaussian noise to the controls. This paper introduces Variational Information Maximizing Exploration (VIME), an exploration strategy based on maximization of information gain about the agent's belief of environment dynamics. We propose a practical implementation, using variational inference in Bayesian neural networks which efficiently handles continuous state and action spaces. VIME modifies the MDP reward function, and can be applied with several different underlying RL algorithms. We demonstrate that VIME achieves significantly better performance compared to heuristic exploration methods across a variety of continuous control tasks and algorithms, including tasks with very sparse rewards.</p>
<h2>1 Introduction</h2>
<p>Reinforcement learning (RL) studies how an agent can maximize its cumulative reward in a previously unknown environment, which it learns about through experience. A long-standing problem is how to manage the trade-off between exploration and exploitation. In exploration, the agent experiments with novel strategies that may improve returns in the long run; in exploitation, it maximizes rewards through behavior that is known to be successful. An effective exploration strategy allows the agent to generate trajectories that are maximally informative about the environment. For small tasks, this trade-off can be handled effectively through Bayesian RL [1] and PAC-MDP methods [2-6], which offer formal guarantees. However, these guarantees assume discrete state and action spaces. Hence, in settings where state-action discretization is infeasible, many RL algorithms use heuristic exploration strategies. Examples include acting randomly using $\epsilon$-greedy or Boltzmann exploration [7], and utilizing Gaussian noise on the controls in policy gradient methods [8]. These heuristics often rely on random walk behavior which can be highly inefficient, for example Boltzmann exploration requires a training time exponential in the number of states in order to solve the well-known $n$-chain MDP [9]. In between formal methods and simple heuristics, several works have proposed to address the exploration problem using less formal, but more expressive methods [10-14]. However, none of them fully address exploration in continuous control, as discretization of the state-action space scales exponentially in its dimensionality. For example, the Walker2D task [15] has a 26-dim state-action space. If we assume a coarse discretization into 10 bins for each dimension, a table of state-action visitation counts would require $10^{20}$ entries.</p>
<p>This paper proposes a curiosity-driven exploration strategy, making use of information gain about the agent’s internal belief of the dynamics model as a driving force. This principle can be traced back to the concepts of curiosity and surprise [16-18]. Within this framework, agents are encouraged to take actions that result in states they deem surprising—i.e., states that cause large updates to the dynamics model distribution. We propose a practical implementation of measuring information gain using variational inference. Herein, the agent’s current understanding of the environment dynamics is represented by a Bayesian neural network (BNN) [19, 20]. We also show how this can be interpreted as measuring compression improvement, a proposed model of curiosity [21]. In contrast to previous curiosity-based approaches [10, 22], our model scales naturally to continuous state and action spaces. The presented approach is evaluated on a range of continuous control tasks, and multiple underlying RL algorithms. Experimental results show that VIME achieves significantly better performance than naïve exploration strategies.</p>
<h2>2 Methodology</h2>
<p>In Section 2.1, we establish notation for the subsequent equations. Next, in Section 2.2, we explain the theoretical foundation of curiosity-driven exploration. In Section 2.3 we describe how to adapt this idea to continuous control, and we show how to build on recent advances in variational inference for Bayesian neural networks (BNNs) to make this formulation practical. Thereafter, we make explicit the intuitive link between compression improvement and the variational lower bound in Section 2.4. Finally, Section 2.5 describes how our method is practically implemented.</p>
<h3>2.1 Preliminaries</h3>
<p>This paper assumes a finite-horizon discounted Markov decision process (MDP), defined by $(\mathcal{S},\mathcal{A},\mathcal{P},r, \rho_{0}, \gamma, T)$, in which $\mathcal{S} \subseteq \mathbb{R}^{n}$ is a state set, $\mathcal{A} \subseteq \mathbb{R}^{m}$ an action set, $\mathcal{P}: \mathcal{S} \times \mathcal{A} \times \mathcal{S} \rightarrow \mathbb{R}<em 0="0">{\geq 0}$ a transition probability distribution, $r: \mathcal{S} \times \mathcal{A} \rightarrow \mathbb{R}$ a bounded reward function, $\rho</em>}: \mathcal{S} \rightarrow \mathbb{R<em _alpha="\alpha">{\geq 0}$ an initial state distribution, $\gamma \in(0,1]$ a discount factor, and $T$ the horizon. States and actions viewed as random variables are abbreviated as $S$ and $A$. The presented models are based on the optimization of a stochastic policy $\pi</em>}: \mathcal{S} \times \mathcal{A} \rightarrow \mathbb{R<em _alpha="\alpha">{\geq 0}$, parametrized by $\alpha$. Let $\mu\left(\pi</em>}\right)$ denote its expected discounted return: $\mu\left(\pi_{\alpha}\right)=\mathbb{E<em t="0">{\tau}\left[\sum</em>\right)$.}^{T} \gamma^{t} r\left(s_{t}, a_{t}\right)\right]$, where $\tau=\left(s_{0}, a_{0}, \ldots\right)$ denotes the whole trajectory, $s_{0} \sim \rho_{0}\left(s_{0}\right), a_{t} \sim \pi_{\alpha}\left(a_{t} \mid s_{t}\right)$, and $s_{t+1} \sim \mathcal{P}\left(s_{t+1} \mid s_{t}, a_{t</p>
<h3>2.2 Curiosity</h3>
<p>Our method builds on the theory of curiosity-driven exploration [16, 17, 21, 22], in which the agent engages in systematic exploration by seeking out state-action regions that are relatively unexplored. The agent models the environment dynamics via a model $p\left(s_{t+1} \mid s_{t}, a_{t} ; \theta\right)$, parametrized by the random variable $\Theta$ with values $\theta \in \boldsymbol{\Theta}$. Assuming a prior $p(\theta)$, it maintains a distribution over dynamic models through a distribution over $\theta$, which is updated in a Bayesian manner (as opposed to a point estimate). The history of the agent up until time step $t$ is denoted as $\xi_{t}=\left{s_{1}, a_{1}, \ldots, s_{t}\right}$. According to curiosity-driven exploration [17], the agent should take actions that maximize the reduction in uncertainty about the dynamics. This can be formalized as maximizing the sum of reductions in entropy</p>
<p>$$
\sum_{t}\left(H\left(\Theta \mid \xi_{t}, a_{t}\right)-H\left(\Theta \mid S_{t+1}, \xi_{t}, a_{t}\right)\right)
$$</p>
<p>through a sequence of actions $\left{a_{t}\right}$. According to information theory, the individual terms equal the mutual information between the next state distribution $S_{t+1}$ and the model parameter $\Theta$, namely $I\left(S_{t+1} ; \Theta \mid \xi_{t}, a_{t}\right)$. Therefore, the agent is encouraged to take actions that lead to states that are maximally informative about the dynamics model. Furthermore, we note that</p>
<p>$$
I\left(S_{t+1} ; \Theta \mid \xi_{t}, a_{t}\right)=\mathbb{E}<em t_1="t+1">{s</em>\right)\right]\right]
$$} \sim \mathcal{P}\left(\cdot \mid \xi_{t}, a_{t}\right)}\left[D_{\mathrm{KL}}\left[p\left(\theta \mid \xi_{t}, a_{t}, s_{t+1}\right) | p\left(\theta \mid \xi_{t</p>
<p>the KL divergence from the agent's new belief over the dynamics model to the old one, taking expectation over all possible next states according to the true dynamics $\mathcal{P}$. This KL divergence can be interpreted as information gain.</p>
<p>If calculating the posterior dynamics distribution is tractable, it is possible to optimize Eq. (2) directly by maintaining a belief over the dynamics model [17]. However, this is not generally the case. Therefore, a common practice [10; 23] is to use RL to approximate planning for maximal mutual information along a trajectory $\sum_{t} I\left(S_{t+1} ;\Theta \mid \xi_{t}, a_{t}\right)$ by adding each term $I\left(S_{t+1} ; \Theta \mid \xi_{t}, a_{t}\right)$ as an intrinsic reward, which captures the agent's surprise in the form of a reward function. This is practically realized by taking actions $a_{t} \sim \pi_{\alpha}\left(s_{t}\right)$ and sampling $s_{t+1} \sim \mathcal{P}\left(\cdot \mid s_{t}, a_{t}\right)$ in order to add $D_{\mathrm{KL}}\left[p\left(\theta \mid \xi_{t}, a_{t}, s_{t+1}\right) | p\left(\theta \mid \xi_{t}\right)\right]$ to the external reward. The trade-off between exploitation and exploration can now be realized explicitly as follows:</p>
<p>$$
r^{\prime}\left(s_{t}, a_{t}, s_{t+1}\right)=r\left(s_{t}, a_{t}\right)+\eta D_{\mathrm{KL}}\left[p\left(\theta \mid \xi_{t}, a_{t}, s_{t+1}\right) | p\left(\theta \mid \xi_{t}\right)\right]
$$</p>
<p>with $\eta \in \mathbb{R}<em t="t">{+}$a hyperparameter controlling the urge to explore. In conclusion, the biggest practical issue with maximizing information gain for exploration is that the computation of Eq. (3) requires calculating the posterior $p\left(\theta \mid \xi</em>\right)$, which is generally intractable.}, a_{t}, s_{t+1</p>
<h1>2.3 Variational Bayes</h1>
<p>We propose a tractable solution to maximize the information gain objective presented in the previous section. In a purely Bayesian setting, we can derive the posterior distribution given a new state-action pair through Bayes' rule as</p>
<p>$$
p\left(\theta \mid \xi_{t}, a_{t}, s_{t+1}\right)=\frac{p\left(\theta \mid \xi_{t}\right) p\left(s_{t+1} \mid \xi_{t}, a_{t} ; \theta\right)}{p\left(s_{t+1} \mid \xi_{t}, a_{t}\right)}
$$</p>
<p>with $p\left(\theta \mid \xi_{t}, a_{t}\right)=p\left(\theta \mid \xi_{t}\right)$ as actions do not influence beliefs about the environment [17]. Herein, the denominator is computed through the integral</p>
<p>$$
p\left(s_{t+1} \mid \xi_{t}, a_{t}\right)=\int_{\Theta} p\left(s_{t+1} \mid \xi_{t}, a_{t} ; \theta\right) p\left(\theta \mid \xi_{t}\right) d \theta
$$</p>
<p>In general, this integral tends to be intractable when using highly expressive parametrized models (e.g., neural networks), which are often needed to accurately capture the environment model in high-dimensional continuous control.</p>
<p>We propose a practical solution through variational inference [24]. Herein, we embrace the fact that calculating the posterior $p(\theta \mid \mathcal{D})$ for a data set $\mathcal{D}$ is intractable. Instead we approximate it through an alternative distribution $q(\theta ; \phi)$, parametrized by $\phi$, by minimizing $D_{\mathrm{KL}}[q(\theta ; \phi) | p(\theta \mid \mathcal{D})]$. This is done through maximization of the variational lower bound $L[q(\theta ; \phi), \mathcal{D}]$ :</p>
<p>$$
L[q(\theta ; \phi), \mathcal{D}]=\mathbb{E}<em _mathrm_KL="\mathrm{KL">{\theta \sim q(\cdot ; \phi)}[\log p(\mathcal{D} \mid \theta)]-D</em>[q(\theta ; \phi) | p(\theta)]
$$}</p>
<p>Rather than computing information gain in Eq. (3) explicitly, we compute an approximation to it, leading to the following total reward:</p>
<p>$$
r^{\prime}\left(s_{t}, a_{t}, s_{t+1}\right)=r\left(s_{t}, a_{t}\right)+\eta D_{\mathrm{KL}}\left[q\left(\theta ; \phi_{t+1}\right) | q\left(\theta ; \phi_{t}\right)\right]
$$</p>
<p>with $\phi_{t+1}$ the updated and $\phi_{t}$ the old parameters representing the agent's belief. Natural candidates for parametrizing the agent's dynamics model are Bayesian neural networks (BNNs) [19], as they maintain a distribution over their weights. This allows us to view the BNN as an infinite neural network ensemble by integrating out its parameters:</p>
<p>$$
p(y \mid x)=\int_{\Theta} p(y \mid x ; \theta) q(\theta ; \phi) d \theta
$$</p>
<p>In particular, we utilize a BNN parametrized by a fully factorized Gaussian distribution [20]. Practical BNN implementation details are deferred to Section 2.5, while we give some intuition into the behavior of BNNs in the appendix.</p>
<h3>2.4 Compression</h3>
<p>It is possible to derive an interesting relationship between compression improvement-an intrinsic reward objective defined in [25], and the information gain of Eq. (2). In [25], the agent's curiosity is</p>
<p>equated with compression improvement, measured through $C\left(\xi_{t} ; \phi_{t-1}\right)-C\left(\xi_{t} ; \phi_{t}\right)$, where $C(\xi ; \phi)$ is the description length of $\xi$ using $\phi$ as a model. Furthermore, it is known that the negative variational lower bound can be viewed as the description length [19]. Hence, we can write compression improvement as $L\left[q\left(\theta ; \phi_{t}\right), \xi_{t}\right]-L\left[q\left(\theta ; \phi_{t-1}\right), \xi_{t}\right]$. In addition, an alternative formulation of the variational lower bound in Eq. (6) is given by</p>
<p>$$
\log p(\mathcal{D})=\overbrace{\int_{\Theta} q(\theta ; \phi) \log \frac{p(\theta, \mathcal{D})}{q(\theta ; \phi)} d \theta}^{\mathcal{L}\left[q(\theta ; \phi) \mid \mid p(\theta \mid \mathcal{D})\right]}
$$</p>
<p>Thus, compression improvement can now be written as</p>
<p>$$
\left(\log p\left(\xi_{t}\right)-D_{\mathrm{KL}}\left[q\left(\theta ; \phi_{t}\right) | p\left(\theta \mid \xi_{t}\right)\right]\right)-\left(\log p\left(\xi_{t}\right)-D_{\mathrm{KL}}\left[q\left(\theta ; \phi_{t-1}\right) | p\left(\theta \mid \xi_{t}\right)\right]\right)
$$</p>
<p>If we assume that $\phi_{t}$ perfectly optimizes the variational lower bound for the history $\xi_{t}$, then $D_{\mathrm{KL}}\left[q\left(\theta ; \phi_{t}\right) | p\left(\theta \mid \xi_{t}\right)\right]=0$, which occurs when the approximation equals the true posterior, i.e., $q\left(\theta ; \phi_{t}\right)=p\left(\theta \mid \xi_{t}\right)$. Hence, compression improvement becomes $D_{\mathrm{KL}}\left[p\left(\theta \mid \xi_{t-1}\right) | p\left(\theta \mid \xi_{t}\right)\right]$. Therefore, optimizing for compression improvement comes down to optimizing the KL divergence from the posterior given the past history $\xi_{t-1}$ to the posterior given the total history $\xi_{t}$. As such, we arrive at an alternative way to encode curiosity than information gain, namely $D_{\mathrm{KL}}\left[p\left(\theta \mid \xi_{t}\right) | p\left(\theta \mid \xi_{t}, a_{t}, s_{t+1}\right)\right]$, its reversed KL divergence. In experiments, we noticed no significant difference between the two KL divergence variants. This can be explained as both variants are locally equal when introducing small changes to the parameter distributions. Investigation of how to combine both information gain and compression improvement is deferred to future work.</p>
<h1>2.5 Implementation</h1>
<p>The complete method is summarized in Algorithm 1. We first set forth implementation and parametrization details of the dynamics BNN. The BNN weight distribution $q(\theta ; \phi)$ is given by the fully factorized Gaussian distribution [20]:</p>
<p>$$
q(\theta ; \phi)=\prod_{i=1}^{|\Theta|} \mathcal{N}\left(\theta_{i} \mid \mu_{i} ; \sigma_{i}^{2}\right)
$$</p>
<p>Hence, $\phi={\mu, \sigma}$, with $\mu$ the Gaussian's mean vector and $\sigma$ the covariance matrix diagonal. This is particularly convenient as it allows for a simple analytical formulation of the KL divergence. This is described later in this section. Because of the restriction $\sigma&gt;0$, the standard deviation of the Gaussian BNN parameter is parametrized as $\sigma=\log \left(1+e^{\rho}\right)$, with $\rho \in \mathbb{R}$ [20].</p>
<p>Now the training of the dynamics BNN through optimization of the variational lower bound is described. The second term in Eq. (6) is approximated through sampling $\mathbb{E}<em i="1">{\theta \sim q(\cdot ; \phi)}[\log p(\mathcal{D} \mid \theta)] \approx$ $\frac{1}{N} \sum</em>\right)$. This is to break up the strong intratrajectory sample correlation which destabilizes learning in favor of obtaining i.i.d. data [7]. Moreover, it diminishes the effect of compounding posterior approximation errors.}^{N} \log p\left(\mathcal{D} \mid \theta_{i}\right)$ with $N$ samples drawn according to $\theta \sim q(\cdot ; \phi)$ [20]. Optimizing the variational lower bound in Eq. (6) in combination with the reparametrization trick is called stochastic gradient variational Bayes (SGVB) [26] or Bayes by Backprop [20]. Furthermore, we make use of the local reparametrization trick proposed in [26], in which sampling at the weights is replaced by sampling the neuron pre-activations, which is more computationally efficient and reduces gradient variance. The optimization of the variational lower bound is done at regular intervals during the RL training process, by sampling $\mathcal{D}$ from a FIFO replay pool that stores recent samples $\left(s_{t}, a_{t}, s_{t+1</p>
<p>The posterior distribution of the dynamics parameter, which is needed to compute the KL divergence in the total reward function $r^{\prime}$ of Eq. (7), can be computed through the following minimization</p>
<p>$$
\phi^{\prime}=\underset{\phi}{\arg \min }\left[\frac{\frac{\ell\left(q(\theta ; \phi), s_{t}\right)}{\ell\left(q(\theta ; \phi)\right)}}{\ell_{\mathrm{KL}}(q(\theta ; \phi))}-\mathbb{E}<em t="t">{\theta \sim q(\cdot ; \phi)}\left[\log p\left(s</em> ; \theta\right)\right]\right]
$$} \mid \xi_{t}, a_{t</p>
<p>where we replace the expectation over $\theta$ with samples $\theta \sim q(\cdot ; \phi)$. Because we only update the model periodically based on samples drawn from the replay pool, this optimization can be performed in parallel for each $s_{t}$, keeping $\phi_{t-1}$ fixed. Once $\phi^{\prime}$ has been obtained, we can use it to compute the intrinsic reward.</p>
<p>for each epoch $n$ do
for each timestep $t$ in each trajectory generated during $n$ do
Generate action $a_{t} \sim \pi_{\alpha}\left(s_{t}\right)$ and sample state $s_{t+1} \sim \mathcal{P}\left(\cdot \mid \xi_{t}, a_{t}\right)$, get $r\left(s_{t}, a_{t}\right)$.
Add triplet $\left(s_{t}, a_{t}, s_{t+1}\right)$ to FIFO replay pool $\mathcal{R}$.
Compute $D_{\mathrm{KL}}\left[q\left(\theta ; \phi_{n+1}^{\prime}\right) | q\left(\theta ; \phi_{n+1}\right)\right]$ by approximation $\nabla^{\top} H^{-1} \nabla$, following Eq. (16) for diagonal BNNs, or by optimizing Eq. (12) to obtain $\phi_{n+1}^{\prime}$ for general BNNs.
Divide $D_{\mathrm{KL}}\left[q\left(\theta ; \phi_{n+1}^{\prime}\right) | q\left(\theta ; \phi_{n+1}\right)\right]$ by median of previous KL divergences.
Construct $r^{\prime}\left(s_{t}, a_{t}, s_{t+1}\right) \leftarrow r\left(s_{t}, a_{t}\right)+\eta D_{\mathrm{KL}}\left[q\left(\theta ; \phi_{n+1}^{\prime}\right) | q\left(\theta ; \phi_{n+1}\right)\right]$, following Eq. (7).
Minimize $D_{\mathrm{KL}}\left[q\left(\theta ; \phi_{n}\right) | p(\theta)\right]-\mathbb{E}<em n="n">{\theta \sim q\left(\cdot ; \phi</em>\right)$.
Use rewards $\left{r^{\prime}\left(s_{t}, a_{t}, s_{t+1}\right)\right}$ to update policy $\pi_{\alpha}$ using any standard RL method.}\right)}[\log p(\mathcal{D} \mid \theta)]$ following Eq. (6), with $\mathcal{D}$ sampled randomly from $\mathcal{R}$, leading to updated posterior $q\left(\theta ; \phi_{n+1</p>
<p>To optimize Eq. (12) efficiently, we only take a single second-order step. This way, the gradient is rescaled according to the curvature of the KL divergence at the origin. As such, we compute $D_{\mathrm{KL}}[q(\theta ; \phi+\lambda \Delta \phi) | q(\theta ; \phi)]$, with the update step $\Delta \phi$ defined as</p>
<p>$$
\Delta \phi=H^{-1}(\ell) \nabla_{\phi} \ell\left(q(\theta ; \phi), s_{t}\right)
$$</p>
<p>in which $H(\ell)$ is the Hessian of $\ell\left(q(\theta ; \phi), s_{t}\right)$. Since we assume that the variational approximation is a fully factorized Gaussian, the KL divergence from posterior to prior has a particularly simple form:</p>
<p>$$
D_{\mathrm{KL}}[q(\theta ; \phi) | q\left(\theta ; \phi^{\prime}\right)]=\frac{1}{2} \sum_{i=1}^{|\Theta|}\left(\left(\frac{\sigma_{i}}{\sigma_{i}^{\prime}}\right)^{2}+2 \log \sigma_{i}^{\prime}-2 \log \sigma_{i}+\frac{\left(\mu_{i}^{\prime}-\mu\right) 2}{\sigma_{i}^{\prime 2}}\right)-\frac{|\Theta|}{2}
$$</p>
<p>Because this KL divergence is approximately quadratic in its parameters and the log-likelihood term can be seen as locally linear compared to this highly curved KL term, we approximate $H$ by only calculating it for the term KL term $\ell_{\mathrm{KL}}(q(\theta ; \phi))$. This can be computed very efficiently in case of a fully factorized Gaussian distribution, as this approximation becomes a diagonal matrix. Looking at Eq. (14), we can calculate the following Hessian at the origin. The $\mu$ and $\rho$ entries are defined as</p>
<p>$$
\frac{\partial^{2} \ell_{\mathrm{KL}}}{\partial \mu_{i}^{2}}=\frac{1}{\log ^{2}\left(1+e^{\rho_{i}}\right)} \quad \text { and } \quad \frac{\partial^{2} \ell_{\mathrm{KL}}}{\partial \rho_{i}^{4}}=\frac{2 e^{2 \rho_{i}}}{\left(1+e^{\rho_{i}}\right)^{2}} \frac{1}{\log ^{2}\left(1+e^{\rho_{i}}\right)}
$$</p>
<p>while all other entries are zero. Furthermore, it is also possible to approximate the KL divergence through a second-order Taylor expansion as $\frac{1}{2} \Delta \phi H \Delta \phi=\frac{1}{2}\left(H^{-1} \nabla\right)^{\top} H\left(H^{-1} \nabla\right)$, since both the value and gradient of the KL divergence are zero at the origin. This gives us</p>
<p>$$
D_{\mathrm{KL}}\left[q(\theta ; \phi+\lambda \Delta \phi) | q(\theta ; \phi)\right] \approx \frac{1}{2} \lambda^{2} \nabla_{\phi} \ell^{\top} H^{-1}\left(\ell_{\mathrm{KL}}\right) \nabla_{\phi} \ell
$$</p>
<p>Note that $H^{-1}\left(\ell_{\mathrm{KL}}\right)$ is diagonal, so this expression can be computed efficiently. Instead of using the KL divergence $D_{\mathrm{KL}}\left[q\left(\theta ; \phi_{t+1}\right) | q\left(\theta ; \phi_{t}\right)\right]$ directly as an intrinsic reward in Eq. (7), we normalize it by division through the average of the median KL divergences taken over a fixed number of previous trajectories. Rather than focusing on its absolute value, we emphasize relative difference in KL divergence between samples. This accomplishes the same effect since the variance of KL divergence converges to zero, once the model is fully learned.</p>
<h1>3 Experiments</h1>
<p>In this section, we investigate (i) whether VIME can succeed in domains that have extremely sparse rewards, (ii) whether VIME improves learning when the reward is shaped to guide the agent towards its goal, and (iii) how $\eta$, as used in in Eq. (3), trades off exploration and exploitation behavior. All experiments make use of the rllab [15] benchmark code base and the complementary continuous control tasks suite. The following tasks are part of the experimental setup: CartPole ( $\mathcal{S} \subseteq \mathbb{R}^{4}$, $\mathcal{A} \subseteq \mathbb{R}^{1}$ ), CartPoleSwingup ( $\mathcal{S} \subseteq \mathbb{R}^{4}, \mathcal{A} \subseteq \mathbb{R}^{1}$ ), DoublePendulum ( $\mathcal{S} \subseteq \mathbb{R}^{6}, \mathcal{A} \subseteq \mathbb{R}^{1}$ ), MountainCar ( $\mathcal{S} \subseteq \mathbb{R}^{3}, \mathcal{A} \subseteq \mathbb{R}^{1}$ ), locomotion tasks HalfCheetah ( $\mathcal{S} \subseteq \mathbb{R}^{20}, \mathcal{A} \subseteq \mathbb{R}^{6}$ ), Walker2D ( $\mathcal{S} \subseteq \mathbb{R}^{20}$, $\mathcal{A} \subseteq \mathbb{R}^{6}$ ), and the hierarchical task SwimmerGather ( $\mathcal{S} \subseteq \mathbb{R}^{33}, \mathcal{A} \subseteq \mathbb{R}^{2}$ ).</p>
<p>Performance is measured through the average return (not including the intrinsic rewards) over the trajectories generated (y-axis) at each iteration (x-axis). More specifically, the darker-colored lines in each plot represent the median performance over a fixed set of 10 random seeds while the shaded areas show the interquartile range at each iteration. Moreover, the number in each legend shows this performance measure, averaged over all iterations. The exact setup is described in the Appendix.
<img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1: (a,b,c) TRPO+VIME versus TRPO on tasks with sparse rewards; (d) comparison of TRPO+VIME (red) and TRPO (blue) on MountainCar: visited states until convergence</p>
<p>Domains with sparse rewards are difficult to solve through naïve exploration behavior because, before the agent obtains any reward, it lacks a feedback signal on how to improve its policy. This allows us to test whether an exploration strategy is truly capable of systematic exploration, rather than improving existing RL algorithms by adding more hyperparameters. Therefore, VIME is compared with heuristic exploration strategies on the following tasks with sparse rewards. A reward of +1 is given when the car escapes the valley on the right side in MountainCar; when the pole is pointed upwards in CartPoleSwingup; and when the cheetah moves forward over five units in HalfCheetah. We compare VIME with the following baselines: only using Gaussian control noise [15] and using the $\ell^{2}$ BNN prediction error as an intrinsic reward, a continuous extension of [10]. TRPO [8] is used as the RL algorithm, as it performs very well compared to other methods [15]. Figure 1 shows the performance results. We notice that using a naïve exploration performs very poorly, as it is almost never able to reach the goal in any of the tasks. Similarly, using $\ell^{2}$ errors does not perform well. In contrast, VIME performs much better, achieving the goal in most cases. This experiment demonstrates that curiosity drives the agent to explore, even in the absence of any initial reward, where naïve exploration completely breaks down.</p>
<p>To further strengthen this point, we have evaluated VIME on the highly difficult hierarchical task SwimmerGather in Figure 5 whose reward signal is naturally sparse. In this task, a two-link robot needs to reach "apples" while avoiding "bombs" that are perceived through a laser scanner. However, before it can make any forward progress, it has to learn complex locomotion primitives in the absence of any reward. None of the RL methods tested previously in [15] were able to make progress with naïve exploration. Remarkably, VIME leads the agent to acquire coherent motion primitives without any reward guidance, achieving promising results on this challenging task.</p>
<p>Next, we investigate whether VIME is widely applicable by (i) testing it on environments where the reward is well shaped, and (ii) pairing it with different RL methods. In addition to TRPO, we choose to equip REINFORCE [27] and ERWR [28] with VIME because these two algorithms usually suffer from premature convergence to suboptimal policies [15, 29], which can potentially be alleviated by better exploration. Their performance is shown in Figure 2 on several well-established continuous control tasks. Furthermore, Figure 3 shows the same comparison for the Walker2D locomotion task. In the majority of cases, VIME leads to a significant performance gain over heuristic exploration. Our exploration method allows the RL algorithms to converge faster, and notably helps REINFORCE and ERWR avoid converging to a locally optimal solution on DoublePendulum and MountainCar. We note that in environments such as CartPole, a better exploration strategy is redundant as following the policy gradient direction leads to the globally optimal solution. Additionally, we tested adding Gaussian noise to the rewards as a baseline, which did not improve performance.</p>
<p>To give an intuitive understanding of VIME's exploration behavior, the distribution of visited states for both naïve exploration and VIME after convergence is investigated. Figure 1d shows that using Gaussian control noise exhibits random walk behavior: the state visitation plot is more condensed and ball-shaped around the center. In comparison, VIME leads to a more diffused visitation pattern, exploring the states more efficiently, and hence reaching the goal more quickly.</p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 2: Performance of TRPO (top row), ERWR (middle row), and REINFORCE (bottom row) with (+VIME) and without exploration for different continuous control tasks.</p>
<p><img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 3: Performance of TRPO with and without VIME on the high-dimensional Walker2D locomotion task.</p>
<p><img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Figure 4: VIME: performance over the first few iterations for TRPO, REINFORCE, and ERWR i.f.o. $\eta$ on MountainCar.</p>
<p><img alt="img-4.jpeg" src="img-4.jpeg" /></p>
<p>Figure 5: Performance of TRPO with and without VIME on the challenging hierarchical task SwimmerGather.</p>
<p>Finally, we investigate how $\eta$, as used in Eq. (3), trades off exploration and exploitation behavior. On the one hand, higher $\eta$ values should lead to a higher curiosity drive, causing more exploration. On the other hand, very low $\eta$ values should reduce VIME to traditional Gaussian control noise. Figure 4 shows the performance on MountainCar for different $\eta$ values. Setting $\eta$ too high clearly results in prioritizing exploration over getting additional external reward. Too low of an $\eta$ value reduces the method to the baseline algorithm, as the intrinsic reward contribution to the total reward $r^{\prime}$ becomes negligible. Most importantly, this figure highlights that there is a wide $\eta$ range for which the task is best solved, across different algorithms.</p>
<h1>4 Related Work</h1>
<p>A body of theoretically oriented work demonstrates exploration strategies that are able to learn online in a previously unknown MDP and incur a polynomial amount of regret—as a result, these algorithms find a near-optimal policy in a polynomial amount of time. Some of these algorithms are based on the principle of optimism under uncertainty: E<sup>2</sup> [3], R-Max [4], UCRL [30]. An alternative approach is Bayesian reinforcement learning methods, which maintain a distribution over possible MDPs [1, 17, 23, 31]. The optimism-based exploration strategies have been extended to continuous state spaces, for example, [6, 9], however these methods do not accommodate nonlinear function approximators.</p>
<p>Practical RL algorithms often rely on simple exploration heuristics, such as ε-greedy and Boltzmann exploration [32]. However, these heuristics exhibit random walk exploratory behavior, which can lead</p>
<p>to exponential regret even in case of small MDPs [9]. Our proposed method of utilizing information gain can be traced back to [22], and has been further explored in [17, 33, 34]. Other metrics for curiosity have also been proposed, including prediction error [10, 35], prediction error improvement [36], leverage [14], neuro-correlates [37], and predictive information [38]. These methods have not been applied directly to high-dimensional continuous control tasks without discretization. We refer the reader to [21, 39] for an extensive review on curiosity and intrinsic rewards.</p>
<p>Recently, there have been various exploration strategiesproposed in the context of deep RL. [10] proposes to use the $\ell^{2}$ prediction error as the intrinsic reward. [12] performs approximate visitation counting in a learned state embedding using Gaussian kernels. [11] proposes a form of Thompson sampling, training multiple value functions using bootstrapping. Although these approaches can scale up to high-dimensional state spaces, they generally assume discrete action spaces. [40] make use of mutual information for gait stabilization in continuous control, but rely on state discretization. Finally, [41] proposes a variational method for information maximization in the context of optimizing empowerment, which, as noted by [42], does not explicitly favor exploration.</p>
<h1>5 Conclusions</h1>
<p>We have proposed Variational Information Maximizing Exploration (VIME), a curiosity-driven exploration strategy for continuous control tasks. Variational inference is used to approximate the posterior distribution of a Bayesian neural network that represents the environment dynamics. Using information gain in this learned dynamics model as intrinsic rewards allows the agent to optimize for both external reward and intrinsic surprise simultaneously. Empirical results show that VIME performs significantly better than heuristic exploration methods across various continuous control tasks and algorithms. As future work, we would like to investigate measuring surprise in the value function and using the learned dynamics model for planning.</p>
<h2>Acknowledgments</h2>
<p>This work was done in collaboration between UC Berkeley, Ghent University and OpenAI. The work at Berkeley was supported in part by the DARPA SIMPLEX program and by ONR through a PECASE award. Xi Chen was supported by a Berkeley AI Research lab Fellowship. Yan Duan was supported by a Berkeley AI Research lab Fellowship and a Berkeley AI Huawei Fellowship. Rein Houthooft was supported by a Ph.D. Fellowship of the Research Foundation - Flanders (FWO).</p>
<h2>References</h2>
<p>[1] M. Ghavamzadeh, S. Mannor, J. Pineau, and A. Tamar, "Bayesian reinforcement learning: A survey", Found. Trends. Mach. Learn., vol. 8, no. 5-6, pp. 359-483, 2015.
[2] S. Kakade, M. Kearns, and J. Langford, "Exploration in metric state spaces", in ICML, vol. 3, 2003, pp. 306-312.
[3] M. Kearns and S. Singh, "Near-optimal reinforcement learning in polynomial time", Mach. Learn., vol. 49, no. 2-3, pp. 209-232, 2002.
[4] R. I. Brafman and M. Tennenholtz, "R-Max - a general polynomial time algorithm for near-optimal reinforcement learning", J. Mach. Learn. Res., vol. 3, pp. 213-231, 2003.
[5] P. Auer, "Using confidence bounds for exploitation-exploration trade-offs", J. Mach. Learn. Res., vol. 3, pp. 397-422, 2003.
[6] J. Pazis and R. Parr, "PAC optimal exploration in continuous space Markov decision processes", in AAAI, 2013.
[7] V. Mnih, K. Kavukcuoglu, D. Silver, A. A. Rusu, J. Veness, M. G. Bellemare, A. Graves, M. Riedmiller, A. K. Fidjeland, G. Ostrovski, et al., "Human-level control through deep reinforcement learning", Nature, vol. 518, no. 7540, pp. 529-533, 2015.
[8] J. Schulman, S. Levine, P. Moritz, M. I. Jordan, and P. Abbeel, "Trust region policy optimization", in ICML, 2015.
[9] I. Osband, B. Van Roy, and Z. Wen, "Generalization and exploration via randomized value functions", ArXiv preprint arXiv:1402.0635, 2014.</p>
<p>[10] B. C. Stadie, S. Levine, and P. Abbeel, "Incentivizing exploration in reinforcement learning with deep predictive models", ArXiv preprint arXiv:1507.00814, 2015.
[11] I. Osband, C. Blundell, A. Pritzel, and B. Van Roy, "Deep exploration via bootstrapped DQN", in NIPS, 2016.
[12] J. Oh, X. Guo, H. Lee, R. L. Lewis, and S. Singh, "Action-conditional video prediction using deep networks in Atari games", in NIPS, 2015, pp. 2845-2853.
[13] T. Hester and P. Stone, "Intrinsically motivated model learning for developing curious robots", Artificial Intelligence, 2015.
[14] K. Subramanian, C. L. Isbell Jr, and A. L. Thomaz, "Exploration from demonstration for interactive reinforcement learning", in AAMAS, 2016.
[15] Y. Duan, X. Chen, R. Houthooft, J. Schulman, and P. Abbeel, "Benchmarking deep reinforcement learning for continous control", in ICML, 2016.
[16] J. Schmidhuber, "Curious model-building control systems", in IJCNN, 1991, pp. 1458-1463.
[17] Y. Sun, F. Gomez, and J. Schmidhuber, "Planning to be surprised: Optimal Bayesian exploration in dynamic environments", in Artificial General Intelligence, 2011, pp. 41-51.
[18] L. Itti and P. F. Baldi, "Bayesian surprise attracts human attention", in NIPS, 2005, pp. 547-554.
[19] A. Graves, "Practical variational inference for neural networks", in NIPS, 2011, pp. 2348-2356.
[20] C. Blundell, J. Comebise, K. Kavukcuoglu, and D. Wierstra, "Weight uncertainty in neural networks", in ICML, 2015.
[21] J. Schmidhuber, "Formal theory of creativity, fun, and intrinsic motivation (1990-2010)", IEEE Trans. Auton. Mental Develop., vol. 2, no. 3, pp. 230-247, 2010.
[22] J. Storck, S. Hochreiter, and J. Schmidhuber, "Reinforcement driven information acquisition in nondeterministic environments", in ICANN, vol. 2, 1995, pp. 159-164.
[23] J. Z. Kolter and A. Y. Ng, "Near-Bayesian exploration in polynomial time", in ICML, 2009, pp. 513-520.
[24] G. E. Hinton and D. Van Camp, "Keeping the neural networks simple by minimizing the description length of the weights", in COLT, 1993, pp. 5-13.
[25] J. Schmidhuber, "Simple algorithmic principles of discovery, subjective beauty, selective attention, curiosity \&amp; creativity", in Intl. Conf. on Discovery Science, 2007, pp. 26-38.
[26] D. P. Kingma, T. Salimans, and M. Welling, "Variational dropout and the local reparameterization trick", in NIPS, 2015, pp. 2575-2583.
[27] R. J. Williams, "Simple statistical gradient-following algorithms for connectionist reinforcement learning", Mach. Learn., vol. 8, no. 3-4, pp. 229-256, 1992.
[28] J. Kober and J. R. Peters, "Policy search for motor primitives in robotics", in NIPS, 2009, pp. 849-856.
[29] J. Peters and S. Schaal, "Reinforcement learning by reward-weighted regression for operational space control", in ICML, 2007, pp. 745-750.
[30] P. Auer, T. Jaksch, and R. Ortner, "Near-optimal regret bounds for reinforcement learning", in NIPS, 2009, pp. 89-96.
[31] A. Guez, N. Heess, D. Silver, and P. Dayan, "Bayes-adaptive simulation-based search with value function approximation", in NIPS, 2014, pp. 451-459.
[32] R. S. Sutton, Introduction to reinforcement learning.
[33] S. Still and D. Precup, "An information-theoretic approach to curiosity-driven reinforcement learning", Theory Biosci., vol. 131, no. 3, pp. 139-148, 2012.
[34] D. Y. Little and F. T. Sommer, "Learning and exploration in action-perception loops", Closing the Loop Around Neural Systems, p. 295, 2014.
[35] S. B. Thrun, "Efficient exploration in reinforcement learning", Tech. Rep., 1992.
[36] M. Lopes, T. Lang, M. Toussaint, and P.-Y. Oudeyer, "Exploration in model-based reinforcement learning by empirically estimating learning progress", in NIPS, 2012, pp. 206-214.
[37] J. Schossau, C. Adami, and A. Hintze, "Information-theoretic neuro-correlates boost evolution of cognitive systems", Entropy, vol. 18, no. 1, p. 6, 2015.
[38] K. Zahedi, G. Martius, and N. Ay, "Linear combination of one-step predictive information with an external reward in an episodic policy gradient setting: A critical analysis", Front. Psychol., vol. 4, 2013.
[39] P.-Y. Oudeyer and F. Kaplan, "What is intrinsic motivation? a typology of computational approaches", Front Neurorobot., vol. 1, p. 6, 2007.
[40] G. Montufar, K. Ghazi-Zahedi, and N. Ay, "Information theoretically aided reinforcement learning for embodied agents", ArXiv preprint arXiv:1605.09735, 2016.
[41] S. Mohamed and D. J. Rezende, "Variational information maximisation for intrinsically motivated reinforcement learning", in NIPS, 2015, pp. 2116-2124.
[42] C. Salge, C. Glackin, and D. Polani, "Guided self-organization: Inception", in. 2014, ch. EmpowermentAn Introduction, pp. 67-114.</p>
<p>A Bayesian neural networks (BNNs)</p>
<p>We demonstrate the behavior of a BNN [1] when trained on simple regression data. Figure 1 shows a snapshot of the behavior of the BNN during training. In this figure, the red dots represent the regression training data, which has a 1-dim input $x$ and a 1-dim output. The input to the BNN is constructed as $x=[x,x^{2},x^{3},x^{4}]$. The green dots represent BNN predictions, each for a differently sampled $\theta$ value, according to $q(\cdot ;\phi)$. The color lines represent the output for different, but fixed, $\theta$ samples. The shaded areas represent the sampled output mean plus-minus one and two standard deviations.</p>
<p><img alt="img-5.jpeg" src="img-5.jpeg" /></p>
<p>Figure 1: BNN output on a 1D regression task. Shaded areas: sampled output mean $\pm$ one/two standard deviations. Red dots: targets; green dots: prediction samples. Colored lines: neural network functions for different $\theta \sim q(\cdot ; \phi)$ samples.</p>
<p><img alt="img-6.jpeg" src="img-6.jpeg" /></p>
<p>Figure 2: Just before iteration 10,000 we introduce data outside the training data range to the BNN. This results in a KL divergence spike, showing the model's surprise.</p>
<p>The figure shows that the BNN output is very certain in the training data range, while having high uncertainty otherwise. If we introduce data outside of this training range, or data that is significantly different from the training data, it will have a high impact on the parameter distribution $q(\theta ; \phi)$. This is tested in Figure 2: previously unseen data is introduced right before training iteration 10,000. The KL divergence from posterior to prior (y-axis) is set out in function of the training iteration number (x-axis). We see a sharp spike in the KL divergence curve, which represents the BNN's surprise about this novel data. This spike diminishes over time as the BNN learns to fit this new data, becoming less surprised about it.</p>
<h2>B Experimental setup</h2>
<p>In case of the classic tasks CartPole, CartPoleSwingup, DoublePendulum, and MountainCar, as well as in the case of the hierarchical task SwimmerGather, the dynamics BNN has one hidden layer of 32 units. For the locomotion tasks Walker2D and HalfCheetah, the dynamics BNN has two hidden layers of 64 units each. All hidden layers have rectified linear unit (ReLU) nonlinearities, while no nonlinearity is applied to the output layer. The number of samples drawn to approximate the variational lower bound expectation term is fixed to 10. The batch size for the policy gradient methods is set to 5,000 samples, except for the SwimmerGather task, where it is set to 50,000. The replay pool has a fixed size of 100,000 samples, with a minimum size of 500 samples for all but the SwimmerGather task. In this latter case, the replay pool has a size of 1,000,000 samples. The dynamics BNN is updated each epoch, using 500 iterations of Adam [2], with a batch size of 10, except for the SwimmerGather task, in which 5,000 iterations are used. The Adam learning rate is set to 0.0001 while the batches are drawn randomly with replacement from the replay pool. In the second-order KL divergence update step, $\lambda$ is set to 0.01. The BNN prior weight distribution is a fully factorized Gaussian with $\mu$ sampled from a different Gaussian distribution $\mathcal{N}(\mathbf{0},I)$, while $\rho$ is fixed to $\log(1+e^{0.5})$.</p>
<p>The classic tasks make use of a neural network policy with one layer of 32 tanh units, while the locomotion tasks make use of a two-layer neural network of 64 and 32 tanh units. The outputs are modeled by a fully factorized Gaussian distribution $\mathcal{N}(\mu, \sigma^{2} I)$, in which $\mu$ is modeled as the network output, while $\sigma$ is a parameter. The classic tasks make use of a neural network baseline with one layer of 32 ReLU units, while the locomotion tasks make use linear baseline function.</p>
<p>All tasks are implemented as described in [3]. The tasks have the following state and action dimensions: CartPole, $\mathcal{S} \subseteq \mathbb{R}^{4}, \mathcal{A} \subseteq \mathbb{R}^{1}$; CartPoleSwingup, $\mathcal{S} \subseteq \mathbb{R}^{4}, \mathcal{A} \subseteq \mathbb{R}^{1}$; DoublePendulum, $\mathcal{S} \subseteq \mathbb{R}^{8}, \mathcal{A} \subseteq \mathbb{R}^{1}$; MountainCar $\mathcal{S} \subseteq \mathbb{R}^{3}, \mathcal{A} \subseteq \mathbb{R}^{1}$; locomotion tasks HalfCheetah, $\mathcal{S} \subseteq \mathbb{R}^{30}, \mathcal{A} \subseteq \mathbb{R}^{6}$; and Walker2D, $\mathcal{S} \subseteq \mathbb{R}^{20}, \mathcal{A} \subseteq \mathbb{R}^{6}$; and hierarchical task SwimmerGather, $\mathcal{S} \subseteq \mathbb{R}^{33}, \mathcal{A} \subseteq \mathbb{R}^{2}$. The time horizon is set to $T=500$ for all tasks. For the</p>
<p>sparse reward experiments, the tasks have been modified as follows. In MountainCar, the agent receives a reward of +1 when the goal state is reached, namely escaping the valley from the right side. In CartPoleSwingup, the agent receives a reward of +1 when $\cos (\beta)&gt;0.8$, with $\beta$ the pole angle. Therefore, the agent has to figure out how to swing up the pole in the absence of any initial external rewards. In HalfCheetah, the agent receives a reward of +1 when $x_{\text {body }}&gt;5$. As such, it has to figure out how to move forward without any initial external reward.</p>
<h1>References</h1>
<p>[1] C. Blundell, J. Cornebise, K. Kavukcuoglu, and D. Wierstra, "Weight uncertainty in neural networks", in ICML, 2015.
[2] D. Kingma and J. Ba, "Adam: A method for stochastic optimization", in ICLR, 2015.
[3] Y. Duan, X. Chen, R. Houthooft, J. Schulman, and P. Abbeel, "Benchmarking deep reinforcement learning for continous control", in ICML, 2016.</p>            </div>
        </div>

    </div>
</body>
</html>