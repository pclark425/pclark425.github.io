<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-3835 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-3835</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-3835</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-91.html">extraction-schema-91</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of methods, systems, or studies that use large language models (LLMs) to distill theories or synthesize knowledge from large collections of scholarly papers, including details about the method, input corpus, topic/query specification, output, evaluation, results, and limitations.</div>
                <p><strong>Paper ID:</strong> paper-3950df97ea527009a32569cb7016bc3df1383dca</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/3950df97ea527009a32569cb7016bc3df1383dca" target="_blank">QA-GNN: Reasoning with Language Models and Knowledge Graphs for Question Answering</a></p>
                <p><strong>Paper Venue:</strong> North American Chapter of the Association for Computational Linguistics</p>
                <p><strong>Paper TL;DR:</strong> This work proposes a new model, QA-GNN, which addresses the problem of answering questions using knowledge from pre-trained language models (LMs) and knowledge graphs (KGs) through two key innovations: relevance scoring and joint reasoning.</p>
                <p><strong>Paper Abstract:</strong> The problem of answering questions using knowledge from pre-trained language models (LMs) and knowledge graphs (KGs) presents two challenges: given a QA context (question and answer choice), methods need to (i) identify relevant knowledge from large KGs, and (ii) perform joint reasoning over the QA context and KG. Here we propose a new model, QA-GNN, which addresses the above challenges through two key innovations: (i) relevance scoring, where we use LMs to estimate the importance of KG nodes relative to the given QA context, and (ii) joint reasoning, where we connect the QA context and KG to form a joint graph, and mutually update their representations through graph-based message passing. We evaluate QA-GNN on the CommonsenseQA and OpenBookQA datasets, and show its improvement over existing LM and LM+KG models, as well as its capability to perform interpretable and structured reasoning, e.g., correctly handling negation in questions.</p>
                <p><strong>Cost:</strong> 0.005</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <p class="empty-note">No extracted data.</p>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <p class="empty-note">No potentially relevant new papers extracted.</p>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-3835",
    "paper_id": "paper-3950df97ea527009a32569cb7016bc3df1383dca",
    "extraction_schema_id": "extraction-schema-91",
    "extracted_data": [],
    "potentially_relevant_new_papers": [],
    "cost": 0.00539775,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>QA-GNN: Reasoning with Language Models and Knowledge Graphs for Question Answering</h1>
<p>Michihiro Yasunaga Hongyu Ren Antoine Bosselut<br>Percy Liang Jure Leskovec<br>Stanford University<br>{myasu,hyren, antoineb, pliang, jure}@cs.stanford.edu</p>
<h4>Abstract</h4>
<p>The problem of answering questions using knowledge from pre-trained language models (LMs) and knowledge graphs (KGs) presents two challenges: given a QA context (question and answer choice), methods need to (i) identify relevant knowledge from large KGs, and (ii) perform joint reasoning over the QA context and KG. Here we propose a new model, $Q A-G N N$, which addresses the above challenges through two key innovations: (i) relevance scoring, where we use LMs to estimate the importance of KG nodes relative to the given QA context, and (ii) joint reasoning, where we connect the QA context and KG to form a joint graph, and mutually update their representations through graph-based message passing. We evaluate QA-GNN on the CommonsenseQA and OpenBookQA datasets, and show its improvement over existing LM and LM+KG models, as well as its capability to perform interpretable and structured reasoning, e.g., correctly handling negation in questions.</p>
<h2>1 Introduction</h2>
<p>Question answering systems must be able to access relevant knowledge and reason over it. Typically, knowledge can be implicitly encoded in large language models (LMs) pre-trained on unstructured text (Petroni et al., 2019; Bosselut et al., 2019), or explicitly represented in structured knowledge graphs (KGs), such as Freebase (Bollacker et al., 2008) and ConceptNet (Speer et al., 2017), where entities are represented as nodes and relations between them as edges. Recently, pre-trained LMs have demonstrated remarkable success in many question answering tasks (Liu et al., 2019; Raffel et al., 2020). However, while LMs have a broad coverage of knowledge, they do not empirically perform well on structured reasoning (e.g., handling negation) (Kassner and Schütze, 2020). On the other hand, KGs are more suited for structured reasoning (Ren et al., 2020; Ren and Leskovec, 2020) and enable explainable predictions e.g., by providing reasoning paths (Lin et al., 2019), but may lack coverage and
<img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1: Given the QA context (question and answer choice; purple box), we aim to derive the answer by performing joint reasoning over the language and the knowledge graph (green box).
be noisy (Bordes et al., 2013; Guu et al., 2015). How to reason effectively with both sources of knowledge remains an important open problem.</p>
<p>Combining LMs and KGs for reasoning (henceforth, LM+KG) presents two challenges: given a QA context (e.g., question and answer choices; Figure 1 purple box), methods need to (i) identify informative knowledge from a large KG (green box); and (ii) capture the nuance of the QA context and the structure of the KGs to perform joint reasoning over these two sources of information. Previous works (Bao et al., 2016; Sun et al., 2018; Lin et al., 2019) retrieve a subgraph from the KG by taking topic entities (KG entities mentioned in the given QA context) and their few-hop neighbors. However, this introduces many entity nodes that are semantically irrelevant to the QA context, especially when the number of topic entities or hops increases. Additionally, existing LM+KG methods for reasoning (Lin et al., 2019; Wang et al., 2019a; Feng et al., 2020; Lv et al., 2020) treat the QA context and KG as two separate modalities. They individually apply LMs to the QA context and graph</p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 2: Overview of our approach. Given a QA context $(z)$, we connect it with the retrieved KG to form a joint graph (working graph; §3.1), compute the relevance of each KG node conditioned on $z$ ( $\S 3.2$; node shading indicates the relevance score), and perform reasoning on the working graph ( $\S 3.3$ ).
neural networks (GNNs) to the KG, and do not mutually update or unify their representations. This separation might limit their capability to perform structured reasoning, e.g., handling negation.</p>
<p>Here we propose $Q A-G N N$, an end-to-end LM+KG model for question answering that addresses the above two challenges. We first encode the QA context using an LM, and retrieve a KG subgraph following prior works (Feng et al., 2020). Our QA-GNN has two key insights: (i) Relevance scoring: Since the KG subgraph consists of all few-hop neighbors of the topic entities, some entity nodes are more relevant than others with respect to the given QA context. We hence propose KG node relevance scoring: we score each entity on the KG subgraph by concatenating the entity with the QA context and calculating the likelihood using a pretrained LM. This presents a general framework to weight information on the KG; (ii) Joint reasoning: We design a joint graph representation of the QA context and KG, where we explicitly view the QA context as an additional node ( $Q A$ context node) and connect it to the topic entities in the KG subgraph as shown in Figure 1. This joint graph, which we term the working graph, unifies the two modalities into one graph. We then augment the feature of each node with the relevance score, and design a new attention-based GNN module for reasoning. Our joint reasoning algorithm on the working graph simultaneously updates the representation of both the KG entities and the QA context node, bridging the gap between the two sources of information.</p>
<p>We evaluate QA-GNN on two question answering datasets that require reasoning with knowledge: CommonsenseQA (Talmor et al., 2019) and OpenBookQA (Mihaylov et al., 2018), using the ConceptNet KG (Speer et al., 2017). QA-GNN outperforms strong fine-tuned LM baselines as well as the existing best LM+KG model (with the same LM) by up to $5.7 \%$ and $3.7 \%$ respectively. In particular, QA-GNN exhibits improved performance on some forms of structured reasoning (e.g., correctly han-
dling negation and entity substitution in questions): it achieves $4.6 \%$ improvement over fine-tuned LMs on questions with negation, while existing LM+KG models are $+0.6 \%$ over fine-tuned LMs. We also show that one can extract reasoning processes from QA-GNN in the form of general KG subgraphs, not just paths (Lin et al., 2019), suggesting a general method for explaining model predictions.</p>
<h2>2 Problem Statement</h2>
<p>We aim to answer natural language questions using knowledge from a pre-trained LM and a structured KG. We use the term language model broadly to be any composition of two functions, $f_{\text {head }}\left(f_{\text {enc }}(\mathbf{x})\right)$, where $f_{\text {enc }}$, the encoder, maps a textual input $\mathbf{x}$ to a contextualized vector representation $\mathbf{h}^{\mathrm{LM}}$, and $f_{\text {head }}$ uses this representation to perform a desired task (which we discuss in $\S 3.2$ ). In this work, we specifically use masked language models (e.g., RoBERTa) as $f_{\text {enc }}$, and let $\mathbf{h}^{\mathrm{LM}}$ denote the output representation of a [CLS] token that is prepended to the input sequence $\mathbf{x}$, unless otherwise noted. We define the knowledge graph as a multi-relational graph $\mathcal{G}=$ $(\mathcal{V}, \mathcal{E})$. Here $\mathcal{V}$ is the set of entity nodes in the KG; $\mathcal{E} \subseteq \mathcal{V} \times \mathcal{R} \times \mathcal{V}$ is the set of edges that connect nodes in $\mathcal{V}$, where $\mathcal{R}$ represents a set of relation types.</p>
<p>Given a question $q$ and an answer choice $a \in \mathcal{C}$, we follow prior work (Lin et al., 2019) to link the entities mentioned in the question and answer choice to the given $\mathrm{KG} \mathcal{G}$. We denote $\mathcal{V}<em a="a">{q} \subseteq \mathcal{V}$ and $\mathcal{V}</em>} \subseteq \mathcal{V}$ as the set of KG entities mentioned in the question (question entities; blue entities in Figure1) and answer choice (answer choice entities; red entities in Figure 1), respectively, and use $\mathcal{V<em q="q">{q, a}:=\mathcal{V}</em>} \cup \mathcal{V<em _sub="{sub" _text="\text">{a}$ to denote all the entities that appear in either the question or answer choice, which we call topic entities. We then extract a subgraph from $\mathcal{G}$ for a question-choice pair, $\mathcal{G}</em>}}^{q, a}=\left(\mathcal{V<em _sub="{sub" _text="\text">{\text {sub }}^{q, a}, \mathcal{E}</em>$.}}^{q, a}\right),{ }^{1}$ which comprises all nodes on the $k$-hop paths between nodes in $\mathcal{V}_{q, a</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p><img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 3: Relevance scoring of the retrieved KG: we use a pre-trained LM to calculate the relevance of each KG entity node conditioned on the QA context (§3.2).</p>
<h2>3 Approach: QA-GNN</h2>
<p>As shown in Figure 2, given a question and an answer choice $a$, we concatenate them to get the $Q A$ context $[q ; a]$. To reason over a given QA context using knowledge from both the LM and the KG, QA-GNN works as follows. First, we use the LM to obtain a representation for the QA context, and retrieve the subgraph $\mathcal{G}<em a="a" q_="q,">{\text {sub }}$ from the KG. Then we introduce a $Q A$ context node $z$ that represents the QA context, and connect $z$ to the topic entities $\mathcal{V}</em>}$ so that we have a joint graph over the two sources of knowledge, which we term the working graph, $\mathcal{G<em _mathrm_W="\mathrm{W">{\mathrm{W}}$ (§3.1). To adaptively capture the relationship between the QA context node and each of the other nodes in $\mathcal{G}</em>$ for multiple rounds (§3.3). Finally, we make the final prediction using the LM representation, QA context node representation and a pooled working graph representation (§3.4).}}$, we calculate a relevance score for each pair using the LM, and use this score as an additional feature for each node (§3.2). We then propose an attention-based GNN module that does message passing on the $\mathcal{G}_{\mathrm{W}</p>
<h3>3.1 Joint graph representation</h3>
<p>To design a joint reasoning space for the two sources of knowledge, we explicitly connect them in a common graph structure. We introduce a new QA context node $z$ which represents the QA context, and connect $z$ to each topic entity in $\mathcal{V}<em _sub="{sub" _text="\text">{q, a}$ on the KG subgraph $\mathcal{G}</em>$. These relation types capture the relationship between the QA context and the relevant entities in the KG, depending on whether the entity is found in the question portion or the answer portion of the QA context. Since this joint graph intuitively provides a reasoning space (working memory) over
the QA context and KG, we term it working graph $\mathcal{G}}}$ using two new relation types $r_{z, q}$ and $r_{z, a<em _mathrm_W="\mathrm{W">{\mathrm{W}}=\left(\mathcal{V}</em>}}, \mathcal{E<em _mathrm_W="\mathrm{W">{\mathrm{W}}\right)$, where $\mathcal{V}</em>}}=\mathcal{V<em _mathrm_W="\mathrm{W">{\text {sub }} \cup{z}$ and $\mathcal{E}</em>}}=$ $\mathcal{E<em q="q" z_="z,">{\text {sub }} \cup\left{\left(z, r</em>}, v\right) \mid v \in \mathcal{V<em a="a" z_="z,">{q}\right} \cup\left{\left(z, r</em>\right}$.}, v\right) \mid v \in \mathcal{V}_{a</p>
<p>Each node in the $\mathcal{G}<em q="q">{\mathrm{W}}$ is associated with one of the four types: $\mathcal{T}={\mathbf{Z}, \mathbf{Q}, \mathbf{A}, \mathbf{O}}$, each indicating the context node $z$, nodes in $\mathcal{V}</em>}$, nodes in $\mathcal{V<em _sub="{sub" _text="\text">{a}$, and other nodes, respectively (corresponding to the node color, purple, blue, red, gray in Figure 1 and 2). We denote the text of the context node $z$ (QA context) and KG node $v \in \mathcal{V}</em>(z)$ and text $(v)$.}}$ (entity name) as $\operatorname{text</p>
<p>We initialize the node embedding for $z$ using the LM representation of the QA context ( $\mathbf{z}^{\mathrm{LM}}=f_{\text {enc }}(\operatorname{text}(z))$ ), and each node on the $\mathcal{G}_{\text {sub }}$ using the entity embedding from Feng et al. (2020). In the subsequent sections, we will reason over the working graph in order to score a given (question, answer choice) pair.</p>
<h3>3.2 KG node relevance scoring</h3>
<p>Many nodes on the KG subgraph $\mathcal{G}<em _sub="{sub" _text="\text">{\text {sub }}$ (i.e., those heuristically retrieved from the KG) can be irrelevant under the current QA context. As an example shown in Figure 3, the retrieved KG subgraph $\mathcal{G}</em>}}$ with few-hop neighbors of the $\mathcal{V<em a="a" q_="q,">{q, a}$ may include nodes that are uninformative for the reasoning process, e.g., nodes "holiday" and "river bank" are off-topic; "human" and "place" are generic. These irrelevant nodes may result in overfitting or introduce unnecessary difficulty in reasoning, an issue especially when $\mathcal{V}</em>\right|&gt;400$ nodes on average if we consider 3-hop neighbors.}$ is large. For instance, we empirically find that using the ConceptNet KG (Speer et al., 2017), we will retrieve a KG with $\left|\mathcal{V}_{\text {sub }</p>
<p>In response, we propose node relevance scoring, where we use the pre-trained language model to score the relevance of each KG node $v \in \mathcal{V}_{\text {sub }}$</p>
<p>conditioned on the QA context. For each node $v$, we concatenate the entity $\operatorname{text}(v)$ with the QA context $\operatorname{text}(z)$ and compute the relevance score:</p>
<p>$$
\rho_{v}=f_{\text {head }}\left(f_{\text {enc }}([\operatorname{text}(z) ; \operatorname{text}(v)]))\right.
$$</p>
<p>where $f_{\text {head }} \circ f_{\text {enc }}$ denotes the probability of text $(v)$ computed by the LM. This relevance score $\rho_{v}$ captures the importance of each KG node relative to the given QA context, which is used for reasoning or pruning the working graph $\mathcal{G}_{\mathrm{W}}$.</p>
<h3>3.3 GNN architecture</h3>
<p>To perform reasoning on the working graph $\mathcal{G}<em t="t">{\mathrm{W}}$, our GNN module builds on the graph attention framework (GAT) (Veličković et al., 2018), which induces node representations via iterative message passing between neighbors on the graph. Specifically, in a $L$-layer QA-GNN, for each layer, we update the representation $\boldsymbol{h}</em>$ by}^{(\ell)} \in \mathbb{R}^{D}$ of each node $t \in \mathcal{V}_{\mathrm{W}</p>
<p>$$
\boldsymbol{h}<em n="n">{t}^{(\ell+1)}=f</em>}\left(\sum_{s \in \mathcal{N<em s="s" t="t">{t} \cup{t}} \alpha</em>} \boldsymbol{m<em t="t">{s t}\right)+\boldsymbol{h}</em>
$$}^{(\ell)</p>
<p>where $\mathcal{N}<em s="s" t="t">{t}$ represents the neighborhood of node $t$, $\boldsymbol{m}</em>} \in \mathbb{R}^{D}$ notes the message from each neighbor node $s$ to $t$, and $\alpha_{s t}$ is an attention weight that scales each message $\boldsymbol{m<em n="n">{s t}$ from $s$ to $t$. The sum of the messages is then passed through a 2-layer MLP, $f</em>}: \mathbb{R}^{D} \rightarrow \mathbb{R}^{D}$, with batch normalization (Ioffe and Szegedy, 2015). For each node $t \in \mathcal{V<em t="t">{\mathrm{W}}$, we set $\boldsymbol{h}</em>}^{(0)}$ using a linear transformation $f_{h}$ that maps its initial node embedding (described in $\S 3.1$ ) to $\mathbb{R}^{D}$. Crucially, as our GNN message passing operates on the working graph, it will jointly leverage and update the representation of the QA context and KG. We further propose an expressive message ( $\boldsymbol{m<em s="s" t="t">{s t}$ ) and attention $\left(\alpha</em>\right)$ computation below.</p>
<p>Node type \&amp; relation-aware message. As $\mathcal{G}<em t="t">{\mathrm{W}}$ is a multi-relational graph, the message passed from a source node to the target node should capture their relationship, i.e., relation type of the edge and source/target node types. To this end, we first obtain the type embedding $\boldsymbol{u}</em>$ from node $s$ to node $t$ by}$ of each node $t$, as well as the relation embedding $\boldsymbol{r}_{s t</p>
<p>$$
\boldsymbol{u}<em u="u">{t}=f</em>}\left(\mathrm{u<em s="s" t="t">{t}\right), \quad \boldsymbol{r}</em>}=f_{r}\left(\mathrm{e<em s="s">{s t}, \mathrm{u}</em>\right)
$$}, \mathrm{u}_{t</p>
<p>where $\mathrm{u}<em t="t">{s}, \mathrm{u}</em>} \in{0,1}^{|\mathcal{T}|}$ are one-hot vectors indicating the node types of $s$ and $t, \mathrm{e<em u="u">{s t} \in{0,1}^{|\mathcal{R}|}$ is a one-hot vector indicating the relation type of edge $(s, t), f</em>$ is a 2-layer MLP. We then compute the message from $s$ to $t$ as}: \mathbb{R}^{|\mathcal{T}|} \rightarrow \mathbb{R}^{D / 2}$ is a linear transformation, and $f_{r}: \mathbb{R}^{|\mathcal{R}|+2|\mathcal{T}|} \rightarrow \mathbb{R}^{D</p>
<p>$$
\boldsymbol{m}<em m="m">{s t}=f</em>}\left(\boldsymbol{h<em s="s">{s}^{(\ell)}, \boldsymbol{u}</em>\right)
$$}, \boldsymbol{r}_{s t</p>
<p>where $f_{m}: \mathbb{R}^{2.5 D} \rightarrow \mathbb{R}^{D}$ is a linear transformation.</p>
<p>Node type, relation, and score-aware attention. Attention captures the strength of association between two nodes, which is ideally informed by their node types, relations and node relevance scores.
We first embed the relevance score of each node $t$ by</p>
<p>$$
\boldsymbol{\rho}<em _rho="\rho">{t}=f</em>\right)
$$}\left(\rho_{t</p>
<p>where $f_{\rho}: \mathbb{R} \rightarrow \mathbb{R}^{D / 2}$ is an MLP. To compute the attention weight $\alpha_{s t}$ from node $s$ to node $t$, we obtain the query and key vectors $\boldsymbol{q}, \boldsymbol{k}$ by</p>
<p>$$
\begin{aligned}
&amp; \boldsymbol{q}<em q="q">{s}=f</em>}\left(\boldsymbol{h<em s="s">{s}^{(\ell)}, \boldsymbol{u}</em>}, \boldsymbol{\rho<em t="t">{s}\right) \
&amp; \boldsymbol{k}</em>}=f_{k}\left(\boldsymbol{h<em t="t">{t}^{(\ell)}, \boldsymbol{u}</em>}, \boldsymbol{\rho<em s="s" t="t">{t}, \boldsymbol{r}</em>\right)
\end{aligned}
$$</p>
<p>where $f_{q}: \mathbb{R}^{2 D} \rightarrow \mathbb{R}^{D}$ and $f_{k}: \mathbb{R}^{3 D} \rightarrow \mathbb{R}^{D}$ are linear transformations. The attention weight is then</p>
<p>$$
\alpha_{s t}=\frac{\exp \left(\gamma_{s t}\right)}{\sum_{t^{\prime} \in \mathcal{N}<em s="s" t_prime="t^{\prime">{s} \cup{s}} \exp \left(\gamma</em>}}\right)}, \quad \gamma_{s t}=\frac{\boldsymbol{q<em t="t">{s}^{\top} \boldsymbol{k}</em>
$$}}{\sqrt{D}</p>
<h3>3.4 Inference \&amp; Learning</h3>
<p>Given a question $q$ and an answer choice $a$, we use the information from both the QA context and the KG to calculate the probability of it being the answer $p(a \mid q) \propto \exp \left(\operatorname{MLP}\left(\boldsymbol{z}^{\mathrm{LM}}, \boldsymbol{z}^{\mathrm{GNN}}, \boldsymbol{g}\right)\right)$, where $\boldsymbol{z}^{\mathrm{GNN}}=\boldsymbol{h}<em v="v">{s}^{(L)}$ and $\boldsymbol{g}$ denotes the pooling of $\left{\boldsymbol{h}</em>\right}$. In the training data, each question has a set of answer choices with one correct choice. We optimize the model (both the LM and GNN components end-to-end) using the cross entropy loss.}^{(L)} \mid v \in \mathcal{V}_{\text {sub }</p>
<h3>3.5 Computation complexity</h3>
<p>We analyze the time and space complexity of our method and compare with prior works, KagNet (Lin et al., 2019) and MHGRN (Feng et al., 2020) in Table 1. As we handle edges of different relation types using different edge embeddings instead of designing an independent graph networks for each relation as in RGCN (Schlichtkrull et al., 2018) or MHGRN, the time complexity of our method is constant with respect to the number of relations and linear with respect to the number of nodes. We achieve the same space complexity as MHGRN (Feng et al., 2020).</p>
<h2>4 Experiments</h2>
<h3>4.1 Datasets</h3>
<p>We evaluate QA-GNN on two question answering datasets: CommonsenseQA (Talmor et al., 2019) and OpenBookQA (Mihaylov et al., 2018). CommonsenseQA is a 5-way multiple choice QA task that requires reasoning with commonsense knowledge, containing 12,102 questions. The test set of CommonsenseQA is not publicly available, and model predictions can only be evaluated once every two weeks via the official leaderboard. Hence,</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Model</th>
<th style="text-align: center;">Time</th>
<th style="text-align: center;">Space</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">$\mathcal{G}$ is a dense graph</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">$L$-hop KagNet</td>
<td style="text-align: center;">$\mathcal{O}\left(</td>
<td style="text-align: center;">\mathcal{R}</td>
</tr>
<tr>
<td style="text-align: center;">$L$-hop MHGRN</td>
<td style="text-align: center;">$\mathcal{O}\left(</td>
<td style="text-align: center;">\mathcal{R}</td>
</tr>
<tr>
<td style="text-align: center;">$L$-layer QA-GNN</td>
<td style="text-align: center;">$\mathcal{O}\left(</td>
<td style="text-align: center;">\mathcal{V}</td>
</tr>
<tr>
<td style="text-align: center;">$\mathcal{G}$ is a sparse graph with maximum node degree $\Delta \ll</td>
<td style="text-align: center;">\mathcal{V}</td>
<td style="text-align: center;">$</td>
</tr>
<tr>
<td style="text-align: center;">$L$-hop KagNet</td>
<td style="text-align: center;">$\mathcal{O}\left(</td>
<td style="text-align: center;">\mathcal{R}</td>
</tr>
<tr>
<td style="text-align: center;">$L$-hop MHGRN</td>
<td style="text-align: center;">$\mathcal{O}\left(</td>
<td style="text-align: center;">\mathcal{R}</td>
</tr>
<tr>
<td style="text-align: center;">$L$-layer QA-GNN</td>
<td style="text-align: center;">$\mathcal{O}(</td>
<td style="text-align: center;">\mathcal{V}</td>
</tr>
</tbody>
</table>
<p>Table 1: Computation complexity of different $L$-hop reasoning models on a dense/sparse graph $\mathcal{G}=(\mathcal{V}, \mathcal{E})$ with the relation set $\mathcal{R}$.
we perform main experiments on the in-house (IH) data split used in Lin et al. (2019), and also report the score of our final system on the official test set. OpenBookQA is a 4-way multiple choice QA task that requires reasoning with elementary science knowledge, containing 5,957 questions. We use the official data split.</p>
<h3>4.2 Knowledge graphs</h3>
<p>We use ConceptNet (Speer et al., 2017), a generaldomain knowledge graph, as our structured knowledge source $\mathcal{G}$ for both of the above tasks. Given each QA context (question and answer choice), we retrieve the subgraph $\mathcal{G}<em _sub="{sub" _text="\text">{\text {sub }}$ from $\mathcal{G}$ following the pre-processing step described in Feng et al. (2020), with hop size $k=2$. Henceforth, in this section (§4) we use the term "KG" to refer to $\mathcal{G}</em>$.}</p>
<h3>4.3 Implementation \&amp; training details</h3>
<p>We set the dimension $(D=200)$ and number of layers $(L=5)$ of our GNN module, with dropout rate 0.2 applied to each layer (Srivastava et al., 2014). The parameters of the model are optimized by RAdam (Liu et al., 2020), with batch size 128, gradient clipping 1.0 (Pascanu et al., 2013), and learning rate $1 \mathrm{e}-5$ and $1 \mathrm{e}-3$ for the LM and GNN components respectively. Each model is trained using two GPUs (GTX Titan X), which takes $\sim 20$ hours on average. The above hyperparameters were tuned on the development set.</p>
<h3>4.4 Baselines</h3>
<p>Fine-tuned LM. To study the role of KGs, we compare with a vanilla fine-tuned LM, which does not use the KG. We use RoBERTa-large (Liu et al., 2019) for CommonsenseQA, and RoBERTa-large and AristoRoBERTa ${ }^{2}$ (Clark et al., 2019) for</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<h2>Methods</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">RoBERTa-large (w/o KG)</th>
<th style="text-align: left;">$73.07( \pm 0.45)$</th>
<th style="text-align: left;">$68.69( \pm 0.56)$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">+ RGCN (Schlichtkrull et al., 2018)</td>
<td style="text-align: left;">$72.69( \pm 0.19)$</td>
<td style="text-align: left;">$68.41( \pm 0.66)$</td>
</tr>
<tr>
<td style="text-align: left;">+ GconAttn (Wang et al., 2019a)</td>
<td style="text-align: left;">$72.61( \pm 0.39)$</td>
<td style="text-align: left;">$68.59( \pm 0.96)$</td>
</tr>
<tr>
<td style="text-align: left;">+ KagNet (Lin et al., 2019)</td>
<td style="text-align: left;">$73.47( \pm 0.22)$</td>
<td style="text-align: left;">$69.01( \pm 0.76)$</td>
</tr>
<tr>
<td style="text-align: left;">+ RN (Santoro et al., 2017)</td>
<td style="text-align: left;">$74.57( \pm 0.91)$</td>
<td style="text-align: left;">$69.08( \pm 0.21)$</td>
</tr>
<tr>
<td style="text-align: left;">+ MHGRN (Feng et al., 2020)</td>
<td style="text-align: left;">$74.45( \pm 0.10)$</td>
<td style="text-align: left;">$71.11( \pm 0.81)$</td>
</tr>
<tr>
<td style="text-align: left;">+ QA-GNN (Ours)</td>
<td style="text-align: left;">$\mathbf{7 6 . 5 4}( \pm 0.21)$</td>
<td style="text-align: left;">$\mathbf{7 3 . 4 1}( \pm 0.92)$</td>
</tr>
</tbody>
</table>
<p>Table 2: Performance comparison on Commonsense $\boldsymbol{Q A}$ in-house split (controlled experiments). As the official test is hidden, here we report the in-house Dev (IHdev) and Test (IHtest) accuracy, following the data split of Lin et al. (2019).</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Methods</th>
<th style="text-align: left;">Test</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">RoBERTa (Liu et al., 2019)</td>
<td style="text-align: left;">72.1</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa+FreeLB (Zhu et al., 2020) (ensemble)</td>
<td style="text-align: left;">73.1</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa+HyKAS (Ma et al., 2019)</td>
<td style="text-align: left;">73.2</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa+KE (ensemble)</td>
<td style="text-align: left;">73.3</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa+KEDGN (ensemble)</td>
<td style="text-align: left;">74.4</td>
</tr>
<tr>
<td style="text-align: left;">XLNet+GraphReason (Lv et al., 2020)</td>
<td style="text-align: left;">75.3</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa+MHGRN (Feng et al., 2020)</td>
<td style="text-align: left;">75.4</td>
</tr>
<tr>
<td style="text-align: left;">Albert+PG (Wang et al., 2020b)</td>
<td style="text-align: left;">75.6</td>
</tr>
<tr>
<td style="text-align: left;">Albert (Lan et al., 2020) (ensemble)</td>
<td style="text-align: left;">76.5</td>
</tr>
<tr>
<td style="text-align: left;">UnifiedQA ${ }^{3}$ (Khashabi et al., 2020)</td>
<td style="text-align: left;">$\mathbf{7 9 . 1}$</td>
</tr>
<tr>
<td style="text-align: left;">RoBERTa + QA-GNN (Ours)</td>
<td style="text-align: left;">76.1</td>
</tr>
</tbody>
</table>
<p>Table 3: Test accuracy on CommonsenseQA's official leaderboard. The top system, UnifiedQA (11B parameters) is 30x larger than our model.</p>
<h2>OpenBookQA.</h2>
<p>Existing LM+KG models. We compare with existing LM+KG methods, which share the same high-level framework as ours but use different modules to reason on the KG in place of QA-GNN ("yellow box" in Figure2): (1) Relation Network (RN) (Santoro et al., 2017), (2) RGCN (Schlichtkrull et al., 2018), (3) GconAttn (Wang et al., 2019a), (4) KagNet (Lin et al., 2019), and (5) MHGRN (Feng et al., 2020). (1),(2),(3) are relation-aware GNNs for KGs, and (4),(5) further model paths in KGs. MHGRN is the existing top performance model under this LM+KG framework. For fair comparison, we use the same LM in all the baselines and our model. The key differences between QA-GNN and these are that they do not perform relevance scoring or joint updates with the QA context (§3).</p>
<h3>4.5 Main results</h3>
<p>Table 2 and Table 4 show the results on CommonsenseQA and OpenBookQA, respectively. On both datasets, we observe consistent improvements over fine-tuned LMs and existing LM+KG models, e.g., on OpenBookQA, $+5.7 \%$ over RoBERTa, and $+3.7 \%$ over the prior best LM+KG system,
additional input to the QA context.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Methods</th>
<th style="text-align: center;">RoBERTa-large</th>
<th style="text-align: center;">AristoRoBERTa</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Fine-tuned LMs (w/o KG)</td>
<td style="text-align: center;">$64.80( \pm 2.37)$</td>
<td style="text-align: center;">$78.40( \pm 1.64)$</td>
</tr>
<tr>
<td style="text-align: left;">+ RGCN</td>
<td style="text-align: center;">$62.45( \pm 1.57)$</td>
<td style="text-align: center;">$74.60( \pm 2.53)$</td>
</tr>
<tr>
<td style="text-align: left;">+ GconAtten</td>
<td style="text-align: center;">$64.75( \pm 1.48)$</td>
<td style="text-align: center;">$71.80( \pm 1.21)$</td>
</tr>
<tr>
<td style="text-align: left;">+ RN</td>
<td style="text-align: center;">$65.20( \pm 1.18)$</td>
<td style="text-align: center;">$75.35( \pm 1.39)$</td>
</tr>
<tr>
<td style="text-align: left;">+ MHGRN</td>
<td style="text-align: center;">$66.85( \pm 1.19)$</td>
<td style="text-align: center;">80.6</td>
</tr>
<tr>
<td style="text-align: left;">+ QA-GNN (Ours)</td>
<td style="text-align: center;">$\mathbf{7 0 . 5 8 ( \pm 1 . 4 2 )}$</td>
<td style="text-align: center;">$\mathbf{8 2 . 7 7 ( \pm 1 . 5 6 )}$</td>
</tr>
</tbody>
</table>
<p>Table 4: Test accuracy comparison on OpenBook $\boldsymbol{Q A}$ (controlled experiments). Methods with AristoRoBERTa use the textual evidence by Clark et al. (2019) as an additional input to the QA context.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Methods</th>
<th style="text-align: left;">Test</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Careful Selection (Banerjee et al., 2019)</td>
<td style="text-align: left;">72.0</td>
</tr>
<tr>
<td style="text-align: left;">AristoRoBERTa</td>
<td style="text-align: left;">77.8</td>
</tr>
<tr>
<td style="text-align: left;">KF + SIR (Banerjee and Baral, 2020)</td>
<td style="text-align: left;">80.0</td>
</tr>
<tr>
<td style="text-align: left;">AristoRoBERTa + PG (Wang et al., 2020b)</td>
<td style="text-align: left;">80.2</td>
</tr>
<tr>
<td style="text-align: left;">AristoRoBERTa + MHGRN (Feng et al., 2020)</td>
<td style="text-align: left;">80.6</td>
</tr>
<tr>
<td style="text-align: left;">Albert + KB</td>
<td style="text-align: left;">81.0</td>
</tr>
<tr>
<td style="text-align: left;">T5* (Raffel et al., 2020)</td>
<td style="text-align: left;">83.2</td>
</tr>
<tr>
<td style="text-align: left;">UnifiedQA* (Khashabi et al., 2020)</td>
<td style="text-align: left;">$\mathbf{8 7 . 2}$</td>
</tr>
<tr>
<td style="text-align: left;">AristoRoBERTa + QA-GNN (Ours)</td>
<td style="text-align: left;">82.8</td>
</tr>
</tbody>
</table>
<p>Table 5: Test accuracy on OpenBookQA leaderboard. All listed methods use the provided science facts as an additional input to the language context. The top 2 systems, UnifiedQA (11B params) and T5 (3B params) are 30x and 8x larger than our model.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Graph Connection (§3.1)</th>
<th style="text-align: center;">Dev Acc.</th>
<th style="text-align: center;">Relevance scoring (§3.2)</th>
<th style="text-align: center;">Dev Acc.</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">No edge between Z and KG nodes</td>
<td style="text-align: center;">74.81</td>
<td style="text-align: center;">Nothing</td>
<td style="text-align: center;">75.56</td>
</tr>
<tr>
<td style="text-align: center;">Connect Z to all KG nodes</td>
<td style="text-align: center;">76.38</td>
<td style="text-align: center;">w/ contextual embedding</td>
<td style="text-align: center;">76.31</td>
</tr>
<tr>
<td style="text-align: center;">Connect Z to QA entity nodes (final)</td>
<td style="text-align: center;">76.54</td>
<td style="text-align: center;">w/ relevance score (final)</td>
<td style="text-align: center;">76.54</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">w/ both</td>
<td style="text-align: center;">76.52</td>
</tr>
<tr>
<td style="text-align: center;">GNN Attention \&amp; Message (§3.3)</td>
<td style="text-align: center;">Dev Acc.</td>
<td style="text-align: center;">GNN Layers (§3.3)</td>
<td style="text-align: center;">Dev Acc.</td>
</tr>
<tr>
<td style="text-align: center;">Node type, relation, score-aware (final)</td>
<td style="text-align: center;">76.54</td>
<td style="text-align: center;">$L=4$</td>
<td style="text-align: center;">75.51</td>
</tr>
<tr>
<td style="text-align: center;">- type-aware</td>
<td style="text-align: center;">75.41</td>
<td style="text-align: center;">$L=4$</td>
<td style="text-align: center;">76.14</td>
</tr>
<tr>
<td style="text-align: center;">- relation-aware</td>
<td style="text-align: center;">75.61</td>
<td style="text-align: center;">$L=5$ (final)</td>
<td style="text-align: center;">76.94</td>
</tr>
<tr>
<td style="text-align: center;">- score-aware</td>
<td style="text-align: center;">75.56</td>
<td style="text-align: center;">$L=5$</td>
<td style="text-align: center;">76.21</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">$L=7$</td>
<td style="text-align: center;">75.06</td>
</tr>
</tbody>
</table>
<p>Table 6: Ablation study of our model components, using the CommonsenseQA IHdev set.</p>
<p>MHGRN. The boost over MHGRN suggests that QA-GNN makes a better use of KGs to perform joint reasoning than existing LM+KG methods.</p>
<p>We also achieve competitive results to other systems on the official leaderboards (Table 3 and 5). Notably, the top two systems, T5 (Raffel et al., 2020) and UnifiedQA (Khashabi et al., 2020), are trained with more data and use 8 x to 30 x more parameters than our model (ours has $\sim 360 \mathrm{M}$ parameters). Excluding these and ensemble systems, our model is comparable in size and amount of data to other systems, and achieves the top performance on the two datasets.</p>
<h3>4.6 Analysis</h3>
<h3>4.6.1 Ablation studies</h3>
<p>Table 6 summarizes the ablation study conducted on each of our model components (§3.1, §3.2, §3.3), using the CommonsenseQA IHdev set.</p>
<p>Graph connection (top left table): The first key component of QA-GNN is the joint graph that connects the $z$ node (QA context) to QA entity nodes $V_{q, a}$ in the $\operatorname{KG}(\S 3.1)$. Without these edges, the QA context and KG cannot mutually update their representations, hurting the performance: 76.5\% $\rightarrow 74.8 \%$, which is close to the previous LM+KG system, MHGRN. If we connected $z$ to all the nodes in the KG (not just QA entities), the performance is comparable or drops slightly ( $-0.16 \%$ ).</p>
<p>KG node relevance scoring (top right table): We find the relevance scoring of KG nodes (§3.2) provides a boost: $75.56 \% \rightarrow 76.54 \%$. As a variant of the relevance scoring in Eq. 1, we also experimented with obtaining a contextual embedding $\boldsymbol{w}<em _sub="{sub" _text="\text">{v}$ for each node $v \in \mathcal{V}</em>}}$ and adding to the node features: $\boldsymbol{w<em _enc="{enc" _text="\text">{v}=f</em>(v)\right]\right)$. However, we find that it does not perform as well ( $76.31 \%$ ), and using both the relevance score and contextual embedding performs on par with using the score alone, suggesting that the score has a sufficient information in our tasks; hence, our final system simply uses the relevance score.}}\left(\left[\operatorname{text}(z) ; \operatorname{text</p>
<p>GNN architecture (bottom tables): We ablate the information of node type, relation, and relevance score from the attention and message computation in the GNN (§3.3). The results suggest that all these features improve the model performance. For the number of GNN layers, we find $L=5$ works the best on the dev set. Our intuition is that 5 layers allow various message passing or reasoning patterns between the QA context $(z)$ and KG, such as " $z \rightarrow 3$ hops on KG nodes $\rightarrow z$ ".</p>
<h3>4.6.2 Model interpretability</h3>
<p>We aim to interpret QA-GNN's reasoning process by analyzing the node-to-node attention weights induced by the GNN. Figure 4 shows two examples. In (a), we perform Best First Search (BFS) on the working graph to trace high attention weights from the QA context node ( $\mathbf{Z}$; purple) to Question entity nodes (blue) to Other (gray) or Answer choice entity nodes (orange), which reveals that the QA context $z$ attends to "elevator" and "basement" in the KG, "elevator" and "basement" both attend strongly to "building", and "building" attends to "office building", which is our final answer. In (b),</p>
<p><img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Figure 4: Interpreting QA-GNN's reasoning process by analyzing the node-to-node attention weights induced by the GNN. Darker and thicker edges indicate higher attention weights.
we use BFS to trace attention weights from two directions: $\mathbf{Z} \rightarrow \mathbf{Q} \rightarrow \mathbf{O}$ and $\mathbf{Z} \rightarrow \mathbf{A} \rightarrow \mathbf{O}$, which reveals concepts ("sea" and "ocean") in the KG that are not necessarily mentioned in the QA context but bridge the reasoning between the question entity ("crab") and answer choice entity ("salt water"). While prior KG reasoning models (Lin et al., 2019; Feng et al., 2020) enumerate individual paths in the KG for model interpretation, QA-GNN is not specific to paths, and helps to find more general reasoning structures (e.g., a KG subgraph with multiple anchor nodes as in example (a)).</p>
<h3>4.6.3 Structured reasoning</h3>
<p>Structured reasoning, e.g., precise handling of negation or entity substitution (e.g., "hair" $\rightarrow$ "art" in Figure 5b) in question, is crucial for making robust predictions. Here we analyze QA-GNN's ability to perform structured reasoning and compare with baselines (fine-tuned LMs and existing LM+KG models).</p>
<p>Quantitative analysis. Table 7 compares model performance on questions containing negation words (e.g., no, not, nothing, unlikely), taken from the CommonsenseQA IHtest set. We find that previous LM+KG models (KagNet, MHGRN) provide limited improvements over RoBERTa on questions with negation ( $+0.6 \%$ ); whereas QA-GNN exhibits a bigger boost ( $+4.6 \%$ ), suggesting its strength</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Methods</th>
<th style="text-align: center;">IHtest-Acc. <br> (Overall)</th>
<th style="text-align: center;">IHtest-Acc. <br> (Question w/ negation)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">RoBERTa-large (w/o KG)</td>
<td style="text-align: center;">68.7</td>
<td style="text-align: center;">54.2</td>
</tr>
<tr>
<td style="text-align: left;">+ KagNet</td>
<td style="text-align: center;">$69.0(+0.3)$</td>
<td style="text-align: center;">$54.2(+0.0)$</td>
</tr>
<tr>
<td style="text-align: left;">+ MHGRN</td>
<td style="text-align: center;">$71.1(+2.4)$</td>
<td style="text-align: center;">$54.8(+0.6)$</td>
</tr>
<tr>
<td style="text-align: left;">+ QA-GNN (Ours)</td>
<td style="text-align: center;">$73.4(+4.7)$</td>
<td style="text-align: center;">$\mathbf{5 8 . 8 (+ 4 . 6 )}$</td>
</tr>
<tr>
<td style="text-align: left;">+ QA-GNN (no edge</td>
<td style="text-align: center;">$71.5(+2.8)$</td>
<td style="text-align: center;">$55.1(+0.9)$</td>
</tr>
<tr>
<td style="text-align: left;">between Z and KG)</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>Table 7: Performance on questions with negation in CommonsenseQA. () shows the difference with RoBERTa. Existing LM+KG methods (KagNet, MHGRN) provide limited improvements over RoBERTa $(+0.6 \%)$; QA-GNN exhibits a bigger boost ( $+4.6 \%$ ), suggesting its strength in structured reasoning.
in structured reasoning. We hypothesize that QAGNN's joint updates of the representations of the QA context and KG (during GNN message passing) allows the model to integrate semantic nuances expressed in language. To further study this hypothesis, we remove the connections between $z$ and KG nodes from our QA-GNN (Table 7 bottom): now the performance on negation becomes close to the prior work, MHGRN, suggesting that the joint message passing helps for performing structured reasoning.
Qualitative analysis. Figure 5 shows a case study to analyze our model's behavior for structured reasoning. The question on the left contains negation "not used for hair", and the correct answer is "B. art supply". We observe that in the 1st layer of QA-GNN, the attention from $z$ to question entities ("hair", "round brush") is diffuse. After multiples rounds of message passing on the working graph, $z$ attends strongly to "round brush" in the final layer of the GNN, but weakly to the negated entity "hair". The model correctly predicts the answer "B. art supply". Next, given the original question on the left, we (a) drop the negation or (b) modify the topic entity ("hair" $\rightarrow$ "art"). In (a), $z$ now attends strongly to "hair", which is not negated anymore. The model predicts the correct answer "A. hair brush". In (b), we observe that QA-GNN recognizes the same structure as the original question (with only the entity swapped): $z$ attends weakly to the negated entity ("art") like before, and the model correctly predicts "A. hair brush" over "B. art supply".</p>
<p>Table 8 shows additional examples, where we compare QA-GNN's predictions with the LM baseline (RoBERTa). We observe that RoBERTa tends to make the same prediction despite the modifications we make to the original questions (e.g., drop/insert negation, change an entity); on the other hand, QA-GNN adapts predictions to the modifications correctly (except for double negation</p>
<p><img alt="img-4.jpeg" src="img-4.jpeg" /></p>
<p>Figure 5: Analysis of QA-GNN's behavior for structured reasoning. Given an original question (left), we modify its negation (middle) or topic entity (right): we find that QA-GNN adapts attention weights and final predictions accordingly, suggesting its capability to handle structured reasoning.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Example (Original taken from CommonsenseQA Dev)</th>
<th style="text-align: center;">RoBERTa Prediction</th>
<th style="text-align: center;">Our Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">[Original] If it is not used for hair, a round brush is an example of what? <br> A. hair brush B. art supply</td>
<td style="text-align: center;">A. hair brush ( $\boldsymbol{\&amp;}$ )</td>
<td style="text-align: center;">B. art supply $(\checkmark)$</td>
</tr>
<tr>
<td style="text-align: center;">[Negation flip] If it is used for hair, a round brush is an example of what?</td>
<td style="text-align: center;">A. hair brush ( just no change?)</td>
<td style="text-align: center;">A. hair brush $(\checkmark)$</td>
</tr>
<tr>
<td style="text-align: center;">[Entity change] If it is not used for art, a round brush is an example of what?</td>
<td style="text-align: center;">A. hair brush ( just no change?)</td>
<td style="text-align: center;">A. hair brush $(\checkmark)$</td>
</tr>
<tr>
<td style="text-align: center;">[Original] If you have to read a book that is very dry you may become what? <br> A. interested B. bored</td>
<td style="text-align: center;">B. bored $(\checkmark)$</td>
<td style="text-align: center;">B. bored $(\checkmark)$</td>
</tr>
<tr>
<td style="text-align: center;">[Negation ver 1] If you have to read a book that is very dry you may not become what?</td>
<td style="text-align: center;">B. bored $(\&amp;)$</td>
<td style="text-align: center;">A. interested $(\checkmark)$</td>
</tr>
<tr>
<td style="text-align: center;">[Negation ver 2] If you have to read a book that is not dry you may become what?</td>
<td style="text-align: center;">B. bored $(\&amp;)$</td>
<td style="text-align: center;">A. interested $(\checkmark)$</td>
</tr>
<tr>
<td style="text-align: center;">[Double negation] If you have to read a book that is not dry you may not become what?</td>
<td style="text-align: center;">B. bored ( $\&amp;$ )</td>
<td style="text-align: center;">A. interested $(\&amp;)$</td>
</tr>
</tbody>
</table>
<p>Table 8: Case study of structured reasoning, comparing predictions by RoBERTa and our model (RoBERTa + QA-GNN). Our model correctly handles changes in negation and topic entities.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Methods</th>
<th style="text-align: center;">IHtest-Acc. <br> (Question w/ <br> $\leq 10$ entities)</th>
<th style="text-align: center;">IHtest-Acc. <br> (Question w/ <br> $&gt;10$ entities)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">RoBERTa-large (w/o KG)</td>
<td style="text-align: center;">68.4</td>
<td style="text-align: center;">70.0</td>
</tr>
<tr>
<td style="text-align: left;">+ MHGRN</td>
<td style="text-align: center;">71.5</td>
<td style="text-align: center;">70.1</td>
</tr>
<tr>
<td style="text-align: left;">+ QA-GNN (w/o node <br> relevance score)</td>
<td style="text-align: center;">$72.8(+1.3)$</td>
<td style="text-align: center;">$71.5(+1.4)$</td>
</tr>
<tr>
<td style="text-align: left;">+ QA-GNN (w/ node <br> relevance score; final system)</td>
<td style="text-align: center;">$73.4(+1.9)$</td>
<td style="text-align: center;">$\mathbf{7 3 . 5 (+ 3 . 4 )}$</td>
</tr>
</tbody>
</table>
<p>Table 9: Performance on questions with fewer/more entities in CommonsenseQA. () shows the difference with MHGRN (LM+KG baseline). KG node relevance scoring ( $\$ 3.2$ ) boosts the performance on questions containing more entities (i.e. larger retrieved KG).
in the table bottom, which is a future work).</p>
<h3>4.6.4 Effect of KG node relevance scoring</h3>
<p>We find that KG node relevance scoring ( $\$ 3.2$ ) is helpful when the retrieved $\mathrm{KG}\left(\mathcal{G}<em _sub="{sub" _text="\text">{\text {sub }}\right)$ is large. Table 9 shows model performance on questions containing fewer $(\leq 10)$ or more $(&gt;10)$ entities in the CommonsenseQA IHtest set (on average, the former and latter result in 90 and 160 nodes in $\mathcal{G}</em>$, respectively). Existing LM+KG models such as MHGRN achieve limited performance on questions with more entities due to the size and noisiness of retrieved KGs: $70.1 \%$ accuracy vs $71.5 \%$ accuracy on questions with fewer entities. KG node relevance scoring mitigates this bottleneck, reducing the accuracy discrepancy: $73.5 \%$ and $73.4 \%$ accuracy on questions with more/fewer entities, respectively.}</p>
<h2>5 Related work and discussion</h2>
<p>Knowledge-aware methods for NLP. Various works have studied methods to augment NLP systems with knowledge. Existing works (Pan et al., 2019; Ye et al., 2019; Petroni et al., 2019; Bosselut et al., 2019) study pre-trained LMs' potential as latent knowledge bases. To provide more explicit and interpretable knowledge, several works integrate structured knowledge (KGs) into LMs (Mihaylov and Frank, 2018; Lin et al., 2019; Wang et al., 2019a; Yang et al., 2019; Wang et al., 2020b; Bosselut et al., 2021).</p>
<p>Question answering with LM+KG. In particular, a line of works propose LM+KG methods for question answering. Most closely related to ours are works by Lin et al. (2019); Feng et al. (2020); Lv et al. (2020). Our novelties are (1) the joint graph of QA context and KG, on which we mutually update the representations of the LM and KG; and (2) language-conditioned KG node relevance scoring. Other works on scoring or pruning KG nodes/paths rely on graph-based metrics such as PageRank, centrality, and off-the-shelf KG embeddings (Paul and Frank, 2019; Fadnis et al., 2019; Bauer et al., 2018; Lin et al., 2019), without reflecting the QA context.</p>
<p>Other QA tasks. Several works study other forms of question answering tasks, e.g., passagebased QA, where systems identify answers using given or retrieved documents (Rajpurkar et al., 2016; Joshi et al., 2017; Yang et al., 2018), and</p>
<p>KBQA, where systems perform semantic parsing of a given question and execute the parsed queries on knowledge bases (Berant et al., 2013; Yih et al., 2016; Yu et al., 2018). Different from these tasks, we approach question answering using knowledge available in LMs and KGs.</p>
<p>Knowledge representations. Several works study joint representations of external textual knowledge (e.g., Wikipedia articles) and structured knowledge (e.g., KGs) (Riedel et al., 2013; Toutanova et al., 2015; Xiong et al., 2019; Sun et al., 2019; Wang et al., 2019b). The primary distinction of our joint graph representation is that we construct a graph connecting each question and KG rather than textual and structural knowledge, approaching a complementary problem to the above works.</p>
<p>Graph neural networks (GNNs). GNNs have been shown to be effective for modeling graphbased data. Several works use GNNs to model the structure of text (Yasunaga et al., 2017; Zhang et al., 2018; Yasunaga and Liang, 2020) or KGs (Wang et al., 2020a). In contrast to these works, QA-GNN jointly models the language and KG. Graph Attention Networks (GATs) (Veličković et al., 2018) perform attention-based message passing to induce graph representations. We build on this framework, and further condition the GNN on the language input by introducing a QA context node ( $\S 3.1$ ), KG node relevance scoring ( $\S 3.2$ ), and joint update of the KG and language representations (§3.3).</p>
<h2>6 Conclusion</h2>
<p>We presented QA-GNN, an end-to-end question answering model that leverages LMs and KGs. Our key innovations include (i) Relevance scoring, where we compute the relevance of KG nodes conditioned on the given QA context, and (ii) Joint reasoning over the QA context and KGs, where we connect the two sources of information via the working graph, and jointly update their representations through GNN message passing. Through both quantitative and qualitative analyses, we showed QA-GNN's improvements over existing LM and LM+KG models on question answering tasks, as well as its capability to perform interpretable and structured reasoning, e.g., correctly handling negation in questions.</p>
<h2>Acknowledgment</h2>
<p>We thank Rok Sosic, Weihua Hu, Jing Huang, Michele Catasta, members of the SNAP research group, P-Lambda group and Project MOWGLI
team, as well as our anonymous reviewers for valuable feedback.</p>
<p>We gratefully acknowledge the support of DARPA under Nos. N660011924033 (MCS); Funai Foundation Fellowship; ARO under Nos. W911NF-16-1-0342 (MURI), W911NF-16-1-0171 (DURIP); NSF under Nos. OAC-1835598 (CINES), OAC1934578 (HDR), CCF-1918940 (Expeditions), IIS-2030477 (RAPID); Stanford Data Science Initiative, Wu Tsai Neuro-sciences Institute, Chan Zuckerberg Biohub, Amazon, JP-Morgan Chase, Docomo, Hitachi, JD.com, KDDI, NVIDIA, Dell, Toshiba, and United Health Group. Hongyu Ren is supported by Masason Foundation Fellowship and the Apple PhD Fellowship. Jure Leskovec is a Chan Zuckerberg Biohub investigator.</p>
<h2>Reproducibility</h2>
<p>All code and data are available at
https://github.com/michiyasunaga/qagnn. Experiments are available at
https://worksheets.
codalab.org/worksheets/
0xf215deb05edf44a2ac353c711f52a25f.</p>
<h2>References</h2>
<p>Pratyay Banerjee and Chitta Baral. 2020. Knowledge fusion and semantic knowledge ranking for open domain question answering. arXiv preprint arXiv:2004.03101.</p>
<p>Pratyay Banerjee, Kuntal Kumar Pal, Arindam Mitra, and Chitta Baral. 2019. Careful selection of knowledge to solve open book question answering. In Association for Computational Linguistics (ACL).</p>
<p>Junwei Bao, Nan Duan, Zhao Yan, Ming Zhou, and Tiejun Zhao. 2016. Constraint-based question answering with knowledge graph. In International Conference on Computational Linguistics (COLING).</p>
<p>Lisa Bauer, Yicheng Wang, and Mohit Bansal. 2018. Commonsense for generative multi-hop question answering tasks. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Jonathan Berant, Andrew Chou, Roy Frostig, and Percy Liang. 2013. Semantic parsing on freebase from question-answer pairs. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Kurt Bollacker, Colin Evans, Praveen Paritosh, Tim Sturge, and Jamie Taylor. 2008. Freebase: a collaboratively created graph database for structuring human knowledge. In SIGMOD.</p>
<p>Antoine Bordes, Nicolas Usunier, Alberto GarciaDuran, Jason Weston, and Oksana Yakhnenko.</p>
<ol>
<li>Translating embeddings for modeling multirelational data. In Advances in Neural Information Processing Systems (NeurIPS).</li>
</ol>
<p>Antoine Bosselut, Ronan Le Bras, and Yejin Choi. 2021. Dynamic neuro-symbolic knowledge graph construction for zero-shot commonsense question answering. In Proceedings of the AAAI Conference on Artificial Intelligence.</p>
<p>Antoine Bosselut, Hannah Rashkin, Maarten Sap, Chaitanya Malaviya, Asli Çelikyilmaz, and Yejin Choi. 2019. Comet: Commonsense transformers for automatic knowledge graph construction. In Association for Computational Linguistics (ACL).</p>
<p>Peter Clark, Oren Etzioni, Daniel Khashabi, Tushar Khot, Bhavana Dalvi Mishra, Kyle Richardson, Ashish Sabharwal, Carissa Schoenick, Oyvind Tafjord, Niket Tandon, et al. 2019. From'f'to'a'on the ny regents science exams: An overview of the aristo project. arXiv preprint arXiv:1909.01958.</p>
<p>Kshitij Fadnis, Kartik Talamadupula, Pavan Kapanipathi, Haque Ishfaq, Salim Roukos, and Achille Fokoue. 2019. Heuristics for interpretable knowledge graph contextualization. arXiv preprint arXiv:1911.02085.</p>
<p>Yanlin Feng, Xinyue Chen, Bill Yuchen Lin, Peifeng Wang, Jun Yan, and Xiang Ren. 2020. Scalable multi-hop relational reasoning for knowledge-aware question answering. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Kelvin Guu, John Miller, and Percy Liang. 2015. Traversing knowledge graphs in vector space. Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Sergey Ioffe and Christian Szegedy. 2015. Batch normalization: Accelerating deep network training by reducing internal covariate shift. In International conference on machine learning (ICML).</p>
<p>Mandar Joshi, Eunsol Choi, Daniel S Weld, and Luke Zettlemoyer. 2017. Triviaqa: A large scale distantly supervised challenge dataset for reading comprehension. In Association for Computational Linguistics (ACL).</p>
<p>Nora Kassner and Hinrich Schütze. 2020. Negated and misprimed probes for pretrained language models: Birds can talk, but cannot fly. In Association for Computational Linguistics (ACL).</p>
<p>Daniel Khashabi, Tushar Khot, Ashish Sabharwal, Oyvind Tafjord, Peter Clark, and Hannaneh Hajishirzi. 2020. Unifiedqa: Crossing format boundaries with a single qa system. In Findings of EMNLP.</p>
<p>Zhenzhong Lan, Mingda Chen, Sebastian Goodman, Kevin Gimpel, Piyush Sharma, and Radu Soricut. 2020. Albert: A lite bert for self-supervised learning of language representations. In International Conference on Learning Representations (ICLR).</p>
<p>Bill Yuchen Lin, Xinyue Chen, Jamin Chen, and Xiang Ren. 2019. Kagnet: Knowledge-aware graph networks for commonsense reasoning. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Liyuan Liu, Haoming Jiang, Pengcheng He, Weizhu Chen, Xiaodong Liu, Jianfeng Gao, and Jiawei Han. 2020. On the variance of the adaptive learning rate and beyond. In International Conference on Learning Representations (ICLR).</p>
<p>Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov. 2019. Roberta: A robustly optimized bert pretraining approach. arXiv preprint arXiv:1907.11692.</p>
<p>Shangwen Lv, Daya Guo, Jingjing Xu, Duyu Tang, Nan Duan, Ming Gong, Linjun Shou, Daxin Jiang, Guihong Cao, and Songlin Hu. 2020. Graph-based reasoning over heterogeneous external knowledge for commonsense question answering. In Proceedings of the AAAI Conference on Artificial Intelligence.</p>
<p>Kaixin Ma, Jonathan Francis, Quanyang Lu, Eric Nyberg, and Alessandro Oltramari. 2019. Towards generalizable neuro-symbolic systems for commonsense question answering. arXiv preprint arXiv:1910.14087.</p>
<p>Todor Mihaylov, Peter Clark, Tushar Khot, and Ashish Sabharwal. 2018. Can a suit of armor conduct electricity? a new dataset for open book question answering. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Todor Mihaylov and Anette Frank. 2018. Knowledgeable reader: Enhancing cloze-style reading comprehension with external commonsense knowledge. In Association for Computational Linguistics (ACL).</p>
<p>Xiaoman Pan, Kai Sun, Dian Yu, Jianshu Chen, Heng Ji, Claire Cardie, and Dong Yu. 2019. Improving question answering with external knowledge. arXiv preprint arXiv:1902.00993.</p>
<p>Razvan Pascanu, Tomas Mikolov, and Yoshua Bengio. 2013. On the difficulty of training recurrent neural networks. In International conference on machine learning (ICML), pages 1310-1318.</p>
<p>Debjit Paul and Anette Frank. 2019. Ranking and selecting multi-hop knowledge paths to better predict human needs. In North American Chapter of the Association for Computational Linguistics (NAACL).</p>
<p>Fabio Petroni, Tim Rocktäschel, Patrick Lewis, Anton Bakhtin, Yuxiang Wu, Alexander H Miller, and Sebastian Riedel. 2019. Language models as knowledge bases? In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J Liu. 2020. Exploring the limits of transfer learning with a unified text-to-text</p>
<p>transformer. Journal of Machine Learning Research (JMLR).</p>
<p>Pranav Rajpurkar, Jian Zhang, Konstantin Lopyrev, and Percy Liang. 2016. Squad: 100,000+ questions for machine comprehension of text. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Hongyu Ren, Weihua Hu, and Jure Leskovec. 2020. Query2box: Reasoning over knowledge graphs in vector space using box embeddings. In International Conference on Learning Representations (ICLR).</p>
<p>Hongyu Ren and Jure Leskovec. 2020. Beta embeddings for multi-hop logical reasoning in knowledge graphs. In Advances in Neural Information Processing Systems (NeurIPS).</p>
<p>Sebastian Riedel, Limin Yao, Andrew McCallum, and Benjamin M Marlin. 2013. Relation extraction with matrix factorization and universal schemas. In North American Chapter of the Association for Computational Linguistics (NAACL).</p>
<p>Adam Santoro, David Raposo, David G Barrett, Mateusz Malinowski, Razvan Pascanu, Peter Battaglia, and Timothy Lillicrap. 2017. A simple neural network module for relational reasoning. In Advances in Neural Information Processing Systems (NeurIPS).</p>
<p>Michael Schlichtkrull, Thomas N Kipf, Peter Bloem, Rianne Van Den Berg, Ivan Titov, and Max Welling. 2018. Modeling relational data with graph convolutional networks. In European Semantic Web Conference.</p>
<p>Robyn Speer, Joshua Chin, and Catherine Havasi. 2017. Conceptnet 5.5: An open multilingual graph of general knowledge. In Proceedings of the AAAI Conference on Artificial Intelligence.</p>
<p>Nitish Srivastava, Geoffrey Hinton, Alex Krizhevsky, Ilya Sutskever, and Ruslan Salakhutdinov. 2014. Dropout: A simple way to prevent neural networks from overfitting. Journal of Machine Learning Research (JMLR), 15(1):1929-1958.</p>
<p>Haitian Sun, Tania Bedrax-Weiss, and William W Cohen. 2019. Pullnet: Open domain question answering with iterative retrieval on knowledge bases and text. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Haitian Sun, Bhuwan Dhingra, Manzil Zaheer, Kathryn Mazaitis, Ruslan Salakhutdinov, and William W Cohen. 2018. Open domain question answering using early fusion of knowledge bases and text. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Alon Talmor, Jonathan Herzig, Nicholas Lourie, and Jonathan Berant. 2019. Commonsenseqa: A question answering challenge targeting commonsense knowledge. In North American Chapter of the Association for Computational Linguistics (NAACL).</p>
<p>Kristina Toutanova, Danqi Chen, Patrick Pantel, Hoifung Poon, Pallavi Choudhury, and Michael Gamon. 2015. Representing text for joint embedding of text and knowledge bases. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Petar Veličković, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro Liò, and Yoshua Bengio. 2018. Graph attention networks. In International Conference on Learning Representations (ICLR).</p>
<p>Hongwei Wang, Hongyu Ren, and Jure Leskovec. 2020a. Entity context and relational paths for knowledge graph completion. arXiv preprint arXiv:2002.06757.</p>
<p>Peifeng Wang, Nanyun Peng, Pedro Szekely, and Xiang Ren. 2020b. Connecting the dots: A knowledgeable path generator for commonsense question answering. arXiv preprint arXiv:2005.00691.</p>
<p>Xiaoyan Wang, Pavan Kapanipathi, Ryan Musa, Mo Yu, Kartik Talamadupula, Ibrahim Abdelaziz, Maria Chang, Achille Fokoue, Bassem Makni, Nicholas Mattei, et al. 2019a. Improving natural language inference using external knowledge in the science questions domain. In Proceedings of the AAAI Conference on Artificial Intelligence.</p>
<p>Xiaozhi Wang, Tianyu Gao, Zhaocheng Zhu, Zhiyuan Liu, Juanzi Li, and Jian Tang. 2019b. Kepler: A unified model for knowledge embedding and pretrained language representation. Transactions of the Association for Computational Linguistics (TACL).</p>
<p>Wenhan Xiong, Mo Yu, Shiyu Chang, Xiaoxiao Guo, and William Yang Wang. 2019. Improving question answering over incomplete kbs with knowledgeaware reader. In Association for Computational Linguistics (ACL).</p>
<p>An Yang, Quan Wang, Jing Liu, Kai Liu, Yajuan Lyu, Hua Wu, Qiaoqiao She, and Sujian Li. 2019. Enhancing pre-trained language representations with rich knowledge for machine reading comprehension. In Association for Computational Linguistics (ACL).</p>
<p>Zhilin Yang, Peng Qi, Saizheng Zhang, Yoshua Bengio, William W Cohen, Ruslan Salakhutdinov, and Christopher D Manning. 2018. Hotpotqa: A dataset for diverse, explainable multi-hop question answering. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Michihiro Yasunaga and Percy Liang. 2020. Graphbased, self-supervised program repair from diagnostic feedback. In International Conference on Machine Learning (ICML).</p>
<p>Michihiro Yasunaga, Rui Zhang, Kshitijh Meelu, Ayush Pareek, Krishnan Srinivasan, and Dragomir Radev. 2017. Graph-based neural multi-document summarization. In Conference on Computational Natural Language Learning (CoNLL).</p>
<p>Zhi-Xiu Ye, Qian Chen, Wen Wang, and Zhen-Hua Ling. 2019. Align, mask and select: A simple method for incorporating commonsense knowledge into language representation models. arXiv preprint arXiv:1908.06725.</p>
<p>Wen-tau Yih, Matthew Richardson, Christopher Meek, Ming-Wei Chang, and Jina Suh. 2016. The value of semantic parse labeling for knowledge base question answering. In Association for Computational Linguistics (ACL).</p>
<p>Tao Yu, Rui Zhang, Kai Yang, Michihiro Yasunaga, Dongxu Wang, Zifan Li, James Ma, Irene Li, Qingning Yao, Shanelle Roman, et al. 2018. Spider: A large-scale human-labeled dataset for complex and cross-domain semantic parsing and text-to-sql task. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Yuhao Zhang, Peng Qi, and Christopher D Manning. 2018. Graph convolution over pruned dependency trees improves relation extraction. In Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Chen Zhu, Yu Cheng, Zhe Gan, Siqi Sun, Thomas Goldstein, and Jingjing Liu. 2020. Freelb: Enhanced adversarial training for language understanding. In International Conference on Learning Representations (ICLR).</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{2}$ OpenBookQA provides an extra corpus of scientific facts in a textual form. AristoRoBERTa uses the facts corresponding to each question, prepared by Clark et al. (2019), as an&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>