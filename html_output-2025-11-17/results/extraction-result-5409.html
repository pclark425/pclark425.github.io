<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-5409 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-5409</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-5409</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-112.html">extraction-schema-112</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of LLMs being evaluated on cognitive psychology tests, including details of the tests, LLM performance, human baseline performance, and any direct comparisons or notable differences.</div>
                <p><strong>Paper ID:</strong> paper-8b0f27bb594b1eaaf493eaf1e2ee723a2b0a19ad</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/8b0f27bb594b1eaaf493eaf1e2ee723a2b0a19ad" target="_blank">HellaSwag: Can a Machine Really Finish Your Sentence?</a></p>
                <p><strong>Paper Venue:</strong> Annual Meeting of the Association for Computational Linguistics</p>
                <p><strong>Paper TL;DR:</strong> The construction of HellaSwag, a new challenge dataset, and its resulting difficulty, sheds light on the inner workings of deep pretrained models, and suggests a new path forward for NLP research, in which benchmarks co-evolve with the evolving state-of-the-art in an adversarial way, so as to present ever-harder challenges.</p>
                <p><strong>Paper Abstract:</strong> Recent work by Zellers et al. (2018) introduced a new task of commonsense natural language inference: given an event description such as “A woman sits at a piano,” a machine must select the most likely followup: “She sets her fingers on the keys.” With the introduction of BERT, near human-level performance was reached. Does this mean that machines can perform human level commonsense inference? In this paper, we show that commonsense inference still proves difficult for even state-of-the-art models, by presenting HellaSwag, a new challenge dataset. Though its questions are trivial for humans (>95% accuracy), state-of-the-art models struggle (<48%). We achieve this via Adversarial Filtering (AF), a data collection paradigm wherein a series of discriminators iteratively select an adversarial set of machine-generated wrong answers. AF proves to be surprisingly robust. The key insight is to scale up the length and complexity of the dataset examples towards a critical ‘Goldilocks’ zone wherein generated text is ridiculous to humans, yet often misclassified by state-of-the-art models. Our construction of HellaSwag, and its resulting difficulty, sheds light on the inner workings of deep pretrained models. More broadly, it suggests a new path forward for NLP research, in which benchmarks co-evolve with the evolving state-of-the-art in an adversarial way, so as to present ever-harder challenges.</p>
                <p><strong>Cost:</strong> 0.003</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <p class="empty-note">No extracted data.</p>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <p class="empty-note">No potentially relevant new papers extracted.</p>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-5409",
    "paper_id": "paper-8b0f27bb594b1eaaf493eaf1e2ee723a2b0a19ad",
    "extraction_schema_id": "extraction-schema-112",
    "extracted_data": [],
    "potentially_relevant_new_papers": [],
    "cost": 0.00333375,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>HellaSwaq: Can a Machine Really Finish Your Sentence?</h1>
<p>Rowan Zellers ${ }^{\star}$ Ari Holtzman ${ }^{\star}$ Yonatan Bisk ${ }^{\star}$ Ali Farhadi ${ }^{\star \text { Y }}$ Yejin Choi ${ }^{\star 0}$<br>${ }^{\star}$ Paul G. Allen School of Computer Science \&amp; Engineering, University of Washington<br>${ }^{\circledR}$ Allen Institute for Artificial Intelligence<br>https://rowanzellers.com/hellaswag</p>
<h4>Abstract</h4>
<p>Recent work by Zellers et al. (2018) introduced a new task of commonsense natural language inference: given an event description such as "A woman sits at a piano," a machine must select the most likely followup: "She sets her fingers on the keys." With the introduction of BERT (Devlin et al., 2018), near human-level performance was reached. Does this mean that machines can perform human level commonsense inference?</p>
<p>In this paper, we show that commonsense inference still proves difficult for even state-of-the-art models, by presenting HellaSwaq, a new challenge dataset. Though its questions are trivial for humans ( $&gt;95 \%$ accuracy), state-of-the-art models struggle ( $&lt;48 \%$ ). We achieve this via Adversarial Filtering (AF), a data collection paradigm wherein a series of discriminators iteratively select an adversarial set of machine-generated wrong answers. AF proves to be surprisingly robust. The key insight is to scale up the length and complexity of the dataset examples towards a critical 'Goldilocks' zone wherein generated text is ridiculous to humans, yet often misclassified by state-of-the-art models.</p>
<p>Our construction of HellaSwaq, and its resulting difficulty, sheds light on the inner workings of deep pretrained models. More broadly, it suggests a new path forward for NLP research, in which benchmarks co-evolve with the evolving state-of-the-art in an adversarial way, so as to present ever-harder challenges.</p>
<h2>1 Introduction</h2>
<p>Imagine a woman chasing a dog around outside, trying to give it a bath. What might happen next? Humans can read a narrative like this, shown in Figure 1, and connect it to a rich model of the world: the dog is currently dry and not soapy, and it actively doesn't want to be bathed. Thus, one
<img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1: Models like BERT struggle to finish the sentences in HellaSwaq, even when they come from the same distribution as the training set. While the wrong endings are on-topic, with words that relate to the context, humans consistently judge their meanings to be either incorrect or implausible. For example, option A of the WikiHow passage suggests that a driver should stop at a red light for no more than two seconds.
plausible next event is option $\mathbf{C}$-that she'll get the dog wet and it will run away again.</p>
<p>When the SWAG dataset was first announced (Zellers et al., 2018), this new task of commonsense natural language inference seemed trivial for humans ( $88 \%$ ) and yet challenging for then-state-of-the-art models ( $&lt;60 \%$ ), including ELMo (Peters et al., 2018). However, BERT (Devlin et al., 2018) soon reached over $86 \%$, almost human-level performance. One news article on this development was headlined "finally, a machine that can finish your sentence."1</p>
<p>In this paper, we investigate the following question: How well do deep pretrained models, like</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>BERT, perform at commonsense natural language inference (NLI)? Our surprising conclusion is that the underlying task remains unsolved. Indeed, we find that deep models such as BERT do not demonstrate robust commonsense reasonining ability by themselves. Instead, they operate more like rapid surface learners for a particular dataset. Their strong performance on SWAG is dependent on the finetuning process, wherein they largely learn to pick up on dataset-specific distributional biases. When the distribution of language shifts slightly, performance drops drastically - even if the domain remains identical.</p>
<p>We study this question by introducing Jellaswag, ${ }^{2}$ a new benchmark for commonsense NLI. We use Adversarial Filtering (AF), a datacollection paradigm in which a series of discriminators is used to select a challenging set of generated wrong answers. AF is surprisingly effective towards this goal: the resulting dataset of 70 k problems is easy for humans ( $95.6 \%$ accuracy), yet challenging for machines ( $&lt;50 \%$ ). This result holds even when models are given a significant number of training examples, and even when the test data comes from the exact same distribution as the training data. Machine performance slips an additional $5 \%$ when evaluated on examples that cover novel concepts from the same domain.</p>
<p>To make this dataset robust to deep pretrained models, we use a trifecta of state-of-theart generators (Radford et al., 2018), state-of-the-art discriminators (BERT), and high quality source text. We expand on the SWAG's original video-captioning domain by using WikiHow articles, greatly increasing the context diversity and generation length. Our investigation reveals a Goldilocks zone - roughly three sentences of context, and two generated sentences - wherein generations are largely nonsensical, even though state-of-the-art discriminators cannot reliably tell the difference between these generations and the ground truth.</p>
<p>More broadly, our paper presents a case-study towards a future of verified progress in NLP, via iterative rounds of building and breaking datasets. If our ultimate goal is to provide reliable benchmarks for challenging tasks, such as commonsense NLI, these benchmarks cannot be static. Instead, they must evolve together with the evolving state-of-</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 2: An overview of Adversarial Filtering. On each iteration, a new classifier is trained on a dummy training set $\mathcal{D}<em _test="{test" _text="\text">{\text {train }}$ to replace easily-classified negative endings on the dummy test set $\mathcal{D}</em>$ with adversarial endings. This process is repeated iteratively, to obtain a challenging dataset regardless of the final split.
the-art. Continued evolution in turn requires principled dataset creation algorithms. Whenever a new iteration of a dataset is created, these algorithms must leverage existing modeling advancements to filter out spurious biases. Only once this cycle becomes impossible can we say that the underlying task - as opposed an individual dataset is solved.}</p>
<h2>2 Background</h2>
<p>SWAG is a dataset for commonsense NLI. For each question, a model is given a context from a video caption and four ending choices for what might happen next. Only one choice is right - the actual next caption of the video.</p>
<p>Obtaining interesting negatives is challenging. Prior work (e.g. Gururangan et al., 2018; Poliak et al., 2018) has found that when humans write the endings to NLI questions, they introduce subtle yet strong class-conditional biases known as annotation artifacts. ${ }^{3}$</p>
<p>To address this, Zellers et al. (2018) introduced Adversarial Filtering (AF). An overview is shown in Figure 2. The key idea is to produce a dataset $\mathcal{D}$ which is adversarial for any arbitrary split of $\left(\mathcal{D}<em _test="{test" _text="\text">{\text {train }}, \mathcal{D}</em>\right)$. This requires a generator of negative candidates (i.e., wrong endings that vi-}</p>
<p><sup id="fnref:1"><a class="footnote-ref" href="#fn:1">2</a></sup></p>
<p><img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 3: Validation accuracy on SWAG for BERT-Large versus training set size. The baseline (25% accuracy) is random chance. BERT does well given as few as 16 training examples, but requires tens of thousands of examples to approach human performance.</p>
<p>The data is collected in a state human notions about how the world works, which we achieve by using a language model. Potential candidates of incorrect answers were massively oversampled from a language model trained on in-domain data, and then selected using an ensemble of adversaries. The selection process happens iteratively: on each iteration, the dataset is randomly partitioned into $\mathcal{D}<em _text_test="\text{test">{\text{train}}$ and $\mathcal{D}</em>}}$. The ensemble is trained to classify endings as real or generated on $\mathcal{D<em _text_test="\text{test">{\text{train}}$, then, AF replaces easy-to-classify generations in $\mathcal{D}</em>$. This process continues until the accuracy of these adversaries converges. Last, humans validate the data to remove adversarial endings that seem realistic.}</p>
<p>Importantly, AF creates a final dataset that is challenging to models regardless of the final dataset split. In Section 4, we will use AF as the underlying workhorse to construct an NLI dataset that is easy for humans, yet challenging for machines. This difficulty persists even when models are provided significant training data, and even when this data comes from the same distribution as the test set. This contrasts with past work on adversarial examples (e.g., Jia and Liang, 2017; Glockner et al., 2018; Belinkov and Bisk, 2018) which consider cases where an out-of-distribution test set is constructed to be adversarial.</p>
<h3>3 Investigating SWAG</h3>
<p>In this section, we investigate why SWAG was solved. We focus on BERT, since it is the best known approach at the time of writing. Core to our analysis is investigating how a model trained on Wikipedia and books can be so effectively finetuned for SWAG, a dataset from video captions.</p>
<h4>3.1 How much innate knowledge does BERT have about SWAG?</h4>
<p>We investigate this question by measuring BERT's performance on SWAG while varying the size of the training dataset; results are shown in Figure 3. While the best known ELMo NLI model (ESIM+ELMo; Chen et al., 2017) requires the entire training set to reach 59%, BERT outperforms this given only 64 examples. However, BERT still needs upwards of 16k examples to approach human performance, around which it plateaus.</p>
<h4>3.2 What is learned during finetuning?</h4>
<p>Figure 4 compares BERT's performance when trained and evaluated on variants of SWAG.</p>
<p><strong>Context:</strong> BERT's performance only slips 11.9 points (86.7%→74.8%) when context is omitted (Ending Only), suggesting a bias exists in the endings themselves. If a followup event seems unreasonable <em>absent of context</em>, then there must be something markedly different between the space of human-written and machine-generated endings.</p>
<p><strong>Structure:</strong> To distinguish word usage from</p>
<p><img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Figure 4: BERT validation accuracy when trained and evaluated under several versions of SWAG, with the new dataset <em>Hella Swag</em> as comparison. We compare:</p>
<ul>
<li><strong>Ending Only</strong>: No context is provided; just the endings.</li>
<li><strong>Shuffled</strong>: Endings that are indidivually tokenized, shuffled, and then detokenized.</li>
<li><strong>Shuffled+</strong>: No context is provided <em>and</em> each ending is knowable.</li>
</ul>
<p>^{4}See the appendix for a discussion of the BERT architecture and hyperparameter settings we used in our experiments.</p>
<p>^{5}These biases are similar to those in NLI datasets, as found by Gururangan et al. (2018); Poliak et al. (2018).</p>
<p><img alt="img-4.jpeg" src="img-4.jpeg" /></p>
<p>Figure 5: Adversarial Filtering (AF) results with BERT-Large as the discriminator. Left: AF applied to ActivityNet generations produced by Zellers et al. (2018)'s language model versus OpenAI GPT. While GPT converges at random, the LM used for SWAG converges at 75%. Right: AF applied to WikiHow generations from GPT, while varying the ending length from one to three sentences. They converge to random, ~40%, and ~50%, respectively.</p>
<p>Structural patterns, we consider a new scenario, Shuffled. Here the shared context is provided, but the words in each ending choice are randomly permuted. Surprisingly, this reduces BERT performance by less than 10%. Even though BERT was never exposed to randomly shuffled text during pretraining, it easily adapts to this setting, which suggests that BERT is largely performing lexical reasoning over each (context, answer) pair.</p>
<p>Finally, when the context is removed and the words in each ending are shuffled, performance drops to 60.4%. While low, this is still higher than ELMo's performance (&lt;60% from Zellers et al., 2018). As neither context nor structure is needed to discriminate between human and machine-written endings in a majority of cases, it is likely that systems primarily learn to detect distributional stylistic patterns during finetuning.</p>
<h3>3.3 Where do the stylistic biases come from?</h3>
<p>SWAG was constructed via Adversarial Filtering (AF). Endings were generated via a language model, and then selected to fool a discriminator. To understand why it was solved requires understanding the interplay of AF with respect to SWAG's generators and discriminators.</p>
<p>Zellers et al. (2018) used a two-layer LSTM for generation, with shallow stylistic adversarial filters. This setup was robust against ELMo models, but has the shallow LM in particular produced distributional artifacts that BERT picks up on?</p>
<p>To investigate this, we perform AF using BERT-Large as the discriminator in two settings, comparing generations from Zellers et al. (2018) with those from a finetuned GPT (Radford et al., 2018).</p>
<p>Strikingly, the results, Figure 5 (left), show that the generations used in SWAG are so different from the human-written endings that AF never drops the accuracy to chance; instead, it converges to roughly 75%. On the other hand, GPT's generations are good enough that BERT accuracy drops below 30% over many random subsplits of the data, revealing the importance of the generator.</p>
<h3>4 <em>HelloSwag</em></h3>
<p>The success of BERT implies that high-quality generators and discriminators are crucial to AF's success. However, it does <em>not</em> imply that the underlying task of commonsense NLI – as opposed to a single dataset – is solved. To evaluate this claim requires us to try making a new evolution of the SWAG dataset, one in which artifacts are removed. In this section, we do just that by introducing <em>HelloSwag</em>.</p>
<h3>4.1 ActivityNet Captions</h3>
<p>We start by including video captions from the ActivityNet Captions dataset (Krishna et al., 2017). The original SWAG dataset contains these, along with captions from LSMDC (Rohrbach et al., 2017), but for <em>HelloSwag</em> we solely used</p>
<p><sup>6</sup>The discriminator was an ensemble that featured a bag of words model, a shallow CNN, a multilayer perceptron operating on language model perplexities.</p>
<p><sup>7</sup>On each iteration, BERT-Large is re-initialized from its pretrained checkpoint, finetuned, and then evaluated in a four-way setting on the dummy test set of held-out data. See Supp A for a details of our BERT-Large AF setup.</p>
<p>ActivityNet. In addition to temporal descriptions, ActivityNet also provides activity labels for each caption (e.g. jumping rope). We will use these activity labels as additional structure to test generalization ability.</p>
<h3>4.2 WikiHow: A New Testbed</h3>
<p>We next consider a new and challenging testbed for commonsense reasoning: completing how-to articles from WikiHow, an online how-to manual. We scrape 80 k context and follow-up paragraphs from WikiHow, covering such diverse topics as "how to make an origami owl" to "how to survive a bank robbery." Each context has at most three sentences, as do the follow-ups.</p>
<p>AF's effectiveness in this new setting is shown in Figure 5 (right). We consider three settings, corresponding to endings that are either one, two, or three sentences long. In all cases, BERT performance begins high ( $70-90 \%$ ), but there are enough generations for Adversarial Filtering to lower the final accuracy considerably. While the one-sentence case converges to slightly higher than random $-35 \%$ when it converges - the two and three sentence cases are higher, at $40 \%$ and $50 \%$ respectively. Given more context, it becomes easier to classify an ending as machine- or humanwritten. We compromise and use two-sentence generations. Particularly in the two-sentence case, we find ourselves in a Goldilocks zone wherein generations are challenging for deep models, yet as we shall soon see, easy for humans.</p>
<h3>4.3 Obtaining high human agreement</h3>
<p>How well can humans distinguish human-written endings from machine generations refined with Adversarial Filtering? In Figure 6, we compare human performance with that of BERT on a random $80 \% / 20 \%$ split. We see a contrast between the ActivityNet and WikiHow performance. While ActivityNet starts off harder for BERT ( $25.5 \%$ ), it also proves difficult for humans (60\%). In contrast, WikiHow starts easier for BERT ( $41.1 \%$ ) and humans find the domain almost trivial ( $93.5 \%$ ). We hypothesis this discrepancy is due to the lengths of both datasets (Figure 7). WikiHow's 2-sentence generations average 41 tokens, versus 13 for ActivityNet. This gives WikiHow generations three times as many opportunities to make a detectable mistake.</p>
<p>To ensure high agreement on ActivityNet, we perform several rounds of human filtering, in-
<img alt="img-5.jpeg" src="img-5.jpeg" /></p>
<p>Figure 6: For HellaSwaq, we ensure high human agreement through several rounds of annotation. By collecting how likely each ending is we can filter false negative endings - machine generations that sound realistic - and replace them with true negatives. On both subdatasets, BERT performance increases during validation, but the gap to human performance remains wide.
<img alt="img-6.jpeg" src="img-6.jpeg" /></p>
<p>Figure 7: Lengths of ActivityNet and WikiHow; the latter with two-sentence generations. WikiHow is much longer, which corresponds to being easier for humans, while taking longer for AF to converge.
creasing human performance to $94 \%$. During human validation, crowd workers are given a context and six ending choices, of which one is the true ending, and the other five are from AF. On each iteration, we replace machine-written endings that the worker rated as realistic with new samples. In the end, we keep the 25 k best ActivityNet contexts (i.e. those with highest agreement among workers ${ }^{8}$ ) and the 45 k best WikiHow contexts.</p>
<h3>4.4 Zero-shot categories for evaluation</h3>
<p>To evaluate a model's ability to generalize to new situations, we use category labels from WikiHow and ActivityNet to make 'zero-shot' evaluation sets. For each set (validation or test), we craft two subsets: one containing 5 k 'in-domain' examples that come from categories as seen during training (Figure 8), and another with 5 k 'zero-shot' examples from randomly chosen held-out categories. In total, there are 70 k dataset examples.</p>
<p><sup id="fnref3:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<table>
<thead>
<tr>
<th style="text-align: center;">Model</th>
<th style="text-align: center;">Overall</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">In-Domain</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">Zero-Shot</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">ActivityNet</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">WikiHow</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Val</td>
<td style="text-align: center;">Test</td>
<td style="text-align: center;">Val</td>
<td style="text-align: center;">Test</td>
<td style="text-align: center;">Val</td>
<td style="text-align: center;">Test</td>
<td style="text-align: center;">Val</td>
<td style="text-align: center;">Test</td>
<td style="text-align: center;">Val</td>
<td style="text-align: center;">Test</td>
</tr>
<tr>
<td style="text-align: center;">Split Size $\rightarrow$</td>
<td style="text-align: center;">10 K</td>
<td style="text-align: center;">10 K</td>
<td style="text-align: center;">5 K</td>
<td style="text-align: center;">5 K</td>
<td style="text-align: center;">5 K</td>
<td style="text-align: center;">5 K</td>
<td style="text-align: center;">3.2 K</td>
<td style="text-align: center;">3.5 K</td>
<td style="text-align: center;">6.8 K</td>
<td style="text-align: center;">6.5 K</td>
</tr>
<tr>
<td style="text-align: center;">Chance</td>
<td style="text-align: center;">25.0</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">fastText</td>
<td style="text-align: center;">30.9</td>
<td style="text-align: center;">31.6</td>
<td style="text-align: center;">33.8</td>
<td style="text-align: center;">32.9</td>
<td style="text-align: center;">28.0</td>
<td style="text-align: center;">30.2</td>
<td style="text-align: center;">27.7</td>
<td style="text-align: center;">28.4</td>
<td style="text-align: center;">32.4</td>
<td style="text-align: center;">33.3</td>
</tr>
<tr>
<td style="text-align: center;">LSTM+GloVe</td>
<td style="text-align: center;">31.9</td>
<td style="text-align: center;">31.7</td>
<td style="text-align: center;">34.3</td>
<td style="text-align: center;">32.9</td>
<td style="text-align: center;">29.5</td>
<td style="text-align: center;">30.4</td>
<td style="text-align: center;">34.3</td>
<td style="text-align: center;">33.8</td>
<td style="text-align: center;">30.7</td>
<td style="text-align: center;">30.5</td>
</tr>
<tr>
<td style="text-align: center;">LSTM+ELMo</td>
<td style="text-align: center;">31.7</td>
<td style="text-align: center;">31.4</td>
<td style="text-align: center;">33.2</td>
<td style="text-align: center;">32.8</td>
<td style="text-align: center;">30.4</td>
<td style="text-align: center;">30.0</td>
<td style="text-align: center;">33.8</td>
<td style="text-align: center;">33.3</td>
<td style="text-align: center;">30.8</td>
<td style="text-align: center;">30.4</td>
</tr>
<tr>
<td style="text-align: center;">LSTM+BERT-Base</td>
<td style="text-align: center;">35.9</td>
<td style="text-align: center;">36.2</td>
<td style="text-align: center;">38.7</td>
<td style="text-align: center;">38.2</td>
<td style="text-align: center;">33.2</td>
<td style="text-align: center;">34.1</td>
<td style="text-align: center;">40.5</td>
<td style="text-align: center;">40.5</td>
<td style="text-align: center;">33.7</td>
<td style="text-align: center;">33.8</td>
</tr>
<tr>
<td style="text-align: center;">ESIM+ELMo</td>
<td style="text-align: center;">33.6</td>
<td style="text-align: center;">33.3</td>
<td style="text-align: center;">35.7</td>
<td style="text-align: center;">34.2</td>
<td style="text-align: center;">31.5</td>
<td style="text-align: center;">32.3</td>
<td style="text-align: center;">37.7</td>
<td style="text-align: center;">36.6</td>
<td style="text-align: center;">31.6</td>
<td style="text-align: center;">31.5</td>
</tr>
<tr>
<td style="text-align: center;">OpenAI GPT</td>
<td style="text-align: center;">41.9</td>
<td style="text-align: center;">41.7</td>
<td style="text-align: center;">45.3</td>
<td style="text-align: center;">44.0</td>
<td style="text-align: center;">38.6</td>
<td style="text-align: center;">39.3</td>
<td style="text-align: center;">46.4</td>
<td style="text-align: center;">43.8</td>
<td style="text-align: center;">39.8</td>
<td style="text-align: center;">40.5</td>
</tr>
<tr>
<td style="text-align: center;">BERT-Base</td>
<td style="text-align: center;">39.5</td>
<td style="text-align: center;">40.5</td>
<td style="text-align: center;">42.9</td>
<td style="text-align: center;">42.8</td>
<td style="text-align: center;">36.1</td>
<td style="text-align: center;">38.3</td>
<td style="text-align: center;">48.9</td>
<td style="text-align: center;">45.7</td>
<td style="text-align: center;">34.9</td>
<td style="text-align: center;">37.7</td>
</tr>
<tr>
<td style="text-align: center;">BERT-Large</td>
<td style="text-align: center;">46.7</td>
<td style="text-align: center;">47.3</td>
<td style="text-align: center;">50.2</td>
<td style="text-align: center;">49.7</td>
<td style="text-align: center;">43.3</td>
<td style="text-align: center;">45.0</td>
<td style="text-align: center;">54.7</td>
<td style="text-align: center;">51.7</td>
<td style="text-align: center;">42.9</td>
<td style="text-align: center;">45.0</td>
</tr>
<tr>
<td style="text-align: center;">Human</td>
<td style="text-align: center;">95.7</td>
<td style="text-align: center;">95.6</td>
<td style="text-align: center;">95.6</td>
<td style="text-align: center;">95.6</td>
<td style="text-align: center;">95.8</td>
<td style="text-align: center;">95.7</td>
<td style="text-align: center;">94.0</td>
<td style="text-align: center;">94.0</td>
<td style="text-align: center;">96.5</td>
<td style="text-align: center;">96.5</td>
</tr>
</tbody>
</table>
<p>Table 1: Performance of models, evaluated with accuracy (\%).We report results on the full validation and test sets (Overall), as well as results on informative subsets of the data: evaluated on in-domain, versus zero-shot situations, along with performance on the underlying data sources (ActivityNet versus WikiHow). All models substantially underperform humans: the gap is over $45 \%$ on in-domain categories, and $50 \%$ on zero-shot categories.</p>
<p><img alt="img-7.jpeg" src="img-7.jpeg" /></p>
<p>Figure 8: Examples on the in-domain validation set of HellaSwaq, grouped by category label. Our evaluation setup equally weights performance on categories seen during training as well as out-of-domain.</p>
<h2>5 Results</h2>
<p>We evaluate the difficulty of HellaSwaq using a variety of strong baselines, with and without massive pretraining. The models share the same format: given a context and an ending, return a logit for that ending. Accordingly, we train our models using a four-way cross-entropy loss, where the objective is to predict the correct ending. In addition to BERT-Large, our comparisons include:
a. OpenAI GPT (Radford et al., 2018): A finetuned 12-layer transformer that was pre-trained on the BookCorpus (Zhu et al., 2015).
b. Bert-Base: A smaller version of the BERT model whose architecture size matches GPT.
c. ESIM+ELMo (Chen et al., 2017; Peters et al., 2018): This is the best-performing ELMo model for NLI, modified slightly so the final output layer
is now a four-way softmax over endings.
d. LSTM sentence encoder: This is a randomly initialized two-layer bi-LSTM; the second layer's hidden states are max-pooled and fed into an MLP to predict the logit. We consider three variations: GloVe embeddings, ELMo embeddings, or (frozen) BERT-Base embeddings. ${ }^{9}$
e. FastText: (Joulin et al., 2017) An off-the-shelf library for bag-of-words text classification. ${ }^{10}$</p>
<p>We compare all models to human performance by asking five independent crowd workers to solve the same four-way multiple choice problems; their predictions are combined via majority vote.</p>
<p>Our results, shown in Table 1, hint at the difficulty of the dataset: human performance is over $95 \%$, while overall model performance is below $50 \%$ for every model. Surprisingly, despite BERTLarge having been used as the adversarial filter, it still performs the strongest at $47.3 \%$ overall. By making the dataset adversarial for BERT, it seems to also have become adversarial for every other model. For instance, while ESIM+ELMo obtained $59 \%$ accuracy on SWAG, it obtains only $33.3 \%$ accuracy on HellaSwaq.</p>
<p>In addition to pretraining being critical, so too is end-to-end finetuning. Freezing BERT-Base and adding an LSTM on top lowers its overall performance $4.3 \%$. This may help explain why models such as ESIM+ELMo struggled on SWAG, as ELMo isn't updated during finetuning.</p>
<p>While BERT is the best model, it still struggles on HellaSwaq, and especially so on zero-shot cat-</p>
<p><sup id="fnref4:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p><img alt="img-8.jpeg" src="img-8.jpeg" /></p>
<p>Figure 9: Transfer experiments from SWAG to HellaSway and vice versa, evaluated on the validation sets. Overall, a BERT-Large that is trained on SWAG hardly generalizes to HellaSway: it scores $34.6 \%$.
egories. Performance drops roughly $5 \%$ on the test fold, which suggests that the finetuning is not enough for BERT to learn to generalize to novel activities or how-to categories.</p>
<p>Last, we see that WikiHow is a much harder domain that ActivityNet for machines: 45\% BertLarge performance, versus $96.5 \%$ for humans. Curiously, it is on this source dataset that we see the smallest gap between OpenAI GPT and BERT. In fact, OpenAI GPT outperforms BERT on WikiHow, but the reverse is true for ActivityNet. One possibility is that the left-to-right structure of GPT is the right inductive bias for WikiHow - perhaps reasoning bidirectionally over long contexts is too much for a 12-layer transformer to learn.</p>
<h3>5.1 SWAG to HellaSway transfer</h3>
<p>Given the shared goals and partial domains of SWAG and HellaSway, it is natural to ask to what extent models can transfer between the two datasets. In Figure 9 we show the results from transfer experiments: models are trained on one dataset and evaluated on the other. ${ }^{11}$</p>
<p>The best models are trained on the same dataset that they are evaluated on: training on SWAG and evaluating on HellaSway lowers performance by $12 \%$; vice versa lowers performance by $15 \%$. The missing domain for HellaSway models is movie descriptions (LSMDC), still, HellaSway models obtain $69 \%$ accuracy. On the other hand, SWAG models do not generalize at all to their missing domain, WikiHow (28\%), suggesting that learning general commonsense reasoning</p>
<p><sup id="fnref5:0"><a class="footnote-ref" href="#fn:0">1</a></sup><img alt="img-9.jpeg" src="img-9.jpeg" /></p>
<p>Figure 10: Example questions answered by BERTLarge. Correct model predictions are blue, incorrect predictions are red. The right answers are bolded.
was hardly necessary to solve SWAG.</p>
<h3>5.2 Qualitative examples</h3>
<p>We show several qualitative examples in Figure 10, along with BERT-Large's predictions. BERT does well on some ActivityNet contexts, such as in the first row, where it correctly predicts the ending for a shaving caption. Whereas shaving is in-domain, the second example about sharpening knives is zero-shot. In this context, BERT's answer suggests that one would use a knife to sharpen a stone, rather than vice versa. The last example comes from WikiHow, which appears to be incredibly challenging for BERT. BERT picks answer d, which has more words that match the context of technology (planes, traffic, laptop), but is incoherent. ${ }^{12}$</p>
<p><sup id="fnref2:1"><a class="footnote-ref" href="#fn:1">2</a></sup></p>
<p><img alt="img-10.jpeg" src="img-10.jpeg" /></p>
<p>Figure 11: Performance on the WikiHow subset of alternative variations of HellaSway, where different Adversarial Filters are used (but without human validation). We consider the shallow stylistic adversaries used by Zellers et al. (2018) (Stylistic Ensemble), as well as an LSTM with ELMo embeddings, GPT, BERT-Base, and BERT-Large. For each adversarial filtering model, we record the accuracy of that model before and after AF is used. We also evaluate each alternative dataset using BERT-Large. The results suggest that using a stronger model at test time (over the model used for AF) improves performance, but is not enough to solve the task.</p>
<h2>6 Discussion</h2>
<p>Our results suggest that HellaSway is a challenging testbed for state-of-the-art NLI models, even those built on extensive pretraining. The question still remains, though, of <em>where will the field go next?</em></p>
<h3>6.1 How easy might HellaSway be for future discriminators?</h3>
<p>In this paper, we showed the existence of a Goldilocks zone of text complexity – in which generations are nonsensical, but existing state-of-the-art NLP models cannot tell the difference. How hard will the dataset be for future, even more powerful, models?</p>
<p>Answering this question is challenging because <em>these models don't exist (or are unavailable) at the time of writing</em>. However, one remedy is to perform an ablation study on the Adversarial Filtering model used, comparing weaker filters with stronger discriminators. We present our results in Figure 11, and find that while weak discriminators (like the stylistic ensemble used to make SWAG) only marginally reduce the accuracy of BERT-Large, increasing the gap between the filter and the final discriminator is not enough to solve the task. For instance, using a discriminator with 3x the parameters as the adversarial filter (BERT-Large vs. BERT-Base) results in 63% machine accuracy.</p>
<p><img alt="img-11.jpeg" src="img-11.jpeg" /></p>
<p>Figure 12: Estimated pretraining hours required to reach a desired accuracy on HellaSway. We estimate performance with respect to a RTX 2080 Ti - a modern, fast GPU, and fit a log-linear regression line. An extrapolation suggests that to reach human-level performance on HellaSway, without algorithmic or computational improvements, would require 10<sup>9</sup> GPU-hours of pretraining (over 100k GPU years).</p>
<h3>6.2 How well does pretraining scale?</h3>
<p>Overall, the current paradigm of pretraining large models on lots of data has made immense progress on NLP benchmarks. Though we expect this trend to continue, it also behooves us to consider its limits. If more compute is indeed the answer for human-level commonsense inference, what would the compute requirements of this hypothetical massive model look like?</p>
<p>We investigate this in Figure 12 by comparing the accuracies of known models on HellaSway with their computational needs. This estimation is a rough estimate: we convert reported TPU runtimes to our benchmark RTX 2080 Ti GPU using the Roofline model (Williams et al., 2009), which focuses primarily on the bottleneck of loading tensors into GPU memory. Extrapolating from an exponential fit suggests that reaching human-level performance on our dataset would require 10<sup>9</sup> GPU hours, or 100k years – unless algorithmic improvements are made.</p>
<p>What might these algorithmic improvements look like? These could include architectural advances, better pretraining objectives, and beyond. However, these improvements share the bottleneck of the data source. To answer some HellaSway questions correctly without reasoning deeply – like knowing that it is a bad idea to stop at a red light for 'at most two seconds' – might require an exponential number of samples, due to prob-</p>
<p>lems of reporting bias (Gordon and Van Durme, 2013). Alternatively, future models might answer correctly only by picking up on spurious patterns, in which case a new development of the benchmark - using these models as adversaries - would place us in the same position as we are right now.</p>
<p>Put another way, for humans to answer HellaSway questions requires abstracting away from language and modeling world states instead. We postulate that this is what separates solving the task of commonsense NLI, as opposed to a particular dataset. Indeed, we find that existing deep methods often get fooled by lexical false friends. For example, in the WikiHow example from Figure 10, BERT chooses an ending that matches the technology words in the context, rather than matching the deeper topic: using technology as an excuse for not doing homework.</p>
<h3>6.3 Towards a future of evolving benchmarks</h3>
<p>What happens when HellaSway gets solved? We believe the answer is simple: crowdsource another dataset, with the same exact format, and see where models fail. Indeed, in our work we found this to be straightforward from an algorithmic perspective: by throwing in the best known generator (GPT) and the best known discriminator (BERTLarge), we made a dataset that is adversarial - not just to BERT, but to all models we have access to.</p>
<p>While this was easy algorithmically, care must be taken from a data curation standpoint. Indeed, we find success exists within a Goldilocks zone: the data source must be complex enough that state-of-the-art generators often make mistakes, while simple enough such that discriminators often fail to catch them. This ties the future of SWAGstyle benchmarks to progress on language generation: until generation is solved, commonsense NLI will remain unsolved. Even recent promising results on scaling up language models (Radford et al., 2019) find problems in terms of consistency, with the best curated examples requiring 25 random seeds.</p>
<h2>7 Conclusion</h2>
<p>In this paper, we presented HellaSway, a new dataset for physically situated commonsense reasoning. By constructing the dataset through adversarial filtering, combined with state-of-the-art models for language generation and discrimination, we produced a dataset that is adversarial to
the most robust models available - even when models are evaluated on items from the training distribution. In turn, we provided insight into the inner workings of pretrained models, and suggest a path for NLP progress going forward: towards benchmarks that adversarially co-evolve with evolving state-of-the-art models.</p>
<h2>Acknowledgments</h2>
<p>We thank the reviewers, as well as Jesse Thomason, for their helpful feedback. We thank the Mechanical Turk workers for their great work during dataset collection. Thanks also to Zak Stone and the Google Cloud TPU team for help with the computing infrastructure. This work was supported by the National Science Foundation through a Graduate Research Fellowship (DGE1256082) and NSF grants (IIS-1524371, 1637479, 165205, 1703166), the DARPA CwC program through ARO (W911NF-15-1-0543), the IARPA DIVA program through D17PC00343, the Sloan Research Foundation through a Sloan Fellowship, the Allen Institute for Artificial Intelligence, the NVIDIA Artificial Intelligence Lab, and gifts by Google and Facebook. The views and conclusions contained herein are those of the authors and should not be interpreted as representing endorsements of IARPA, DOI/IBC, or the U.S. Government.</p>
<h2>References</h2>
<p>Yonatan Belinkov and Yonatan Bisk. 2018. Synthetic and natural noise both break neural machine translation. In ICLR. ICLR.</p>
<p>Qian Chen, Xiaodan Zhu, Zhen-Hua Ling, Si Wei, Hui Jiang, and Diana Inkpen. 2017. Enhanced lstm for natural language inference. In Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), volume 1, pages 1657-1668.</p>
<p>Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2018. Bert: Pre-training of deep bidirectional transformers for language understanding. arXiv preprint arXiv:1810.04805.</p>
<p>Max Glockner, Vered Shwartz, and Yoav Goldberg. 2018. Breaking nli systems with sentences that require simple lexical inferences. In Proceedings of the 56th Annual Meeting of the Association for Computational Linguistics (Volume 2: Short Papers), pages 650-655.</p>
<p>Jonathan Gordon and Benjamin Van Durme. 2013. Reporting bias and knowledge acquisition. In Proceed-</p>
<p>ings of the 2013 workshop on Automated knowledge base construction, pages 25-30. ACM.</p>
<p>Suchin Gururangan, Swabha Swayamdipta, Omer Levy, Roy Schwartz, Samuel R. Bowman, and Noah A. Smith. 2018. Annotation artifacts in natural language inference data. In Proc. of NAACL.</p>
<p>Ari Holtzman, Jan Buys, Maxwell Forbes, and Yejin Choi. 2019. The curious case of neural text degeneration. arXiv preprint arXiv:1904.09751.</p>
<p>Robin Jia and Percy Liang. 2017. Adversarial examples for evaluating reading comprehension systems. In Proceedings of the 2017 Conference on Empirical Methods in Natural Language Processing, pages 2021-2031.</p>
<p>Armand Joulin, Edouard Grave, Piotr Bojanowski, and Tomas Mikolov. 2017. Bag of tricks for efficient text classification. In Proceedings of the 15th Conference of the European Chapter of the Association for Computational Linguistics: Volume 2, Short Papers, volume 2, pages 427-431.</p>
<p>Ranjay Krishna, Kenji Hata, Frederic Ren, Li Fei-Fei, and Juan Carlos Niebles. 2017. Dense-Captioning Events in Videos. In International Conference on Computer Vision (ICCV).</p>
<p>Matthew Peters, Mark Neumann, Mohit Iyyer, Matt Gardner, Christopher Clark, Kenton Lee, and Luke Zettlemoyer. 2018. Deep contextualized word representations. In Proceedings of the 2018 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long Papers), volume 1, pages 2227-2237.</p>
<p>Adam Poliak, Jason Naradowsky, Aparajita Haldar, Rachel Rudinger, and Benjamin Van Durme. 2018. Hypothesis only baselines in natural language inference. In Proceedings of the Seventh Joint Conference on Lexical and Computational Semantics, pages 180-191.</p>
<p>Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever. 2018. Improving language understanding by generative pre-training. Technical report, OpenAI.</p>
<p>Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, and Ilya Sutskever. 2019. Language models are unsupervised multitask learners. Technical report, OpenAI.</p>
<p>Anna Rohrbach, Atousa Torabi, Marcus Rohrbach, Niket Tandon, Christopher Pal, Hugo Larochelle, Aaron Courville, and Bernt Schiele. 2017. Movie Description. International Journal of Computer Vision, 123(1):94-120.</p>
<p>Rachel Rudinger, Vera Demberg, Ashutosh Modi, Benjamin Van Durme, and Manfred Pinkal. 2015. Learning to predict script events from domainspecific text. In Proceedings of the Fourth Joint</p>
<p>Conference on Lexical and Computational Semantics, pages 205-210.</p>
<p>Samuel Williams, Andrew Waterman, and David Patterson. 2009. Roofline: An insightful visual performance model for floating-point programs and multicore architectures. Technical report, Lawrence Berkeley National Lab.(LBNL), Berkeley, CA (United States).</p>
<p>Rowan Zellers, Yonatan Bisk, Roy Schwartz, and Yejin Choi. 2018. Swag: A large-scale adversarial dataset for grounded commonsense inference. In Proceedings of the 2018 Conference on Empirical Methods in Natural Language Processing (EMNLP).</p>
<p>Yukun Zhu, Ryan Kiros, Richard Zemel, Ruslan Salakhutdinov, Raquel Urtasun, Antonio Torralba, and Sanja Fidler. 2015. Aligning books and movies: Towards story-like visual explanations by watching movies and reading books. In arXiv preprint arXiv:1506.06724.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{11}$ Note that the ActivityNet splits are different for each dataset. To avoid skewing the results, we report only on the validation video captions that are not in the training sets of either dataset. The overall accuracy is then a weighted average, where ActivityNet examples are weighted proportionately more. This gives a slight advantage to training on SWAG, as it sees all the ActivityNet categories when training.&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref5:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:1">
<p>${ }^{12}$ Among other issues, why would someone suddenly be aware that they are 'flying at high speed on a plane...?'&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 2 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:1" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>