<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-5885 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-5885</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-5885</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-118.html">extraction-schema-118</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of large language models (LLMs) being used to distill qualitative laws, principles, or generalizable rules from large numbers of scholarly or scientific papers, including methods, results, limitations, and examples.</div>
                <p><strong>Paper ID:</strong> paper-36877d3608fb391bad5a22fabd81c6669e721e69</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/36877d3608fb391bad5a22fabd81c6669e721e69" target="_blank">Large Language Models for Automated Data Science: Introducing CAAFE for Context-Aware Automated Feature Engineering</a></p>
                <p><strong>Paper Venue:</strong> Neural Information Processing Systems</p>
                <p><strong>Paper TL;DR:</strong> Context-Aware Automated Feature Engineering (CAAFE), a feature engineering method for tabular datasets that utilizes an LLM to iteratively generate additional semantically meaningful features fortabular datasets based on the description of the dataset, is introduced.</p>
                <p><strong>Paper Abstract:</strong> As the field of automated machine learning (AutoML) advances, it becomes increasingly important to incorporate domain knowledge into these systems. We present an approach for doing so by harnessing the power of large language models (LLMs). Specifically, we introduce Context-Aware Automated Feature Engineering (CAAFE), a feature engineering method for tabular datasets that utilizes an LLM to iteratively generate additional semantically meaningful features for tabular datasets based on the description of the dataset. The method produces both Python code for creating new features and explanations for the utility of the generated features. Despite being methodologically simple, CAAFE improves performance on 11 out of 14 datasets -- boosting mean ROC AUC performance from 0.798 to 0.822 across all dataset - similar to the improvement achieved by using a random forest instead of logistic regression on our datasets. Furthermore, CAAFE is interpretable by providing a textual explanation for each generated feature. CAAFE paves the way for more extensive semi-automation in data science tasks and emphasizes the significance of context-aware solutions that can extend the scope of AutoML systems to semantic AutoML. We release our $\href{https://github.com/automl/CAAFE}{code}$, a simple $\href{https://colab.research.google.com/drive/1mCA8xOAJZ4MaB_alZvyARTMjhl6RZf0a}{demo}$ and a $\href{https://pypi.org/project/caafe/}{python\ package}$.</p>
                <p><strong>Cost:</strong> 0.006</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <p class="empty-note">No extracted data.</p>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <p class="empty-note">No potentially relevant new papers extracted.</p>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-5885",
    "paper_id": "paper-36877d3608fb391bad5a22fabd81c6669e721e69",
    "extraction_schema_id": "extraction-schema-118",
    "extracted_data": [],
    "potentially_relevant_new_papers": [],
    "cost": 0.005516,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>Large Language Models for Automated Data Science: Introducing CAAFE for Context-Aware Automated Feature Engineering</h1>
<p>Noah Hollmann<br>University of Freiburg<br>Charité Hospital Berlin<br>Prior Labs<br>noah.homa@gmail.com</p>
<p>Samuel Müller<br>University of Freiburg<br>Prior Labs<br>muellesa@cs.uni-freiburg.de</p>
<p>Frank Hutter<br>University of Freiburg<br>Prior Labs<br>fh@cs.uni-freiburg.de</p>
<h4>Abstract</h4>
<p>As the field of automated machine learning (AutoML) advances, it becomes increasingly important to incorporate domain knowledge into these systems. We present an approach for doing so by harnessing the power of large language models (LLMs). Specifically, we introduce Context-Aware Automated Feature Engineering (CAAFE), a feature engineering method for tabular datasets that utilizes an LLM to iteratively generate additional semantically meaningful features for tabular datasets based on the description of the dataset. The method produces both Python code for creating new features and explanations for the utility of the generated features. Despite being methodologically simple, CAAFE improves performance on 11 out of 14 datasets - boosting mean ROC AUC performance from 0.798 to 0.822 across all dataset - similar to the improvement achieved by using a random forest instead of logistic regression on our datasets. Furthermore, CAAFE is interpretable by providing a textual explanation for each generated feature. CAAFE paves the way for more extensive semi-automation in data science tasks and emphasizes the significance of context-aware solutions that can extend the scope of AutoML systems to semantic AutoML. We release our code, a simple demo and a python package.</p>
<p><img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1: CAAFE accepts a dataset as well as user-specified context information and operates by iteratively proposing and evaluating feature engineering operations.</p>
<p>1 Introduction</p>
<p>Automated machine learning (AutoML; e.g., [hutter2019automated]) is very effective at optimizing the machine learning (ML) part of the data science workflow, but existing systems leave tasks such as data engineering and integration of domain knowledge largely to human practitioners. However, model selection, training, and scoring only account for a small percentage of the time spent by data scientists (roughly 23% according to the "State of Data Science"( [anaconda2020data]). Thus, the most time-consuming tasks, namely data engineering and data cleaning, are only supported to a very limited degree by AutoML tools, if at all.</p>
<p>While the traditional AutoML approach has been fruitful and appropriate given the technical capabilities of ML tools at the time, large language models (LLMs) may extend the reach of AutoML to cover more of data science and allow it to evolve towards automated data science ( [de2022automated]). LLMs encapsulate extensive domain knowledge that can be used to automate various data science tasks, including those that require contextual information. They are, however, not interpretable, or verifiable, and behave less consistently than classical ML algorithms. E.g., even the best LLMs still fail to count or perform simple calculations that are easily solved by classical methods ( [hendrycks2021automated]; [OpenAICommunity2021]).</p>
<p>In this work, we propose an approach that combines the scalability and robustness of classical ML classifiers (e.g. random forests ( [Breiman2001]) with the vast domain knowledge embedded in LLMs, as visualized in Figure 2. We bridge the gap between LLMs and classical algorithms by using code as an interface between them: LLMs generate code that modifies input datasets, these modified datasets can then be processed by classical algorithms. Our proposed method, CAAFE, generates Python code that creates semantically meaningful features that improve the performance of downstream prediction tasks in an iterative fashion and with algorithmic feedback as shown in Figure 1. Furthermore, CAAFE generates a comment for each feature which explains the utility of generated feature. This allows interpretable AutoML, making it easier for the user to understand a solution, but also to modify and improve on it. Our approach combines the advantages of classical ML (robustness, predictability and a level of interpretability) and LLMs (domain-knowledge and creativity).</p>
<p>Automating the integration of domain-knowledge into the AutoML process has clear advantages that extend the scope of existing AutoML methods. These benefits include: i) Reducing the latency from data to trained models; ii) Reducing the cost of creating ML models; iii) Evaluating a more informed space of solutions than previously possible with AutoML, but a larger space than previously possible with manual approaches for integrating domain knowledge; and iv) Enhancing the robustness and reproducibility of solutions, as computer-generated solutions are more easily reproduced. CAAFE demonstrates the potential of LLMs for automating a broader range of data science tasks and highlights the emerging potential for creating more robust and context-aware AutoML tools.</p>
<h2>2 Background</h2>
<h3>2.1 Large Language Models (LLMs)</h3>
<p>LLMs are neural networks that are pre-trained on large quantities of raw text data to predict the next word in text documents. Recently, GPT-4 has been released as a powerful and publicly available LLM ( [OpenAI2023b]). The architecture of GPT-4 is not oublished, it is likely based on a deep neural network that uses a transformer architecture ( [vaswani2017attention]), large-scale pre-training on a diverse corpus of text and fine-tuning using reinforcement learning from human feedback ( [RLHF]) ( [ziegler2019automated]). It achieves state-of-the-art performance on various tasks, such as text generation, summarization, question answering and coding. One can adapt LLMs to a specific task without retraining by writing a prompt ( [brown2020language]; [wei2021gpt]; the model parameters are frozen and the model performs in-context inference tasks based on a textual input that formulates the task and potentially contains examples.</p>
<p>LLMs as Tabular Prediction Models [hegselmann2023tabular] recently showed how to use LLMs for tabular data prediction by applying them to a textual representation of these datasets. A prediction on an unseen sample then involves continuing the textual description of that sample on the target column. However, this method requires encoding the entire training dataset as a string and processing it using a transformer-based architecture, where the computational cost increases</p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 2: Data Science pipeline, inspired by De Bie et al. (2022). CAAFE allows for automation of semantic data engineering, while LLMs could provide even further automation: (1) Context specification is user driven (2) exploitation and data engineering can be automated through LLMs (3) model building can be automated by classical AutoML approaches.
quadratically with respect to $N \cdot M$, where $N$ denotes the number of samples and $M$ the number of features. Furthermore, the predictions generated by LLMs are not easily interpretable, and there is no assurance that the LLMs will produce consistent predictions, as these predictions depend directly on the complex and heterogeneous data used to train the models. So far, Hegselmann et al. (2023) found that their method yielded the best performance on tiny datasets with up to 8 samples, but was outperformed for larger data sets.</p>
<p>LLMs for Data Wrangling Narayan et al. (2022) demonstrated state-of-the-art results using LLMs for entity matching, error detection, and data imputation using prompting and manually tuning the LLMs. Vos et al. (2022) extended this technique by employing an improved prefix tuning technique. Both approaches generate and utilize the LLMs output for each individual data sample, executing a prompt for each row. This is in contrast to CAAFE, which uses code as an interface, making our work much more scalable and faster to execute, since one LLM query can be applied to all samples.</p>
<h1>2.2 Feature Engineering</h1>
<p>Feature engineering refers to the process of constructing suitable features from raw input data, which can lead to improved predictive performance. Given a dataset $D=\left(x_{i}, y_{i}\right)<em i="i">{i=1}^{n}$, the goal is to find a function $\phi: \mathcal{X} \rightarrow \mathcal{X}^{\prime}$ which maximizes the performance of $A\left(\phi\left(x</em>\right)$ for some learning algorithm $A$. Common methods include numerical transformations, categorical encoding, clustering, group aggregation, and dimensionality reduction techniques, such as principal component analysis (Wold et al., 1987).}\right), y_{i</p>
<p>Deep learning methods are capable of learning suitable transformations from the raw input data making them more data-driven and making explicit feature engineering less critical, but only given a lot of data. Thus, appropriate feature engineering still improves the performance of classical and deep learning models, particularly for limited data, complex patterns, or model interpretability.</p>
<p>Various strategies for automated feature engineering have been explored in prior studies. Deep Feature Synthesis (DFS; Kanter \&amp; Veeramachaneni (2015)) integrates multiple tables for feature engineering by enumerating potential transformations on features and performing feature selection based on model performance. Cognito (Khurana et al., 2016) proposes a tree-like exploration of the feature space using handcrafted heuristic traversal strategies. AutoFeat (Horn et al., 2019) employs an iterative subsampling of features using beam search. Learning-based methods, such as LFE (Nargesian et al., 2017), utilize machine learning models to recommend beneficial transformations while other methods use reinforcement learning-based strategies (Khurana et al., 2018; Zhang et al., 2019). Despite these advancements, none of the existing methods can harness semantic information in an automated manner.</p>
<h1>2.2.1 Incorporating Semantic Information</h1>
<p><img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 3: Contextual information can simplify a task immensely. On the left-hand side no contextual information is added to the plot, and it is hard to predict the label for the green query point. On the right-hand side contextual information is added and a useful additional feature (weekend or weekday) is derived from which a mapping from features to targets can be found.</p>
<p>The potential feature space, when considering the combinatorial number of transformations and combinations, is vast. Therefore, semantic information is useful, to serve as a prior for identifying useful features. By incorporating semantic and contextual information, feature engineering techniques can be limited to semantically meaningful features enhancing the performance by mitigating issues with multiple testing and computational complexity and boosting the interpretability of machine learning models. This strategy is naturally applied by human experts who leverage their domainspecific knowledge and insights. Figure 3 exemplifies the usefulness of contextual information.</p>
<h2>3 Method</h2>
<p>We present CAAFE, an approach that leverages large language models to incorporate domain knowledge into the feature engineering process, offering a promising direction for automating data science tasks while maintaining interpretability and performance.
Our method takes the training and validation datasets, $D_{\text {train }}$ and $D_{\text {valid }}$, as well as a description of the context of the training dataset and features as input. From this information CAAFE constructs a prompt, i.e. instructions to the LLM containing specifics of the dataset and the feature engineering task. Our method performs multiple iterations of feature alterations and evaluations on the validation dataset, as outlined in Figure 1. In each iteration, the LLM generates code, which is then executed on the current $D_{\text {train }}$ and $D_{\text {valid }}$ resulting in the transformed datasets $D_{\text {train }}^{\prime}$ and $D_{\text {valid }}^{\prime}$. We then use $D_{\text {train }}^{\prime}$ to fit an ML-classifier and evaluate its performance $P^{\prime}$ on $D_{\text {valid }}^{\prime}$. If $P^{\prime}$ exceeds the performance $P$ achieved by training on $D_{\text {train }}$ and evaluating on $D_{\text {valid }}$, the feature is kept and we set $D_{\text {train }}:=D_{\text {train }}^{\prime}$ and $D_{\text {valid }}:=D_{\text {valid }}^{\prime}$. Otherwise, the feature is rejected and $D_{\text {train }}$ and $D_{\text {valid }}$ remain unchanged. Figure 4 shows a shortened version of one such run on the Tic-Tac-Toe Endgame dataset.</p>
<p>Prompting LLMs for Feature Engineering Code Here, we describe how CAAFE builds the prompt that is used to perform feature engineering. In this prompt, the LLM is instructed to create valuable features for a subsequent prediction task and to provide justifications for the added feature's utility. It is also instructed to drop unnecessary features, e.g. when their information is captured by other created features.</p>
<p>The prompt contains semantic and descriptive information about the dataset. Descriptive information, i.e. summary statistics, such as the percentage of missing values is based solely on the train split of the dataset. The prompt consists of the following data points:</p>
<p>A A user-generated dataset description, that contains contextual information about the dataset (see Section 4 for details on dataset descriptions for our experiments)
B Feature names adding contextual information and allowing the LLM to generate code to index features by their names</p>
<div class="codehilite"><pre><span></span><code><span class="nv">Dataset</span><span class="w"> </span><span class="nv">description</span>:<span class="w"> </span><span class="nv">Tic</span><span class="o">-</span><span class="nv">Tac</span><span class="o">-</span><span class="nv">Toe</span><span class="w"> </span><span class="nv">Endgame</span><span class="w"> </span><span class="nv">database</span>
<span class="nv">This</span><span class="w"> </span><span class="nv">database</span><span class="w"> </span><span class="nv">encodes</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">complete</span><span class="w"> </span><span class="nv">set</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">possible</span><span class="w"> </span><span class="nv">board</span>
<span class="w">    </span><span class="nv">configurations</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">tic</span><span class="o">-</span><span class="nv">tac</span><span class="o">-</span><span class="nv">toe</span><span class="w"> </span><span class="nv">games</span>,<span class="w"> </span><span class="nv">where</span><span class="w"> </span><span class="s2">&quot;x&quot;</span><span class="w"> </span><span class="nv">is</span>
<span class="w">    </span><span class="nv">assumed</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">have</span><span class="w"> </span><span class="nv">played</span><span class="w"> </span><span class="nv">first</span>.<span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">target</span><span class="w"> </span><span class="nv">concept</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="s2">&quot;win for x&quot;</span><span class="w"> </span><span class="ss">(</span><span class="nv">i</span>
<span class="w">    </span>.<span class="nv">e</span>.,<span class="w"> </span><span class="nv">true</span><span class="w"> </span><span class="nv">when</span><span class="w"> </span><span class="s2">&quot;x&quot;</span><span class="w"> </span><span class="nv">has</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="nv">possible</span><span class="w"> </span><span class="nv">ways</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">create</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="err">&quot;three-</span>
<span class="w">    </span><span class="nv">in</span><span class="o">-</span><span class="nv">a</span><span class="o">-</span><span class="nv">row</span><span class="err">&quot;).</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="nx">number</span><span class="o">-</span><span class="nx">of</span><span class="o">-</span><span class="nx">x</span><span class="o">-</span><span class="nx">wins</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">Number</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">ways</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">board</span><span class="err">&#39;</span><span class="p">)</span>
<span class="err">#</span><span class="w"> </span><span class="nx">Usefulness</span><span class="p">:</span><span class="w"> </span><span class="nx">Knowing</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">number</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">ways</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">board</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">useful</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span><span class="nx">predicting</span><span class="w"> </span><span class="nx">whether</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="nx">has</span><span class="w"> </span><span class="nx">won</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">game</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">not</span><span class="p">.</span>
<span class="err">#</span><span class="w"> </span><span class="nx">Input</span><span class="w"> </span><span class="nx">samples</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">top</span><span class="o">-</span><span class="nx">left</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">top</span><span class="o">-</span><span class="nx">middle</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span>
<span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">number</span><span class="o">-</span><span class="nx">of</span><span class="o">-</span><span class="nx">x</span><span class="o">-</span><span class="nx">wins</span><span class="err">&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">((</span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">top</span><span class="o">-</span><span class="nx">left</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">top</span><span class="o">-</span><span class="nx">middle</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">df</span>
<span class="w">    </span><span class="p">[</span><span class="err">&#39;</span><span class="nx">top</span><span class="o">-</span><span class="nx">right</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)).</span><span class="nx">astype</span><span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">middle</span><span class="o">-</span><span class="nx">left</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">middle</span>
<span class="w">    </span><span class="o">-</span><span class="nx">middle</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">middle</span><span class="o">-</span><span class="nx">right</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)).</span><span class="nx">astype</span><span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</code></pre></div>

<h1>Iteration 1</h1>
<p>Performance before adding features ROC 0.888 , ACC 0.700 .
Performance after adding features ROC 0.987 , ACC 0.980 .
Improvement ROC 0.099 , ACC 0.280 . Code was executed and changes to df retained.</p>
<div class="codehilite"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="p">(</span><span class="err">&#39;</span><span class="nx">number</span><span class="o">-</span><span class="nx">of</span><span class="o">-</span><span class="nx">o</span><span class="o">-</span><span class="nx">wins</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">Number</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">ways</span><span class="w"> </span><span class="nx">o</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">board</span><span class="err">&#39;</span><span class="p">)</span>
<span class="err">#</span><span class="w"> </span><span class="nx">Usefulness</span><span class="p">:</span><span class="w"> </span><span class="nx">Knowing</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">number</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">ways</span><span class="w"> </span><span class="nx">o</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">win</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">board</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">useful</span><span class="w"> </span><span class="k">in</span>
<span class="w">    </span><span class="nx">predicting</span><span class="w"> </span><span class="nx">whether</span><span class="w"> </span><span class="nx">o</span><span class="w"> </span><span class="nx">has</span><span class="w"> </span><span class="nx">won</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">game</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">not</span><span class="p">.</span>
<span class="err">#</span><span class="w"> </span><span class="nx">Input</span><span class="w"> </span><span class="nx">samples</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">top</span><span class="o">-</span><span class="nx">left</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">top</span><span class="o">-</span><span class="nx">middle</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="o">...</span>
<span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">number</span><span class="o">-</span><span class="nx">of</span><span class="o">-</span><span class="nx">o</span><span class="o">-</span><span class="nx">wins</span><span class="err">&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">((</span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">top</span><span class="o">-</span><span class="nx">left</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">top</span><span class="o">-</span><span class="nx">middle</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">df</span>
<span class="w">    </span><span class="p">[</span><span class="err">&#39;</span><span class="nx">top</span><span class="o">-</span><span class="nx">right</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">)).</span><span class="nx">astype</span><span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">((</span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">middle</span><span class="o">-</span><span class="nx">left</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">middle</span>
<span class="w">    </span><span class="o">-</span><span class="nx">middle</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">middle</span><span class="o">-</span><span class="nx">right</span><span class="o">-</span><span class="nx">square</span><span class="err">&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">)).</span><span class="nx">astype</span><span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="o">...</span><span class="p">]</span>
</code></pre></div>

<p>Iteration 2
Performance before adding features ROC 0.987 , ACC 0.980 .
Performance after adding features ROC 1.000 , ACC 1.000 .
Improvement ROC 0.013 , ACC 0.020 . Code was executed and changes to df retained.</p>
<p>Figure 4: Exemplary run of CAAFE on the Tic-Tac-Toe Endgame dataset. User generated input is shown in blue, ML-classifier generated data shown in red and LLM generated code is shown with syntax highlighting. The generated code contains a comment per generated feature that follows a template provided in our prompt (Feature name, description of usefulness, features used in the generated code and sample values of these features). In this run, CAAFE improves the ROC AUC on the validation dataset from 0.888 to 1.0 in two feature engineering iterations.</p>
<p>C Data types (e.g. float, int, category, string) - this adds information on how to handle a feature in the generated code</p>
<p>D Percentage of missing values - missing values are an additional challenge for code generation
E 10 random rows from the dataset - this provides information on the feature scale, encoding, etc.</p>
<p>Additionally, the prompt provides a template for the expected form of the generated code and explanations. Adding a template when prompting is a common technique to improve the quality of responses (OpenAI, 2023b). We use Chain-of-thought instructions - instructing a series of intermediate reasoning steps -, another effective technique for prompting (Wei et al., 2023). The prompt includes an example of one such Chain-of-thought for the code generation of one feature: first providing the high-level meaning and usefulness of the generated feature, providing the names of features used to generate it, retrieving sample values it would need to accept and finally writing a line of code. We provide the complete prompt in Figure 5 in the appendix.</p>
<p>If the execution of a code block raises an error, this error is passed to the LLM for the next code generation iteration. We observe that using this technique CAAFE recovered from all errors in our experiments. One such example can be found in Table 3.</p>
<p>Technical Setup The data is stored in a Pandas dataframe (Wes McKinney, 2010), which is preloaded into memory for code execution. The generated Python code is executed in an environment where the training and validation data frame is preloaded. The performance is measured on the current dataset with ten random validation splits $D_{\text {valid }}$ and the respective transformed datasets $D_{\text {valid }}^{\prime}$ with the mean change of accuracy and ROC AUC used to determine if the changes of a code block are kept, i.e. when the average of both is greater than 0 . We use OpenAI's GPT-4 and GPT-3.5 as LLMs (OpenAI, 2023a) in CAAFE. We perform ten feature engineering iterations and TabPFN (Hollmann et al., 2022) in the iterative evaluation of code blocks.</p>
<p>The automatic execution of AI-generated code carries inherent risks, such as misuse by malicious actors or unintended consequences from AI systems operating outside of controlled environments. Our approach is informed by previous studies on AI code generation and cybersecurity (Rohlf, 2023; Crockett, 2023). We parse the syntax of the generated python code and use a whitelist of operations that are allowed for execution. Thus operations such as imports, arbitrary function calls and others are excluded. This does not provide full security, however, e.g. does not exclude operations that can lead to infinite loops and excessive resource usage such as loops and list comprehensions.</p>
<h1>4 Experimental Setup</h1>
<p>Setup of Downstream-Classifiers We evaluate our method with Logistic Regression, Random Forests (Breiman, 2001) and TabPFN (Hollmann et al., 2022) for the final evaluation while using TabPFN to evaluate the performance of added features. We impute missing values with the mean, one-hot or ordinal encoded categorical inputs, normalized features and passed categorical feature indicators, where necessary, using the setup of Hollmann et al. (2022) ${ }^{1}$.</p>
<p>Setup of Automated Feature Engineering Methods We also evaluate popular context-agnostic feature engineering libraries Deep Feature Synthesis (DFS; Kanter \&amp; Veeramachaneni, 2015) and AutoFeat (Horn et al., 2019) ${ }^{2}$. We evaluate DFS and AutoFeat alone and in combination with CAAFE. When combined, CAAFE is applied first and the context-agnostic AutoFE method subsequently. For DFS we use the primitives "add_numeric" and "multiply_numeric", and default settings otherwise. For TabPFN, DFS generates more features than TabPFN accepts (the maximum number of features is 100) in some cases. In these cases, we set the performance to the performance without feature engineering. For AutoFeat, we use one feature engineering step and default settings otherwise.</p>
<p>Evaluating LLMs on Tabular Data The LLM's training data originates from the web, potentially including datasets and related notebooks. GPT-4 and GPT-3.5 have a knowledge cutoff in September 2021, i.e., almost all of its training data originated from before this date. Thus, an evaluation on established benchmarks can be biased since a textual description of these benchmarks might have been used in the training of the LLM.</p>
<p>We use two categories of datasets for our evaluation: (1) widely recognized datasets from OpenML released before September 2021, that could potentially be part of the LLMs training corpus and (2) lesser known datasets from Kaggle released after September 2021 and only accessible after accepting an agreement and thus harder to access by web crawlers.</p>
<p>From OpenML (Vanschoren et al., 2013; Feurer et al.), we use small datasets that have descriptive feature names (i.e. we do not include any datasets with numbered feature names). Datasets on OpenML contain a task description that we provide as user context to our method. When datasets are perfectly solvable with TabPFN alone (i.e. reaches ROC AUC of 1.0) we reduce the training set size for that dataset, marked in Table 1. We focus on small datasets with up to 2000 samples in total, because feature engineering is most important and significant for smaller datasets.</p>
<p>We describe the collection and preprocessing of datasets in detail in Appendix G.1.</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>Table 1: ROC AUC OVO results using TabPFN. $\pm$ indicates the standard deviation across 5 splits. [R] indicates datasets where reduced data was used because TabPFN had 100% accuracy by default, see Appendix G.1.</p>
<p>|  | TabPFN |  |  |
|  | No Feat. Eng. | CAAFE (GPT-3.5) | CAAFE (GPT-4) |
| airlines | $\mathbf{0 . 6 2 1 1} \pm .04$ | $0.619 \pm .04$ | $0.6203 \pm .04$ |
| balance-scale [R] | $0.8444 \pm .29$ | $0.844 \pm .31$ | $\mathbf{0 . 8 8 2} \pm .26$ |
| breast-w [R] | $0.9783 \pm .02$ | $\mathbf{0 . 9 8 0 9} \pm .02$ | $\mathbf{0 . 9 8 0 9} \pm .02$ |
| cmc | $0.7375 \pm .02$ | $0.7383 \pm .02$ | $\mathbf{0 . 7 3 9 3} \pm .02$ |
| credit-g | $0.7824 \pm .03$ | $0.7824 \pm .03$ | $\mathbf{0 . 7 8 3 2} \pm .03$ |
| diabetes | $0.8427 \pm .03$ | $\mathbf{0 . 8 4 3 4} \pm .03$ | $0.8425 \pm .03$ |
| eucalyptus | $\mathbf{0 . 9 3 1 9} \pm .01$ | $0.9317 \pm .01$ | $\mathbf{0 . 9 3 1 9} \pm .00$ |
| jungle_chess.. | $0.9334 \pm .01$ | $0.9361 \pm .01$ | $\mathbf{0 . 9 4 5 3} \pm .01$ |
| pc1 | $0.9035 \pm .01$ | $0.9087 \pm .02$ | $\mathbf{0 . 9 0 9 3} \pm .01$ |
| tic-tac-toe [R] | $0.6989 \pm .08$ | $0.6989 \pm .08$ | $\mathbf{0 . 9 5 3 6} \pm .06$ |
| $\langle$ Kaggle $\rangle$ health-insurance | $0.5745 \pm .02$ | $0.5745 \pm .02$ | $\mathbf{0 . 5 7 4 8} \pm .02$ |
| $\langle$ Kaggle $\rangle$ pharyngitis | $0.6976 \pm .03$ | $0.6976 \pm .03$ | $\mathbf{0 . 7 0 7 8} \pm .04$ |
| $\langle$ Kaggle $\rangle$ kidney-stone | $0.7883 \pm .04$ | $0.7873 \pm .04$ | $\mathbf{0 . 7 9 0 3} \pm .04$ |
| $\langle$ Kaggle $\rangle$ spaceship-titanic | $0.838 \pm .02$ | $0.8383 \pm .02$ | $\mathbf{0 . 8 4 0 5} \pm .02$ |</p>
<p>Evaluation Protocol For each dataset, we evaluate 5 repetitions, each with a different random seed and train- and test split to reduce the variance stemming from these splits (Bouthillier et al., 2021). We split into $50 \%$ train and $50 \%$ test samples and all methods used the same splits.</p>
<h1>5 Results</h1>
<p>In this section we showcase the results of our method in three different ways. First, we show that CAAFE can improve the performance of a state-of-the-art classifier. Next, we show how CAAFE interacts with traditional automatic feature engineering methods and conclude with examples of the features that CAAFE creates.</p>
<p>Table 2: Mean ROC AUC and average rank (ROC AUC) per downstream classification method and feature extension method. Best AutoFE method per base classifer is shown in bold. The features generated by CAAFE are chosen with TabPFN as classifier. Rank are calculated across all classifiers and feature engineering methods. FETCH was too computationally expensive to compute for all base classifiers in the rebuttal. Each seed and dataset takes up to 24 hours and has to be evaluated for each base classifer independently. Thus, we use features computed for logistic regression for all other classifiers.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;">Baselines</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;">CAAFE</th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">No FE</td>
<td style="text-align: left;">DFS</td>
<td style="text-align: left;">AutoFeat</td>
<td style="text-align: left;">FETCH</td>
<td style="text-align: left;">OpenFE</td>
<td style="text-align: left;">GPT-3.5</td>
<td style="text-align: left;">GPT-4</td>
</tr>
<tr>
<td style="text-align: left;">Log. Reg.</td>
<td style="text-align: left;">Mean</td>
<td style="text-align: left;">0.749</td>
<td style="text-align: left;">0.764</td>
<td style="text-align: left;">0.754</td>
<td style="text-align: left;">0.76</td>
<td style="text-align: left;">0.757</td>
<td style="text-align: left;">0.763</td>
<td style="text-align: left;">$\mathbf{0 . 7 6 9}$</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean Rank</td>
<td style="text-align: left;">27.4</td>
<td style="text-align: left;">$\mathbf{2 3 . 6}$</td>
<td style="text-align: left;">26.2</td>
<td style="text-align: left;">25.2</td>
<td style="text-align: left;">25</td>
<td style="text-align: left;">24.8</td>
<td style="text-align: left;">24.3</td>
</tr>
<tr>
<td style="text-align: left;">Random Forest</td>
<td style="text-align: left;">Mean</td>
<td style="text-align: left;">0.782</td>
<td style="text-align: left;">0.783</td>
<td style="text-align: left;">0.783</td>
<td style="text-align: left;">0.785</td>
<td style="text-align: left;">0.785</td>
<td style="text-align: left;">0.79</td>
<td style="text-align: left;">$\mathbf{0 . 8 0 3}$</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean Rank</td>
<td style="text-align: left;">23.4</td>
<td style="text-align: left;">22.1</td>
<td style="text-align: left;">21.8</td>
<td style="text-align: left;">23.5</td>
<td style="text-align: left;">22.3</td>
<td style="text-align: left;">23.1</td>
<td style="text-align: left;">$\mathbf{1 9 . 9}$</td>
</tr>
<tr>
<td style="text-align: left;">ASKL2</td>
<td style="text-align: left;">Mean</td>
<td style="text-align: left;">0.807</td>
<td style="text-align: left;">0.801</td>
<td style="text-align: left;">0.808</td>
<td style="text-align: left;">0.807</td>
<td style="text-align: left;">0.806</td>
<td style="text-align: left;">0.815</td>
<td style="text-align: left;">$\mathbf{0 . 8 1 8}$</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean Rank</td>
<td style="text-align: left;">12.2</td>
<td style="text-align: left;">12.9</td>
<td style="text-align: left;">12.6</td>
<td style="text-align: left;">13.4</td>
<td style="text-align: left;">13.5</td>
<td style="text-align: left;">$\mathbf{1 0 . 9}$</td>
<td style="text-align: left;">11.6</td>
</tr>
<tr>
<td style="text-align: left;">Autogluon</td>
<td style="text-align: left;">Mean</td>
<td style="text-align: left;">0.796</td>
<td style="text-align: left;">0.799</td>
<td style="text-align: left;">0.797</td>
<td style="text-align: left;">0.787</td>
<td style="text-align: left;">0.798</td>
<td style="text-align: left;">0.803</td>
<td style="text-align: left;">$\mathbf{0 . 8 1 2}$</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean Rank</td>
<td style="text-align: left;">17.6</td>
<td style="text-align: left;">15.4</td>
<td style="text-align: left;">16.4</td>
<td style="text-align: left;">17.6</td>
<td style="text-align: left;">16.6</td>
<td style="text-align: left;">15.8</td>
<td style="text-align: left;">$\mathbf{1 4 . 1}$</td>
</tr>
<tr>
<td style="text-align: left;">TabPFN</td>
<td style="text-align: left;">Mean</td>
<td style="text-align: left;">0.798</td>
<td style="text-align: left;">0.791</td>
<td style="text-align: left;">0.796</td>
<td style="text-align: left;">0.796</td>
<td style="text-align: left;">0.798</td>
<td style="text-align: left;">0.806</td>
<td style="text-align: left;">$\mathbf{0 . 8 2 2}$</td>
</tr>
<tr>
<td style="text-align: left;"></td>
<td style="text-align: left;">Mean Rank</td>
<td style="text-align: left;">13.9</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">14.8</td>
<td style="text-align: left;">16.5</td>
<td style="text-align: left;">13.9</td>
<td style="text-align: left;">12.9</td>
<td style="text-align: left;">$\mathbf{9 . 7 8}$</td>
</tr>
</tbody>
</table>
<p>Performance of CAAFE CAAFE can improve our strongest classifier, TabPFN, substantially. If it is used with GPT-4, we improve average ROC AUC performance from 0.798 to 0.822 , as shown in Table 2, and enhance the performance for 11/14 datasets. On the evaluated datasets, this improvement</p>
<p>Table 3: Examples of common strategies employed by CAAFE for feature extension. The full code and comments are automatically generated based on the user-provided dataset descriptions. CAAFE combines features, creates ordinal versions of numerical features through binning, performs string transformations, removes superfluous features, and even recovers from errors when generating invalid code.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Description</th>
<th style="text-align: center;">Generated code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Combination <br> Example from the Kaggle Kidney Stone dataset.</td>
<td style="text-align: center;"><code># Usefulness: Fever and rhinorrhea are two of the most common symptoms of respiratory infections, including GAS pharyngitis. This feature captures their co-occurrence. # Input samples: 'temperature': [38.0, 39.0, 39.5], 'rhinorrhea': [0.0, 0.0, 0.0] df['fever_and_rhinorrhea'] = ((df['temperature'] &gt;= 38.0) &amp; (df[' rhinorrhea'] &gt; 0)).astype(int)</code></td>
</tr>
<tr>
<td style="text-align: center;">Dinning <br> Example from the Kaggle Spaceship Titanic dataset.</td>
<td style="text-align: center;">```# Feature: AgeGroup (categorizes passengers into age groups) # Usefulness: Different age groups might have different likelihoods of being transported. # Input samples: 'Age': [30.0, 0.0, 37.0] bins = [0, 12, 18, 35, 60, 100] labels = ['Child', 'Teen', 'YoungAdult', 'Adult', 'Senior'] df['AgeGroup'] = pd.cut(df['Age'], bins=bins, labels=labels) df['AgeGroup'] = df['AgeGroup'].astype('category')</td>
</tr>
<tr>
<td style="text-align: center;">String transformation <br> Example from the Kaggle Spaceship Titanic dataset.</td>
<td style="text-align: center;"><code># Feature: Deck # Usefulness: The deck information can help identify patterns in the location of cabins associated with transported passengers. # Input samples: 'Cabin': ['F/356/S', 'G/86/P', 'C/37/P'] df['Deck'] = df['Cabin'].apply(lambda x: x[0] if isinstance(x, str) else 'Unknown') # Feature: CabinSide # Usefulness: The side of the cabin can help identify patterns in the location of cabins associated with transported passengers. # Input samples: 'Cabin': ['F/356/S', 'G/86/P', 'C/37/P'] df['CabinSide'] = df['Cabin'].apply(lambda x: x.split('/')[-I] if isinstance(x, str) else 'Unknown')</code></td>
</tr>
<tr>
<td style="text-align: center;">Removing features <br> Example from the Balance Scale dataset.</td>
<td style="text-align: center;">```# Drop original columns # Explanation: The original columns 'left-weight', 'left-distance', 'right-weight', and 'right-distance' can be dropped as the newly created columns 'left_moment', 'right_moment', and moment_difference' capture the relevant information for predicting the 'class'. df.drop(columns=['left-weight', 'left-distance', 'right-weight', right-distance'], inplace=True) # No more additional columns needed</td>
</tr>
<tr>
<td style="text-align: center;">Error Recovery <br> Example from the Kaggle Health Insurance dataset. The code execution failed because missing values were not considered in the dataframe. In the next iteration code is suggested that can handle missing values.</td>
<td style="text-align: center;"><code># Feature: Age_difference # Usefulness: Age difference between upper and lower age can be useful in determining the likelihood of a person applying for a policy. # Input samples: 'Upper_Age': ['C33', 'C2', 'C3'], 'Lower_Age': [' Owned', 'Rented', 'Rented'] df['Age_difference'] = df['Upper_Age'].str.extract('(\d+)').astype( int) - df['Lower_Age'].str.extract('(\d+)').astype(int) Feedback: failed with error: cannot convert float NaN to integer. # Feature: Age_difference # Usefulness: Age difference between upper and lower age can be useful in determining the likelihood of a person applying for a policy. # Input samples: 'Upper_Age': ['C33', 'C2', 'C3'], 'Lower_Age': [' Owned', 'Rented', 'Rented'] df['Age_difference'] = df['Upper_Age'].str.extract('(\d+)').astype( float).fillna(0) - df['Lower_Age'].str.extract('(\d+)').astype( float).fillna(0)</code></td>
</tr>
</tbody>
</table>
<p>is similar ( $71 \%$ ) to the average improvement achieved by using a random forest (AUC 0.783 ) instead of logistic regression (AUC 0.749 ). We can see that CAAFE even improves performance for all of the new datasets from Kaggle. If we use CAAFE with GPT-3.5 only, we can see that it performs clearly worse than with GPT-4, and only improves performance on 6/14 datasets.
There is great variability in the improvement size depending on whether (1) a problem is amenable to feature engineering, i.e. is there a mapping of features that explains the data better and that can be expressed through simple code; and (2) the quality of the dataset description (e.g., the balance-scale dataset contains an accurate description of how the dataset was constructed) Per dataset performance can be found in Table 1. CAAFE takes 4:43 minutes to run on each dataset, $90 \%$ of the time is spent on the LLM's code generation and $10 \%$ on the evaluation of the generated features. In Appendix F we plot the performance, time and cost of CAAFE across feature engineering iterations, showing the tradeoff between these parameters. For the 14 datasets, 5 splits and 10 CAAFE iterations, CAAFE generates 52 faulty features ( $7.4 \%$ ) in the generation stage, from which it recovers (see Figure 3).</p>
<p>Incorporating Classical AutoFE Methods Classical AutoFE methods can readily be combined with our method, one simply runs CAAFE first and then lets a classical AutoFE method find further feature extensions, as we did in Table 2. For less powerful downstream classifiers, namely Logistic Regression and Random Forests, we observe that applying AutoFE additionally to CAAFE improves performance further. The AutoML method TabPFN on the other hand is not improved by applying the evaluated AutoFE methods. This discrepancy might stem from the larger hypothesis space (complexity) of TabPFN, it can get all necessary information from the data directly. For all combinations of classifiers and additional AutoFE methods, we can see that CAAFE improves performance on average.</p>
<h1>6 Conclusion</h1>
<p>Our study presents a novel approach to integrating domain knowledge into the AutoML process through Context-Aware Automated Feature Engineering (CAAFE). By leveraging the power of large language models, CAAFE automates feature engineering for tabular datasets, generating semantically meaningful features and explanations of their utility. Our evaluation demonstrates the effectiveness of this approach, which complements existing automated feature engineering and AutoML methods.
This work emphasizes the importance of context-aware solutions in achieving robust outcomes. We expect that LLMs will also be useful for automating other aspects of the data science pipeline, such as data collection, processing, model building, and deployment. As large language models continue to improve, it is expected that the effectiveness of CAAFE will also increase.
Dataset descriptions play a critical role in our method; however, in our study, they were derived solely from web-crawled text associated with public datasets. If users were to provide more accurate and detailed descriptions, the effectiveness of our approach could be significantly improved.
However, our current approach has some limitations. Handling datasets with a large number of features can lead to very large prompts, which can be challenging for LLMs to process effectively. The testing procedure for adding features is not based on statistical tests, and could be improved using techniques of previous feature engineering works. LLMs, at times, exhibit a phenomenon known as "hallucinations.", where models produce inaccurate or invented information. Within CAAFE, this might result in the generation of features and associated explanations that appear significant and are logically presented, even though they may not be grounded in reality. Such behavior can be problematic, especially when individuals place trust in these systems for essential decision-making or research tasks. Finally, the usage of LLMs in automated data analysis comes with a set of societal and ethical challenges. Please see Section B for a discussion on the broader impact and ethical considerations.</p>
<p>Future research may explore prompt tuning, fine-tuning language models, and automatically incorporating domain-knowledge into models in other ways. Also, there may lie greater value in the interaction of human users with such automated methods, also termed human-in-the-loop AutoML (Lee \&amp; Macke, 2020), where human and algorithm interact continuously. This would be particularly easy with a setup similar to CAAFE, as the input and output of the LLM are interpretable and easily modified by experts.</p>
<h1>References</h1>
<p>Anaconda. The state of data science 2020. Website, 2020. URL https://www. anaconda.com/ state-of-data-science-2020.</p>
<p>Xavier Bouthillier, Pierre Delaunay, Mirko Bronzi, Assya Trofimov, Brennan Nichyporuk, Justin Szeto, Nazanin Mohammadi Sepahvand, Edward Raff, Kanika Madan, Vikram Voleti, Samira Ebrahimi Kahou, Vincent Michalski, Tal Arbel, Chris Pal, Gael Varoquaux, and Pascal Vincent. Accounting for variance in machine learning benchmarks. In A. Smola, A. Dimakis, and I. Stoica (eds.), Proceedings of Machine Learning and Systems, volume 3, pp. 747769, 2021. URL https://proceedings.mlsys.org/paper_files/paper/2021/file/ cfecdb276f634854f3ef915e2e980c31-Paper.pdf.</p>
<p>Leo Breiman. Random forests. Machine learning, 45:5-32, 2001.
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. Language models are few-shot learners. Advances in neural information processing systems, 33:1877-1901, 2020.</p>
<p>Adam Crockett. Ai generated code creates a new security attack vector, April 2023. URL https://dev.to/adam_cyclones/ ai-generated-code-creates-a-new-security-attack-vector-39if.</p>
<p>Tijl De Bie, Luc De Raedt, José Hernández-Orallo, Holger H Hoos, Padhraic Smyth, and Christopher KI Williams. Automating data science. Communications of the ACM, 65(3):76-87, 2022.</p>
<p>Matthias Feurer, Jan N. van Rijn, Arlind Kadra, Pieter Gijsbers, Neeratyoy Mallik, Sahithya Ravi, Andreas Mueller, Joaquin Vanschoren, and Frank Hutter. Openml-python: an extensible python api for openml. arXiv, 1911.02490. URL https://arxiv.org/pdf/1911.02490.pdf.</p>
<p>Stefan Hegselmann, Alejandro Buendia, Hunter Lang, Monica Agrawal, Xiaoyi Jiang, and David Sontag. Tabllm: Few-shot classification of tabular data with large language models, 2023.</p>
<p>Dan Hendrycks, Collin Burns, Saurav Kadavath, Akul Arora, Steven Basart, Eric Tang, Dawn Song, and Jacob Steinhardt. Measuring mathematical problem solving with the MATH dataset. CoRR, abs/2103.03874, 2021. URL https://arxiv.org/abs/2103.03874.</p>
<p>Noah Hollmann, Samuel Müller, Katharina Eggensperger, and Frank Hutter. Tabpfn: A transformer that solves small tabular classification problems in a second. arXiv preprint arXiv:2207.01848, 2022.</p>
<p>Franziska Horn, Robert Pack, and Michael Rieger. The autofeat python library for automatic feature engineering and selection. CoRR, abs/1901.07329, 2019. URL http://arxiv.org/abs/1901. 07329 .
F. Hutter, L. Kotthoff, and J. Vanschoren (eds.). Automated Machine Learning: Methods, Systems, Challenges. Springer, 2019. Available for free at http://automl.org/book.</p>
<p>James Max Kanter and Kalyan Veeramachaneni. Deep feature synthesis: Towards automating data science endeavors. In 2015 IEEE international conference on data science and advanced analytics (DSAA), pp. 1-10. IEEE, 2015.</p>
<p>Udayan Khurana, Deepak Turaga, Horst Samulowitz, and Srinivasan Parthasrathy. Cognito: Automated feature engineering for supervised learning. In 2016 IEEE 16th International Conference on Data Mining Workshops (ICDMW), pp. 1304-1307, 2016. doi: 10.1109/ICDMW.2016.0190.</p>
<p>Udayan Khurana, Horst Samulowitz, and Deepak Turaga. Feature engineering for predictive modeling using reinforcement learning. In Proceedings of the AAAI Conference on Artificial Intelligence, volume 32, 2018.</p>
<p>Doris Jung-Lin Lee and Stephen Macke. A human-in-the-loop perspective on automl: Milestones and the road ahead. IEEE Data Engineering Bulletin, 2020.</p>
<p>Avanika Narayan, Ines Chami, Laurel Orr, Simran Arora, and Christopher Ré. Can foundation models wrangle your data?, 2022.</p>
<p>Fatemeh Nargesian, Horst Samulowitz, Udayan Khurana, Elias B Khalil, and Deepak S Turaga. Learning feature engineering for classification. In Ijcai, volume 17, pp. 2529-2535, 2017.</p>
<p>OpenAI. Gpt-4 technical report, 2023a.
OpenAI. openai/openai-cookbook: Examples and guides for using the openai api. https://github. com/openai/openai-cookbook, 2023b. (Accessed on 04/20/2023).</p>
<p>OpenAI Community. GPT-3 can't count syllables - or doesn't "get" haiku. https://community . openai.com/t/gpt-3-cant-count-syllables-or-doesnt-get-haiku/18733, 2021. Accessed on: 2023-03-21.</p>
<p>Vinay Uday Prabhu and Abeba Birhane. Large image datasets: A pyrrhic win for computer vision?, 2020.</p>
<p>Inioluwa Deborah Raji, Emily M. Bender, Amandalynne Paullada, Emily Denton, and Alex Hanna. Ai and the everything in the whole wide world benchmark, 2021.</p>
<p>Chris Rohlf. Ai code generation and cybersecurity, April 2023. URL https://www.cfr.org/ blog/ai-code-generation-and-cybersecurity.</p>
<p>Alaina N. Talboy and Elizabeth Fuller. Challenging the appearance of machine intelligence: Cognitive bias in llms and best practices for adoption, 2023.</p>
<p>Joaquin Vanschoren, Jan N. van Rijn, Bernd Bischl, and Luis Torgo. Openml: Networked science in machine learning. SIGKDD Explorations, 15(2):49-60, 2013. doi: 10.1145/2641190.2641198. URL http://doi.acm.org/10.1145/2641190.2641198.</p>
<p>Joaquin Vanschoren, Jan N. van Rijn, Bernd Bischl, and Luís Torgo. Openml: networked science in machine learning. CoRR, abs/1407.7722, 2014. URL http://arxiv.org/abs/1407.7722.</p>
<p>Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. Attention is all you need. CoRR, abs/1706.03762, 2017. URL http://arxiv.org/abs/1706.03762.</p>
<p>David Vos, Till Döhmen, and Sebastian Schelter. Towards parameter-efficient automation of data wrangling tasks with prefix-tuning. In NeurIPS 2022 First Table Representation Workshop, 2022. URL https://openreview.net/forum?id=8kyYJs2YkFH.</p>
<p>Hilde Weerts, Florian Pfisterer, Matthias Feurer, Katharina Eggensperger, Edward Bergman, Noor Awad, Joaquin Vanschoren, Mykola Pechenizkiy, Bernd Bischl, and Frank Hutter. Can fairness be automated? guidelines and opportunities for fairness-aware automl, 2023.</p>
<p>Jason Wei, Maarten Bosma, Vincent Y Zhao, Kelvin Guu, Adams Wei Yu, Brian Lester, Nan Du, Andrew M Dai, and Quoc V Le. Finetuned language models are zero-shot learners. arXiv preprint arXiv:2109.01652, 2021.</p>
<p>Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Brian Ichter, Fei Xia, Ed Chi, Quoc Le, and Denny Zhou. Chain-of-thought prompting elicits reasoning in large language models, 2023.</p>
<p>Wes McKinney. Data Structures for Statistical Computing in Python. In Stéfan van der Walt and Jarrod Millman (eds.), Proceedings of the 9th Python in Science Conference, pp. 56 - 61, 2010. doi: 10.25080/Majora-92bf1922-00a.</p>
<p>Svante Wold, Kim Esbensen, and Paul Geladi. Principal component analysis. Chemometrics and intelligent laboratory systems, 2(1-3):37-52, 1987.</p>
<p>Jianyu Zhang, Jianye Hao, Françoise Fogelman-Soulié, and Zan Wang. Automatic feature engineering by deep reinforcement learning. In Proceedings of the 18th International Conference on Autonomous Agents and MultiAgent Systems, pp. 2312-2314, 2019.</p>
<p>Daniel M Ziegler, Nisan Stiennon, Jeffrey Wu, Tom B Brown, Alec Radford, Dario Amodei, Paul Christiano, and Geoffrey Irving. Fine-tuning language models from human preferences. arXiv preprint arXiv:1909.08593, 2019.</p>
<h1>A Acknowledgements</h1>
<p>GPT-4 (OpenAI, 2023a) was used in the following ways: to help us iterate on LaTeX formatting and diagram plotting; for text summarization; and as a copyediting tool; for rephrasing proposals.</p>
<h2>B Broader Impact Statement</h2>
<h2>B. 1 Social Impact of Automation</h2>
<p>The broader implications of our research may contribute to the automation of data science tasks, potentially displacing workers in the field. However, CAAFE crucially depends on the users inputs for feature generation and processing and provides an example of human-in-the-loop AutoML. The automation of routine tasks could free up data scientists to focus on higher-level problem-solving and decision-making activities. It is essential for stakeholders to be aware of these potential consequences, and to consider strategies for workforce education and adaptation to ensure a smooth transition as AI technologies continue to evolve.</p>
<h2>B. 2 Replication of Biases</h2>
<p>AI algorithms have been observed to replicate and perpetuate biases observed in their training data distribution. CAAFE leverages GPT-4, which has been trained on web crawled data that contains existing social biases and generated features may be biased on these biases. An example study of such biases in web-crawled data was done by Prabhu \&amp; Birhane (2020). When data that contains demographic information or other data that can potentially be used to discriminate against groups, we advise not to use CAAFE or to proceed with great caution, double checking the generated features.
We would like to mention the best practice studies on fairness for AutoML by Weerts et al. (2023) and on bias in the use of LLMs by Talboy \&amp; Fuller (2023).
Weerts et al. (2023) give recommendations for what AutoML developers can do to improve fairnessconscious AutoML, and we follow the three most emphasized closely. i) We clearly emphasize the limitations and biases of our method. i) We emphasize the 'Usefulness' comment that our prompt asks the LLM to write into our UI to "help users identify sources of fairness-related harm", as Weerts et al. (2023) write. ii) We execute code only after asking the user for explicit confirmation that it does not contain dangerous actions or biases; these kinds of design decisions are called "seam-full design" by (Weerts et al., 2023).
(Talboy \&amp; Fuller, 2023) give recommendations on how to best use LLMs. Their recommendation, which we as interface developers can more easily follow, is the one they emphasize the most. Namely, that "LLMs [...] should be used as decision support tools, not final decision makers. We follow this closely by not allowing the LLM to execute code without the user's explicit consent.
The choice of benchmarks can also introduce dangerous biases in machine learning methods, as there are only a few that dominate the landscape (Raji et al., 2021). We address this problem by using datasets from two different sources (Kaggle and OpenML). In addition, we use multiple datasets from each source.</p>
<p>How Can Biases Arise in CAAFE? Since we are using a trained model (the LLM) to define the training setup (features used) of a downstream classifier trained on potentially biased data, we can have bias at three levels: i) at the level of the LLM, and ii) at the level of the generated features, ii) at the level of the downstream classifier.
The level of the downstream classifier is affected by the previous two levels, but is not directly affected by CAAFE, so we do not discuss it in detail. Here, as in any data science application, the user must be careful to use unbiased data. The way we set up CAAFE has some robustness against biases in the first two steps, which are controlled by CAAFE:
i) We use GPT-4, where great care has been taken to mitigate biases - still it does contain biases in its generations. We add a statement that choosing a language model that is trained to mitigate biases is a crucial step for the user to tackle this problem.</p>
<p>ii) Feature engineering operations by the LLM are only retained if they lead to improvements in cross-validation, due to the way our method is set up (we generate code and verify that it improves performance at each step). This gives us a slightly better defense against bias than using the LLM outputs directly, since biases that are present in the LLM but not in the data are discarded.</p>
<p>However, since the biases of the LLM and the dataset are most likely not independent, there is still a risk that the two will be aligned. To illustrate this risk and make users aware of potential problems, we include an illustrative Example (see end of this reply).</p>
<p>Simple Example We have built a fake dataset that has only one feature, a person's name, and as output we want to predict whether the person is a doctor or a nurse. The description of the dataset used in our challenge is</p>
<div class="codehilite"><pre><span></span><code><span class="nx">Doctor</span><span class="o">-</span><span class="k">or</span><span class="o">-</span><span class="nx">Nurse</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">dataset</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">asks</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">predict</span><span class="w"> </span><span class="nx">whether</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">person</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">doctor</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">nurse</span>
<span class="w">    </span><span class="nx">just</span><span class="w"> </span><span class="nx">based</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">their</span><span class="w"> </span><span class="nx">name</span><span class="p">.</span>
<span class="nx">The</span><span class="w"> </span><span class="nx">intentionally</span><span class="w"> </span><span class="nx">biased</span><span class="w"> </span><span class="nx">sample</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">dataset</span><span class="w"> </span><span class="nx">shown</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">LLM</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">prompt</span><span class="w"> </span><span class="k">is</span>
<span class="nx">Columns</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">df</span><span class="err">&#39;</span><span class="w"> </span><span class="p">(</span><span class="kc">true</span><span class="w"> </span><span class="nx">feature</span><span class="w"> </span><span class="nx">dtypes</span><span class="w"> </span><span class="nx">listed</span><span class="w"> </span><span class="nx">here</span><span class="p">,</span><span class="w"> </span><span class="nx">categoricals</span><span class="w"> </span><span class="nx">encoded</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nx">int</span><span class="p">):</span>
<span class="nx">Name</span><span class="w"> </span><span class="p">(</span><span class="nx">object</span><span class="p">):</span><span class="w"> </span><span class="nx">NaN</span><span class="o">-</span><span class="nx">freq</span><span class="w"> </span><span class="p">[</span><span class="m m-Double">0.0</span><span class="o">%</span><span class="p">],</span><span class="w"> </span><span class="nx">Samples</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;</span><span class="nx">Anna</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">Jack</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">Frank</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">Laura</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">Travis</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span>
<span class="w">    </span><span class="nx">Sophia</span><span class="err">&#39;</span><span class="p">]</span>
<span class="nx">is_doctor</span><span class="w"> </span><span class="p">(</span><span class="nx">int</span><span class="p">):</span><span class="w"> </span><span class="nx">NaN</span><span class="o">-</span><span class="nx">freq</span><span class="w"> </span><span class="p">[</span><span class="m m-Double">0.0</span><span class="o">%</span><span class="p">],</span><span class="w"> </span><span class="nx">Samples</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>

<p>In all cases in this sample a name commonly associated with male gender is associated with a doctor. Additionally, we only used female names ending in an "a".</p>
<p>We can see that GPT-4 tends to suggest an attribute that uses the typically gender-associated ending of the name to classify, i.e. it generates the following output</p>
<div class="codehilite"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="nx">Feature</span><span class="p">:</span><span class="w"> </span><span class="nx">end_with_a</span>
<span class="err">#</span><span class="w"> </span><span class="nx">Usefulness</span><span class="p">:</span><span class="w"> </span><span class="nx">Names</span><span class="w"> </span><span class="nx">ending</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="w"> </span><span class="nx">might</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">more</span><span class="w"> </span><span class="nx">common</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">females</span><span class="p">.</span><span class="w"> </span><span class="nx">Assuming</span><span class="w"> </span><span class="nx">there</span><span class="w"> </span><span class="nx">might</span>
<span class="w">    </span><span class="nx">be</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">gender</span><span class="w"> </span><span class="nx">bias</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">doctor</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">nurse</span><span class="w"> </span><span class="nx">profession</span><span class="p">,</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">could</span><span class="w"> </span><span class="nx">provide</span><span class="w"> </span><span class="nx">some</span><span class="w"> </span><span class="nx">useful</span>
<span class="w">    </span><span class="nx">information</span><span class="p">.</span>
<span class="err">#</span><span class="w"> </span><span class="nx">Input</span><span class="w"> </span><span class="nx">samples</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="err">&#39;</span><span class="nx">Anna</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">Jack</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">Frank</span><span class="err">&#39;</span><span class="p">]</span>
<span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">end_with_a</span><span class="err">&#39;</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">df</span><span class="p">[</span><span class="err">&#39;</span><span class="nx">Name</span><span class="err">&#39;</span><span class="p">].</span><span class="nx">str</span><span class="p">.</span><span class="nx">endswith</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">).</span><span class="nx">astype</span><span class="p">(</span><span class="nx">int</span><span class="p">)</span>
</code></pre></div>

<p>Listing 1: CAAFE output</p>
<p>We can see that our prompt actually makes it very easy to detect the bias of the LLM in this case, since the 'Usefulness' comment the LLM is asked to provide, at least in this non-cherry-picked example, just gives away its bias.</p>
<h1>B. 3 AI Model Interpretability</h1>
<p>As the adoption of advanced AI methods grows, it becomes increasingly important to comprehend and interpret their results. Our approach aims to enhance interpretability by providing clear explanations of model outputs and generating simple code, thus making the automated feature engineering process more transparent.</p>
<h2>B. 4 Risk of increasing AI capabilities</h2>
<p>We do not believe this research affects the general capabilities of LLMs but rather demonstrates their application. As such we estimate our work does not contribute to the risk of increasing AI capabilities.</p>
<h2>C Reproducibility</h2>
<p>Code release In an effort to ensure reproducibility, we release code to reproduce our experiments at https://github.com/autom1/CAAFE We release a minimal demo at a simple demo.
Availability of datasets All datasets used in our experiments are freely available at OpenML.org (Vanschoren et al., 2014) or at kaggle. com, with downloading procedures included in the submission.</p>
<h1>D Full LLM Prompt</h1>
<p>Figure 5 shows the full prompt for one examplary dataset. The generated prompts are in our repository: https://github.com/automl/CAAFE/tree/main/data/generated_code.</p>
<p>The dataframe 'df' is loaded and in memory. Columns are also named attributes.
Description of the dataset in 'df' (column dtypes might be inaccurate):
'++Tic-Tac-Toe Endgame database++
This database encodes the complete set of possible board configurations at the end of tic-tactoe games, where " $x$ " is assumed to have played first. The target concept is "win for $x$ " (i.e., true when " $x$ " has one of 8 possible ways to create a "three-in-a-row"). "</p>
<p>Columns in 'df' (true feature dtypes listed here, categoricals encoded as int):
top-left-square (int32): NaN-freq [0.0\%], Samples [2, 2, 2, 2, 2, 2, 0, 1, 1, 2]
top-middle-square (int32): NaN-freq [0.0\%], Samples [0, 0, 1, 1, 1, 2, 0, 2, 2, 2]
top-right-square (int32): NaN-freq [0.0\%], Samples [1, 0, 1, 2, 1, 1, 1, 0, 2, 1]
middle-left-square (int32): NaN-freq [0.0\%], Samples [1, 0, 2, 1, 2, 0, 0, 2, 1, 2]
middle-middle-square (int32): NaN-freq [0.0\%], Samples [0, 2, 2, 1, 2, 1, 1, 1, 2, 1]
middle-right-square (int32): NaN-freq [0.0\%], Samples [1, 1, 2, 2, 2, 2, 0, 0, 0, 0]
bottom-left-square (int32): NaN-freq [0.0\%], Samples [2, 1, 1, 0, 0, 1, 2, 0, 1, 1]
bottom-middle-square (int32): NaN-freq [0.0\%], Samples [2, 0, 0, 0, 1, 2, 2, 2, 1, 0]
bottom-right-square (int32): NaN-freq [0.0\%], Samples [2, 2, 0, 2, 0, 1, 2, 1, 2, 0]
Class (category): NaN-freq [0.0\%], Samples [1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0]</p>
<p>This code was written by an expert datascientist working to improve predictions. It is a snippet of code that adds new columns to the dataset.
Number of samples (rows) in training dataset: 71
This code generates additional columns that are useful for a downstream classification algorithm (such as XGBoost) predicting "Class".
Additional columns add new semantic information, that is they use real world knowledge on the dataset. They can e.g. be feature combinations, transformations, aggregations where the new column is a function of the existing columns.
The scale of columns and offset does not matter. Make sure all used columns exist. Follow the above description of columns closely and consider the datatypes and meanings of classes.
This code also drops columns, if these may be redundant and hurt the predictive performance of the downstream classifier (Feature selection). Dropping columns may help as the chance of overfitting is lower, especially if the dataset is small.
The classifier will be trained on the dataset with the generated columns and evaluated on a holdout set. The evaluation metric is accuracy. The best performing code will be selected</p>
<p>Added columns can be used in other codeblocks, dropped columns are not available anymore.
Code formatting for each added column:
' " python
# (Feature name and description)
# Usefulness: (Description why this adds useful real world knowledge to classify "Class" according to dataset description and attributes.)
# Input samples: (Three samples of the columns used in the following code, e.g. 'top-leftsquare': [2, 2, 2], 'top-middle-square': [0, 0, 1], ...)
(Some pandas code using top-left-square', 'top-middle-square', ... to add a new column for each row in df)
' "end
Code formatting for dropping columns:
' " python
# Explanation why the column XX is dropped
df drop(columns=['XX'], inplace=True)
' "end
Each codeblock generates exactly one useful column and can drop unused columns (Feature selection).
Each codeblock ends with ' "end and starts with "' "python"
Codeblock:</p>
<p>Figure 5: Full LLM Prompt for the CMC dataset. The generated code will be the reply to this prompt.</p>
<h1>E Additional Results</h1>
<h2>E. 1 Semantic Blinding</h2>
<p>Semantic information, i.e. the context of the dataset and its columns, is crucial and can only be captured through laborious human work or our novel approach of using LLMs - this is the core of our approach. To further verify and quantify this claim, we perform an experiment where the context of the dataset is left out (i.e. feature names and dataset description are not given to the LLM). We find a strong drop in performance from an average AUROC of 0.822 to 0.8 over all datasets for GPT-4.</p>
<p>Table 4: CAAFE with semantic and without "Semantic Blinding". For "Semantic Blinding" feature names and the dataset description is concealed to CAAFE. Mean ROC AUC and average rank (ROC AUC) per downstream classification method and feature extension method is shown. Best performing AutoFE method per classifier is shown in bild. The features generated by CAAFE are chosen with TabPFN as classifier. Ranks are calculated across all classifiers and feature engineering methods.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;">No FE</th>
<th style="text-align: center;">GPT-3.5 <br> Semantic Blinding</th>
<th style="text-align: center;">Default</th>
<th style="text-align: center;">Semantic Blinding</th>
<th style="text-align: center;">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Log. Reg.</td>
<td style="text-align: center;">Mean</td>
<td style="text-align: center;">0.749</td>
<td style="text-align: center;">0.754</td>
<td style="text-align: center;">0.763</td>
<td style="text-align: center;">0.749</td>
<td style="text-align: center;">0.769</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Mean Rank</td>
<td style="text-align: center;">19.6</td>
<td style="text-align: center;">19.1</td>
<td style="text-align: center;">17.8</td>
<td style="text-align: center;">19.3</td>
<td style="text-align: center;">17.4</td>
</tr>
<tr>
<td style="text-align: center;">Random Forest</td>
<td style="text-align: center;">Mean</td>
<td style="text-align: center;">0.782</td>
<td style="text-align: center;">0.789</td>
<td style="text-align: center;">0.79</td>
<td style="text-align: center;">0.783</td>
<td style="text-align: center;">0.803</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Mean Rank</td>
<td style="text-align: center;">17.2</td>
<td style="text-align: center;">16.5</td>
<td style="text-align: center;">16.8</td>
<td style="text-align: center;">16.5</td>
<td style="text-align: center;">14.6</td>
</tr>
<tr>
<td style="text-align: center;">ASKL2</td>
<td style="text-align: center;">Mean</td>
<td style="text-align: center;">0.807</td>
<td style="text-align: center;">0.812</td>
<td style="text-align: center;">0.815</td>
<td style="text-align: center;">0.809</td>
<td style="text-align: center;">0.818</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Mean Rank</td>
<td style="text-align: center;">9.17</td>
<td style="text-align: center;">9.29</td>
<td style="text-align: center;">8.16</td>
<td style="text-align: center;">8.88</td>
<td style="text-align: center;">8.59</td>
</tr>
<tr>
<td style="text-align: center;">Autogluon</td>
<td style="text-align: center;">Mean</td>
<td style="text-align: center;">0.796</td>
<td style="text-align: center;">0.803</td>
<td style="text-align: center;">0.803</td>
<td style="text-align: center;">0.801</td>
<td style="text-align: center;">0.812</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Mean Rank</td>
<td style="text-align: center;">12.9</td>
<td style="text-align: center;">12.2</td>
<td style="text-align: center;">11.6</td>
<td style="text-align: center;">12.7</td>
<td style="text-align: center;">10.3</td>
</tr>
<tr>
<td style="text-align: center;">TabPFN</td>
<td style="text-align: center;">Mean</td>
<td style="text-align: center;">0.798</td>
<td style="text-align: center;">0.807</td>
<td style="text-align: center;">0.806</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">0.822</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;">Mean Rank</td>
<td style="text-align: center;">10.5</td>
<td style="text-align: center;">9.33</td>
<td style="text-align: center;">9.71</td>
<td style="text-align: center;">9.33</td>
<td style="text-align: center;">7.59</td>
</tr>
</tbody>
</table>
<h2>E. 2 Per Dataset Results</h2>
<p>Table 5: ROC AUC OVO results per dataset and downstream classification method. CAAFE optimized for strong performance on TabPFN.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;">AutoFE-Base</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">CAAFE</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">AutoFE-Base + CAAFE</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">AutoFeat</td>
<td style="text-align: center;">DFS</td>
<td style="text-align: center;">GPT-3.5</td>
<td style="text-align: center;">GPT-4</td>
<td style="text-align: center;">GPT-4 + AF</td>
<td style="text-align: center;">GPT-4 + DFS</td>
</tr>
<tr>
<td style="text-align: center;">airlines</td>
<td style="text-align: center;">$0.6211 \pm .04$</td>
<td style="text-align: center;">$0.6076 \pm .04$</td>
<td style="text-align: center;">$0.595 \pm .04$</td>
<td style="text-align: center;">$0.619 \pm .04$</td>
<td style="text-align: center;">$0.6203 \pm .04$</td>
<td style="text-align: center;">$0.602 \pm .04$</td>
<td style="text-align: center;">$0.5966 \pm .04$</td>
</tr>
<tr>
<td style="text-align: center;">balance-scale</td>
<td style="text-align: center;">$0.8444 \pm .29$</td>
<td style="text-align: center;">$0.8438 \pm .30$</td>
<td style="text-align: center;">$0.8428 \pm .31$</td>
<td style="text-align: center;">$0.844 \pm .31$</td>
<td style="text-align: center;">$\mathbf{0 . 8 8 2} \pm .26$</td>
<td style="text-align: center;">$0.8812 \pm .27$</td>
<td style="text-align: center;">$0.8773 \pm .27$</td>
</tr>
<tr>
<td style="text-align: center;">breast-w</td>
<td style="text-align: center;">$0.9783 \pm .02$</td>
<td style="text-align: center;">$0.9713 \pm .03$</td>
<td style="text-align: center;">$0.9783 \pm .02$</td>
<td style="text-align: center;">$\mathbf{0 . 9 8 0 9} \pm .02$</td>
<td style="text-align: center;">$\mathbf{0 . 9 8 0 9} \pm .02$</td>
<td style="text-align: center;">$0.9713 \pm .03$</td>
<td style="text-align: center;">$\mathbf{0 . 9 8 0 9} \pm .02$</td>
</tr>
<tr>
<td style="text-align: center;">cmc</td>
<td style="text-align: center;">$0.7375 \pm .02$</td>
<td style="text-align: center;">$0.7384 \pm .02$</td>
<td style="text-align: center;">$0.7349 \pm .02$</td>
<td style="text-align: center;">$0.7383 \pm .02$</td>
<td style="text-align: center;">$\mathbf{0 . 7 3 9 3} \pm .02$</td>
<td style="text-align: center;">$0.7386 \pm .02$</td>
<td style="text-align: center;">$0.7362 \pm .02$</td>
</tr>
<tr>
<td style="text-align: center;">credit-g</td>
<td style="text-align: center;">$0.7824 \pm .03$</td>
<td style="text-align: center;">$0.7819 \pm .03$</td>
<td style="text-align: center;">$0.7824 \pm .03$</td>
<td style="text-align: center;">$0.7824 \pm .03$</td>
<td style="text-align: center;">$0.7832 \pm .03$</td>
<td style="text-align: center;">$\mathbf{0 . 7 8 4} \pm .03$</td>
<td style="text-align: center;">$0.7824 \pm .03$</td>
</tr>
<tr>
<td style="text-align: center;">diabetes</td>
<td style="text-align: center;">$0.8427 \pm .03$</td>
<td style="text-align: center;">$0.8414 \pm .03$</td>
<td style="text-align: center;">$0.8417 \pm .03$</td>
<td style="text-align: center;">$\mathbf{0 . 8 4 3 4} \pm .03$</td>
<td style="text-align: center;">$0.8425 \pm .03$</td>
<td style="text-align: center;">$0.8432 \pm .03$</td>
<td style="text-align: center;">$0.8382 \pm .03$</td>
</tr>
<tr>
<td style="text-align: center;">eucalyptus</td>
<td style="text-align: center;">$0.9319 \pm .01$</td>
<td style="text-align: center;">$0.9321 \pm .01$</td>
<td style="text-align: center;">$0.9319 \pm .01$</td>
<td style="text-align: center;">$0.9317 \pm .01$</td>
<td style="text-align: center;">$0.9319 \pm .00$</td>
<td style="text-align: center;">$\mathbf{0 . 9 3 2 3} \pm .01$</td>
<td style="text-align: center;">$0.9319 \pm .01$</td>
</tr>
<tr>
<td style="text-align: center;">jungle_chess..</td>
<td style="text-align: center;">$0.9334 \pm .01$</td>
<td style="text-align: center;">$0.9197 \pm .01$</td>
<td style="text-align: center;">$0.9284 \pm .01$</td>
<td style="text-align: center;">$0.9361 \pm .01$</td>
<td style="text-align: center;">$0.9453 \pm .01$</td>
<td style="text-align: center;">$\mathbf{0 . 9 5 3 5} \pm .01$</td>
<td style="text-align: center;">$0.94 \pm .01$</td>
</tr>
<tr>
<td style="text-align: center;">$\langle$ Kaggle $\rangle$ health-insurance</td>
<td style="text-align: center;">$0.5745 \pm .02$</td>
<td style="text-align: center;">$\mathbf{0 . 5 8 0 5} \pm .03$</td>
<td style="text-align: center;">$0.5753 \pm .02$</td>
<td style="text-align: center;">$0.5745 \pm .02$</td>
<td style="text-align: center;">$0.5748 \pm .02$</td>
<td style="text-align: center;">$0.5777 \pm .03$</td>
<td style="text-align: center;">$0.5782 \pm .03$</td>
</tr>
<tr>
<td style="text-align: center;">$\langle$ Kaggle $\rangle$ pharyngitis</td>
<td style="text-align: center;">$0.6976 \pm .03$</td>
<td style="text-align: center;">$0.6976 \pm .03$</td>
<td style="text-align: center;">$0.6976 \pm .03$</td>
<td style="text-align: center;">$0.6976 \pm .03$</td>
<td style="text-align: center;">$\mathbf{0 . 7 0 7 8} \pm .04$</td>
<td style="text-align: center;">$0.7073 \pm .04$</td>
<td style="text-align: center;">$0.6976 \pm .03$</td>
</tr>
<tr>
<td style="text-align: center;">$\langle$ Kaggle $\rangle$ kidney-stone</td>
<td style="text-align: center;">$0.7883 \pm .04$</td>
<td style="text-align: center;">$0.7856 \pm .04$</td>
<td style="text-align: center;">$0.7929 \pm .04$</td>
<td style="text-align: center;">$0.7873 \pm .04$</td>
<td style="text-align: center;">$0.7903 \pm .04$</td>
<td style="text-align: center;">$0.7875 \pm .04$</td>
<td style="text-align: center;">$\mathbf{0 . 7 9 6 7} \pm .03$</td>
</tr>
<tr>
<td style="text-align: center;">$\langle$ Kaggle $\rangle$ spaceship-titanic</td>
<td style="text-align: center;">$0.838 \pm .02$</td>
<td style="text-align: center;">$0.8486 \pm .02$</td>
<td style="text-align: center;">$0.8443 \pm .02$</td>
<td style="text-align: center;">$0.8383 \pm .02$</td>
<td style="text-align: center;">$0.8405 \pm .02$</td>
<td style="text-align: center;">$\mathbf{0 . 8 5 3} \pm .02$</td>
<td style="text-align: center;">$0.8486 \pm .02$</td>
</tr>
<tr>
<td style="text-align: center;">pc1</td>
<td style="text-align: center;">$0.9035 \pm .01$</td>
<td style="text-align: center;">$0.9046 \pm .01$</td>
<td style="text-align: center;">$0.9035 \pm .01$</td>
<td style="text-align: center;">$0.9087 \pm .02$</td>
<td style="text-align: center;">$\mathbf{0 . 9 0 9 3} \pm .01$</td>
<td style="text-align: center;">$0.908 \pm .01$</td>
<td style="text-align: center;">$0.9035 \pm .01$</td>
</tr>
<tr>
<td style="text-align: center;">tic-tac-toe</td>
<td style="text-align: center;">$0.6989 \pm .08$</td>
<td style="text-align: center;">$0.6989 \pm .08$</td>
<td style="text-align: center;">$0.6291 \pm .10$</td>
<td style="text-align: center;">$0.6989 \pm .08$</td>
<td style="text-align: center;">$\mathbf{0 . 9 5 3 6} \pm .06$</td>
<td style="text-align: center;">$\mathbf{0 . 9 5 3 6} \pm .06$</td>
<td style="text-align: center;">$0.938 \pm .06$</td>
</tr>
</tbody>
</table>
<h2>E. 3 Generated Prompts and Code</h2>
<p>You can find the generated prompts and the respective LLM generated code in our repository: https://github.com/cafeautomatedfeatures/CAFE/tree/main/data/generated_code.</p>
<h1>F Compute</h1>
<p><img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Figure 6: Mean ROC AUC OVO, inference cost for GPT and time spent with an increasing number of feature generation runs.</p>
<p>Figure F illustrates the increasing performance but also cost and time spent for more feature engineering iterations. Prediction for LLMs is done per token and so the generation of code takes dominates the 4:43 minutes evaluation time of CAAFE on average per dataset. For GPT-3.5 this time is reduce to about $1 / 4$. Also for GPT-3.5 the cost is reduced to $1 / 10$ as of the writing of this paper. For the evaluation of TabPFN we use one Nvidia RTX 2080 Ti as well as 8 Intel(R) Xeon(R) Gold 6242 CPU @ 2.80 GHz CPU cores.</p>
<h2>G Datasets</h2>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: right;"># Features</th>
<th style="text-align: right;"># Samples</th>
<th style="text-align: right;"># Classes</th>
<th style="text-align: left;">OpenML ID / Kaggle Name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Name</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">balance-scale</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">11</td>
</tr>
<tr>
<td style="text-align: left;">breast-w</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">15</td>
</tr>
<tr>
<td style="text-align: left;">cmc</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">1473</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">23</td>
</tr>
<tr>
<td style="text-align: left;">credit-g</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">31</td>
</tr>
<tr>
<td style="text-align: left;">diabetes</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">768</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">37</td>
</tr>
<tr>
<td style="text-align: left;">tic-tac-toe</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">50</td>
</tr>
<tr>
<td style="text-align: left;">eucalyptus</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">736</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">188</td>
</tr>
<tr>
<td style="text-align: left;">pc1</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">1109</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">1068</td>
</tr>
<tr>
<td style="text-align: left;">airlines</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">1169</td>
</tr>
<tr>
<td style="text-align: left;">jungle_chess_2pcs_raw_endgame_complete</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">41027</td>
</tr>
<tr>
<td style="text-align: left;">pharyngitis</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">512</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">pharyngitis</td>
</tr>
<tr>
<td style="text-align: left;">health-insurance</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">health-insurance-lead-prediction-raw-data</td>
</tr>
<tr>
<td style="text-align: left;">spaceship-titanic</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">spaceship-titanic</td>
</tr>
<tr>
<td style="text-align: left;">kidney-stone</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">414</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">playground-series-s3e12</td>
</tr>
</tbody>
</table>
<p>Table 6: Test datasets used for the evaluation. See Section 4 for a description of the datasets used.</p>
<h2>G. 1 Dataset Collection and Preprocessing</h2>
<p>OpenML datasets We use small datasets from OpenML (Vanschoren et al., 2013; Feurer et al.) that have descriptive feature names (i.e. we do not include any datasets with numbered feature names). Datasets on OpenML contain a task description that we provide as user context to our method and that we clean from redundant information for feature engineering, such as author names or release history. While some descriptions are very informative, other descriptions contain much less information. We remove datasets with more than 20 features, since the prompt length rises linearly with the number</p>
<p>of features and exceeds the permissible 8,192 tokens that standard GPT-4 can accept. We show all datasets we used in Table 6 in Appendix G. When datasets are perfectly solvable with TabPFN alone (i.e. reaches ROC AUC of 1.0) we reduce the training set size for that dataset to $10 \%$ or $20 \%$ of the original dataset size. This is the case for the datasets "balance-scale" (20\%), "breast-w" (10\%) and "tic-tac-toe" (10\%). We focus on small datasets with up to 2000 samples in total, because feature engineering is most important and significant for smaller datasets.</p>
<p>Kaggle datasets We additionally evaluate CAAFE on 4 datasets from Kaggle that were released after the knowledge cutoff of our LLM Model. These datasets contain string features as well. String features allow for more complex feature transformations, such as separating Names into First and Last Names, which allows grouping families. We drop rows that contain missing values for our evaluations. Details of these datasets can also be found in Table 6 in Appendix G.</p>
<h1>G. 2 Dataset Descriptions</h1>
<p>The dataset descriptions used were crawled from the respective datasource. For OpenML prompts uninformative information such as the source or reference papers were removed. Figures 20 show the parsed dataset descriptions used for each dataset.</p>
<div class="codehilite"><pre><span></span><code>**Balance Scale Weight &amp; Distance Database**
This data set was generated to model psychological experimental results. Each example is
    classified as having the balance scale tip to the right, tip to the left, or be
    balanced. The attributes are the left weight, the left distance, the right weight,
    and the right distance. The correct way to find the class is the greater of (left-
    distance <span class="gs">* left-weight) and (right-distance *</span> right-weight). If they are equal, it
    is balanced.
Attribute description
The attributes are the left weight, the left distance, the right weight, and the right
    distance.
</code></pre></div>

<p>Figure 7: Dataset description for balance-scale.</p>
<div class="codehilite"><pre><span></span><code>**Breast Cancer Wisconsin (Original) Data Set.** Features are computed from a digitized
    image of a fine needle aspirate (FNA) of a breast mass. They describe
    characteristics of the cell nuclei present in the image. The target feature records
    the prognosis (malignant or benign).
</code></pre></div>

<p>Figure 8: Dataset description for breast-w.</p>
<div class="codehilite"><pre><span></span><code><span class="mf">4.</span><span class="w"> </span><span class="n">Relevant</span><span class="w"> </span><span class="n">Information</span><span class="p">:</span>
<span class="w">    </span><span class="n">This</span><span class="w"> </span><span class="kd">data</span><span class="n">set</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subset</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mf">1987</span><span class="w"> </span><span class="n">National</span><span class="w"> </span><span class="n">Indonesia</span><span class="w"> </span><span class="kr">Cont</span><span class="n">raceptive</span>
<span class="w">    </span><span class="n">Prevalence</span><span class="w"> </span><span class="n">Survey</span><span class="mf">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">samples</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">married</span><span class="w"> </span><span class="n">women</span><span class="w"> </span><span class="n">who</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="ow">not</span>
<span class="w">    </span><span class="n">pregnant</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">know</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nb">int</span><span class="n">erview</span><span class="mf">.</span><span class="w"> </span><span class="n">The</span>
<span class="w">    </span><span class="n">problem</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">predict</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="kr">cont</span><span class="n">raceptive</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">choice</span>
<span class="w">    </span><span class="p">(</span><span class="n">no</span><span class="w"> </span><span class="n">use</span><span class="p">,</span><span class="w"> </span><span class="n">long</span><span class="o">-</span><span class="n">term</span><span class="w"> </span><span class="n">methods</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">short</span><span class="o">-</span><span class="n">term</span><span class="w"> </span><span class="n">methods</span><span class="p">)</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">woman</span><span class="w"> </span><span class="n">based</span>
<span class="w">    </span><span class="kr">on</span><span class="w"> </span><span class="n">her</span><span class="w"> </span><span class="n">demographic</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">socio</span><span class="o">-</span><span class="n">economic</span><span class="w"> </span><span class="n">characteristics</span><span class="mf">.</span>
<span class="mf">7.</span><span class="w"> </span><span class="n">Attribute</span><span class="w"> </span><span class="n">Information</span><span class="p">:</span>
<span class="w">    </span><span class="mf">1.</span><span class="w"> </span><span class="n">Wife</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="p">(</span><span class="n">numerical</span><span class="p">)</span>
<span class="w">    </span><span class="mf">2.</span><span class="w"> </span><span class="n">Wife</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">education</span><span class="w"> </span><span class="p">(</span><span class="n">categorical</span><span class="p">)</span><span class="w"> </span><span class="mf">1</span><span class="o">=</span><span class="n">low</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="o">=</span><span class="n">high</span>
<span class="w">    </span><span class="mf">3.</span><span class="w"> </span><span class="n">Husband</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">education</span><span class="w"> </span><span class="p">(</span><span class="n">categorical</span><span class="p">)</span><span class="w"> </span><span class="mf">1</span><span class="o">=</span><span class="n">low</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="o">=</span><span class="n">high</span>
<span class="w">    </span><span class="mf">4.</span><span class="w"> </span><span class="n">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">children</span><span class="w"> </span><span class="n">ever</span><span class="w"> </span><span class="n">born</span><span class="w"> </span><span class="p">(</span><span class="n">numerical</span><span class="p">)</span>
<span class="w">    </span><span class="mf">5.</span><span class="w"> </span><span class="n">Wife</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">religion</span><span class="w"> </span><span class="p">(</span><span class="n">binary</span><span class="p">)</span><span class="w"> </span><span class="mf">0</span><span class="o">=</span><span class="n">Non</span><span class="o">-</span><span class="n">Islam</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="o">=</span><span class="n">Islam</span>
<span class="w">    </span><span class="mf">6.</span><span class="w"> </span><span class="n">Wife</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">working</span><span class="err">?</span><span class="w"> </span><span class="p">(</span><span class="n">binary</span><span class="p">)</span><span class="w"> </span><span class="mf">0</span><span class="o">=</span><span class="n">Yes</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="o">=</span><span class="n">No</span>
<span class="w">    </span><span class="mf">7.</span><span class="w"> </span><span class="n">Husband</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">occupation</span><span class="w"> </span><span class="p">(</span><span class="n">categorical</span><span class="p">)</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span>
<span class="w">    </span><span class="mf">8.</span><span class="w"> </span><span class="n">Standard</span><span class="o">-</span><span class="n">of</span><span class="o">-</span><span class="n">living</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="p">(</span><span class="n">categorical</span><span class="p">)</span><span class="w"> </span><span class="mf">1</span><span class="o">=</span><span class="n">low</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">3</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="o">=</span><span class="n">high</span>
<span class="w">    </span><span class="mf">9.</span><span class="w"> </span><span class="n">Media</span><span class="w"> </span><span class="nb">exp</span><span class="n">osure</span><span class="w"> </span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
<span class="w">    </span><span class="mf">10.</span><span class="w"> </span><span class="kr">Cont</span><span class="n">raceptive</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="p">(</span><span class="n">class</span><span class="w"> </span><span class="n">attribute</span><span class="p">)</span><span class="w"> </span><span class="mf">0</span><span class="o">=</span><span class="kr">Go</span><span class="n">od</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="o">=</span><span class="ow">Not</span><span class="w"> </span><span class="kr">go</span><span class="n">od</span>
<span class="w">                                    </span><span class="mf">1</span><span class="o">=</span><span class="n">No</span><span class="o">-</span><span class="n">use</span>
<span class="w">                                    </span><span class="mf">2</span><span class="o">=</span><span class="n">Long</span><span class="o">-</span><span class="n">term</span>
<span class="w">                                    </span><span class="mf">3</span><span class="o">=</span><span class="n">Short</span><span class="o">-</span><span class="n">term</span>
</code></pre></div>

<p>Figure 9: Dataset description for cmc.</p>
<div class="codehilite"><pre><span></span><code>**German Credit dataset**
This dataset classifies people described by a set of attributes as good or bad credit
    risks.
This dataset comes with a cost matrix:
    ***
Good Bad (predicted)
Good 0 1 (actual)
Bad 5 0
***
It is worse to class a customer as good when they are bad (5), than it is to class a
    customer as bad when they are good (1).
    Attribute description
1. Status of existing checking account, in Deutsche Mark.
2. Duration in months
3. Credit history (credits taken, paid back duly, delays, critical accounts)
4. Purpose of the credit (car, television,...)
5. Credit amount
6. Status of savings account/bonds, in Deutsche Mark.
7. Present employment, in number of years.
8. Installment rate in percentage of disposable income
9. Personal status (married, single,... ) and sex
10. Other debtors / guarantors
11. Present residence since % years
12. Property (e.g. real estate)
13. Age in years
14. Other installment plans (banks, stores)
15. Housing (rent, own,...)
16. Number of existing credits at this bank
17. Job
18. Number of people being liable to provide maintenance for
19. Telephone (yes,no)
20. Foreign worker (yes,no)
</code></pre></div>

<p>Figure 10: Dataset description for credit-g.</p>
<div class="codehilite"><pre><span></span><code><span class="mf">4.</span><span class="w"> </span><span class="n">Relevant</span><span class="w"> </span><span class="n">Information</span><span class="p">:</span>
<span class="w">    </span><span class="n">Several</span><span class="w"> </span><span class="n">constraints</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="n">placed</span><span class="w"> </span><span class="kr">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">selection</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">instances</span><span class="w"> </span><span class="n">from</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="n">larger</span><span class="w"> </span><span class="kd">data</span><span class="n">base</span><span class="mf">.</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="n">particular</span><span class="p">,</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">patients</span><span class="w"> </span><span class="n">here</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">females</span><span class="w"> </span><span class="n">at</span>
<span class="w">    </span><span class="n">least</span><span class="w"> </span><span class="mf">21</span><span class="w"> </span><span class="n">years</span><span class="w"> </span><span class="n">old</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Pima</span><span class="w"> </span><span class="n">Indian</span><span class="w"> </span><span class="n">heritage</span><span class="mf">.</span><span class="w"> </span><span class="n">ADAP</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">adaptive</span><span class="w"> </span><span class="n">learning</span>
<span class="w">    </span><span class="n">routine</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">generates</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">executes</span><span class="w"> </span><span class="n">digital</span><span class="w"> </span><span class="n">analogs</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">perceptron</span><span class="o">-</span><span class="n">like</span>
<span class="w">    </span><span class="n">devices</span><span class="mf">.</span><span class="w"> </span><span class="n">It</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">unique</span><span class="w"> </span><span class="n">algorithm</span><span class="p">;</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">paper</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">details</span><span class="mf">.</span>
<span class="mf">7.</span><span class="w"> </span><span class="kr">For</span><span class="w"> </span><span class="n">Each</span><span class="w"> </span><span class="n">Attribute</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">all</span><span class="w"> </span><span class="n">numeric</span><span class="o">-</span><span class="nb">val</span><span class="n">ued</span><span class="p">)</span>
<span class="w">    </span><span class="mf">1.</span><span class="w"> </span><span class="n">Number</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="n">pregnant</span>
<span class="w">    </span><span class="mf">2.</span><span class="w"> </span><span class="n">Plasma</span><span class="w"> </span><span class="n">glucose</span><span class="w"> </span><span class="n">concentration</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="n">hours</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="ow">or</span><span class="n">al</span><span class="w"> </span><span class="n">glucose</span><span class="w"> </span><span class="kr">to</span><span class="n">lerance</span><span class="w"> </span><span class="n">test</span>
<span class="w">    </span><span class="mf">3.</span><span class="w"> </span><span class="n">Diastolic</span><span class="w"> </span><span class="n">blood</span><span class="w"> </span><span class="n">pressure</span><span class="w"> </span><span class="p">(</span><span class="n">mm</span><span class="w"> </span><span class="n">Hg</span><span class="p">)</span>
<span class="w">    </span><span class="mf">4.</span><span class="w"> </span><span class="n">Triceps</span><span class="w"> </span><span class="n">skin</span><span class="w"> </span><span class="n">fold</span><span class="w"> </span><span class="n">thickness</span><span class="w"> </span><span class="p">(</span><span class="n">mm</span><span class="p">)</span>
<span class="w">    </span><span class="mf">5.</span><span class="w"> </span><span class="mf">2</span><span class="o">-</span><span class="n">Hour</span><span class="w"> </span><span class="n">serum</span><span class="w"> </span><span class="n">insulin</span><span class="w"> </span><span class="p">(</span><span class="n">mu</span><span class="w"> </span><span class="n">U</span><span class="o">/</span><span class="n">ml</span><span class="p">)</span>
<span class="w">    </span><span class="mf">6.</span><span class="w"> </span><span class="n">Body</span><span class="w"> </span><span class="n">mass</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">kg</span><span class="o">/</span><span class="p">(</span><span class="n">height</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">m</span><span class="p">)</span><span class="o">^</span><span class="mf">2</span><span class="p">)</span>
<span class="w">    </span><span class="mf">7.</span><span class="w"> </span><span class="n">Diabetes</span><span class="w"> </span><span class="n">pedigree</span><span class="w"> </span><span class="n">function</span>
<span class="w">    </span><span class="mf">8.</span><span class="w"> </span><span class="n">Age</span><span class="w"> </span><span class="p">(</span><span class="n">years</span><span class="p">)</span>
<span class="w">    </span><span class="mf">9.</span><span class="w"> </span><span class="n">Class</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="p">(</span><span class="mf">0</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span>
<span class="n">Relabeled</span><span class="w"> </span><span class="nb">val</span><span class="n">ues</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">attribute</span><span class="w"> </span><span class="err">&#39;</span><span class="n">class</span><span class="err">&#39;</span>
<span class="w">    </span><span class="n">From</span><span class="p">:</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="kr">To</span><span class="p">:</span><span class="w"> </span><span class="n">tested_negative</span>
<span class="w">    </span><span class="n">From</span><span class="p">:</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="kr">To</span><span class="p">:</span><span class="w"> </span><span class="n">tested_positive</span>
</code></pre></div>

<p>Figure 11: Dataset description for diabetes.</p>
<div class="codehilite"><pre><span></span><code>**Tic-Tac-Toe Endgame database**
This database encodes the complete set of possible board configurations at the end of tic
    -tac-toe games, where &quot;z&quot; is assumed to have played first. The target concept is &quot;
    win for x&quot; (i.e., true when &quot;x&quot; has one of 8 possible ways to create a &quot;three-in-a-
    row&quot;).
</code></pre></div>

<p>Figure 12: Dataset description for tic-tac-toe.</p>
<div class="codehilite"><pre><span></span><code><span class="o">**</span><span class="n">Eucalyptus</span><span class="w"> </span><span class="n">Soil</span><span class="w"> </span><span class="n">Conservation</span><span class="o">**</span>
<span class="n">The</span><span class="w"> </span><span class="n">objective</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">determine</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">seedlots</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">species</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">soil</span><span class="w"> </span><span class="n">conservation</span>
<span class="w">        </span><span class="ow">in</span><span class="w"> </span><span class="n">seasonally</span><span class="w"> </span><span class="n">dry</span><span class="w"> </span><span class="n">hill</span><span class="w"> </span><span class="n">country</span><span class="o">.</span><span class="w"> </span><span class="n">Determination</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">measurement</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">height</span><span class="p">,</span>
<span class="w">        </span><span class="n">diameter</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">height</span><span class="p">,</span><span class="w"> </span><span class="n">survival</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">contributing</span><span class="w"> </span><span class="n">factors</span><span class="o">.</span>
<span class="n">It</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">important</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">note</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">eucalypt</span><span class="w"> </span><span class="n">trial</span><span class="w"> </span><span class="n">methods</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="n">over</span><span class="w"> </span><span class="n">time</span><span class="p">;</span><span class="w"> </span><span class="n">earlier</span><span class="w"> </span><span class="n">trials</span>
<span class="w">        </span><span class="n">included</span><span class="w"> </span><span class="n">mostly</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">30</span><span class="n">cm</span><span class="w"> </span><span class="n">tall</span><span class="w"> </span><span class="n">seedling</span><span class="w"> </span><span class="n">grown</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">peat</span><span class="w"> </span><span class="n">plots</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">trials</span>
<span class="w">        </span><span class="n">have</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="n">mostly</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">replications</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">eight</span><span class="w"> </span><span class="n">trees</span><span class="w"> </span><span class="n">grown</span><span class="o">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">may</span>
<span class="w">        </span><span class="n">contribute</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">significant</span><span class="w"> </span><span class="n">results</span><span class="o">.</span>
<span class="n">Experimental</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">recording</span><span class="w"> </span><span class="n">procedures</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">require</span><span class="w"> </span><span class="n">noting</span><span class="w"> </span><span class="n">include</span><span class="p">:</span>
<span class="o">-</span><span class="w"> </span><span class="n">instances</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">recorded</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">experimental</span><span class="w"> </span><span class="n">recording</span><span class="w"> </span><span class="n">procedures</span>
<span class="n">require</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">absence</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">species</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">replicate</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">site</span><span class="w"> </span><span class="n">was</span>
<span class="n">treated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">absent</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">replicates</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">a</span>
<span class="o">-</span><span class="w"> </span><span class="n">site</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">species</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">excluded</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">site</span><span class="s1">&#39;s analyses.</span>
<span class="o">-</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">survival</span><span class="p">,</span><span class="w"> </span><span class="n">vigour</span><span class="p">,</span><span class="w"> </span><span class="n">insect</span><span class="w"> </span><span class="n">resistance</span><span class="p">,</span><span class="w"> </span><span class="n">stem</span><span class="w"> </span><span class="n">form</span><span class="p">,</span><span class="w"> </span><span class="n">crown</span><span class="w"> </span><span class="n">form</span>
<span class="ow">and</span><span class="w"> </span><span class="n">utility</span><span class="w"> </span><span class="n">especially</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">recorded</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Morea</span><span class="w"> </span><span class="n">Station</span><span class="p">;</span><span class="w"> </span><span class="n">this</span>
<span class="n">could</span><span class="w"> </span><span class="n">indicate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">death</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">species</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">areas</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">lack</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">collection</span>
<span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="o">.</span>
<span class="n">Attribute</span><span class="w"> </span><span class="n">Information</span>
<span class="mf">1.</span><span class="w"> </span><span class="n">Abbrev</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">site</span><span class="w"> </span><span class="n">abbreviation</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">enumerated</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">Rep</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">site</span><span class="w"> </span><span class="n">rep</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">integer</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">Locality</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">site</span><span class="w"> </span><span class="n">locality</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">North</span><span class="w"> </span><span class="n">Island</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">enumerated</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">Map_Ref</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">North</span><span class="w"> </span><span class="n">Island</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">enumerated</span>
<span class="mf">5.</span><span class="w"> </span><span class="n">Latitude</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">latitude</span><span class="w"> </span><span class="n">approximation</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">enumerated</span>
<span class="mf">6.</span><span class="w"> </span><span class="n">Altitude</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">altitude</span><span class="w"> </span><span class="n">approximation</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">integer</span>
<span class="mf">7.</span><span class="w"> </span><span class="n">Rainfall</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">rainfall</span><span class="w"> </span><span class="p">(</span><span class="n">mm</span><span class="w"> </span><span class="n">pa</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">integer</span>
<span class="mf">8.</span><span class="w"> </span><span class="n">Frosts</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">frosts</span><span class="w"> </span><span class="p">(</span><span class="n">deg</span><span class="o">.</span><span class="w"> </span><span class="n">c</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">integer</span>
<span class="mf">9.</span><span class="w"> </span><span class="n">Year</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">year</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">planting</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">integer</span>
<span class="mf">10.</span><span class="w"> </span><span class="n">Sp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">species</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">enumerated</span>
<span class="mf">11.</span><span class="w"> </span><span class="n">PMCno</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">seedlot</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">integer</span>
<span class="mf">12.</span><span class="w"> </span><span class="n">DBH</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">best</span><span class="w"> </span><span class="n">diameter</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="p">(</span><span class="n">cm</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">real</span>
<span class="mf">13.</span><span class="w"> </span><span class="n">Ht</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">real</span>
<span class="mf">14.</span><span class="w"> </span><span class="n">Surv</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">survival</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">integer</span>
<span class="mf">15.</span><span class="w"> </span><span class="n">Vig</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">vigour</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">real</span>
<span class="mf">16.</span><span class="w"> </span><span class="n">Ins_res</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">insect</span><span class="w"> </span><span class="n">resistance</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">real</span>
<span class="mf">17.</span><span class="w"> </span><span class="n">Stem_Fm</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">stem</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">real</span>
<span class="mf">18.</span><span class="w"> </span><span class="n">Crown_Fm</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">crown</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">real</span>
<span class="mf">19.</span><span class="w"> </span><span class="n">Brnch_Fm</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">branch</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">real</span>
<span class="n">Class</span><span class="p">:</span>
<span class="mf">20.</span><span class="w"> </span><span class="n">Utility</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">utility</span><span class="w"> </span><span class="n">rating</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">enumerated</span>
<span class="n">Relevant</span><span class="w"> </span><span class="n">papers</span>
<span class="n">Bulluch</span><span class="w"> </span><span class="n">B</span><span class="o">.</span><span class="w"> </span><span class="n">T</span><span class="o">.</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">1992</span><span class="p">)</span><span class="w"> </span><span class="n">Eucalyptus</span><span class="w"> </span><span class="n">Species</span><span class="w"> </span><span class="n">Selection</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">Soil</span><span class="w"> </span><span class="n">Conservation</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">Seasonally</span>
<span class="w">    </span><span class="n">Dry</span><span class="w"> </span><span class="n">Hill</span><span class="w"> </span><span class="n">Country</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Twelfth</span><span class="w"> </span><span class="n">Year</span><span class="w"> </span><span class="n">Assessment</span><span class="w"> </span><span class="n">New</span><span class="w"> </span><span class="n">Zealand</span><span class="w"> </span><span class="n">Journal</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Forestry</span><span class="w"> </span><span class="n">Science</span>
<span class="w">    </span><span class="mi">21</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">31</span><span class="w"> </span><span class="p">(</span><span class="mi">1991</span><span class="p">)</span>
<span class="n">Kirsten</span><span class="w"> </span><span class="n">Thomson</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Robert</span><span class="w"> </span><span class="n">J</span><span class="o">.</span><span class="w"> </span><span class="n">McQueen</span><span class="w"> </span><span class="p">(</span><span class="mi">1996</span><span class="p">)</span><span class="w"> </span><span class="n">Machine</span><span class="w"> </span><span class="n">Learning</span><span class="w"> </span><span class="n">Applied</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Fourteen</span>
<span class="w">    </span><span class="n">Agricultural</span><span class="w"> </span><span class="n">Datasets</span><span class="o">.</span><span class="w"> </span><span class="n">University</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">Waikato</span><span class="w"> </span><span class="n">Research</span><span class="w"> </span><span class="n">Report</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">cs</span><span class="o">.</span><span class="n">waikato</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">nz</span><span class="o">/</span><span class="n">ml</span><span class="o">/</span><span class="n">publications</span><span class="o">/</span><span class="mi">1996</span><span class="o">/</span><span class="n">Thomson</span><span class="o">-</span><span class="n">McQueen</span><span class="o">-</span><span class="mf">96.</span><span class="n">pdf</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">original</span>
<span class="w">    </span><span class="n">publication</span><span class="p">:</span>
</code></pre></div>

<p>Figure 13: Dataset description for eucalyptus.</p>
<div class="codehilite"><pre><span></span><code>Binarized version of the original data set (see version 1). The multi-class target
    feature is converted to a two-class nominal target feature by re-labeling the
    majority class as positive (&#39;P&#39;) and all others as negative (&#39;N&#39;). Originally
    converted by Quan Sun.
</code></pre></div>

<p>Figure 14: Dataset description for wine.</p>
<p><strong>PC1 Software defect prediction</strong> One of the NASA Metrics Data Program defect data sets. Data from flight software for earth orbiting satellite. Data comes from McCabe and Halstead features extractors of source code. These features were defined in the 70s in an attempt to objectively characterize code features that are associated with software quality.</p>
<p>Attribute Information</p>
<table>
<thead>
<tr>
<th style="text-align: left;">1. loc</th>
<th style="text-align: left;">$:$ numeric \% McCabe's line count of code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">2. $v(g)$</td>
<td style="text-align: left;">$:$ numeric \% McCabe "cyclomatic complexity"</td>
</tr>
<tr>
<td style="text-align: left;">3. ev(g)</td>
<td style="text-align: left;">$:$ numeric \% McCabe "essential complexity"</td>
</tr>
<tr>
<td style="text-align: left;">4. iv(g)</td>
<td style="text-align: left;">$:$ numeric \% McCabe "design complexity"</td>
</tr>
<tr>
<td style="text-align: left;">5. n</td>
<td style="text-align: left;">$:$ numeric \% Halstead total operators + operands</td>
</tr>
<tr>
<td style="text-align: left;">6. v</td>
<td style="text-align: left;">$:$ numeric \% Halstead "volume"</td>
</tr>
<tr>
<td style="text-align: left;">7. l</td>
<td style="text-align: left;">$:$ numeric \% Halstead "program length"</td>
</tr>
<tr>
<td style="text-align: left;">8. d</td>
<td style="text-align: left;">$:$ numeric \% Halstead "difficulty"</td>
</tr>
<tr>
<td style="text-align: left;">9. i</td>
<td style="text-align: left;">$:$ numeric \% Halstead "intelligence"</td>
</tr>
<tr>
<td style="text-align: left;">10. e</td>
<td style="text-align: left;">$:$ numeric \% Halstead "effort"</td>
</tr>
<tr>
<td style="text-align: left;">11. b</td>
<td style="text-align: left;">$:$ numeric \% Halstead</td>
</tr>
<tr>
<td style="text-align: left;">12. t</td>
<td style="text-align: left;">$:$ numeric \% Halstead's time estimator</td>
</tr>
<tr>
<td style="text-align: left;">13. lOCode</td>
<td style="text-align: left;">$:$ numeric \% Halstead's line count</td>
</tr>
<tr>
<td style="text-align: left;">14. lOComment</td>
<td style="text-align: left;">$:$ numeric \% Halstead's count of lines of comments</td>
</tr>
<tr>
<td style="text-align: left;">15. lOBlank</td>
<td style="text-align: left;">$:$ numeric \% Halstead's count of blank lines</td>
</tr>
<tr>
<td style="text-align: left;">16. lOCodeAndComment</td>
<td style="text-align: left;">$:$ numeric</td>
</tr>
<tr>
<td style="text-align: left;">17. uniq_Op</td>
<td style="text-align: left;">$:$ numeric \% unique operators</td>
</tr>
<tr>
<td style="text-align: left;">18. uniq_Opnd</td>
<td style="text-align: left;">$:$ numeric \% unique operands</td>
</tr>
<tr>
<td style="text-align: left;">19. total_Op</td>
<td style="text-align: left;">$:$ numeric \% total operators</td>
</tr>
<tr>
<td style="text-align: left;">20. total_Opnd</td>
<td style="text-align: left;">$:$ numeric \% total operands</td>
</tr>
<tr>
<td style="text-align: left;">21. branchCount</td>
<td style="text-align: left;">$:$ numeric \% of the flow graph</td>
</tr>
<tr>
<td style="text-align: left;">22. branchCount</td>
<td style="text-align: left;">$:$ numeric \% of the flow graph</td>
</tr>
<tr>
<td style="text-align: left;">23. defects</td>
<td style="text-align: left;">$:$ {false,true} \% module has/has not one or more reported defects</td>
</tr>
</tbody>
</table>
<p>Relevant papers</p>
<ul>
<li>Shepperd, M. and Qinbao Song and Zhongbin Sun and Mair, C. (2013)</li>
</ul>
<p>Data Quality: Some Comments on the NASA Software Defect Datasets, IEEE Transactions on Software Engineering, 39.</p>
<ul>
<li>Tim Menzies and Justin S. Di Stefano (2004) How Good is Your Blind Spot Sampling Policy ? 2004 IEEE Conference on High Assurance
Software Engineering.</li>
<li>T. Menzies and J. DiStefano and A. Orrego and R. Chapman (2004) Assessing Predictors of Software Defects", Workshop on Predictive Software Models, Chicago</li>
</ul>
<p>Figure 15: Dataset description for pc1.</p>
<p>Airlines Dataset Inspired in the regression dataset from Elena Ikonomovska. The task is to predict whether a given flight will be delayed, given the information of the scheduled departure.</p>
<p>Figure 16: Dataset description for airlines.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{1}$ https://github.com/automl/TabPFN/blob/main/tabpfn/scripts/tabular_baselines.py
${ }^{2}$ https://github.com/alteryz/featuretools, https://github.com/cod3licious/autofeat&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>