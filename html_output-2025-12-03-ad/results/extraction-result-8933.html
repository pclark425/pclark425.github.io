<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-8933 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-8933</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-8933</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-155.html">extraction-schema-155</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <p><strong>Paper ID:</strong> paper-b822f2abca1da6f990b2bd47ed43da0671bfc6f8</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/b822f2abca1da6f990b2bd47ed43da0671bfc6f8" target="_blank">Unifying Molecular and Textual Representations via Multi-task Language Modelling</a></p>
                <p><strong>Paper Venue:</strong> International Conference on Machine Learning</p>
                <p><strong>Paper TL;DR:</strong> This work proposes the first multi-domain, multi-task language model that can solve a wide range of tasks in both the chemical and natural language domains and suggests that such models can robustly and efficiently accelerate discovery in physical sciences by superseding problem-specific fine-tuning and enhancing human-model interactions.</p>
                <p><strong>Paper Abstract:</strong> The recent advances in neural language models have also been successfully applied to the field of chemistry, offering generative solutions for classical problems in molecular design and synthesis planning. These new methods have the potential to fuel a new era of data-driven automation in scientific discovery. However, specialized models are still typically required for each task, leading to the need for problem-specific fine-tuning and neglecting task interrelations. The main obstacle in this field is the lack of a unified representation between natural language and chemical representations, complicating and limiting human-machine interaction. Here, we propose the first multi-domain, multi-task language model that can solve a wide range of tasks in both the chemical and natural language domains. Our model can handle chemical and natural language concurrently, without requiring expensive pre-training on single domains or task-specific models. Interestingly, sharing weights across domains remarkably improves our model when benchmarked against state-of-the-art baselines on single-domain and cross-domain tasks. In particular, sharing information across domains and tasks gives rise to large improvements in cross-domain tasks, the magnitude of which increase with scale, as measured by more than a dozen of relevant metrics. Our work suggests that such models can robustly and efficiently accelerate discovery in physical sciences by superseding problem-specific fine-tuning and enhancing human-model interactions.</p>
                <p><strong>Cost:</strong> 0.021</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <div class="extraction-instance-container" id="e8933.0">
                <h3 class="extraction-instance">Extracted Data Instance 0 (e8933.0)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Text+Chem T5</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Multitask Text and Chemistry T5</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A T5-based multi-task, multi-domain encoder-decoder language model trained to jointly handle natural language and chemical representations (SMILES) for cross-domain tasks including text->SMILES generation, SMILES->text captioning, forward reaction prediction, retrosynthesis and paragraph->actions.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Text+Chem T5</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>encoder-decoder transformer (T5 backbone)</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td>small (60M), base (220M)</td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td>Multi-task aggregated dataset: Pistachio-derived reaction pairs (mol2mol; 2.3M train, augmented variant 6.7M), procedures dataset for paragraph->actions (~2.16M), CheBI-20 molecule-description pairs (~26k); balanced mixing to 11.5M samples (standard) or augmented 33.5M samples; initialized from pretrained T5 (t5-small / t5-base) then multi-task fine-tuned.</td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Cross-domain molecular design and synthesis workflows (text-conditional de novo molecule generation, molecular captioning), plus reaction prediction/retrosynthesis and execution protocol generation (wet-lab synthesis guidance).</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Direct sequence-to-sequence generation conditioned on natural-language prompts (prompt templates provided) to produce SMILES (text2mol) or natural-language descriptions (mol2text); also sequence prediction for mol2mol tasks (forward/retro). No RL; uses multi-task supervised fine-tuning and shared encoder weights.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td>No explicit metric reported for fraction of novel molecules vs training set; evaluations report validity and fingerprint/similarity statistics (MACCS-FTS, RDK-FTS, Morgan-FTS) and Fréchet ChemNet Distance (FCD) rather than explicit novelty percentages.</td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Specificity achieved via conditioning on textual descriptions and evaluated using exact-match accuracy and fingerprint-similarity metrics; model is not reported to perform property optimization or target-binding design (no explicit binding/assay conditioning reported).</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td>BLEU, BLEU-2/4, ROUGE-1/2/L, METEOR for text outputs; for text2mol: BLEU, Accuracy (exact SMILES match), Levenshtein distance, MACCS-FTS, RDK-FTS, Morgan-FTS, FCD, and RDKit validity; for mol2mol: forward accuracy and retrosynthesis round-trip accuracy; paragraph->actions: BLEU and accuracy.</td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>Outperforms baselines on cross-domain tasks: e.g., text2mol BLEU up to 0.853 (base, augmented), accuracy up to 0.322 (base, augm), validity up to 0.951 (small augm), mol2text BLEU-2 up to 0.625 (base augm); demonstrates end-to-end workflow capability (text->SMILES->retrosynthesis->protocol) on a Monuron example where general-purpose LLMs failed. Performance improves with model size and dataset augmentation.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Compared against Transformer baseline, T5 (fine-tuned), MolT5, and RXN-family models; Text+Chem T5 yields superior cross-domain generation (text2mol, mol2text) versus MolT5 and T5 in reported metrics, while specialized RXN models outperform on some mol2mol tasks unless Text+Chem T5 is trained with augmented reaction data.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Uses SMILES which can produce invalid sequences (paper suggests SELFIES as a possible improvement); subject to biases present in training data; no guarantee of synthesizability or safety — generated molecules require standard experimental validation; models presented are research prototypes and not for direct clinical/operational use.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Unifying Molecular and Textual Representations via Multi-task Language Modelling', 'publication_date_yy_mm': '2023-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8933.1">
                <h3 class="extraction-instance">Extracted Data Instance 1 (e8933.1)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>MolT5</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>MolT5</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A multi-domain T5-derived model pre-trained on both text and chemical modalities to enable translation between molecules and natural language (text2mol and mol2text).</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Translation between molecules and natural language.</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>MolT5</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>encoder-decoder transformer (T5-derived, multi-domain pretraining)</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td>small (77M), base (250M)</td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td>Pretrained on large mono-modality datasets including both text and chemistry (details in referenced MolT5 work); used with per-task fine-tuning for cross-domain tasks.</td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Cross-domain molecular translation tasks: text-conditional de novo generation and molecular captioning.</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Pretraining on both text and chemistry domains followed by task-specific fine-tuning; sequence-to-sequence generation of SMILES from text and vice versa.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td>Not reported in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Task-specific fine-tuning to adapt pretrained model to particular cross-domain tasks; not presented as a multi-task single-model solution without per-task finetuning.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td>BLEU, BLEU-2/4, ROUGE, METEOR, accuracy, fingerprint similarity metrics (as used in comparisons).</td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>Strong baseline for cross-domain tasks; in reported experiments Text+Chem T5 often outperforms MolT5 on cross-domain metrics (e.g., mol2text and text2mol BLEU scores), particularly when Text+Chem T5 is multi-task trained and/or augmented.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>MolT5 requires expensive pretraining on both domains and per-task finetuning; Text+Chem T5 is designed to avoid expensive chemistry pretraining while achieving equal or better cross-domain performance via multi-task joint training.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Relies on costly pretraining across modalities and per-task finetuning, limiting sample-efficiency and general multi-task sharing; not optimized as a single multi-task, multi-domain model in this paper's framing.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Unifying Molecular and Textual Representations via Multi-task Language Modelling', 'publication_date_yy_mm': '2023-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8933.2">
                <h3 class="extraction-instance">Extracted Data Instance 2 (e8933.2)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>T5 (fine-tuned)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Text-to-Text Transfer Transformer (T5)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A general-purpose, pre-trained text-to-text encoder-decoder transformer used as backbone and baseline; when fine-tuned per task it can perform chemical-language tasks but fails zero-shot on cross-domain translation.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Exploring the limits of transfer learning with a unified text-to-text transformer</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>T5</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>encoder-decoder transformer</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td>small (60M), base (220M)</td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td>Pretrained on large text corpora (general text pretraining); used here as initialization for fine-tuning on chemical and cross-domain tasks and also as the initialization for Text+Chem T5.</td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Used for text2mol/mol2text when fine-tuned; paragraph->actions and other NLP tasks in chemistry domain.</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Task-specific fine-tuning of pretrained text-only T5 on chemical datasets; direct sequence generation.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td>Not reported.</td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Requires per-task fine-tuning to adapt to chemistry tasks; zero-shot T5 fails at cross-domain (text2mol/mol2text) in experiments.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td>BLEU, accuracy, validity, fingerprint similarity metrics when applied to chemical tasks.</td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>Fine-tuned T5 achieves competitive results on some tasks (e.g., paragraph->actions strong BLEU/accuracy), but zero-shot T5 cannot perform cross-domain translation; multi-domain multi-task models outperform fine-tuned T5 on several cross-domain metrics.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Serves as a reference backbone and baseline; Text+Chem T5 builds on T5 initialization and improves cross-domain performance via joint multi-task training and encoder sharing.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Not designed for chemistry out-of-the-box; needs per-task finetuning and fails zero-shot on cross-domain tasks.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Unifying Molecular and Textual Representations via Multi-task Language Modelling', 'publication_date_yy_mm': '2023-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8933.3">
                <h3 class="extraction-instance">Extracted Data Instance 3 (e8933.3)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>RXN / Molecular Transformer</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Molecular Transformer / RXN family</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Transformer-based sequence-to-sequence models specialized for chemical reaction prediction (forward) and retrosynthesis planning (RXN family), used as strong task-specific baselines for mol2mol tasks.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Molecular transformer: a model for uncertainty-calibrated chemical reaction prediction.</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Molecular Transformer (RXN family)</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>sequence-to-sequence transformer specialized for reaction prediction</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td>RXN forward ~12M, RXN retrosynthesis ~12M, RXN paragraph2action ~20M (as listed in the paper's Table 11)</td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td>Trained on reaction datasets (Pistachio-derived and related reaction corpora); datasets used for evaluation in this paper include the Pistachio-derived set (Toniato et al., 2021).</td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Forward reaction prediction and retrosynthesis (one-step) for chemical synthesis planning.</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Sequence-to-sequence prediction of reaction products from reactants (forward) and reactants from product (retrosynthesis); retrosynthesis can be coupled with hypergraph search strategies for multi-step planning (in referenced works).</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td>Not reported.</td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Designed specifically to predict reaction outcomes and propose plausible precursors; evaluated by accuracy and round-trip accuracy metrics.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td>Forward reaction accuracy, retrosynthesis round-trip accuracy (as reported in comparisons).</td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>RXN forward reported accuracy ~0.685 (baseline); RXN retrosynthesis roundtrip ~0.733; specialized RXN models often outperform general multi-domain models on pure mol2mol tasks but lack cross-domain capabilities.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>RXN family as specialized models outperform general multi-domain models on some reaction prediction metrics; Text+Chem T5 trades some mol2mol performance (unless augmented) for broad cross-domain capabilities.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Task-specific models requiring separate models per task; not optimized for cross-domain text<->chemistry translation; need substantial task-specific data and training.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Unifying Molecular and Textual Representations via Multi-task Language Modelling', 'publication_date_yy_mm': '2023-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8933.4">
                <h3 class="extraction-instance">Extracted Data Instance 4 (e8933.4)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>ChatGPT</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>ChatGPT</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A large instruction-tuned conversational language model used here as a qualitative baseline for cross-domain workflows (text2mol, retrosynthesis, paragraph->actions); it produced plausible but imperfect outputs in chemical generation and protocol synthesis comparisons.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>ChatGPT</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>autoregressive transformer LLM (instruction-tuned conversational model)</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Attempted cross-domain chemical tasks in qualitative comparisons: generating SMILES from descriptions, proposing retrosynthesis steps and stepwise protocols.</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Prompt-based conversational generation to produce SMILES strings and procedural text; no domain-specific fine-tuning reported in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td>Not reported.</td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Produces plausible chemical descriptions and reaction ideas but with small chemical inaccuracies (e.g., wrong substituents) and verbosity; not optimized for exact SMILES generation.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td>Qualitative comparison and example-based checks (e.g., correctness of SMILES and match to target molecule; RXN confidence used to assess plausibility of suggested reactions).</td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>In the Monuron workflow ChatGPT produced chemically plausible but incorrect SMILES and made small errors across tasks; suggested retrosynthesis that was chemically possible but unlikely to succeed with lower RXN confidence compared to Text+Chem T5's suggested reaction.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Underperforms Text+Chem T5 on exact SMILES generation and end-to-end workflow for the Monuron example; sometimes provides plausible but inexact reactions compared to RXN-predicted high-confidence routes.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Hallucinations/inaccuracies in chemical detail, inability to reliably produce exact valid SMILES for complex descriptions, verbosity; not tailored or fine-tuned specifically for chemistry generation in these experiments.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Unifying Molecular and Textual Representations via Multi-task Language Modelling', 'publication_date_yy_mm': '2023-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8933.5">
                <h3 class="extraction-instance">Extracted Data Instance 5 (e8933.5)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Galactica</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Galactica</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A large language model trained for scientific text that was evaluated qualitatively for chemical workflow tasks and found to struggle to produce valid SMILES and to invent or mix-up information in protocol generation.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Galactica: A large language model for science</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Galactica</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>transformer-based large language model for scientific text</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td>1.3B (as used in qualitative comparisons)</td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td>Scientific literature and related corpora (as per Galactica paper), not detailed here.</td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Attempted cross-domain tasks (text2mol, mol2text, retrosynthesis and protocol generation) in qualitative comparisons.</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Prompt-based generation following authors' prompt style; in experiments forced to produce SMILES or text outputs.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td>Not reported.</td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Produced textual descriptions rather than valid SMILES for some inputs and invented facts in protocol decomposition tasks.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td>Qualitative comparison on example tasks (Monuron workflow); judged on ability to produce valid SMILES and sensible protocol steps.</td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>Failed to provide valid SMILES in tested examples and invented or mixed information in paragraph-to-actions outputs; outperformed by Text+Chem T5 in the provided workflow example.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Performed worse than Text+Chem T5 and in some cases worse than ChatGPT for precise SMILES generation and reliable protocol generation in the evaluated examples.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Poor reliability for exact chemical-structure generation (SMILES) and tendency to invent or misattribute procedural details in synthesis descriptions.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Unifying Molecular and Textual Representations via Multi-task Language Modelling', 'publication_date_yy_mm': '2023-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8933.6">
                <h3 class="extraction-instance">Extracted Data Instance 6 (e8933.6)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>T5Chem</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>T5Chem</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A unified multi-task model for chemistry built on T5 that employs task-specific heads to handle reaction prediction, regression and classification within the chemical domain.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Unified deep learning model for multitask reaction predictions with explanation</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>mention</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>T5Chem</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>T5-based multi-task transformer with task-specific heads</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td>Pretrained on chemistry data (specific datasets not enumerated in this paper's text).</td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Chemical-domain tasks such as reaction prediction, regression and classification.</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Multi-task fine-tuning with separate heads for different chemistry tasks rather than a single shared decoder head.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td>Not reported.</td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Restricted to the chemical domain and uses task-specific heads; contrasted with Text+Chem T5 which avoids task-specific heads and aims for cross-domain capability.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>Prior work demonstrating a multi-task approach in chemistry; characterized here as limited in cross-domain applicability because of task-specific heads and mono-domain focus.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>T5Chem relies on chemistry pretraining and task-specific outputs, whereas Text+Chem T5 emphasizes shared encoders and a single decoder for both domains and tasks.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Restricted to chemical domain, uses task-specific heads, and not directly designed for cross-domain text<->chemistry translation.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Unifying Molecular and Textual Representations via Multi-task Language Modelling', 'publication_date_yy_mm': '2023-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>Translation between molecules and natural language. <em>(Rating: 2)</em></li>
                <li>Molecular transformer: a model for uncertainty-calibrated chemical reaction prediction. <em>(Rating: 2)</em></li>
                <li>Predicting retrosynthetic pathways using transformer-based models and a hyper-graph exploration strategy. <em>(Rating: 2)</em></li>
                <li>Unified deep learning model for multitask reaction predictions with explanation <em>(Rating: 2)</em></li>
                <li>Exploring the limits of transfer learning with a unified text-to-text transformer <em>(Rating: 1)</em></li>
                <li>Automated extraction of chemical synthesis actions from experimental procedures <em>(Rating: 1)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-8933",
    "paper_id": "paper-b822f2abca1da6f990b2bd47ed43da0671bfc6f8",
    "extraction_schema_id": "extraction-schema-155",
    "extracted_data": [
        {
            "name_short": "Text+Chem T5",
            "name_full": "Multitask Text and Chemistry T5",
            "brief_description": "A T5-based multi-task, multi-domain encoder-decoder language model trained to jointly handle natural language and chemical representations (SMILES) for cross-domain tasks including text-&gt;SMILES generation, SMILES-&gt;text captioning, forward reaction prediction, retrosynthesis and paragraph-&gt;actions.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "Text+Chem T5",
            "model_type": "encoder-decoder transformer (T5 backbone)",
            "model_size": "small (60M), base (220M)",
            "training_data": "Multi-task aggregated dataset: Pistachio-derived reaction pairs (mol2mol; 2.3M train, augmented variant 6.7M), procedures dataset for paragraph-&gt;actions (~2.16M), CheBI-20 molecule-description pairs (~26k); balanced mixing to 11.5M samples (standard) or augmented 33.5M samples; initialized from pretrained T5 (t5-small / t5-base) then multi-task fine-tuned.",
            "application_domain": "Cross-domain molecular design and synthesis workflows (text-conditional de novo molecule generation, molecular captioning), plus reaction prediction/retrosynthesis and execution protocol generation (wet-lab synthesis guidance).",
            "generation_method": "Direct sequence-to-sequence generation conditioned on natural-language prompts (prompt templates provided) to produce SMILES (text2mol) or natural-language descriptions (mol2text); also sequence prediction for mol2mol tasks (forward/retro). No RL; uses multi-task supervised fine-tuning and shared encoder weights.",
            "novelty_of_chemicals": "No explicit metric reported for fraction of novel molecules vs training set; evaluations report validity and fingerprint/similarity statistics (MACCS-FTS, RDK-FTS, Morgan-FTS) and Fréchet ChemNet Distance (FCD) rather than explicit novelty percentages.",
            "application_specificity": "Specificity achieved via conditioning on textual descriptions and evaluated using exact-match accuracy and fingerprint-similarity metrics; model is not reported to perform property optimization or target-binding design (no explicit binding/assay conditioning reported).",
            "evaluation_metrics": "BLEU, BLEU-2/4, ROUGE-1/2/L, METEOR for text outputs; for text2mol: BLEU, Accuracy (exact SMILES match), Levenshtein distance, MACCS-FTS, RDK-FTS, Morgan-FTS, FCD, and RDKit validity; for mol2mol: forward accuracy and retrosynthesis round-trip accuracy; paragraph-&gt;actions: BLEU and accuracy.",
            "results_summary": "Outperforms baselines on cross-domain tasks: e.g., text2mol BLEU up to 0.853 (base, augmented), accuracy up to 0.322 (base, augm), validity up to 0.951 (small augm), mol2text BLEU-2 up to 0.625 (base augm); demonstrates end-to-end workflow capability (text-&gt;SMILES-&gt;retrosynthesis-&gt;protocol) on a Monuron example where general-purpose LLMs failed. Performance improves with model size and dataset augmentation.",
            "comparison_to_other_methods": "Compared against Transformer baseline, T5 (fine-tuned), MolT5, and RXN-family models; Text+Chem T5 yields superior cross-domain generation (text2mol, mol2text) versus MolT5 and T5 in reported metrics, while specialized RXN models outperform on some mol2mol tasks unless Text+Chem T5 is trained with augmented reaction data.",
            "limitations_and_challenges": "Uses SMILES which can produce invalid sequences (paper suggests SELFIES as a possible improvement); subject to biases present in training data; no guarantee of synthesizability or safety — generated molecules require standard experimental validation; models presented are research prototypes and not for direct clinical/operational use.",
            "uuid": "e8933.0",
            "source_info": {
                "paper_title": "Unifying Molecular and Textual Representations via Multi-task Language Modelling",
                "publication_date_yy_mm": "2023-01"
            }
        },
        {
            "name_short": "MolT5",
            "name_full": "MolT5",
            "brief_description": "A multi-domain T5-derived model pre-trained on both text and chemical modalities to enable translation between molecules and natural language (text2mol and mol2text).",
            "citation_title": "Translation between molecules and natural language.",
            "mention_or_use": "use",
            "model_name": "MolT5",
            "model_type": "encoder-decoder transformer (T5-derived, multi-domain pretraining)",
            "model_size": "small (77M), base (250M)",
            "training_data": "Pretrained on large mono-modality datasets including both text and chemistry (details in referenced MolT5 work); used with per-task fine-tuning for cross-domain tasks.",
            "application_domain": "Cross-domain molecular translation tasks: text-conditional de novo generation and molecular captioning.",
            "generation_method": "Pretraining on both text and chemistry domains followed by task-specific fine-tuning; sequence-to-sequence generation of SMILES from text and vice versa.",
            "novelty_of_chemicals": "Not reported in this paper.",
            "application_specificity": "Task-specific fine-tuning to adapt pretrained model to particular cross-domain tasks; not presented as a multi-task single-model solution without per-task finetuning.",
            "evaluation_metrics": "BLEU, BLEU-2/4, ROUGE, METEOR, accuracy, fingerprint similarity metrics (as used in comparisons).",
            "results_summary": "Strong baseline for cross-domain tasks; in reported experiments Text+Chem T5 often outperforms MolT5 on cross-domain metrics (e.g., mol2text and text2mol BLEU scores), particularly when Text+Chem T5 is multi-task trained and/or augmented.",
            "comparison_to_other_methods": "MolT5 requires expensive pretraining on both domains and per-task finetuning; Text+Chem T5 is designed to avoid expensive chemistry pretraining while achieving equal or better cross-domain performance via multi-task joint training.",
            "limitations_and_challenges": "Relies on costly pretraining across modalities and per-task finetuning, limiting sample-efficiency and general multi-task sharing; not optimized as a single multi-task, multi-domain model in this paper's framing.",
            "uuid": "e8933.1",
            "source_info": {
                "paper_title": "Unifying Molecular and Textual Representations via Multi-task Language Modelling",
                "publication_date_yy_mm": "2023-01"
            }
        },
        {
            "name_short": "T5 (fine-tuned)",
            "name_full": "Text-to-Text Transfer Transformer (T5)",
            "brief_description": "A general-purpose, pre-trained text-to-text encoder-decoder transformer used as backbone and baseline; when fine-tuned per task it can perform chemical-language tasks but fails zero-shot on cross-domain translation.",
            "citation_title": "Exploring the limits of transfer learning with a unified text-to-text transformer",
            "mention_or_use": "use",
            "model_name": "T5",
            "model_type": "encoder-decoder transformer",
            "model_size": "small (60M), base (220M)",
            "training_data": "Pretrained on large text corpora (general text pretraining); used here as initialization for fine-tuning on chemical and cross-domain tasks and also as the initialization for Text+Chem T5.",
            "application_domain": "Used for text2mol/mol2text when fine-tuned; paragraph-&gt;actions and other NLP tasks in chemistry domain.",
            "generation_method": "Task-specific fine-tuning of pretrained text-only T5 on chemical datasets; direct sequence generation.",
            "novelty_of_chemicals": "Not reported.",
            "application_specificity": "Requires per-task fine-tuning to adapt to chemistry tasks; zero-shot T5 fails at cross-domain (text2mol/mol2text) in experiments.",
            "evaluation_metrics": "BLEU, accuracy, validity, fingerprint similarity metrics when applied to chemical tasks.",
            "results_summary": "Fine-tuned T5 achieves competitive results on some tasks (e.g., paragraph-&gt;actions strong BLEU/accuracy), but zero-shot T5 cannot perform cross-domain translation; multi-domain multi-task models outperform fine-tuned T5 on several cross-domain metrics.",
            "comparison_to_other_methods": "Serves as a reference backbone and baseline; Text+Chem T5 builds on T5 initialization and improves cross-domain performance via joint multi-task training and encoder sharing.",
            "limitations_and_challenges": "Not designed for chemistry out-of-the-box; needs per-task finetuning and fails zero-shot on cross-domain tasks.",
            "uuid": "e8933.2",
            "source_info": {
                "paper_title": "Unifying Molecular and Textual Representations via Multi-task Language Modelling",
                "publication_date_yy_mm": "2023-01"
            }
        },
        {
            "name_short": "RXN / Molecular Transformer",
            "name_full": "Molecular Transformer / RXN family",
            "brief_description": "Transformer-based sequence-to-sequence models specialized for chemical reaction prediction (forward) and retrosynthesis planning (RXN family), used as strong task-specific baselines for mol2mol tasks.",
            "citation_title": "Molecular transformer: a model for uncertainty-calibrated chemical reaction prediction.",
            "mention_or_use": "use",
            "model_name": "Molecular Transformer (RXN family)",
            "model_type": "sequence-to-sequence transformer specialized for reaction prediction",
            "model_size": "RXN forward ~12M, RXN retrosynthesis ~12M, RXN paragraph2action ~20M (as listed in the paper's Table 11)",
            "training_data": "Trained on reaction datasets (Pistachio-derived and related reaction corpora); datasets used for evaluation in this paper include the Pistachio-derived set (Toniato et al., 2021).",
            "application_domain": "Forward reaction prediction and retrosynthesis (one-step) for chemical synthesis planning.",
            "generation_method": "Sequence-to-sequence prediction of reaction products from reactants (forward) and reactants from product (retrosynthesis); retrosynthesis can be coupled with hypergraph search strategies for multi-step planning (in referenced works).",
            "novelty_of_chemicals": "Not reported.",
            "application_specificity": "Designed specifically to predict reaction outcomes and propose plausible precursors; evaluated by accuracy and round-trip accuracy metrics.",
            "evaluation_metrics": "Forward reaction accuracy, retrosynthesis round-trip accuracy (as reported in comparisons).",
            "results_summary": "RXN forward reported accuracy ~0.685 (baseline); RXN retrosynthesis roundtrip ~0.733; specialized RXN models often outperform general multi-domain models on pure mol2mol tasks but lack cross-domain capabilities.",
            "comparison_to_other_methods": "RXN family as specialized models outperform general multi-domain models on some reaction prediction metrics; Text+Chem T5 trades some mol2mol performance (unless augmented) for broad cross-domain capabilities.",
            "limitations_and_challenges": "Task-specific models requiring separate models per task; not optimized for cross-domain text&lt;-&gt;chemistry translation; need substantial task-specific data and training.",
            "uuid": "e8933.3",
            "source_info": {
                "paper_title": "Unifying Molecular and Textual Representations via Multi-task Language Modelling",
                "publication_date_yy_mm": "2023-01"
            }
        },
        {
            "name_short": "ChatGPT",
            "name_full": "ChatGPT",
            "brief_description": "A large instruction-tuned conversational language model used here as a qualitative baseline for cross-domain workflows (text2mol, retrosynthesis, paragraph-&gt;actions); it produced plausible but imperfect outputs in chemical generation and protocol synthesis comparisons.",
            "citation_title": "",
            "mention_or_use": "use",
            "model_name": "ChatGPT",
            "model_type": "autoregressive transformer LLM (instruction-tuned conversational model)",
            "model_size": "",
            "training_data": "",
            "application_domain": "Attempted cross-domain chemical tasks in qualitative comparisons: generating SMILES from descriptions, proposing retrosynthesis steps and stepwise protocols.",
            "generation_method": "Prompt-based conversational generation to produce SMILES strings and procedural text; no domain-specific fine-tuning reported in this paper.",
            "novelty_of_chemicals": "Not reported.",
            "application_specificity": "Produces plausible chemical descriptions and reaction ideas but with small chemical inaccuracies (e.g., wrong substituents) and verbosity; not optimized for exact SMILES generation.",
            "evaluation_metrics": "Qualitative comparison and example-based checks (e.g., correctness of SMILES and match to target molecule; RXN confidence used to assess plausibility of suggested reactions).",
            "results_summary": "In the Monuron workflow ChatGPT produced chemically plausible but incorrect SMILES and made small errors across tasks; suggested retrosynthesis that was chemically possible but unlikely to succeed with lower RXN confidence compared to Text+Chem T5's suggested reaction.",
            "comparison_to_other_methods": "Underperforms Text+Chem T5 on exact SMILES generation and end-to-end workflow for the Monuron example; sometimes provides plausible but inexact reactions compared to RXN-predicted high-confidence routes.",
            "limitations_and_challenges": "Hallucinations/inaccuracies in chemical detail, inability to reliably produce exact valid SMILES for complex descriptions, verbosity; not tailored or fine-tuned specifically for chemistry generation in these experiments.",
            "uuid": "e8933.4",
            "source_info": {
                "paper_title": "Unifying Molecular and Textual Representations via Multi-task Language Modelling",
                "publication_date_yy_mm": "2023-01"
            }
        },
        {
            "name_short": "Galactica",
            "name_full": "Galactica",
            "brief_description": "A large language model trained for scientific text that was evaluated qualitatively for chemical workflow tasks and found to struggle to produce valid SMILES and to invent or mix-up information in protocol generation.",
            "citation_title": "Galactica: A large language model for science",
            "mention_or_use": "use",
            "model_name": "Galactica",
            "model_type": "transformer-based large language model for scientific text",
            "model_size": "1.3B (as used in qualitative comparisons)",
            "training_data": "Scientific literature and related corpora (as per Galactica paper), not detailed here.",
            "application_domain": "Attempted cross-domain tasks (text2mol, mol2text, retrosynthesis and protocol generation) in qualitative comparisons.",
            "generation_method": "Prompt-based generation following authors' prompt style; in experiments forced to produce SMILES or text outputs.",
            "novelty_of_chemicals": "Not reported.",
            "application_specificity": "Produced textual descriptions rather than valid SMILES for some inputs and invented facts in protocol decomposition tasks.",
            "evaluation_metrics": "Qualitative comparison on example tasks (Monuron workflow); judged on ability to produce valid SMILES and sensible protocol steps.",
            "results_summary": "Failed to provide valid SMILES in tested examples and invented or mixed information in paragraph-to-actions outputs; outperformed by Text+Chem T5 in the provided workflow example.",
            "comparison_to_other_methods": "Performed worse than Text+Chem T5 and in some cases worse than ChatGPT for precise SMILES generation and reliable protocol generation in the evaluated examples.",
            "limitations_and_challenges": "Poor reliability for exact chemical-structure generation (SMILES) and tendency to invent or misattribute procedural details in synthesis descriptions.",
            "uuid": "e8933.5",
            "source_info": {
                "paper_title": "Unifying Molecular and Textual Representations via Multi-task Language Modelling",
                "publication_date_yy_mm": "2023-01"
            }
        },
        {
            "name_short": "T5Chem",
            "name_full": "T5Chem",
            "brief_description": "A unified multi-task model for chemistry built on T5 that employs task-specific heads to handle reaction prediction, regression and classification within the chemical domain.",
            "citation_title": "Unified deep learning model for multitask reaction predictions with explanation",
            "mention_or_use": "mention",
            "model_name": "T5Chem",
            "model_type": "T5-based multi-task transformer with task-specific heads",
            "model_size": "",
            "training_data": "Pretrained on chemistry data (specific datasets not enumerated in this paper's text).",
            "application_domain": "Chemical-domain tasks such as reaction prediction, regression and classification.",
            "generation_method": "Multi-task fine-tuning with separate heads for different chemistry tasks rather than a single shared decoder head.",
            "novelty_of_chemicals": "Not reported.",
            "application_specificity": "Restricted to the chemical domain and uses task-specific heads; contrasted with Text+Chem T5 which avoids task-specific heads and aims for cross-domain capability.",
            "evaluation_metrics": "",
            "results_summary": "Prior work demonstrating a multi-task approach in chemistry; characterized here as limited in cross-domain applicability because of task-specific heads and mono-domain focus.",
            "comparison_to_other_methods": "T5Chem relies on chemistry pretraining and task-specific outputs, whereas Text+Chem T5 emphasizes shared encoders and a single decoder for both domains and tasks.",
            "limitations_and_challenges": "Restricted to chemical domain, uses task-specific heads, and not directly designed for cross-domain text&lt;-&gt;chemistry translation.",
            "uuid": "e8933.6",
            "source_info": {
                "paper_title": "Unifying Molecular and Textual Representations via Multi-task Language Modelling",
                "publication_date_yy_mm": "2023-01"
            }
        }
    ],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "Translation between molecules and natural language.",
            "rating": 2
        },
        {
            "paper_title": "Molecular transformer: a model for uncertainty-calibrated chemical reaction prediction.",
            "rating": 2
        },
        {
            "paper_title": "Predicting retrosynthetic pathways using transformer-based models and a hyper-graph exploration strategy.",
            "rating": 2
        },
        {
            "paper_title": "Unified deep learning model for multitask reaction predictions with explanation",
            "rating": 2
        },
        {
            "paper_title": "Exploring the limits of transfer learning with a unified text-to-text transformer",
            "rating": 1
        },
        {
            "paper_title": "Automated extraction of chemical synthesis actions from experimental procedures",
            "rating": 1
        }
    ],
    "cost": 0.020546,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>Unifying Molecular and Textual Representations via Multi-task Language Modelling</h1>
<p>Dimitrios Christofidellis ${ }^{<em> 1}$ Giorgio Giannone ${ }^{</em> 123}$<br>Jannis Born ${ }^{14}$ Ole Winther ${ }^{25}$ Teodoro Laino ${ }^{1}$ Matteo Manica ${ }^{1}$</p>
<h4>Abstract</h4>
<p>The recent advances in neural language models have also been successfully applied to the field of chemistry, offering generative solutions for classical problems in molecular design and synthesis planning. These new methods have the potential to fuel a new era of data-driven automation in scientific discovery. However, specialized models are still typically required for each task, leading to the need for problem-specific fine-tuning and neglecting task interrelations. The main obstacle in this field is the lack of a unified representation between natural language and chemical representations, complicating and limiting human-machine interaction. Here, we propose the first multidomain, multi-task language model that can solve a wide range of tasks in both the chemical and natural language domains. Our model can handle chemical and natural language concurrently, without requiring expensive pre-training on single domains or task-specific models. Interestingly, sharing weights across domains remarkably improves our model when benchmarked against state-of-the-art baselines on single-domain and cross-domain tasks. In particular, sharing information across domains and tasks gives rise to large improvements in cross-domain tasks, the magnitude of which increase with scale, as measured by more than a dozen of relevant metrics. Our work suggests that such models can robustly and efficiently accelerate discovery in physical sciences by superseding problem-specific fine-tuning and enhancing human-model interactions.</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<h2>1 Introduction</h2>
<p>The transformer architecture (Vaswani et al., 2017) has had a significant impact on several fields within computer science, such as language understanding (Devlin et al., 2018), text generation (Radford et al., 2019; Brown et al., 2020), image understanding (Dosovitskiy et al., 2020), multi-modal generation (Ramesh et al., 2022; Saharia et al., 2022), among others. Scaling language models using this architecture has proven to be a powerful and general strategy for improving generalization. This has led to the emergence of multi-task (Radford et al., 2019) and few-shot (Brown et al., 2020; Winata et al., 2021) models leveraging scale and compute (Sanh et al., 2021; Raffel et al., 2020).
<img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1: Molecule to Caption task. This plot compares the performance of three different models with different sizes (Text+Chem T5-base, Text+Chem T5-small, MolT5-base, MolT5-small, T5base, and T5-small) on the task of converting SMILES to captions, using six different metrics: BLUE-2, BLEU-4, Rouge-1, Rouge2, Rouge-L, and Meteor. The models are compared by plotting their scores on the $y$-axis. The graph shows that our proposal, Text+Chem T5, performs the best on all metrics and improves with size, corroborating our hypothesis that joint learning on molecular and textual domains leveraging multitask learning is a powerful paradigm to bridge the gap between domains.</p>
<p>Recent developments in language models have fueled applications in engineering and science. One notable area of success is chemistry, where ideas from natural language have been used to make significant advancements in reaction prediction (Schwaller et al., 2019), conditional compound generation (Born et al., 2021b;a), retrosynthesis (Schwaller et al., 2020), text-conditional de novo generation (Edwards</p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 2: Description to Molecule task. This plot compares the performance of three different models with different sizes (Text+Chem T5-base, Text+Chem T5-small, MolT5-base, MolT5-small, T5-base, and T5-small) on the task of converting captions to SMILES, using five different metrics: Accuracy, Morgan FTS, RDK FTS, BLEU, MACCS FTS. The models are compared by plotting their scores on the y-axis. The graph shows that our proposal, Text+Chem T5, performs the best on all metrics and improves with size, corroborating our hypothesis that joint learning on molecular and textual domains leveraging multi-task learning is a powerful paradigm to bridge the gap between domains.
et al., 2021), property-driven molecular design (Born and Manica, 2023), protein structure prediction (Jumper et al., 2021), among others. By interpreting chemistry as a programmable language for life sciences, transformer-based models are revolutionizing the chemical discovery pipeline, significantly speeding up laboratory and design automation (O'Neill, 2021; Vaucher et al., 2020), and paving the way for an age of accelerated discovery in science and engineering (Manica et al., 2023).</p>
<p>Despite these successes, language model advancements in the chemical domain are still limited. Specialized models must be built for each task of interest, which is time-consuming and requires a significant amount of human expertise. When multiple domains are considered, e.g., generating a novel molecule from its technical description in natural language, merging information is challenging due to the domain shift between language and chemistry. Current solutions often involve pre-training the model on large, single-domain datasets and fine-tuning on each task (Edwards et al., 2021), resulting in high computational expense, sample inefficiency, and the need to repeat this process for each use-case.</p>
<p>In light of these limitations, it is worth considering the feasibility of a more efficient and general multi-task model that can translate between the textual and chemical domains. This type of model would be particularly useful in cases where large amounts of data are not available and domains are unbalanced. Such models would also be critically important for tasks where information sharing is essential, like molecular captioning (given a molecule, describe it in natural language) or text-conditional de-novo generation (given a description, generate a molecule).</p>
<p>In this work, we propose a multi-task transformer for natural language and chemical translation, Multitask Text and Chemistry T5 (Text+Chem T5 for brevity). We focus on transfer learning in the chemical domain, with a specific emphasis on cross-domain tasks, tasks that involve chemistry and natural language concurrently. The performance comparisons of Text+Chem T5 to previous models in Figure 1 and Figure 2 show the consistent superiority of our approach for cross-domain tasks across various NLP-based evaluation metrics, like BLEU (Papineni et al., 2002), Rouge (Lin, 2004) and Meteor (Banerjee and Lavie, 2005). Text+Chem T5 does not rely on expensive mono-domain pre-training, task-specific fine-tuning, or separate heads for each task. Our model can be directly used on a variety of chemical and natural language-based tasks in a mono-domain and cross-domain setup (cf. Figure 3 for a graphical abstract). Notably, Text+Chem T5 enables the execution of complex molecular discovery workflows with a single model, a previously unreported ability, that, as we demonstrate, is even beyond the capability of foundation models like ChatGPT or Galactica (Taylor et al., 2022).</p>
<p>Contribution. Our work presents the following key contributions:
(i) We introduce a novel cross-domain, multi-task chemical language model (Multitask Text and Chemistry T5) that effectively bridges natural and chemical languages by enabling translation between the domains.
(ii) We propose an efficient training strategy that leverages the strengths of both single-domain and multi-domain tasks to adapt single-domain models for cross-domain tasks. This eliminates the need for costly pre-training on large mono-domain datasets and task-specific finetuning, while at the same time improving cross-domain translation by sharing information between tasks and across domains.
(iii) We provide experimental validation on benchmark datasets for single and cross-domain tasks, demonstrating that our model is competitive with state-of-the-art methods specialized for single tasks. We also conduct a thorough analysis of various modeling choices, including encoder-decoder architecture, the use of frozen vs. learnable encoders, and single-domain vs. multidomain encoders.</p>
<h2>2 Background</h2>
<p>Our model is designed to handle tasks that span multiple domains (see Fig. 3), specifically chemistry-based tasks (mol2mol), textual-based tasks (text2text), and crossdomain tasks (mol2text and text2mol).</p>
<p>In this section, we present an overview of recent advances in generative language models for transfer and multi-task</p>
<p><img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 3: Text+Chem T5 pipeline. The Text+Chem T5 pipeline is a multi-task, multi-domain language model that integrates natural and chemical language. The model can solve language tasks, chemical tasks, and cross-domain tasks, without the need for task-specific fine-tuning or retraining. The chemical tasks that the model can solve are forward reaction prediction and retro-synthesis. The forward reaction task is about predicting the outcome of a chemical reaction based on the starting materials, and the retro-synthesis task is about predicting the starting materials required to synthesize a given chemical compound. The cross-domain tasks that the model can solve are text-to-molecule (text-conditional de novo generation) and molecule-to-text (molecular captioning). The text-to-molecule task is where the model takes a textual description of a molecule as an input and generates its SMILES representation. The molecule-to-text task is where the model takes a molecule represented as SMILES and generates its human-readable textual description. For the mono-domain, language task, we focus on paragraph-to-action, given a paragraph describing how to build a molecule, and output the actions required to obtain that result. The model leverages large, pre-trained single-domain models, such as T5 (Raffel et al., 2020), to solve all these tasks effectively. The pre-trained models serve as a good starting point for fine-tuning the target distribution of tasks. Further variants of the Text+Chem T5 model that were explored in this work are shown in Figure 4.</p>
<p>Learning in the natural language and chemical domains. We examine the limitations of current models, particularly in cross-domain generation, and demonstrate the necessity for our proposed approach. Transformers, as presented in Vaswani et al., 2017), are widely used in language modeling. T5 (Raffel et al., 2020), a transformer trained on a diverse set of tasks, has demonstrated impressive generalization and adaptation capabilities in multi-tasking and multi-modal generation (Saharia et al., 2022). We use T5 as the backbone of our work.</p>
<p>Specialized models for chemistry have been developed, such as Molecular Transformers (Schwaller et al., 2019) and the RXN family (Schwaller et al., 2018; 2020; Toniato et al., 2021; Vaucher et al., 2020), which address tasks like forward reaction prediction and molecular retrosynthesis. However, these models require separate models for each task, leading to increased computational cost and a need for specialized expertise for each task.</p>
<p>T5Chem (Lu and Zhang, 2022) offers a unified multi-tasking model for chemistry, using a single model for tasks like reaction prediction, regression, and classification. However, T5Chem relies on task-specific heads, is restricted to the chemical domain and has limited applicability in different sub-domains.</p>
<p>MolT5 (Edwards et al., 2022) addresses the difficult problem of cross-domain generation by linking natural language and chemistry, tackling tasks such as text-conditional de novo molecule generation and molecule captioning. However, it relies on costly pre-training on large mono-modality datasets, as well as per-task fine-tuning for each multi-modal task, which in turn limits its ability to leverage the multitasking capabilities of T5 and the sharing of information between tasks.</p>
<p>Despite the progress made using multi-task learning in natural language processing, transferring these advancements to the chemical domain remains a challenge. Current models focus on optimizing specific tasks (Schwaller et al., 2019), multi-tasking learning (Lu and Zhang, 2022) or translation between text and chemistry (Edwards et al., 2022), but still struggle with handling multiple tasks across domains without incurring in the expense of large, sample-inefficient pre-training and fine-tuning. While multi-tasking within a single domain may be feasible, multi-tasking across multiple domains is still a challenge. Our proposed solution is a simple training strategy, which utilizes pre-trained transformers for each modality and a learnable, small output decoder to merge modalities in the later stages of the model, thus addressing these challenges.</p>
<h1>3 Method</h1>
<p>Model. Our goal is to develop a multi-task, multi-domain model for natural and chemical language. To achieve this, we use a T5 backbone, an encoder-decoder transformer architecture specifically proposed for multi-tasking (Raffel et al., 2020). The encoder-decoder architecture is especially suited for cross-domain tasks because we can explore a family of architectural choices modifying the encoder without</p>
<p>Table 1: Language Models for Chemistry. We compare language models by expressivity and flexibility. The column w/ text pretrain (with text pretraining) indicates if a model is pretrained on text before finetuning. The column w/ chem pretrain (with chemistry pretraining) indicates if a model is pretrained on chemistry before finetuning. In particular, if a model pre-trained on one domain (text for T5, MD-T5, MolT5, Text+Chem T5, and chemistry for T5Chem) is also pre-trained on the second domain (chemistry for T5, MD-T5, MolT5, Text+Chem T5 and text for T5Chem) before fine-tuning on the cross-domain tasks, we consider such model pre-trained on both domains (like MolT5) before fine-tuning. In general, more domains are used for pretraining, and more domain-specific data and computational resources are needed. So having a model that is pre-trained on only one domain is preferable. The column "encoder-sharing" indicates whether the model shares encoders between domains or not. The table shows that Text+Chem T5 is the only model that does not leverage expensive pre-training on both domains, and at the same time leverages multi-tasking, multi-domain learning, and encoder sharing, making Text+Chem T5 more expressive and feature-rich than the other models in the literature. $\epsilon^{d}$ : the model uses domain-specific encoders. MD: multi-domain. MT: multi-task.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">w/ text <br> pretrain</th>
<th style="text-align: center;">w/ chem <br> pretrain</th>
<th style="text-align: center;">multi- <br> task</th>
<th style="text-align: center;">multi- <br> domain</th>
<th style="text-align: center;">encoder <br> sharing</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">T5 (Raffel et al., 2020)</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$#$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$#$</td>
<td style="text-align: center;">$\checkmark$</td>
</tr>
<tr>
<td style="text-align: left;">MD-T5 (finetuned)</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$#$</td>
<td style="text-align: center;">$#$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
</tr>
<tr>
<td style="text-align: left;">T5Chem (Lu and Zhang, 2022)</td>
<td style="text-align: center;">$#$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$#$</td>
<td style="text-align: center;">$\checkmark$</td>
</tr>
<tr>
<td style="text-align: left;">MolT5 (Edwards et al., 2022)</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$#$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$#$</td>
</tr>
<tr>
<td style="text-align: left;">MDMT $\epsilon^{2}$-CLM (ours)</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$#$</td>
</tr>
<tr>
<td style="text-align: left;">Text+Chem T5 (ours)</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$#$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
</tr>
</tbody>
</table>
<p>the need to modify the decoder (see Fig. 4). Doing so we can ablate our multi-domain multi-task model with variations where we use two encoders (one for each domain), we consider a different model as chemistry encoder, and we freeze the encoders (more details in Table 5). We name our model Text+Chem T5.</p>
<p>Tasks Distribution. The Text+Chem T5 model is designed to handle tasks that span multiple domains, specifically chemistry-based tasks (mol2mol), textual-based tasks (text2text), and cross-domain tasks (mol2text and text2mol). Our objective is to train the model to learn a mapping between languages without losing proficiency in the original languages, similar to cross-domain generative tasks in the context of language translation. To achieve this, we follow the task-prompting method outlined in Raffel et al. (2020). Specifically, we focus on the following tasks for each domain:</p>
<ul>
<li>mol2mol is a mono-domain task that is focused on chemical reactions, it has two sub-tasks:</li>
</ul>
<p>Forward reaction. Given precursors (optionally including reagents and/or enzymes), the task is to generate the main product of the reulting chemical reaction. This sub-task is a classic example of a forward reaction prediction task, the model has to predict the outcome of a chemical reaction based on the starting chemicals.</p>
<p>Retrosynthesis. Given the product of a chemical reaction, the goal is to find the precursors (optionally including reagents and/or enzymes). This sub-task is an example of a retrosynthesis task, which is the inverse of a forward reaction prediction task. The model needs to predict the starting chemicals that would be required to synthesize a given compound. Note that we consider one-step retrosynthesis only.</p>
<ul>
<li>mol2text is a cross-domain task that is focused on generating natural text from chemical input.</li>
</ul>
<p>Molecular captioning. Given a molecule represented as SMILES (Simplified Molecular Input Line Entry System), the goal is to generate a textual description of such molecule. This task is an example of a cross-domain task as it involves both chemistry and natural language processing. The model is to generate a human-readable description of a chemical compound based on its SMILES representation.</p>
<ul>
<li>text2mol is a cross-domain task that is focused on generating chemical representation from text.</li>
</ul>
<p>Text-conditional de novo generation. In this cross-domain task, a textual paragraph describing the molecule is provided and the goal is to output a SMILES representation for such molecule. This task is an example of a cross-domain task as it involves both natural language processing and chemistry. The model should generate the SMILES representation for a chemical compound based on its textual description.</p>
<ul>
<li>text2text is a mono-domain task that is focused on natural language processing.</li>
</ul>
<p>Paragraph to action. The task is to generate the action sequence for a certain chemical reaction described in natural language. The model is to take a natural language description of a chemical reaction and generates a step-wise execution protocol to carry out that reaction. This task is an example of text generation in natural language processing, and it's focused on understanding the chemical reactions and converting them into a list of actions.</p>
<p>Merging Domains. As shown in Fig. 4 and Table 5, we ablate Text+Chem T5 architecture using different encoder setups. In particular, we want to explore the cross-domain performance when using a different encoder for each domain. In this scenario, we need a mechanism to aggregate information from the natural language and chemistry encoder. Given the difference between domains, it is crucial to find an expressive way to merge information at the late stage in input to the decoder. One way to accomplish this is to simply average the encoder output embeddings. However, a more expressive approach is to use a cross-attention approach, loosely inspired by the contextual attention in Born et al. (2021a). Specifically, by selecting one domain as the base domain, we can translate information in a powerful way. This approach is also well suited to scale to multiple</p>
<p><img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Figure 4: The Chemical Language Model (CLM) family. The caption describes three different approaches to building a multi-domain model for text and chemistry tasks. <strong>A</strong>: a multi-domain model is built without the need to retrain the single-domain encoders (no enc-sharing, no enc-training). Instead, two frozen sets of weights (φ_t, φ_c) are used for the text and chemistry encoders respectively. These weights are extracted from large, pre-trained language encoders, such as T5 (Raffel et al., 2020) and T5Chem (Lu and Zhang, 2022). <strong>B</strong>: a multi-domain model is still built using two sets of weights. However, the chemistry encoder is fine-tuned (enc-training) while the text encoder remains frozen (no enc-sharing). The fine-tuning process starts from a pre-trained T5 checkpoint (1.0) fine-tuned on chemistry data. <strong>C</strong>: The final, proposed Text+Chem T5 model. The encoders are merged, using a joint encoder for text and chemistry (φ_t = φ_c) and trained jointly on the multi-domain and multi-task data (enc-training, enc-sharing). This approach allows the model to be fine-tuned on a variety of tasks and domains, which improves its generalization capabilities. A T5 decoder is used and no separate heads are used for each task or domain. The sharing of information between tasks and domains enriches the model's generalization. V_t is the vocabulary for text and V_c is the one for chemistry.</p>
<p>Domains. We denote H_t ∈ ℝ(ni,hi) as the output of the base domain encoder, where ni is the sequence length (number of tokens) and hi is the hidden dimensionality. We also consider a second domain, H_m ∈ ℝ(ni,hi), where nm is the number of tokens and hm is the dimensionality for the adaptation domain (e.g. chemistry information). We merge this information using cross-attention by setting the base domain as the queries Q = f_t(H_t) ∈ ℝ(ni,di), and the adaptation domain as the keys K = f_k(H_m) ∈ ℝ(ni,di) and values V = f_v(H_m) ∈ ℝ(ni,di). In practice, we compute W = σ(Q, K^T) ∈ ℝ(ni,ni) and finally H_tm = W, V ∈ ℝ(ni,di). We can then apply this block to H_tm in a hierarchical fashion, setting H_t = H_tm. Finally, the output of this attention network is fed to the T5 decoder. The use of text as the base domain means that we can feed the final H_t directly to the T5 decoder, without the need for additional adaptation of the architecture. An alternative and more expressive approach is to merge the adaptation mode into the base mode to obtain H_tm, and then merge the base mode into the adaptation mode to obtain H_mt, and combining these intermediate results to obtain the representation input for the decoder H_tm^i.</p>
<h1>4 Experiments</h1>
<p><strong>Setup.</strong> We evaluate the model's performance on five tasks: forward and backward reaction prediction in chemistry, text-conditional de novo molecule generation and molecule captioning across domains, and paragraph-to-action in the language domain. The training process is carried out using the language modeling trainer based on Hugging Face transformers (Wolf et al., 2020) and PyTorch Lightning (Falcon and The PyTorch Lightning team, 2019) from the GT4SD library (Manica et al., 2023). To initialize our transformer model, we choose to use the natural language domain, as it has the most available data. For this reason, we use T5-small and T5-base as pretrained bases for our respective models. Details on the models' hyperparameters can be found in Appendix D.</p>
<p><strong>Dataset.</strong> To train our model, we generated a multi-domain and a multi-task dataset by aggregating available datasets for each task of interest. Specifically, we leveraged the dataset used in Toniato et al. (2021) which has been derived by Pistachio dataset (Nextmove, 2023) (release of 18 November 2019) for mol2mol tasks. This dataset contains 2.3M reactants-products pairs as training set, 10k pairs as validation set and 10k pairs as testing set. For the paragraph-to-actions task, we relied on the procedures dataset (2.16M samples in the training set and 270k samples in the validation set and in the testing set) presented in Vaucher et al.. Finally, we use the CheBI-20 dataset (Edwards et al., 2021; 2022) (~26k molecule-description pairs as training set, ~3k pairs as validation set and ~3k as testing set) for the description-to-smiles and smiles-to-caption tasks. The final training dataset is balanced between tasks by having 2.3M samples of each task. This leads to a training set of total 11.5M samples. For the task in which their training sets contain fewer samples, we augmented them by repeating the existing samples more than one time. A second augmented version of the training set was also been constructed by including further reactants-products pairs. This second version had 6.7M reaction pairs and in total 33.5M samples. For the second augmented dataset, we again followed an</p>
<p>equal mixing strategy (Raffel et al., 2020), i.e., a balance in the number of instances among tasks was ensured. The use of the augmented dataset in the presented results is indicated by the prefix 'augm' in the respective table rows. In the rest cases, the first version of the multi-task dataset has been used to train the respective model. In both datasets, we rely on prompts for the task definition. The prompt template that has been used can be found in appendix (see Table 10).</p>
<p>Evaluation. Evaluating the model is challenging as it spans multiple domains. For this reason, we treat each task separately and we rely on a combination of NLP based as well as task-specific metrics. Moreover, we provide qualitative evaluations as well as comparisons to broader multitask models like ChatGPT and Galactica (see Appendix B).</p>
<p>For the molecule-to-text task (mol2text), we consider the following metrics: BLEU-2 and BLEU-4 (Papineni et al., 2002) are metrics used to evaluate the quality of machine-generated text by comparing it to a reference text. BLEU-2 computes the 2-grams (word bigrams) overlap between the generated text and reference text, and BLEU-4 extends this to 4-grams. A higher score on the BLEU metric indicates a higher level of similarity between the generated text and reference text. ROUGE-1, ROUGE-2, and ROUGE-L (Lin, 2004) are similar to BLEU, but compute the recall-overlap of unigrams, bigrams, and longest common subsequences between the generated and reference texts. METEOR (Banerjee and Lavie, 2005) is a metric that uses a combination of unigram precision, recall, and a synonym-matching component to evaluate the generated text against the reference text. It's designed to be more sensitive to fluency, meaning, and structure than BLEU.</p>
<p>For the text-to-molecule task (text2mol), we consider the following metrics: BLEU scores, Accuracy, Levenshtein distance, MACCS-FTS (Durant et al., 2002), RDK-FTS (Tanimoto, 1958), Morgan-FTS (Rogers and Hahn, 2010) and FCD (Preuer et al., 2018). Furthermore, we report validity as the percent of molecules which can be processed by RDKit as in Edwards et al. (2022). For this task, the accuracy is the number of correctly generated molecules made by the model divided by the total number of samples. Levenshtein distance is a string similarity metric counting the number of edits (insertions, deletions, or substitutions) required to change one sequence into the other (Levenshtein, 1966). It is often used in natural language processing for tasks such as spell-checking and speech recognition.</p>
<p>Baselines. We compare our proposed method with several baselines including a standard Transformer model, T5 finetuned on each task, the RXN family, and MolT5. For T5, MolT5, and our model, we consider a small (40M) and a base (220M) version.</p>
<h3>4.1 Results</h3>
<p>With these experiments, we aim to demonstrate: (i) the effectiveness of a joint, cross-domain multi-task language model in improving generalization on cross-domain tasks; (ii) that by leveraging pre-trained single-domain information, we can avoid the need for costly pretraining and task-specific fine-tuning; (iii) that by sharing information not only between tasks and domains but also between encoder weights, we can achieve the best cross-domain translation. Lastly, we will illustrate how our approach benefits from increased scale, providing a general paradigm for language models in the scientific domain.</p>
<p>Cross-domain Tasks. Table 2 presents the results of different models that use multi-task learning for different domains and tasks. The models are T5, a multi-task model for the textual domain, and MolT5, a multi-domain model for the textual and chemical domains. The generalization capabilities of these models are evaluated on tasks from both the textual and chemical domains, including chemicalbased tasks (forward and retrosynthesis), cross-domain tasks (text-conditional de novo generation and molecule captioning), and textual-based tasks (text generation). The table includes metrics for each task and model, with the best results highlighted in bold. Text + Chem T5 is the proposed multi-domain and multi-task model. We also compare with additional baselines such as transformer, T5, RXN-family models and MolT5.</p>
<p>Molecule to Text. Table 3 presents the results of different models evaluated on the SMILES to Caption (mol2text) task. The models include Transformer, T5, MolT5, and Text+Chem T5. The performance of each model is evaluated using several metrics, including BLEU-2, BLEU-4, Rouge-1, Rouge-2, Rouge-L, and Meteor. The best results are highlighted in bold. Text+Chem T5 model performs best on all evaluation metrics compared to the other models. Specifically, it achieved the best score on BLEU-2, BLEU-4, Rouge-1, Rouge-2, Rouge-L, and Meteor. The BLEU scores indicate that this model generated captions that were highly similar to the reference captions and the Rouge score indicates that this model is generating grammatically correct and fluent text. The Meteor score indicates this is the model that generated the most similar sentence to reference. Text+Chem T5 model was able to achieve a BLEU-2 and BLEU-4 scores of 0.625 and 0.542 , respectively. These are relatively high scores and indicate that this model is able to generate captions that are highly similar to the reference captions. The Rouge-1 score of 0.647 and Rouge-2 score of 0.498 similarly indicate that this model is generating captions that are grammatically correct and fluent. The Rouge-L score of 0.586 and Meteor score of 0.604 also indicate this model is generating high-quality captions.</p>
<p>Table 2: Results across domains and tasks. We evaluate T5, a multi-task model for the textual domain, finetuned for each class of tasks; for the chemical domain, we consider also specialized models for forward and retrosynthesis (RXN family); and MolT5, a multi-domain model for the textual and chemical domains. Tasks evaluated include chemical-based tasks (forward and retrosynthesis), cross-domain tasks (text-conditional de novo generation and molecule captioning), and textual-based tasks (paragraph to action). Our goal is to leverage multi-task learning to improve cross-domain translation between chemistry and text. The forward and retrosynthesis RXN baseline results are re-evaluations of the original models (Schwaller et al., 2019; 2020) as presented in Toniato et al. (2021). For the forward prediction task the metric is accuracy; for the retrosynthesis task the metric is roundtrip accuracy (Schwaller et al., 2020); for all the other tasks the BLEU score. For more metrics see Tables 3 and 4 and Table 11 for model sizes.</p>
<table>
<thead>
<tr>
<th>Domain</th>
<th></th>
<th>mol2mol</th>
<th></th>
<th>cross-domain</th>
<th></th>
<th>text2text</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Task</td>
<td>Size</td>
<td>forward</td>
<td>retrosynthesis</td>
<td>text2mol</td>
<td>mol2text</td>
<td>paragraph-actions</td>
<td></td>
</tr>
<tr>
<td>T5 (fine-tuned) (Raffel et al., 2020)</td>
<td>small</td>
<td>0.603</td>
<td>0.245</td>
<td>0.499</td>
<td>0.501</td>
<td>0.953</td>
<td></td>
</tr>
<tr>
<td>T5 (fine-tuned) (Raffel et al., 2020)</td>
<td>base</td>
<td>0.629</td>
<td>-</td>
<td>0.762</td>
<td>0.511</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>RXN-forward (Toniato et al., 2021)</td>
<td>-</td>
<td>0.685</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>RXN-retrosynthesis (Toniato et al., 2021)</td>
<td>-</td>
<td>-</td>
<td>0.733</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>RXN-paragraph2actions (Vaucher et al., 2020)</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>-</td>
<td>0.850</td>
<td></td>
</tr>
<tr>
<td>MolT5 (Edwards et al., 2022)</td>
<td>small</td>
<td>-</td>
<td>-</td>
<td>0.755</td>
<td>0.519</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>MolT5 (Edwards et al., 2022)</td>
<td>base</td>
<td>-</td>
<td>-</td>
<td>0.769</td>
<td>0.540</td>
<td>-</td>
<td></td>
</tr>
<tr>
<td>Text+Chem T5 (ours)</td>
<td>small</td>
<td>0.412</td>
<td>0.249</td>
<td>0.815</td>
<td>0.553</td>
<td>0.929</td>
<td></td>
</tr>
<tr>
<td>Text+Chem T5 (ours)</td>
<td>base</td>
<td>0.459</td>
<td>0.478</td>
<td>0.750</td>
<td>0.580</td>
<td>0.935</td>
<td></td>
</tr>
<tr>
<td>Text+Chem T5-augm (ours)</td>
<td>small</td>
<td>0.413</td>
<td>0.405</td>
<td>0.815</td>
<td>0.560</td>
<td>0.926</td>
<td></td>
</tr>
<tr>
<td>Text+Chem T5-augm (ours)</td>
<td>base</td>
<td>0.594</td>
<td>0.372</td>
<td>0.853</td>
<td>0.625</td>
<td>0.943</td>
<td></td>
</tr>
</tbody>
</table>
<p>Table 3: Results of the SMILES to Caption (mol2text) task. The baselines include Transformer (Edwards et al., 2022), T5 (finetuned), and MolT5 (Edwards et al., 2022). The metrics used in the table include BLEU-2, BLEU-4, Rouge-1, Rouge-2, Rouge-L, and Meteor, all of which are common metrics used to evaluate text generation models. The table shows that our proposed model, Text+Chem T5, outperforms the other baselines in all the metrics. Overall, Text+Chem T5 is able to generate more accurate and informative captions for SMILES.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">Size</th>
<th style="text-align: center;">BLEU-2 $\uparrow$</th>
<th style="text-align: center;">BLEU-4 $\uparrow$</th>
<th style="text-align: center;">Rouge-1 $\uparrow$</th>
<th style="text-align: center;">Rouge-2 $\uparrow$</th>
<th style="text-align: center;">Rouge-L $\uparrow$</th>
<th style="text-align: center;">Meteor $\uparrow$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Transformer (Edwards et al., 2022)</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">0.061</td>
<td style="text-align: center;">0.027</td>
<td style="text-align: center;">0.188</td>
<td style="text-align: center;">0.0597</td>
<td style="text-align: center;">0.165</td>
<td style="text-align: center;">0.126</td>
</tr>
<tr>
<td style="text-align: center;">T5 (fine-tuned) (Raffel et al., 2020)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.501</td>
<td style="text-align: center;">0.415</td>
<td style="text-align: center;">0.602</td>
<td style="text-align: center;">0.446</td>
<td style="text-align: center;">0.545</td>
<td style="text-align: center;">0.532</td>
</tr>
<tr>
<td style="text-align: center;">MolT5 (Edwards et al., 2022)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.519</td>
<td style="text-align: center;">0.436</td>
<td style="text-align: center;">0.620</td>
<td style="text-align: center;">0.469</td>
<td style="text-align: center;">0.563</td>
<td style="text-align: center;">0.551</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5 (ours)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.553</td>
<td style="text-align: center;">0.462</td>
<td style="text-align: center;">0.633</td>
<td style="text-align: center;">0.481</td>
<td style="text-align: center;">0.574</td>
<td style="text-align: center;">0.583</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5-augm (ours)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.560</td>
<td style="text-align: center;">0.470</td>
<td style="text-align: center;">0.638</td>
<td style="text-align: center;">0.488</td>
<td style="text-align: center;">0.580</td>
<td style="text-align: center;">0.588</td>
</tr>
<tr>
<td style="text-align: center;">T5(fine-tuned) (Raffel et al., 2020)</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.511</td>
<td style="text-align: center;">0.424</td>
<td style="text-align: center;">0.607</td>
<td style="text-align: center;">0.451</td>
<td style="text-align: center;">0.550</td>
<td style="text-align: center;">0.539</td>
</tr>
<tr>
<td style="text-align: center;">MolT5 (Edwards et al., 2022)</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.540</td>
<td style="text-align: center;">0.457</td>
<td style="text-align: center;">0.634</td>
<td style="text-align: center;">0.485</td>
<td style="text-align: center;">0.578</td>
<td style="text-align: center;">0.569</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5 (ours)</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.580</td>
<td style="text-align: center;">0.490</td>
<td style="text-align: center;">0.647</td>
<td style="text-align: center;">0.498</td>
<td style="text-align: center;">0.586</td>
<td style="text-align: center;">0.604</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5-augm (ours)</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.625</td>
<td style="text-align: center;">0.542</td>
<td style="text-align: center;">0.682</td>
<td style="text-align: center;">0.543</td>
<td style="text-align: center;">0.622</td>
<td style="text-align: center;">0.648</td>
</tr>
</tbody>
</table>
<p>Text to Molecule. Table 4 presents the results of different models evaluated on the Caption to SMILES (text2mol) task. The models include Transformer, T5, MolT5, and Text+Chem T5. The performance of each model is evaluated using BLEU score, Accuracy, and Levenshtein distance. The best results are highlighted in bold. Text+Chem T5 performed best among all the models in the task. Specifically, it achieved the highest BLEU score of 0.853 , indicating that it generated SMILES strings that were highly similar to the reference SMILES. The accuracy indicates that Text+Chem T5 generates more than $32 \%$ of correct SMILES. The Levenshtein distance is a measure of the similarity between two strings. A smaller Levenshtein distance indicates that the generated SMILES is more similar to the reference SMILES. The Levenshtein distance of 16.87 for the Text+Chem T5 model indicates that this model was able
to generate SMILES strings that were very similar to the reference SMILES. Overall, the table suggests that Text+Chem T5 model was the best among all the models for the Caption to SMILES task, as it performed well on all the metrics.</p>
<p>Architecture Ablation. Table 5 presents the results of an ablation study on the aggregation and encoder strategy for the cross-domain tasks of text2mol and mol2text. The different models considered in the ablation study include $\mathrm{MD} e^{2}$-CLM, $\mathrm{MDMT} e^{2}$-CLM, and Text+Chem T5. The performance of each model is evaluated using the text2mol and mol2text metrics. The best results are highlighted in bold. The table compares different variants of the model (Figure 4). $\mathrm{MD} e^{2}$-CLM denotes that the model has different encoders for each domain, whereas $\mathrm{MDMT} e^{2}$-CLM denotes that the model has different encoders for each domain and is trained using multiple tasks. The models are further differen-</p>
<p>Table 4: Results of the Description to SMILES (text2mol) task. The performance of the models is evaluated by BLEU score, Accuracy, Levenshtein distance, and additional metrics (see Evaluation). The results show that the proposed model (Text+Chem T5) outperforms other baselines in all metrics. These results demonstrate the effectiveness of the proposed model in translating from natural language to SMILES representation of molecules.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">Size</th>
<th style="text-align: center;">BLEU score $\uparrow$</th>
<th style="text-align: center;">Accuracy $\uparrow$</th>
<th style="text-align: center;">Levenshtein $\downarrow$</th>
<th style="text-align: center;">MACCS FTS $\uparrow$</th>
<th style="text-align: center;">RDK FTS $\uparrow$</th>
<th style="text-align: center;">Morgan FTS $\uparrow$</th>
<th style="text-align: center;">FCD $\downarrow$</th>
<th style="text-align: center;">Validity $\uparrow$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Transformer (Edwards et al., 2022)</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">0.499</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">57.66</td>
<td style="text-align: center;">0.480</td>
<td style="text-align: center;">0.320</td>
<td style="text-align: center;">0.217</td>
<td style="text-align: center;">11.32</td>
<td style="text-align: center;">0.906</td>
</tr>
<tr>
<td style="text-align: center;">T5 (fine-tuned) (Raffel et al., 2020)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.741</td>
<td style="text-align: center;">0.064</td>
<td style="text-align: center;">27.7</td>
<td style="text-align: center;">0.704</td>
<td style="text-align: center;">0.578</td>
<td style="text-align: center;">0.525</td>
<td style="text-align: center;">2.89</td>
<td style="text-align: center;">0.608</td>
</tr>
<tr>
<td style="text-align: center;">MolT5 (Edwards et al., 2022)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.755</td>
<td style="text-align: center;">0.079</td>
<td style="text-align: center;">25.99</td>
<td style="text-align: center;">0.703</td>
<td style="text-align: center;">0.568</td>
<td style="text-align: center;">0.517</td>
<td style="text-align: center;">2.49</td>
<td style="text-align: center;">0.721</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5 (ours)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.739</td>
<td style="text-align: center;">0.157</td>
<td style="text-align: center;">28.54</td>
<td style="text-align: center;">0.859</td>
<td style="text-align: center;">0.736</td>
<td style="text-align: center;">0.660</td>
<td style="text-align: center;">0.066</td>
<td style="text-align: center;">0.776</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5-augm (ours)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.815</td>
<td style="text-align: center;">0.191</td>
<td style="text-align: center;">21.78</td>
<td style="text-align: center;">0.864</td>
<td style="text-align: center;">0.744</td>
<td style="text-align: center;">0.672</td>
<td style="text-align: center;">0.060</td>
<td style="text-align: center;">0.951</td>
</tr>
<tr>
<td style="text-align: center;">T5 (fine-tuned) (Raffel et al., 2020)</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.762</td>
<td style="text-align: center;">0.069</td>
<td style="text-align: center;">24.95</td>
<td style="text-align: center;">0.731</td>
<td style="text-align: center;">0.605</td>
<td style="text-align: center;">0.545</td>
<td style="text-align: center;">2.48</td>
<td style="text-align: center;">0.660</td>
</tr>
<tr>
<td style="text-align: center;">MolT5 (Edwards et al., 2022)</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.769</td>
<td style="text-align: center;">0.081</td>
<td style="text-align: center;">24.49</td>
<td style="text-align: center;">0.721</td>
<td style="text-align: center;">0.588</td>
<td style="text-align: center;">0.529</td>
<td style="text-align: center;">0.218</td>
<td style="text-align: center;">0.772</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5 (ours)</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.750</td>
<td style="text-align: center;">0.212</td>
<td style="text-align: center;">27.39</td>
<td style="text-align: center;">0.874</td>
<td style="text-align: center;">0.767</td>
<td style="text-align: center;">0.697</td>
<td style="text-align: center;">0.061</td>
<td style="text-align: center;">0.792</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5-augm (ours)</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.853</td>
<td style="text-align: center;">0.322</td>
<td style="text-align: center;">16.87</td>
<td style="text-align: center;">0.901</td>
<td style="text-align: center;">0.816</td>
<td style="text-align: center;">0.757</td>
<td style="text-align: center;">0.050</td>
<td style="text-align: center;">0.943</td>
</tr>
</tbody>
</table>
<p>Table 5: Ablation study for different aggregation and encoder strategies for cross-domain tasks. The objective of this study is to understand how the different choices of aggregation and encoder strategies affect the performance of the model. The tasks considered are text-to-chemistry (text2mol) and chemistry-totext (mol2text). The evaluation metrics used in the table are BLEU scores. It can be observed that the proposed Text+Chem T5 model outperforms the other models in both the text-to-chemistry and chemistry-to-text tasks, and thus the best approach is to use encoder sharing and tuning and not use any specific aggregation strategy. agg: aggregation mechanism; cross-att: cross-attention for aggregation. MD: multi-domain; MT: multi-task; $c^{2}$ : the model uses domain-specific encoders.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Model</th>
<th style="text-align: center;">agg</th>
<th style="text-align: center;">enc- <br> sharing</th>
<th style="text-align: center;">enc- <br> tuning</th>
<th style="text-align: center;">text2 mol2 <br> mol</th>
<th style="text-align: center;">text</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">$\mathrm{MD} c^{2}$-CLM</td>
<td style="text-align: center;">mean</td>
<td style="text-align: center;">$\boldsymbol{x}$</td>
<td style="text-align: center;">$\boldsymbol{x}$</td>
<td style="text-align: center;">0.572</td>
<td style="text-align: center;">0.123</td>
</tr>
<tr>
<td style="text-align: center;">$\mathrm{MD} c^{2}$-CLM</td>
<td style="text-align: center;">cross-att</td>
<td style="text-align: center;">$\boldsymbol{x}$</td>
<td style="text-align: center;">$\boldsymbol{x}$</td>
<td style="text-align: center;">0.702</td>
<td style="text-align: center;">0.274</td>
</tr>
<tr>
<td style="text-align: center;">MDMTc ${ }^{2}$-CLM</td>
<td style="text-align: center;">cross-att</td>
<td style="text-align: center;">$\boldsymbol{x}$</td>
<td style="text-align: center;">$\boldsymbol{x}$</td>
<td style="text-align: center;">0.247</td>
<td style="text-align: center;">0.119</td>
</tr>
<tr>
<td style="text-align: center;">MDMTc ${ }^{2}$-CLM</td>
<td style="text-align: center;">cross-att</td>
<td style="text-align: center;">$\boldsymbol{x}$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">0.211</td>
<td style="text-align: center;">0.075</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">0.750</td>
<td style="text-align: center;">0.580</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5-augm</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">0.853</td>
<td style="text-align: center;">0.625</td>
</tr>
</tbody>
</table>
<p>tiated based on the aggregation and encoder-sharing strategy. "Agg" denotes the method used for aggregating information from the different tasks, "enc-sharing" denotes whether the encoders are shared across tasks, and "enc-tuning" denotes whether the encoders are fine-tuned for each task. Text+Chem T5 performed the best among all the models for both the text2mol and mol2text tasks. It achieved the highest score of 0.853 on the text2mol task and 0.625 on the mol2text task. The model that performed best is Text+Chem T5, it has achieved the highest scores on both cross-domain tasks, it was implemented using shared encoders and fine-tuning approach. Using a shared encoder and fine-tuning strategy for the CLM model improves performance on cross-domain tasks. Also, the ablation study has indicated that the aggregate method didn't play a big role in the performance of the model, but shared encoders and fine-tuning approach had the most significant effect on the performance of the model.</p>
<p>Model Size. Text+Chem T5 results improve by increasing the model size. Figure 1 shows the trend for different metrics (x-axis) for the SMILES to Caption (mol2text) task. We report results for T5-fine-tuned, MolT5 and Text+Chem T5 in two different model sizes: small (60M parameters) and base (220M parameters). These are standard sizes for T5based models. We see how the results for Text+Chem T5 not only improve increasing the model capacity but improve much faster than baselines with similar capacity. We see similar trends in Table 3 and Table 4, corroborating the idea that joint multi-task training on textual and molecular domains is an effective mechanism to enrich representations in language models and share information among tasks and domains.</p>
<p>Dataset Size. The augmented version of the dataset contributes to improved performance across the whole span of tasks. This improvement is especially high in the tasks in which the requested output modality is SMILES which is totally aligned with the new information that we have incorporated in the augmented version of the dataset. This observation underlines the need for a high volume of data in such training strategies to assist the model in better understanding the different domains or modalities of interest.</p>
<p>Qualitative Evaluation. Finally, we conduct a qualitative assessment of Text+Chem T5's ability to guide a user through a hypothetical molecular discovery workflow. As exemplified in Appendix Figure 7 via the common herbicide Monuron, three consecutive calls to Text+Chem T5 are sufficient to convert a textual description of Monuron to a stepwise wet-lab execution protocol to synthesize it. None of the three steps - (1) text2mol - converting the text description to SMILES; (2) retro - converting the SMILES to a precursor list for the synthesis and (3) paragraph2actions - converting a patent description of the generated reaction to a stepwise synthesis execution protocol - can be solved by SOTA LLMs like ChatGPT (Ouyang et al., 2022) or Galactica (Taylor et al., 2022) ${ }^{1}$.</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>Overall, Galactica failed to provide SMILES strings even though it was developed for scientific text; ChatGPT made small errors in all tasks and only Text+Chem T5 was able to arrive at the correct result. See Appendix B for more comparisons and examples.</p>
<h2>5 Related Work</h2>
<p>Transformers for Natural Language. BERT (Devlin et al., 2018) is a prominent example, a bidirectional transformer trained using masked language modeling, which forces the model to reconstruct the input that has been degraded. BERT popularized the adoption of the transformer as the backbone architecture for many language tasks. In the same period, consistent, long-range text generation was achieved using autoregressive training (causal language modeling) using the GPT-family (Radford et al., 2018), transformers with a specific focus on the next token generation. Surprisingly, simple training using large architectures and vast data gave rise to generalization, multitasking (Radford et al., 2019), and few-shot capabilities (Brown et al., 2020). Training on code (Chen et al., 2021), instruction finetuning (Ouyang et al., 2022; Chung et al., 2022) and chain-of-thought prompting (Wei et al., 2022) have further improved the performance of transformer models in reasoning tasks (Fu et al., 2022; Lewkowycz et al., 2022; Liévin et al., 2022).</p>
<p>Generative Transfer and Multi-task Learning. Building on the success of masked language modelling (Devlin et al., 2018), the T5 framework (Raffel et al., 2020) has emerged as a leading paradigm in generative transfer and multitask learning. T5 is a multitask language model that is trained on a wide variety of tasks using masking. This model has shown impressive generalization and adaptation capabilities for multimodal generation (Saharia et al., 2022). These techniques have also greatly improved the performance of cross-domain language models, such as models that can translate between languages (Sanh et al., 2021).</p>
<p>Language Models in Chemistry. Recent advances in neural language models have been successfully applied to the chemical domain. Several studies have utilized transformer architectures to address a variety of chemical tasks, including forward reaction prediction (Schwaller et al., 2019), multi-step retrosynthesis (Schwaller et al., 2020; Toniato et al., 2021), and property prediction (Schwaller et al., 2021; Vaucher et al., 2020; Born and Manica, 2023). In addition, there has been research exploring multitask generation for chemistry using a pretrained T5 model with multiple heads for different types of tasks, such as regression, classification, and generation (Lu and Zhang, 2022). However, there is still a need for models that can handle multiple tasks across domains without the need for expensive pretraining or finetuning.</p>
<h2>6 Limitations</h2>
<p>This study introduces a novel application of large language models in chemistry and cross-domain generation, which is subject to the same limitations as previous research on the topic (Edwards et al., 2022) and the presence of unintended biases encoded in the training data (Raffel et al., 2020; Liang et al., 2021). The chemistry representation is based on SMILES (Weininger, 1988), which can generate invalid sequences. Alternative representations like SELFIES with validity guarantees could improve this issue (Krenn et al., 2020). Finally, it is worth noting that all the presented models were designed for research purposes only, and any molecules generated by the model should undergo standard clinical testing before being used for medical or other purposes.</p>
<h2>7 Conclusion</h2>
<p>In this paper, we introduced Multitask Text and Chemistry T5, a multi-task, multi-domain language model for the natural and chemical domains. The model can effectively translate between natural and chemical languages, making it possible to solve a variety of tasks such as chemical reaction prediction, retro-synthesis, text-conditional de novo generation, and molecular captioning. The strength of the model lies in its ability to solve multiple tasks without the need for additional task-specific heads or adaptation at test time. The result is a step forward in the development of a general multi-task, multi-domain language model for the life sciences. This can potentially accelerate the discovery process in this field, by providing a more efficient way to process, analyze and generate chemical and textual data.</p>
<h2>Code Availability</h2>
<p>The Multitask Text and Chemistry T5 model is available for inference, training and finetuning via the GT4SD library (Manica et al., 2023): https://github.com/ GT4SD/gt4sd-core.</p>
<p>A gradio (Abid et al., 2019) app, build on top of the GT4SD implementation and hosted publicly on HuggingFace spaces, allows easy access to the models: https://huggingface.co/spaces/GT4SD/ multitask-text-and-chemistry-t5.</p>
<p>Code is available at: https://github.com/GT4SD/ multitask_text_and_chemistry_t5</p>
<h2>References</h2>
<p>Abid, A., Abdalla, A., Abid, A., Khan, D., Alfozan, A., and Zou, J. (2019). Gradio: Hassle-free sharing and testing of ml models in the wild. arXiv preprint arXiv:1906.02569.</p>
<p>Banerjee, S. and Lavie, A. (2005). METEOR: An automatic metric for MT evaluation with improved correlation with human judgments. In Proceedings of the ACL Workshop on Intrinsic and Extrinsic Evaluation Measures for Machine Translation</p>
<p>and/or Summarization, pages 65-72, Ann Arbor, Michigan. Association for Computational Linguistics.</p>
<p>Born, J. and Manica, M. (2023). Regression transformer enables concurrent sequence regression and generation for molecular language modelling. Nature Machine Intelligence, 5(4):432444.</p>
<p>Born, J., Manica, M., Cadow, J., Markert, G., Mill, N. A., Filipavicius, M., Janakarajan, N., Cardinale, A., Laino, T., and Martínez, M. R. (2021a). Data-driven molecular design for discovery and synthesis of novel ligands: a case study on sars-cov-2. Machine Learning: Science and Technology, 2(2):025024.</p>
<p>Born, J., Manica, M., Oskooei, A., Cadow, J., Markert, G., and Martínez, M. R. (2021b). Paccmannrl: De novo generation of hit-like anticancer molecules from transcriptomic data via reinforcement learning. Iscience, 24(4):102269.</p>
<p>Brown, T., Mann, B., Ryder, N., Subbiah, M., Kaplan, J. D., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G., Askell, A., et al. (2020). Language models are few-shot learners. Advances in neural information processing systems, 33:1877-1901.</p>
<p>Chen, M., Tworek, J., Jun, H., Yuan, Q., Pinto, H. P. d. O., Kaplan, J., Edwards, H., Burda, Y., Joseph, N., Brockman, G., et al. (2021). Evaluating large language models trained on code. arXiv preprint arXiv:2107.03374.</p>
<p>Chung, H. W., Hou, L., Longpre, S., Zoph, B., Tay, Y., Fedus, W., Li, E., Wang, X., Dehghani, M., Brahma, S., et al. (2022). Scaling instruction-finetuned language models. arXiv preprint arXiv:2210.11416.</p>
<p>Devlin, J., Chang, M.-W., Lee, K., and Toutanova, K. (2018). Bert: Pre-training of deep bidirectional transformers for language understanding. arXiv preprint arXiv:1810.04805.</p>
<p>Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X., Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., et al. (2020). An image is worth 16x16 words: Transformers for image recognition at scale. arXiv preprint arXiv:2010.11929.</p>
<p>Durant, J. L., Leland, B. A., Henry, D. R., and Nourse, J. G. (2002). Reoptimization of mdl keys for use in drug discovery. Journal of chemical information and computer sciences, 42(6):1273-1280.</p>
<p>Edwards, C., Lai, T., Ros, K., Honke, G., and Ji, H. (2022). Translation between molecules and natural language. arXiv preprint arXiv:2204.11817.</p>
<p>Edwards, C., Zhai, C., and Ji, H. (2021). Text2mol: Cross-modal molecule retrieval with natural language queries. In Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing, pages 595-607.</p>
<p>Falcon, W. and The PyTorch Lightning team (2019). PyTorch Lightning.</p>
<p>Fu, Y., Peng, H., Sabharwal, A., Clark, P., and Khot, T. (2022). Complexity-based prompting for multi-step reasoning. arXiv preprint arXiv:2210.00720.</p>
<p>Jumper, J., Evans, R., Pritzel, A., Green, T., Figurnov, M., Ronneberger, O., Tunyasuvunakool, K., Bates, R., Žídek, A., Potapenko, A., et al. (2021). Highly accurate protein structure prediction with alphafold. Nature, 596(7873):583-589.</p>
<p>Krenn, M., Häse, F., Nigam, A., Friederich, P., and Aspuru-Guzik, A. (2020). Self-referencing embedded strings (selfies): A 100\% robust molecular string representation. Machine Learning: Science and Technology, 1(4):045024.</p>
<p>Levenshtein, V. I. (1966). Binary codes capable of correcting deletions, insertions, and reversals. Soviet physics doklady, 10(8):707-710.</p>
<p>Lewkowycz, A., Andreassen, A., Dohan, D., Dyer, E., Michalewski, H., Ramasesh, V., Slone, A., Anil, C., Schlag, I., Gutman-Solo, T., et al. (2022). Solving quantitative reasoning problems with language models. arXiv preprint arXiv:2206.14858.</p>
<p>Liang, P. P., Wu, C., Morency, L.-P., and Salakhutdinov, R. (2021). Towards understanding and mitigating social biases in language models. In International Conference on Machine Learning, pages 6565-6576. PMLR.</p>
<p>Liévin, V., Hother, C. E., and Winther, O. (2022). Can large language models reason about medical questions? arXiv preprint arXiv:2207.08143.</p>
<p>Lin, C.-Y. (2004). Rouge: A package for automatic evaluation of summaries. In Text summarization branches out, pages 74-81.</p>
<p>Lu, J. and Zhang, Y. (2022). Unified deep learning model for multitask reaction predictions with explanation. Journal of Chemical Information and Modeling, 62(6):1376-1387.</p>
<p>Manica, M., Born, J., Cadow, J., Christofidellis, D., Dave, A., Clarke, D., Teukam, Y. G. N., Giannone, G., Hoffman, S. C., Buchan, M., Chenthamarakshan, V., Donovan, T., Hsu, H. H., Zipoli, F., Schilter, O., Kishimoto, A., Hamada, L., Padhi, I., Wehden, K., McHugh, L., Khrabrov, A., Das, P., Takeda, S., and Smith, J. R. (2023). Accelerating material design with the generative toolkit for scientific discovery. npj Computational Materials, 9(1):69.</p>
<p>Nextmove (2023). Nextmove software pistachio.
Ouyang, L., Wu, J., Jiang, X., Almeida, D., Wainwright, C. L., Mishkin, P., Zhang, C., Agarwal, S., Slama, K., Ray, A., et al. (2022). Training language models to follow instructions with human feedback. arXiv preprint arXiv:2203.02155.</p>
<p>O’Neill, S. (2021). Ai-driven robotic laboratories show promise. Engineering, 7(1351.10):1016.</p>
<p>Papineni, K., Roukos, S., Ward, T., and Zhu, W.-J. (2002). Bleu: a method for automatic evaluation of machine translation. In Proceedings of the 40th annual meeting of the Association for Computational Linguistics, pages 311-318.</p>
<p>Preuer, K., Renz, P., Unterthiner, T., Hochreiter, S., and Klambauer, G. (2018). Fréchet chemnet distance: a metric for generative models for molecules in drug discovery. Journal of chemical information and modeling, 58(9):1736-1741.</p>
<p>Radford, A., Narasimhan, K., Salimans, T., Sutskever, I., et al. (2018). Improving language understanding by generative pretraining.</p>
<p>Radford, A., Wu, J., Child, R., Luan, D., Amodei, D., Sutskever, I., et al. (2019). Language models are unsupervised multitask learners. OpenAI blog, 1(8):9.</p>
<p>Raffel, C., Shazeer, N., Roberts, A., Lee, K., Narang, S., Matena, M., Zhou, Y., Li, W., Liu, P. J., et al. (2020). Exploring the limits of transfer learning with a unified text-to-text transformer. J. Mach. Learn. Res., 21(140):1-67.</p>
<p>Ramesh, A., Dhariwal, P., Nichol, A., Chu, C., and Chen, M. (2022). Hierarchical text-conditional image generation with clip latents. arXiv preprint arXiv:2204.06125.</p>
<p>Rogers, D. and Hahn, M. (2010). Extended-connectivity fingerprints. Journal of chemical information and modeling, 50(5):742-754.</p>
<p>Saharia, C., Chan, W., Saxena, S., Li, L., Whang, J., Denton, E., Ghasemipour, S. K. S., Ayan, B. K., Mahdavi, S. S., Lopes, R. G., et al. (2022). Photorealistic text-to-image diffusion models with deep language understanding. arXiv preprint arXiv:2205.11487.</p>
<p>Sanh, V., Webson, A., Raffel, C., Bach, S. H., Sutawika, L., Alyafeai, Z., Chaffin, A., Stiegler, A., Scao, T. L., Raja, A., et al. (2021). Multitask prompted training enables zero-shot task generalization. arXiv preprint arXiv:2110.08207.</p>
<p>Schwaller, P., Gaudin, T., Lanyi, D., Bekas, C., and Laino, T. (2018). "found in translation": predicting outcomes of complex organic chemistry reactions using neural sequence-to-sequence models. Chemical science, 9(28):6091-6098.</p>
<p>Schwaller, P., Laino, T., Gaudin, T., Bolgar, P., Hunter, C. A., Bekas, C., and Lee, A. A. (2019). Molecular transformer: a model for uncertainty-calibrated chemical reaction prediction. ACS central science, 5(9):1572-1583.</p>
<p>Schwaller, P., Petraglia, R., Zullo, V., Nair, V. H., Haeuselmann, R. A., Pisoni, R., Bekas, C., Iuliano, A., and Laino, T. (2020). Predicting retrosynthetic pathways using transformer-based models and a hyper-graph exploration strategy. Chemical science, 11(12):3316-3325.</p>
<p>Schwaller, P., Probst, D., Vaucher, A. C., Nair, V. H., Kreutter, D., Laino, T., and Reymond, J.-L. (2021). Mapping the space of chemical reactions using attention-based neural networks. Nature Machine Intelligence, 3(2):144-152.</p>
<p>Tanimoto, T. T. (1958). Elementary mathematical theory of classification and prediction.</p>
<p>Taylor, R., Kardas, M., Cucurull, G., Scialom, T., Hartshorn, A., Saravia, E., Poulton, A., Kerkez, V., and Stojnic, R. (2022). Galactica: A large language model for science. arXiv preprint arXiv:2211.09085.</p>
<p>Toniato, A., Schwaller, P., Cardinale, A., Geluykens, J., and Laino, T. (2021). Unassisted noise reduction of chemical reaction datasets. Nature Machine Intelligence, 3(6):485-494.</p>
<p>Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, Ł., and Polosukhin, I. (2017). Attention is all you need. Advances in neural information processing systems, 30.</p>
<p>Vaucher, A. C., Zipoli, F., Geluykens, J., Nair, V. H., Schwaller, P., and Laino, T. (2020). Automated extraction of chemical synthesis actions from experimental procedures. Nature communications, 11(1):1-11.</p>
<p>Wei, J., Wang, X., Schuurmans, D., Bosma, M., Chi, E., Le, Q., and Zhou, D. (2022). Chain of thought prompting elicits reasoning in large language models. arXiv preprint arXiv:2201.11903.</p>
<p>Weininger, D. (1988). Smiles, a chemical language and information system. 1. introduction to methodology and encoding rules. Journal of chemical information and computer sciences, 28(1):31-36.</p>
<p>Winata, G. I., Madotto, A., Lin, Z., Liu, R., Yosinski, J., and Fung, P. (2021). Language models are few-shot multilingual learners. arXiv preprint arXiv:2109.07684.</p>
<p>Wolf, T., Debut, L., Sanh, V., Chaumond, J., Delangue, C., Moi, A., Cistac, P., Ma, C., Jernite, Y., Plu, J., Xu, C., Le Scao, T., Gugger, S., Drame, M., Lhoest, Q., and Rush, A. M. (2020). Transformers: State-of-the-Art Natural Language Processing. pages 38-45. Association for Computational Linguistics.</p>
<h1>A Additional Experiments</h1>
<p>Table 6: Comparison on the cross-domain tasks. The models include a fine-tuned transformer, T5 models in both zero-shot and fine-tuned settings, MolT5, and Text+Chem T5. The models are compared at two different sizes, "small" and "base." We can see how T5 zero-shot (without fine-tuning) is completely unable to perform cross-domain translation, corroborating the necessity for multi-domain multitask modelling in the chemical and natural language domains.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">Size</th>
<th style="text-align: center;">text2mol</th>
<th style="text-align: center;">mol2text</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Transformer (fine-tuned)</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">0.499</td>
<td style="text-align: center;">0.061</td>
</tr>
<tr>
<td style="text-align: center;">T5 (zero-shot)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.000</td>
<td style="text-align: center;">0.004</td>
</tr>
<tr>
<td style="text-align: center;">T5 (fine-tuned)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.762</td>
<td style="text-align: center;">0.501</td>
</tr>
<tr>
<td style="text-align: center;">MolT5</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.755</td>
<td style="text-align: center;">0.519</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.815</td>
<td style="text-align: center;">0.560</td>
</tr>
<tr>
<td style="text-align: center;">T5 (zero-shot)</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.000</td>
<td style="text-align: center;">0.003</td>
</tr>
<tr>
<td style="text-align: center;">T5 (fine-tuned)</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.762</td>
<td style="text-align: center;">0.511</td>
</tr>
<tr>
<td style="text-align: center;">MolT5</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.769</td>
<td style="text-align: center;">0.540</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.853</td>
<td style="text-align: center;">0.625</td>
</tr>
</tbody>
</table>
<p>Table 7: Results of the Paragraph to Actions task. The performance of the models is evaluated by BLEU score and accuracy. The results show that the proposed model (Text+Chem T5) outperforms other baselines in all metrics. These results demonstrate the effectiveness of the proposed model in the text modality. RXN model is the paragraph-to-action proposed in (Vaucher et al., 2020).</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">Size</th>
<th style="text-align: center;">BLEU score $\uparrow$</th>
<th style="text-align: center;">Accuracy $\uparrow$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">RXN</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">0.850</td>
<td style="text-align: center;">0.608</td>
</tr>
<tr>
<td style="text-align: center;">T5 (fine-tuned)</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">$\mathbf{0 . 9 5 3}$</td>
<td style="text-align: center;">$\mathbf{0 . 8 5 6}$</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.929</td>
<td style="text-align: center;">0.780</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5-augm</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">0.926</td>
<td style="text-align: center;">0.780</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.935</td>
<td style="text-align: center;">0.800</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5-augm</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">0.943</td>
<td style="text-align: center;">0.829</td>
</tr>
</tbody>
</table>
<p><img alt="img-4.jpeg" src="img-4.jpeg" /></p>
<p>Figure 5: Molecule to Caption task. This plot compares the performance of three different models with different sizes (Text+Chem T5-base, Text+Chem T5-small, MolT5-base, MolT5-small, T5-base, and T5-small) on the task of converting SMILES to captions, using six different metrics: BLUE-2, BLEU-4, Rouge-1, Rouge-2, Rouge-L, and Meteor. The models are compared by plotting their scores on the $y$-axis. The graph shows that our proposal, Text+Chem T5, performs the best on all metrics and improves with size, corroborating our hypothesis that joint learning on molecular and textual domains leveraging multitask learning is a powerful paradigm to bridge the gap between domains.
<img alt="img-5.jpeg" src="img-5.jpeg" /></p>
<p>Figure 6: Text-conditional Molecule Generation. This plot compares the performance of three different models with different sizes (Text+Chem T5-base, Text+Chem T5-small, MolT5-base, MolT5-small, T5-base, and T5-small) on the task of converting captions to SMILES, using five different metrics: Accuracy, Morgan FTS, RDK FTS, BLEU, MACCS FTS. The models are compared by plotting their scores on the $y$-axis. The graph shows that our proposal, Text+Chem T5, performs the best on all metrics and improves with size, corroborating our hypothesis that joint learning on molecular and textual domains leveraging multitask learning is a powerful paradigm to bridge the gap between domains.</p>
<h1>B Comparison with recent Language Models and Workflow example</h1>
<p>Table 8: Conditional Molecule Generation. Given a description, generate the SMILES representation. We compare the generation of our model with GALACTICA (1.3B) and ChatGPT. For our model and ChatGPT we use the prompt structure proposed in Table 10. For GALACTICA, we follow the prompt structure proposed by the authors.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Input</th>
<th style="text-align: center;">The molecule is an acyl-CoA oxoanion that is the pentaanion of (S)-3-hydroxydecanedioyl-CoA arising from deprotonation of the phosphate, diphosphate and carboxylic acid functions; major species at pH 7.3 . It is a conjugate base of a (S)-3-hydroxydecanedioyl-CoA.</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Target</td>
<td style="text-align: center;">$\begin{aligned} &amp; \mathrm{CC}(\mathrm{C})(\mathrm{COP}(=\mathrm{O})([\mathrm{O}-]) \mathrm{OP}(=\mathrm{O})([\mathrm{O}-]) \mathrm{OC}[\mathrm{C} @ @ \mathrm{H}] 1<a href="[\mathrm{C} @ \mathrm{H}]([\mathrm{C} @ \mathrm{H}](\mathrm{O} 1) \ &amp; \mathrm{N} 2 \mathrm{C}=\mathrm{NC} 3=\mathrm{C}(\mathrm{N}=\mathrm{CN}=\mathrm{C} 32) \mathrm{N}) \mathrm{O}">\mathrm{C} @ \mathrm{H}</a> \mathrm{OP}(=\mathrm{O})([\mathrm{O}-])[\mathrm{O}-])<a href="\mathrm{C}(=\mathrm{O}) \mathrm{NCCC}(=\mathrm{O}) \ &amp; \mathrm{NCCSC}(=\mathrm{O}) \mathrm{C}[\mathrm{C} @ \mathrm{H}](\mathrm{CCCCCCC}(=\mathrm{O})[\mathrm{O}-]) \mathrm{O}">\mathrm{C} @ \mathrm{H}</a> \end{aligned}$</td>
</tr>
<tr>
<td style="text-align: center;">GALACTICA</td>
<td style="text-align: center;">(S)-3-hydroxydecanedioyl-CoA</td>
</tr>
<tr>
<td style="text-align: center;">ChatGPT</td>
<td style="text-align: center;">$[\mathrm{O}-] \mathrm{P}(=\mathrm{O})(\mathrm{O}[\mathrm{C} @ @ \mathrm{H}] 1 \mathrm{CCC} @ @([\mathrm{NH} 3+]) \mathrm{C} 1) \mathrm{OCC}(=\mathrm{O}) \mathrm{NCCCC} @ \mathrm{HC}$</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5 (Ours)</td>
<td style="text-align: center;">$\begin{aligned} &amp; \mathrm{CC}(\mathrm{C})(\mathrm{COP}(=\mathrm{O})([\mathrm{O}-]) \mathrm{OP}(=\mathrm{O})([\mathrm{O}-]) \mathrm{OC}[\mathrm{C} @ @ \mathrm{H}] 1<a href="[\mathrm{C} @ \mathrm{H}]([\mathrm{C} @ @ \mathrm{H}](\mathrm{O} 1) \ &amp; \mathrm{N} 2 \mathrm{C}=\mathrm{NC} 3=\mathrm{C}(\mathrm{N}=\mathrm{CN}=\mathrm{C} 32) \mathrm{N}) \mathrm{O}">\mathrm{C} @ \mathrm{H}</a> \mathrm{OP}(=\mathrm{O})([\mathrm{O}-])[\mathrm{O}-])<a href="\mathrm{C}(=\mathrm{O}) \mathrm{NCCC}(=\mathrm{O}) \ &amp; \mathrm{NCCSC}(=\mathrm{O}) \mathrm{C}[\mathrm{C} @ \mathrm{H}](\mathrm{CCCCCCC}(=\mathrm{O})[\mathrm{O}-]) \mathrm{O}">\mathrm{C} @ \mathrm{H}</a> \mathrm{O} \end{aligned}$</td>
</tr>
<tr>
<td style="text-align: center;">Input</td>
<td style="text-align: center;">The molecule is a glucotriose consisting of D-glucopyranose, alpha-D-glucopyranose and beta-D-glucopyranose residues joined in sequence by two ( $1-&gt;4$ ) glycosidic bonds. The configuration of the anomeric centre at the non-reducing terminus is not specified. It is a partially-defined glycan and a glucotriose.</td>
</tr>
<tr>
<td style="text-align: center;">Target</td>
<td style="text-align: center;">$\begin{aligned} &amp; \mathrm{C}([\mathrm{C} @ @ \mathrm{H}] 1<a href="[\mathrm{C} @ @ \mathrm{H}]([\mathrm{C} @ \mathrm{H}](\mathrm{C}(\mathrm{O} 1) \mathrm{O}[\mathrm{C} @ @ \mathrm{H}] 2[\mathrm{C} @ \mathrm{H}](\mathrm{O}[\mathrm{C} @ @ \mathrm{H}]([\mathrm{C} @ @ \mathrm{H}] \ &amp;([\mathrm{C} @ \mathrm{H}] 2 \mathrm{O}) \mathrm{O}) \mathrm{O}[\mathrm{C} @ @ \mathrm{H}] 3[\mathrm{C} @ \mathrm{H}](\mathrm{O}[\mathrm{C} @ \mathrm{H}]([\mathrm{C} @ @ \mathrm{H}]([\mathrm{C} @ \mathrm{H}] 3 \mathrm{O}) \mathrm{O}) \mathrm{O}) \mathrm{CO}) \mathrm{CO}) \mathrm{O}) \mathrm{O}">\mathrm{C} @ \mathrm{H}</a> \mathrm{O} \end{aligned}$</td>
</tr>
<tr>
<td style="text-align: center;">GALACTICA</td>
<td style="text-align: center;">(a) (b) (c) (d) (e) (f) (g) (h)</td>
</tr>
<tr>
<td style="text-align: center;">ChatGPT</td>
<td style="text-align: center;">O[C@H]1C@@HC@HC@@HC@@H[C@H]1O</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5 (Ours)</td>
<td style="text-align: center;">$\begin{aligned} &amp; \mathrm{C}([\mathrm{C} @ @ \mathrm{H}] 1<a href="[\mathrm{C} @ @ \mathrm{H}]([\mathrm{C} @ \mathrm{H}]([\mathrm{C} @ @ \mathrm{H}](\mathrm{O} 1) \mathrm{O}[\mathrm{C} @ @ \mathrm{H}] 2[\mathrm{C} @ \mathrm{H}](\mathrm{O}[\mathrm{C} @ @ \mathrm{H}]([\mathrm{C} @ @ \mathrm{H}] \ &amp;([\mathrm{C} @ \mathrm{H}] 2 \mathrm{O}) \mathrm{O}) \mathrm{O}[\mathrm{C} @ @ \mathrm{H}] 3[\mathrm{C} @ \mathrm{H}](\mathrm{O}[\mathrm{C} @ \mathrm{H}]([\mathrm{C} @ @ \mathrm{H}]([\mathrm{C} @ \mathrm{H}] 3 \mathrm{O}) \mathrm{O}) \mathrm{O}) \mathrm{CO}) \mathrm{CO}) \mathrm{O}) \mathrm{O}">\mathrm{C} @ \mathrm{H}</a> \mathrm{O}) \end{aligned}$</td>
</tr>
<tr>
<td style="text-align: center;">Input</td>
<td style="text-align: center;">The molecule is a secondary amino compound that is 3,4-dimethoxyphenylethylamine in which one of the hydrogens attached to the nitrogen has been replaced by a 4-cyano-4-(3,4-dimethoxyphenyl)-5-methylhexyl group. It is an aromatic ether, a nitrile, a polyether and a secondary amino compound.</td>
</tr>
<tr>
<td style="text-align: center;">Target</td>
<td style="text-align: center;">$\mathrm{CC}(\mathrm{C}) \mathrm{C}(\mathrm{CCCNCCC} 1=\mathrm{CC}(=\mathrm{C}(\mathrm{C}=\mathrm{C} 1) \mathrm{OC}) \mathrm{OC})(\mathrm{C} # \mathrm{~N}) \mathrm{C} 2=\mathrm{CC}(=\mathrm{C}(\mathrm{C}=\mathrm{C} 2) \mathrm{OC}) \mathrm{OC}$</td>
</tr>
<tr>
<td style="text-align: center;">GALACTICA</td>
<td style="text-align: center;">3,4-Dimethoxyphenylethylamine</td>
</tr>
<tr>
<td style="text-align: center;">ChatGPT</td>
<td style="text-align: center;">$\mathrm{CN}(\mathrm{CCCCC}(\mathrm{C} # \mathrm{~N}) \mathrm{c} 1 \mathrm{ccc}(\mathrm{OC}) \mathrm{cc} 1 \mathrm{OC}) \mathrm{CCc} 1 \mathrm{ccc}(\mathrm{OC}) \mathrm{cc} 1 \mathrm{OC}$</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5 (Ours)</td>
<td style="text-align: center;">$\mathrm{CC}(\mathrm{C}) \mathrm{C}(\mathrm{CCCNCC}(\mathrm{C} 1=\mathrm{CC}(=\mathrm{C}(\mathrm{C}=\mathrm{C} 1) \mathrm{OC}) \mathrm{OC}) \mathrm{OC})(\mathrm{C} # \mathrm{~N}) \mathrm{C} 2=\mathrm{CC}(=\mathrm{C}(\mathrm{C}=\mathrm{C} 2) \mathrm{OC}) \mathrm{OC}$</td>
</tr>
</tbody>
</table>
<p>Table 9: Molecular Captioning. Given a SMILES representation generate a description in natural language. We compare the generation of our model with GALACTICA (1.3B) and ChatGPT. For our model and ChatGPT we use the prompt structure proposed in Table 10. For GALACTICA, we follow the prompt structure proposed by the authors.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Input</th>
<th style="text-align: center;">$\mathrm{C}[\mathrm{C} @] 12 \mathrm{CCC}(=\mathrm{O}) \mathrm{C}=\mathrm{C} 1 \mathrm{CC}[\mathrm{C} @ @ \mathrm{H}] 3[\mathrm{C} @ @ \mathrm{H}] 2 \mathrm{C}(=\mathrm{O}) \mathrm{C}[\mathrm{C} @] \backslash \backslash 4([\mathrm{C} @ \mathrm{H}] 3 \mathrm{CC} / \mathrm{C} 4=\mathrm{C} / \mathrm{C}(=\mathrm{O}) \mathrm{OC}) \mathrm{C}$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Target</td>
<td style="text-align: center;">The molecule is a steroid ester that is methyl (17E)-pregna-4,17-dien-21-oate substituted by oxo groups at positions 3 and 11. It is a 3-oxo-Delta(4) steroid, an 11-oxo steroid, a steroid ester and a methyl ester. It derives from a hydride of a pregnane.</td>
</tr>
<tr>
<td style="text-align: center;">GALACTICA</td>
<td style="text-align: center;">$-\mathrm{C}(=\mathrm{O}) \mathrm{OC}$</td>
</tr>
<tr>
<td style="text-align: center;">ChatGPT</td>
<td style="text-align: center;">The SMILES representation corresponds to the chemical structure of a steroid molecule called cortisone. A possible caption could be: "SMILES representation of cortisone, a steroid hormone involved in various physiological processes in the body."</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5 (Ours)</td>
<td style="text-align: center;">The molecule is an androstanoid that is the methyl ester of cortisone. It has a role as a metabolite. It is a cortisol ester, an androstanoid, a methyl ester and a 3-oxo-Delta(4) steroid. It derives from a cortisone.</td>
</tr>
<tr>
<td style="text-align: center;">Input</td>
<td style="text-align: center;">$\mathrm{C}(\mathrm{C}(\mathrm{C}(=\mathrm{O}) \mathrm{O}) \mathrm{N}) \mathrm{S}$</td>
</tr>
<tr>
<td style="text-align: center;">Target</td>
<td style="text-align: center;">The molecule is a sulfur-containing amino acid that is propanoic acid with an amino group at position 2 and a sulfanyl group at position 3. It has a role as a fundamental metabolite. It is an alpha-amino acid, a polar amino acid and a sulfur-containing amino acid. It contains a sulfanylmethyl group. It is a conjugate base of a cysteinium. It is a conjugate acid of a cysteinate(1-). It is a tautomer of a cysteine zwitterion.</td>
</tr>
<tr>
<td style="text-align: center;">GALACTICA</td>
<td style="text-align: center;">C</td>
</tr>
<tr>
<td style="text-align: center;">ChatGPT</td>
<td style="text-align: center;">The SMILES representation corresponds to the chemical structure of a molecule called cysteine. A possible caption could be: "SMILES representation of cysteine, an amino acid that is a building block of proteins and plays important roles in various biological processes."</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5 (Ours)</td>
<td style="text-align: center;">The molecule is a cysteinyl radical derived from cystein. It has a role as a fundamental metabolite. It is a cysteinyl radical and a non-proteinogenic alpha-amino acid. It derives from a cystein. It is a conjugate base of a cysteinyl radical cation. It is a conjugate acid of a cysteinyl radical. It is a tautomer of a cysteinyl radical zwitterion.</td>
</tr>
<tr>
<td style="text-align: center;">Input</td>
<td style="text-align: center;">$\mathrm{CC}(=\mathrm{O}) \mathrm{NC}(\mathrm{CC} 1=\mathrm{CC}=\mathrm{C}(\mathrm{C}=\mathrm{C} 1) \mathrm{O}) \mathrm{C}(=\mathrm{O}) \mathrm{O}$</td>
</tr>
<tr>
<td style="text-align: center;">Target</td>
<td style="text-align: center;">The molecule is an N -acetyl-amino acid that is tyrosine with an amine hydrogen substituted by an acetyl group. It has a role as a human urinary metabolite. It is a tyrosine derivative, a N -acetyl-amino acid and a member of phenols. It derives from a tyrosine.</td>
</tr>
<tr>
<td style="text-align: center;">GALACTICA</td>
<td style="text-align: center;">$\mathrm{CC}(=\mathrm{O}) \mathrm{NC}(\mathrm{CC} 1=\mathrm{CC}=\mathrm{C}(\mathrm{C}=\mathrm{C} 1) \mathrm{O}) \mathrm{C}(=\mathrm{O}) \mathrm{O}$</td>
</tr>
<tr>
<td style="text-align: center;">ChatGPT</td>
<td style="text-align: center;">The SMILES representation corresponds to the chemical structure of a molecule called acetaminophen, which is a common pain reliever and fever reducer. A possible caption could be: "SMILES representation of acetaminophen, a widely used analgesic and antipyretic medication."</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5 (Ours)</td>
<td style="text-align: center;">The molecule is the N -acetyl derivative of N -acetyltyrosine. It derives from a N -acetyltyrosine. It is a conjugate acid of a N -acetyltyrosinate.</td>
</tr>
</tbody>
</table>
<p><img alt="img-6.jpeg" src="img-6.jpeg" /></p>
<p>Figure 7: Discovery workflow. Qualitative comparison of Text+Chem T5 to Galactica 1.3B (Taylor et al., 2022) and ChatGPT for a hypothetical discovery workflow of Monuron, a commonly used herbicide. The discovery workflow starts from a textual description of Monuron and goes all the way to a stepwise execution protocol for wet-lab synthesis.
I) Text to SMILES task: Only Text+Chem T5 produces exactly the desired molecule. Galactica fails to provide a valid SMILES string (when forced to do so), but gives a textual description of a very similar molecule. ChatGPT also produces a similar molecule but adds to many methyl groups to the urea nitrogen. ChatGPT also generated a verbose description of each block of the SMILES string.
II) Retrosynthesis: Asking the model to find a synthetic route for Monuron. While Galactica fails to give a sensible output, ChatGPT hesitantly suggested a possible route: "One possible reaction that could lead to the formation of this product is the reaction between an amine (e.g. N,N-dimethylamine) and a substituted benzoyl chloride (e.g. 4-chlorobenzoyl chloride) in the presence of a base (e.g. triethylamine), which would result in the formation of an amide with the same substituents as the product". This reaction is chemically valid, but unlikely to succeed, as the forward reaction prediction models from IBM RXN for Chemistry (Schwaller et al., 2019) only assign a confidence of 0.6 . On the contrary, the reaction generated by Text+Chem T5 is identical to the target reaction and is predicted to succeed by RXN with a confidence of 1.0 .
III) Paragraph to actions: Last, one might be interested to execute the proposed reaction in a chemistry lab. Since the identified reaction is not heavily documented in the literature, we utilized a reaction atlas (Schwaller et al., 2021) to identify an extremely similar reaction (https://patents.google.com/patent/US8697887; shown in Figure 8). This reaction has a literature-reported experimental procedure that has been validated and patented. We adapted this procedure to arrive at the prompt for the third task. All models split up the procedure in individual steps and Text+Chem T5 as well as ChatGPT conceptually succeeded at this task. Instead, Galactica heavily invented information, even mixing the ingredients (e.g., 3-(4-Chlorophenyl)-1,1-dimethylurea mentioned in step one as an ingredient is the IUPAC name for Monuron, our desired product of the reaction).
Generally, we use the prompt structure proposed in Table 10 for all models, while for GALACTICA, add "ANSWER: " to the original prompt, as proposed by the authors. Note that the shown images were not generated by the model, but rendered from the SMILES string or the textual description (Galactica).</p>
<p>Similar reactions list
<img alt="img-7.jpeg" src="img-7.jpeg" /></p>
<p>Figure 8: Reaction most similar to the generated synthesis route for Monuron.. Reaction identified using IBM RXN for Chemistry (http://rxn.res.ibm.com/rxn/) using the reaction atlas described in Schwaller et al. (2021). The reaction is identical to the identified synthesis route for Monuron apart from the 3-Amino-5-bromo pyridine which is substituted with 4-Chloroanyline to yield Monuron.</p>
<h1>C Prompt templates</h1>
<p>Table 10: Prompt templates that have been used for the 5 tasks of interest for our multi-task and multi-domain training.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Task</th>
<th style="text-align: center;">Template</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Forward prediction</td>
<td style="text-align: center;">Predict the product of the following reaction: <input></td>
</tr>
<tr>
<td style="text-align: center;">Retrosynthesis</td>
<td style="text-align: center;">Predict the reaction that produces the following product: <input></td>
</tr>
<tr>
<td style="text-align: center;">Paragraph-to-actions</td>
<td style="text-align: center;">Which actions are described in the following paragraph: <input></td>
</tr>
<tr>
<td style="text-align: center;">Description-to-smiles</td>
<td style="text-align: center;">Write in SMILES the described molecule: <input></td>
</tr>
<tr>
<td style="text-align: center;">Smiles-to-caption</td>
<td style="text-align: center;">Caption the following SMILES: <input></td>
</tr>
</tbody>
</table>
<h2>D Experimental Details</h2>
<p>Table 11: Models Size.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Model</th>
<th style="text-align: center;">Suffix</th>
<th style="text-align: center;">Parameters (M)</th>
<th style="text-align: center;">Multi-task</th>
<th style="text-align: center;">Multi-domain</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">RXN</td>
<td style="text-align: center;">forward</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">$\gamma$</td>
<td style="text-align: center;">$\gamma$</td>
</tr>
<tr>
<td style="text-align: center;">RXN</td>
<td style="text-align: center;">retrosynthesis</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">$\gamma$</td>
<td style="text-align: center;">$\gamma$</td>
</tr>
<tr>
<td style="text-align: center;">RXN</td>
<td style="text-align: center;">paragraph2action</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">$\gamma$</td>
<td style="text-align: center;">$\gamma$</td>
</tr>
<tr>
<td style="text-align: center;">T5</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\gamma$</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
</tr>
<tr>
<td style="text-align: center;">Transformer</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\gamma$</td>
</tr>
<tr>
<td style="text-align: center;">MolT5</td>
<td style="text-align: center;">small</td>
<td style="text-align: center;">77</td>
<td style="text-align: center;">$\gamma$</td>
<td style="text-align: center;">$\checkmark$</td>
</tr>
<tr>
<td style="text-align: center;">T5</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">220</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\gamma$</td>
</tr>
<tr>
<td style="text-align: center;">Text+Chem T5</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">220</td>
<td style="text-align: center;">$\checkmark$</td>
<td style="text-align: center;">$\checkmark$</td>
</tr>
<tr>
<td style="text-align: center;">MolT5</td>
<td style="text-align: center;">base</td>
<td style="text-align: center;">250</td>
<td style="text-align: center;">$\gamma$</td>
<td style="text-align: center;">$\checkmark$</td>
</tr>
</tbody>
</table>
<p>Table 12: Relevant Hyperparameters for Text+Chem T5.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">Text+Chem T5-small</th>
<th style="text-align: center;">Text+Chem T5-base</th>
<th style="text-align: center;">Text+Chem T5-small augm</th>
<th style="text-align: center;">Text+Chem T5-base augm</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Dataset</td>
<td style="text-align: center;">standard</td>
<td style="text-align: center;">standard</td>
<td style="text-align: center;">augmented</td>
<td style="text-align: center;">augmented</td>
</tr>
<tr>
<td style="text-align: left;">Pretrained base</td>
<td style="text-align: center;">t5-small</td>
<td style="text-align: center;">t5-base</td>
<td style="text-align: center;">t5-small</td>
<td style="text-align: center;">t5-base</td>
</tr>
<tr>
<td style="text-align: left;">Heads</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">12</td>
</tr>
<tr>
<td style="text-align: left;">Layers</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">12</td>
</tr>
<tr>
<td style="text-align: left;">Parameters</td>
<td style="text-align: center;">60 M</td>
<td style="text-align: center;">220 M</td>
<td style="text-align: center;">60 M</td>
<td style="text-align: center;">220 M</td>
</tr>
<tr>
<td style="text-align: left;">Input max length</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">512</td>
</tr>
<tr>
<td style="text-align: left;">Epochs</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr>
<td style="text-align: left;">Batch size</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">64</td>
</tr>
<tr>
<td style="text-align: left;">Accumulated gradient batches</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
</tr>
<tr>
<td style="text-align: left;">Learning rate</td>
<td style="text-align: center;">$4 e^{-4}$</td>
<td style="text-align: center;">$6 e^{-4}$</td>
<td style="text-align: center;">$6 e^{-4}$</td>
<td style="text-align: center;">$6 e^{-4}$</td>
</tr>
</tbody>
</table>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{1}$ Note that the patent description was retrieved manually&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>