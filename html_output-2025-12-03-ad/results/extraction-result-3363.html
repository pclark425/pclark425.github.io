<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-3363 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-3363</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-3363</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-77.html">extraction-schema-77</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of language models solving puzzle games that require spatial knowledge (such as Sudoku), including details about the models, the puzzles, the methods used, performance, and any analysis of how the models solve these tasks.</div>
                <p><strong>Paper ID:</strong> paper-23dd78e424d32f6a48660dcd67ce994b8a7db8be</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/23dd78e424d32f6a48660dcd67ce994b8a7db8be" target="_blank">STaR: Bootstrapping Reasoning With Reasoning</a></p>
                <p><strong>Paper TL;DR:</strong> A technique to iteratively leverage a small number of rationale examples and a large dataset without rationales to bootstrap the ability to perform successively more complex reasoning, called STaR, which lets a model improve itself by learning from its own generated reasoning.</p>
                <p><strong>Paper Abstract:</strong> Generating step-by-step"chain-of-thought"rationales improves language model performance on complex reasoning tasks like mathematics or commonsense question-answering. However, inducing language model rationale generation currently requires either constructing massive rationale datasets or sacrificing accuracy by using only few-shot inference. We propose a technique to iteratively leverage a small number of rationale examples and a large dataset without rationales, to bootstrap the ability to perform successively more complex reasoning. This technique, the"Self-Taught Reasoner"(STaR), relies on a simple loop: generate rationales to answer many questions, prompted with a few rationale examples; if the generated answers are wrong, try again to generate a rationale given the correct answer; fine-tune on all the rationales that ultimately yielded correct answers; repeat. We show that STaR significantly improves performance on multiple datasets compared to a model fine-tuned to directly predict final answers, and performs comparably to fine-tuning a 30$\times$ larger state-of-the-art language model on CommensenseQA. Thus, STaR lets a model improve itself by learning from its own generated reasoning.</p>
                <p><strong>Cost:</strong> 0.007</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <p class="empty-note">No extracted data.</p>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>Thinking fast and slow with deep learning and tree search <em>(Rating: 2)</em></li>
                <li>Iterated learning for emergent systematicity in vqa <em>(Rating: 2)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-3363",
    "paper_id": "paper-23dd78e424d32f6a48660dcd67ce994b8a7db8be",
    "extraction_schema_id": "extraction-schema-77",
    "extracted_data": [],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "Thinking fast and slow with deep learning and tree search",
            "rating": 2
        },
        {
            "paper_title": "Iterated learning for emergent systematicity in vqa",
            "rating": 2
        }
    ],
    "cost": 0.006911249999999999,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>STaR: Self-Taught Reasoner Bootstrapping Reasoning With Reasoning</h1>
<p>Eric Zelikman<em>1, Yuhuai $\mathbf{W u}^{</em> 12}$, Jesse $\mathbf{M u}^{1}$, Noah D. Goodman ${ }^{1}$<br>${ }^{1}$ Department of Computer Science, Stanford University<br>${ }^{2}$ Google Research<br>{ezelikman, yuhuai, muj, ngoodman}@stanford.edu</p>
<h4>Abstract</h4>
<p>Generating step-by-step "chain-of-thought" rationales improves language model performance on complex reasoning tasks like mathematics or commonsense question-answering. However, inducing language model rationale generation currently requires either constructing massive rationale datasets or sacrificing accuracy by using only few-shot inference. We propose a technique to iteratively leverage a small number of rationale examples and a large dataset without rationales, to bootstrap the ability to perform successively more complex reasoning. This technique, the "Self-Taught Reasoner" (STaR), relies on a simple loop: generate rationales to answer many questions, prompted with a few rationale examples; if the generated answers are wrong, try again to generate a rationale given the correct answer; finetune on all the rationales that ultimately yielded correct answers; repeat. We show that STaR significantly improves performance on multiple datasets compared to a model fine-tuned to directly predict final answers, and performs comparably to finetuning a $30 \times$ larger state-of-the-art language model on CommensenseQA. Thus, STaR lets a model improve itself by learning from its own generated reasoning.</p>
<h2>1 Introduction</h2>
<p>Human decision-making is often the result of extended chains of thought [1, 2]. Recent work has shown that explicit intermediate reasoning ("rationales") can improve large language model (LLM) performance as well [3-8]. For example, [5] demonstrated that LLMs explicitly trained to use "scratchpads" for intermediate steps can attain perfect in-distribution performance on arithmetic, and strong out-of-distribution generalization, while models trained to predict answers directly fail to do either. These works suggest that generating explicit rationales before giving a final answer ("rationale generation") is valuable for LLMs across diverse tasks including mathematical reasoning, commonsense reasoning, code evaluation, social bias inference, and natural language inference. However, the two primary methods for inducing rationale generation both have serious drawbacks.</p>
<p>One approach to rationale generation is the construction of a fine-tuning dataset of rationales, either manually by human annotators or automatically with hand-crafted templates [3-5, 9]. Manual methods are expensive, and it is infeasible to construct such a dataset for each interesting problem [3]. Meanwhile, template-based methods rely on automatically-generated rationales but only work when a general solution is already known [5] or reasonable hard-coded heuristics can be made [4].
An alternative is to leverage in-context learning by including only a few rationale examples in the language model prompt. This has been shown to improve accuracy on mathematical and symbolic reasoning tasks relative to prompting without rationales ("direct" prompting) [5, 6]. Yet, while fewshot techniques with rationales tend to outperform their non-reasoning counterparts, they generally substantially underperform models fine-tuned to directly predict answers using larger datasets [5, 6].</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p><img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1: An overview of STaR and a STaR-generated rationale on CommonsenseQA. We indicate the fine-tuning outer loop with a dashed line. The questions and ground truth answers are expected to be present in the dataset, while the rationales are generated using STaR.</p>
<p>In this paper, we adopt a different approach: by leveraging the LLM’s pre-existing reasoning ability, we iteratively <em>bootstrap</em> the ability to generate high-quality rationales. Specifically, we few-shot prompt a large language model to self-generate rationales and refine the model’s ability further by fine-tuning on those rationales that lead to correct answers. We repeat this procedure, using the improved model to generate the next training set each time. This is a synergistic process, where improvements in rationale generation improve the training data, and improvements in training data further improve rationale generation.</p>
<p>However, we find this loop eventually fails to solve any new problems in the training set because it receives no direct training signal for problems it fails to solve. To overcome this issue, we propose <strong>rationalization</strong>: for each problem that the model fails to answer correctly, we generate a new rationale by providing the model with the correct answer. This lets the model reason backward—given the correct answer, the model can more easily generate a useful rationale. These rationales are then collected as part of the training data, which often improves overall accuracy.</p>
<p>We thus develop the Self-Taught Reasoner (STaR, Fig. 1) method, a scalable bootstrapping method allowing models to learn to generate their own rationales, while also learning to solve increasingly difficult problems. In our method, we repeat the following process: in each iteration, first construct a finetuning dataset by attempting to solve the dataset using the current model’s <strong>rationale generation</strong> ability; then, augment this dataset using <strong>rationalization</strong>, justifying ground-truth answers to problems the model failed to solve; finally, finetune the large language model on the combined dataset.</p>
<p>Applying STaR on arithmetic, math word problems, and commonsense reasoning, we observe it is able to effectively translate a small number of few-shot prompts into a large rationale dataset, yielding dramatic performance improvements. On CommonsenseQA [10], we find STaR improves over both a few-shot baseline (+35.9%) and a baseline fine-tuned to directly predict answers (+12.5%) , and performs comparably to a fine-tuned model that is 30× larger (72.5% vs. 73.0%).</p>
<p>Thus, we make the following contributions:</p>
<ol>
<li>We propose a bootstrapping mechanism to iteratively generate a rationale dataset from a few initial examples with rationales—without needing to check new rationales’ correctness.</li>
<li>We complement <strong>rationale generation</strong> with <strong>rationalization</strong>, where a model is tasked with justifying an answer and then fine-tuned as if it had come up with the rationale without any hint. We show rationalization accelerates and improves the bootstrapping process.</li>
<li>We evaluate these techniques with a variety of ablations in both mathematical and commonsense reasoning domains.</li>
<li>We propose what is, to our knowledge, the first technique to allow a pre-trained large language model to iteratively use its language modeling capacity to improve itself.</li>
</ol>
<h1>2 Background and Related Work</h1>
<p>In-context Learning Recently, a collection of works has emerged exploring the capacity for large language models to perform in-context learning [11, 12]. In essence, in-context learning treats few-shot learning as a language modeling problem, by showing a few examples in the context (i.e. prompt), and allowing the model to learn and identify the pattern to apply to new examples. Some have studied in-context learning based on the language modeling objective in terms of Bayesian inference [13] while others have attempted to describe the process more mechanistically in terms of "induction heads" [14]. Moreover, differences in prompt configurations have been known to have dramatic effects on few-shot performance. Some have even found that replacing few-shot prompts with a "soft prompt" which can be optimized in embedding space results in noticeable gains [15]. Instead of emphasizing the representation of the question, we focus on the model output; in particular, we focus on the model's ability to reason through a problem before coming to a conclusion.</p>
<p>Rationales One of the initial works on the impact of rationales on language model performance was [3], showing that training a language model on a dataset with explicit rationales preceding the answer could improve a model's ability to generate the final answer. However, this required many thousands of training examples to be manually annotated with human reasoning. Recently, [5] demonstrated that step-by-step "scratchpads" can improve fine-tuned LLM performance and generalization on tasks such as arithmetic, polynomial evaluation, and program evaluation. Similarly, [6] used a single few-shot "chain-of-thought" reasoning prompt in order to improve model performance on a collection of tasks, without fine-tuning. Finally, [16] showed that a curriculum learning approach could help solve formal math problems, as long as 1) they were translated into Lean (a theorem-proving language [17]), 2) one could directly evaluate the validity of the proofs, 3) one could sample numerous potential solutions for each problem, 4) had trained a separate value function model, and 5) started with GPT-f (a model already fine-tuned on a large math dataset [18]). We note that there are many domains where these conditions do not all apply. In addition, works have aimed to explain why rationales have this beneficial effect: some have analyzed their impact from the perspective of latent variable models [19] while others have provided formal proofs of the benefit of intermediate task supervision [20].</p>
<p>Iterated Learning A variety of iterated learning algorithms have been proposed, where solutions or successful methods which are found are in turn used to find additional solutions [21, 22, 16]. [21] introduced Expert Iteration (ExIt), a reinforcement learning technique serving as an inspiration for our approach. Essentially, it consists of a loop of self-play by an "apprentice," followed by imitation learning with feedback from a slower "expert" and then the replacement of the expert with the nowimproved apprentice. [16] builds off of ExIt for formal reasoning, while [22] applies iterated learning to visual question answering using modular networks which can be combined compositionally. There are further similarities between STaR and expert iteration methods [21]. For example, filtering generated examples based on whether their ultimate answer matches the target can be seen as expert feedback. However, we have a fixed "expert" and do not train a separate value function.</p>
<p>Natural Language Explanations Natural language explanations have also been discussed from the perspective of explainable machine learning, focusing on justification rather than reasoning [23, 24]. The motivation for this line of work is largely grounded in explainable decision making, and similarly to [3], generally does not find that requiring post-hoc explanations improves model performance.</p>
<h2>3 Method</h2>
<h3>3.1 Rationale Generation Bootstrapping (STaR Without Rationalization)</h3>
<p>We are given a pretrained LLM $M$ and an initial dataset of problems $x$ with answers $y: \mathcal{D}=$ $\left{\left(x_{i}, y_{i}\right)\right}<em i="i">{i=1}^{D}$. Our technique starts with a small prompt set $\mathcal{P}$ of examples with intermediate rationales $r: \mathcal{P}=\left{\left(x</em>\right)\right}}^{p}, r_{i}^{p}, y_{i}^{p<em i="i">{i=1}^{P}$, where $P \ll D$ (e.g. $P=10$ ). Like standard few-shot prompting, we concatenate this prompt set to each example in $\mathcal{D}$, i.e. $x</em>}=\left{x_{1}^{p}, r_{1}^{p}, y_{1}^{p}, \ldots, x_{P}^{p}, r_{P}^{p}, y_{P}^{p}, x_{i}\right}$, which encourages the model to produce a rationale $\hat{r<em i="i">{i}$ for $x</em>}$ followed by an answer $\hat{y<em i="i">{i}$. We assume that rationales that lead to correct answers are of better quality than those that lead to incorrect answers. Therefore, we filter the generated rationales to include only the ones which result in the correct answer $\left(\hat{y}</em>\right)$. We fine-tune the base model $M$ on this filtered dataset, and then restart this process by generating the new rationales with the newly fine-tuned model. We keep repeating this process until the performance plateaus. Note that during this process, once we collect a new dataset, we train from the original pre-trained model $M$ instead of continually training one model to avoid overfitting. We provide an outline of this algorithm in Algorithm 1.}=y_{i</p>
<p>STaR can be seen as an approximation to an RL-style policy gradient objective. To see this, note that $M$ can be viewed as a discrete latent variable model $p_{M}(y \mid x)=\sum_{r} p(r \mid x) p(y \mid x, r)$; in other words, $M$ first samples a latent rationale $r$ before predicting $y$. Now, given the indicator reward function $\mathbb{1}(\hat{y}=y)$, the total expected reward across the dataset is</p>
<p>$$
\begin{aligned}
J(M, X, Y) &amp; =\sum_{i} \mathbb{E}<em i="i">{\hat{r}</em>}, \hat{y<em M="M">{i} \sim p</em>}\left(\cdot \mid x_{i}\right)} \mathbb{1}\left(\hat{y<em i="i">{i}=y</em>\right) \
\nabla J(M, X, Y) &amp; =\sum_{i} \mathbb{E}<em i="i">{\hat{r}</em>}, \hat{y<em M="M">{i} \sim p</em>}\left(\cdot \mid x_{i}\right)}\left[\mathbb{1}\left(\hat{y<em i="i">{i}=y</em>}\right) \cdot \nabla \log p_{M}\left(\hat{y<em i="i">{i}, \hat{r}</em>\right)\right]
\end{aligned}
$$} \mid x_{i</p>
<p>where the gradient is obtained via the standard log-derivative trick for policy gradients. Note that the indicator function discards the gradient for all sampled rationales that do not lead to the correct answer $y_{i}$ : this is the filtering process in STaR (Line 5). Thus, STaR approximates $J$ by (1) greedily decoding samples of $\left(\hat{r}<em i="i">{i}, \hat{y}</em>\right)$ to reduce variance of this estimate (at the cost of potentially biased exploration of rationales), and (2) taking multiple gradient steps on the same batch of data (similar to some policy gradient algorithms [25]). These approximations make STaR a simple and broadly applicable method that can be implemented with standard LLM training machinery; future work should more closely investigate the link between STaR and the RL objective above.</p>
<h3>3.2 Rationalization</h3>
<p>The rationale generation bootstrapping algorithm carries a limitation. Since the model is only trained on the examples which it answers correctly, improvement ends when the model fails to solve new problems in the training set. This is fundamentally due to the fact that the algorithm cannot obtain any training signal from failed examples. Inspired by [3], we propose a technique we call "rationalization". Specifically, we provide the answer as a hint to the model and ask it to generate rationales in the same style as in the previous rationale generation step. Given the answer, the model is able to reason backwards, and hence more easily generate a rationale that leads to the correct answer. For example, in Figure 2, we provide the hint that "(b) grocery cart" is the correct answer in the prompt to generate the rationale. We apply rationalization to the problems which the model failed to solve with rationale generation. When adding a rationalization-generated rationale to our dataset, we do not include the hint in its corresponding prompt, as if the model had come up with the rationale without the hint. After filtering, we fine-tune on the previously generated dataset combined with the rationalization-generated dataset.</p>
<div class="codehilite"><pre><span></span><code><span class="n">Q</span><span class="o">:</span><span class="w"> </span><span class="n">Where</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">grapes</span><span class="w"> </span><span class="n">just</span>
<span class="n">before</span><span class="w"> </span><span class="n">checking</span><span class="w"> </span><span class="n">out</span><span class="o">?</span>
<span class="n">Answer</span><span class="w"> </span><span class="n">Choices</span><span class="o">:</span>
<span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="w"> </span><span class="n">mouth</span>
<span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="w"> </span><span class="n">grocery</span><span class="w"> </span><span class="n">cart</span><span class="w"> </span><span class="o">(</span><span class="n">CORRECT</span><span class="o">)</span>
<span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="w"> </span><span class="kd">super</span><span class="w"> </span><span class="n">market</span>
<span class="o">(</span><span class="n">d</span><span class="o">)</span><span class="w"> </span><span class="n">fruit</span><span class="w"> </span><span class="n">basket</span>
<span class="o">(</span><span class="n">e</span><span class="o">)</span><span class="w"> </span><span class="n">fruit</span><span class="w"> </span><span class="n">market</span>
<span class="n">A</span><span class="o">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">place</span>
<span class="n">where</span><span class="w"> </span><span class="n">grocery</span><span class="w"> </span><span class="n">items</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">placed</span><span class="w"> </span><span class="n">before</span>
<span class="w">    </span><span class="n">checking</span><span class="w"> </span><span class="n">out</span><span class="o">.</span><span class="w"> </span><span class="n">Of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">choices</span><span class="o">,</span>
<span class="n">grocery</span><span class="w"> </span><span class="n">cart</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">sense</span><span class="w"> </span><span class="k">for</span>
<span class="w">    </span><span class="n">holding</span><span class="w"> </span><span class="n">grocery</span><span class="w"> </span><span class="n">items</span><span class="o">.</span><span class="w"> </span><span class="n">Therefore</span><span class="o">,</span>
<span class="n">the</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">grocery</span><span class="w"> </span><span class="n">cart</span><span class="w"> </span><span class="o">(</span><span class="n">b</span><span class="o">).</span>
</code></pre></div>

<p>Figure 2: A few-shot prompt hint we use for rationalization (and not for rationale generation), using the rationale from [6], with its hint included in green, followed by the rationale and the answer generated by the model.</p>
<h1>Algorithm 1 STaR</h1>
<p>Input $M$ : a pretrained LLM; dataset $\mathcal{D}=\left{\left(x_{i}, y_{i}\right)\right}<em 0="0">{i=1}^{D}$ (w/ few-shot prompts)
$1: M</em> \leftarrow M #$ Copy the original model
2: for $n$ in $1 \ldots N$ do # Outer loop
$3: \quad\left(\hat{r}<em i="i">{i}, \hat{y}</em>\right) \quad \forall i \in[1, D]$ # Perform rationale generation
$4: \quad\left(\hat{r}}\right) \leftarrow M_{n-1}\left(x_{i<em i="i">{i}^{\text {rat }}, \hat{y}</em>\right)\right) \quad \forall i \in[1, D]$ # Perform rationalization
$5: \quad \mathcal{D}}^{\text {rat }}\right) \leftarrow M_{n-1}\left(\right.$ add_hint $\left.\left(x_{i}, y_{i<em i="i">{n} \leftarrow\left{\left(x</em>}, \hat{r<em i="i">{i}, y</em>}\right) \mid i \in[1, D] \wedge \hat{y<em i="i">{i}=y</em>\right}$ # Filter rationales using ground truth answers
$6: \quad \mathcal{D}<em i="i">{n}^{\text {rat }} \leftarrow\left{\left(x</em>}, \hat{r<em i="i">{i}^{\text {rat }}, y</em>}\right) \mid i \in[1, D] \wedge \hat{y<em i="i">{i} \neq y</em>} \wedge \hat{y<em i="i">{i}^{\text {rat }}=y</em>\right}$ # Filter rationalized rationales
$7: \quad M_{n} \leftarrow \operatorname{train}\left(M, \mathcal{D}<em n="n">{n} \cup \mathcal{D}</em>\right)$ # Finetune the original model on correct solutions - inner loop
8: end for
Algorithm 1 describes the full algorithm, with the parts in blue corresponding to rationalization. Without those parts, Algorithm 1 corresponds to STaR without rationalization. Figure 1 provides an overview diagram. Fine-tuning on the dataset generated by rationalization has a crucial benefit of exposing the model to difficult problems which otherwise would not have appeared in its finetuning dataset. This can be understood as challenging the model to "think outside the box" about problems on which it was unsuccessful. A secondary benefit of rationalization is an increase in dataset size.}^{\text {rat }</p>
<h1>4 Experiments</h1>
<p>For our experiments, we focus on arithmetic, commonsense reasoning, and grade school math to demonstrate STaR's breadth. In particular, for arithmetic, we follow a setup inspired by [5]. For commonsense question-answering we follow [13, 6] and use CommonsenseQA (CQA), a widely used multiple-choice dataset for this domain [10]. For grade school math, we use GSM8K from [9].</p>
<h3>4.1 Experimental Protocol</h3>
<p>We used GPT-J as our base language model, and the fine-tuning script from the GPT-J repository [26]. We chose GPT-J, a 6B-parameter model, because the checkpoint and fine-tuning code are publicly available [26], and the model is large enough to generate rationales of non-trivial quality to be bootstrapped from. More hyperparameter details about GPT-J and our fine-tuning are included in Appendix H. Following the default setting of [26], we perform a 100-step learning rate warmup, from which point we use a constant learning rate. Unless stated otherwise, we start with 40 training steps at the first outer loop, and increase the number of fine-tuning training steps by $20 \%$ with each outer loop. In general, we found that training more slowly at the beginning ultimately benefits model performance. We expect that further improvement is possible via a thorough hyperparameter search-we leave this to future work due to computational constraints.
For arithmetic problems, we first generate a dataset of 50,000 randomly sampled questions (uniformly over the digit lengths) in the format introduced by [5]. For each outer loop iteration on arithmetic, we sample 10,000 problems from the dataset. We use 10 random few-shot rationale examples for each digit for its corresponding few-shot prompt. For each of the 9,741 questions in the training set of CommonsenseQA, we add the question to the few-shot rationale prompt, and prompt the model to generate the rationale and answer for that question. For few shot prompting on CQA, we start with the same 10 questions as used in [6], with the rationales modified slightly to fix an incorrect answer and to more explicitly reference relevant knowledge. We include these modified prompts in Appendix B ${ }^{1}$. These prompts serve as our complete set of explanations. We run STaR until we see performance saturate, and we report the best results.
When performing rationalization, we find that the choice to include or omit few-shot prompts on outer-loop iterations after the first iteration does not have a substantial impact on the method's ultimate performance. However, there are some nuances which we discuss further in Section 5, leading us to use few-shot prompts unless stated otherwise.</p>
<h3>4.2 Datasets</h3>
<p>Arithmetic The arithmetic task is to calculate the sum of two $n$digit integers. We generate the dataset based on the descriptions in [5] and visualize an example scratchpad in Figure 3. Everything up to and including "Target:" is given as part of a prompt, and the model is asked to generate the scratchpad (start/end indicated by "<scratch>") and the final answer, as in [5]. Each line of the scratchpad corresponds to the summation of each pair of digits from the final digit to the first digit, the accumulating final digits of the answer, and a carry digit corresponding to whether the previous pair summed to at least 10 . We include few-shot prompts for 1 to 5 digits. When performing rationalization, we include the correct answer after "Target" and query the model to produce the scratchpad and then reproduce the correct answer following the scratchpad.</p>
<div class="codehilite"><pre><span></span><code>Input:
6<span class="w"> </span>2<span class="w"> </span>4<span class="w"> </span>+<span class="w"> </span>2<span class="w"> </span>5<span class="w"> </span>9
Target:
<span class="nt">&lt;scratch&gt;</span>
6<span class="w"> </span>2<span class="w"> </span>4<span class="w"> </span>+<span class="w"> </span>2<span class="w"> </span>5<span class="w"> </span>9,<span class="w"> </span>C:<span class="w"> </span>0
2<span class="w"> </span>+<span class="w"> </span>5,3C:1
6<span class="w"> </span>+<span class="w"> </span>2,83C:0
,883C:0
0883
<span class="nt">&lt;/scratch&gt;</span>
8<span class="w"> </span>8<span class="w"> </span>3
</code></pre></div>

<p>Figure 3: A visualization of a 3-digit arithmetic problem with a scratchpad. C corresponds to the carry from the previous digit's summation.</p>
<p>CommonsenseQA The multiple-choice commonsense reasoning task, CommonsenseQA [10] (CQA), is constructed from ConceptNet, a semantic graph of concepts and their relationships with over a million nodes [28]. [10] identified a set of "target" concepts in ConceptNet for each question, where the target concepts share a semantic relationship to one "source" concept. Then each question is crowdsourced to allow a reader to identify one target concept, while mentioning the source concept. In addition, two distractor answers are added. The dataset has 12,247 questions, each with five choices, with 9,741 in the train set, 1,221 in the dev set, and 1,285 in the (withheld) test set.</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 4: A visualization of the accuracy of <em>n</em>-digit summation with each iteration of STaR with and without rationalization for arithmetic. Each series corresponds to the accuracy of summing two <em>n</em>-digit numbers.</p>
<p>Corresponding to the broad variety of ConceptNet, CQA contains a diverse set of questions which require commonsense reasoning ability building off of standard world knowledge, where human performance is 89% [10]. Many have pointed out that CQA contains a number of biases, along several dimensions including gender [3]. We discuss how this may impact our method in Appendix G. There are also many typos and questions which are fundamentally ambiguous<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>. We use it despite these issues as it is a general question-answering dataset relying on both common world knowledge and simple reasoning, which serves as a good test-bed for our method.</p>
<h3>Grade School Math (GSM8K)</h3>
<p>We also evaluate on the Grade School Math (GSM8K) dataset, which contains 7,473 train and 1,319 test examples of grade-school-level word problems [9]. These math problems are posed in natural language and require two to eight calculation steps to arrive at a final answer. This dataset combines the skills needed for arithmetic and commonsense reasoning.</p>
<h3>4.3 Symbolic Reasoning: Results on Arithmetic</h3>
<p>The accuracies of the model across digits 1-5 over each iteration of the outer loop are plotted in Figure 4. After running STaR for 16 iterations, the overall accuracy is 89.5%. For reference, a baseline trained on 10,000 examples without rationales for 5,000 steps attains 76.3% accuracy. Notably, few-shot accuracy on arithmetic problems is very low, even with rationales: accuracy on 2-digit addition is less than 1%, and accuracy on more digits close to zero.</p>
<p>With rationalization, the accuracy is able to improve especially quickly. After one fine-tuning iteration on the model's generated scratchpads, 2-digit addition improves to 32% from less than 1%. Without rationalization, the performance improvement is stagewise: the model generally has poor performance on the <em>n</em>-digit sum until it has good performance on the (<em>n</em> − 1)-digit sum. With rationalization, the model can learn many lengths at once, though not with equal accuracy. Rationalization allows many problems to be solved few-shot, so we start STaR training with 300 steps (note, doing so without rationalization causes overfitting on 1-digit addition), and increase training by 20 steps per iteration.</p>
<p><img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 5: We introduce additional digits to STaR with rationalization at the 20th iteration.</p>
<p>We also perform an experiment where we continue pre-training STaR with rationalization with additional digits, starting before the 20th iteration, while keeping the total number of training examples fixed at each iteration. We find that not only does this appear to quickly improve performance on the initial set of digits, but when evaluated on 9 and 10 digit examples, never seen during training, the model successfully solves many of these out-of-distribution problems. As visualized in Figure 5, the introduction of these digits appears to make the training less stable, but the exact cause is unclear.</p>
<p>Table 1: We evaluate several baselines, including a few-shot GPT-J evaluation both with and without scratchpads, a GPT-J baseline finetuned to directly predict the answer, and STaR with and without rationalization applied to GPT-J. We use CoT to denote non-STaR models outputting rationales, and Direct to indicate those directly predicting the final answer. Note the final STaR model is trained on $78.2 \%$ of the training dataset with rationale generation, and an additional $8.5 \%$ from rationalization.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">CQA Dev Set Accuracy (\%)</th>
<th style="text-align: center;">Train Data Used (\%)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">GPT-3 Direct Finetuned [29]</td>
<td style="text-align: center;">73.0</td>
<td style="text-align: center;">100</td>
</tr>
<tr>
<td style="text-align: left;">Few-shot Direct GPT-J</td>
<td style="text-align: center;">20.9</td>
<td style="text-align: center;">$\sim 0$</td>
</tr>
<tr>
<td style="text-align: left;">Few-shot CoT GPT-J ${ }^{3}$</td>
<td style="text-align: center;">36.6</td>
<td style="text-align: center;">$\sim 0$</td>
</tr>
<tr>
<td style="text-align: left;">Few-shot CoT LaMDA 137B [6]</td>
<td style="text-align: center;">55.6</td>
<td style="text-align: center;">$\sim 0$</td>
</tr>
<tr>
<td style="text-align: left;">GPT-J Direct Finetuned</td>
<td style="text-align: center;">60.0</td>
<td style="text-align: center;">100</td>
</tr>
<tr>
<td style="text-align: left;">STaR without rationalization</td>
<td style="text-align: center;">68.8</td>
<td style="text-align: center;">69.7</td>
</tr>
<tr>
<td style="text-align: left;">STaR with rationalization</td>
<td style="text-align: center;">$\mathbf{7 2 . 5}$</td>
<td style="text-align: center;">86.7</td>
</tr>
</tbody>
</table>
<h1>4.4 Natural Language Reasoning: Commonsense Question Answering</h1>
<p>The CommonsesenseQA (CQA) setting introduces several new challenges. In the arithmetic task, an incorrect scratchpad in the reasoning step, and to a lesser degree in the rationalization step, was extremely likely to result in an incorrect answer. On the other hand, CQA problems are 5-way multiple choice questions. Thus, one will get the right answer at random approximately $20 \%$ of the time, regardless of the quality of reasoning. Moreover, some simple heuristics (e.g. semantic similarity) can meaningfully improve this to $\approx 30 \%$ without any reasoning, as shown by [10].
We evaluate this dataset as described in the experimental protocol and compare to several baselines. The first baseline is to finetune GPT-J to directly output the final answer, which we call "GPT-J Finetuned". We also compare to GPT-3 finetuned to directly predict the final answer from [29], and a 137B parameter Lambda model few-shot prompted with chain-of-thought (CoT) rationales from [6].
We found that, as shown in Table 1, STaR without rationalization outperformed GPT-J fine-tuned directly on the final answer for the entire dataset, despite training on less of the data. The inclusion of rationalization improved this performance to $72.5 \%$, far closer to the $73 \%$ of the $30 \times$ larger GPT-3. As expected, we also see STaR surpassed the few-shot baselines, including the much-larger 137B LaMDA model [30, 6]. We expect accuracy would be further improved if we applied STaR to a model with higher few-shot performance.</p>
<p>Case Study Note that it is harder to judge the rationale quality: for arithmetic, one can compare them to the ground truth rationales, but for CQA the evaluation is necessarily qualitative. For this reason, we include a case study in Figure 7. We observe that the rationales provided are generally coherent and of a similar structure to the few-shot rationales. We make the following two observations:</p>
<ol>
<li>After training with STaR, we see the model was able to generate reasonable rationales that solve new problems, which explains part of the observed performance gain.</li>
<li>We also see that there were many instances in which STaR improved the quality of rationales over those generated in a few-shot manner.</li>
</ol>
<p>Human Evaluation Based on the observation that STaR may improve reasoning quality for problems even when they were initially answered correctly via few-shot prompting, we performed a preliminary qualitative analysis. We randomly selected 50 rationales generated from few-shot CoT and STaR-generated rationales on questions which they both answered correctly, as well as humangenerated rationales for these problems from [3]. We then presented a random subset of 10 questions and rationales to each of 20 crowdworkers on Prolific [31] with the rationales in a randomized order, asking them to rank the rationales based on which they felt best justified the answer. The participants were $30 \%$ more likely to rank the STaR-generated rationales higher than the few-shot rationales ( $p=.039$ ). This indicates that, as mentioned in the case study, STaR can improve the quality of rationale generation.
We also found that the participants were $74 \%$ more likely to prefer the STaR-generated rationales over the human-generated rationales ( $p&lt;.001$ ). To be clear, we do not believe that this indicates human-level rationale-generation performance. Instead, we feel that it speaks to the difficulty of eliciting high-quality rationales. We reproduce the test prompts in Appendix C and elaborate on the limitations of the crowdsourced explanations dataset.</p>
<p><sup id="fnref3:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>Table 2: We find that STaR substantially improves GSM8K performance over the baselines, despite training on only 25.0% of the data for the model without rationalization, and 28.7% of the dataset (with 0.5% from rationalization) for the model with rationalization.</p>
<table>
<thead>
<tr>
<th></th>
<th>GSM8K Test Accuracy (%)</th>
<th>Train Data Used (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Few-shot Direct GPT-J</td>
<td>3.0</td>
<td>$\sim 0$</td>
</tr>
<tr>
<td>Few-shot CoT GPT-J</td>
<td>3.1</td>
<td>$\sim 0$</td>
</tr>
<tr>
<td>GPT-J Direct Finetuned</td>
<td>5.8</td>
<td>100</td>
</tr>
<tr>
<td>STaR without rationalization</td>
<td>10.1</td>
<td>25.0</td>
</tr>
<tr>
<td>STaR with rationalization</td>
<td>10.7</td>
<td>28.7</td>
</tr>
</tbody>
</table>
<p>Failure Cases Finally, we found a variety of interesting failure cases, many of which corresponded to standard logical fallacies. For example, the model often made statements related to the topic of the question but which were not actually arguments for why the answer should be true. Sometimes, the model claimed the question implied the answer as an argument, without explaining why. Other times, especially early in training, the model answered as if it has knowledge about a particular individual, instead of making a general statement - e.g. "the king’s castle is a place where he feels safe" instead of "castles are places where kings feel safe." We provide examples and analyze errors in Appendix A.</p>
<p>Few-shot Prompt Training Including few-shot prompts during fine-tuning [12] appears to have a meaningful performance benefit (60.9% to 68.8% without rationalization, 69.9% to 72.5% with rationalization). Thus, we generally suggest its use for at least some portion of the training, though we discuss some caveats in Section 5.</p>
<h3>4.5 Mathematical Reasoning in Language: Grade School Math</h3>
<p>We again find on GSM8K that STaR substantially improves performance beyond few-shot with rationales or training to directly predict the answers (without rationales), shown in Table 2 and include the few-shot prompt in Appendix I. We observe that on this task, the use of rationalization does not substantially improve performance. Note that, in training, it was necessary to cap the number of training steps at the 30th iterations (after 7912 steps), to prevent the training process from becoming prohibitively long. The results were reached after 36 iterations for STaR without rationalization and an additional 10 iterations with rationalization.</p>
<p>Most often, the number of calculation steps generated by the model matches the number of steps taken by humans (generally between 53% and 57% agreement across all iterations). We visualize this explicitly in Figure 6. We see that when the ground truth and model disagree on the number of calculation steps, the model typically uses fewer. Sometimes this is because the model skips steps, but occasionally it finds different solutions. We show an example in Appendix J, where the model disregards redundant information and solves a 7-step problem in a single step.</p>
<h2>5 Discussion and Challenges</h2>
<p>The Impact of Rationalization An essential question is exactly what role rationalization plays. Intuitively, rationalization allows a model to reverse-engineer a solution, or provides a heuristic for identifying whether each step makes the conclusion more likely. This parallels real-world problems where the final result is known, but challenging to derive a good justification. From a mathematical perspective, while rationale generation samples rationales from the distribution $p(r \mid x)$ provided by our model $M$, rationalization conditions on the answer, letting us access an alternative distribution $p(r \mid x, y)$ which may be a better search space for rationales. Then rationalization could be framed as an off-policy estimate of the objective in Equation 1, sampling from the hint-augmented model as a proposal distribution. Future work should establish more connections between rationalization and these RL objectives, and examine more generally when and why rationalization improves learning.</p>
<p>In addition, due to the low sampling temperature, the outputs without rationalization correspond to the examples where the model is most confident in its answer. This results in these examples providing a weaker gradient signal than the rationalization examples, at least in the first iteration. Since we retrain from the initial pre-trained model every time we run a fine-tuning iteration, the degree of this effect is also difficult to measure directly. Finally, we must point out that the method to add the "hint" does not follow immediately from the question and answer and in some contexts providing it may be nontrivial. An exploration of the various impacts of different hinting techniques and their generality is an avenue for future work.</p>
<p>Temperature One intuitive alternative to rationalization, if one seeks to expand the training dataset, is more and higher-temperature sampling. However, in practice, we found that this is counterproductive. In general, it substantially increases the likelihood of a correct answer despite incorrect reasoning, and training on bad or irrelevant reasoning prevents generalization. This is particularly clear in more structured tasks, like arithmetic, where the scratchpads that the model learns to produce with a higher-temperature sampling approach diverge into meaninglessness and cause the model to stagnate. Overall, we found that higher temperatures as an alternative to rationalization (e.g. 0.5 or 0.7 ) consistently led to models worse than models with reasoning alone. In addition, as text generation by large language models is sequential (i.e. one cannot produce a token without producing the preceding token), generating text is a bottleneck and this is computationally far less efficient than rationalization. For example, generating 10 sample outputs is approximately 10 times slower than generating one sample output. However, one potentially valuable way to leverage multiple samples would be to use the method proposed in [32], using the majority-vote result of multiple hightemperature scratchpads as a ground truth against which we compare a low-temperature scratchpad. This may allow one to apply STaR to a dataset of only questions, without answers.</p>
<p>Few-shot Prompting A noteworthy phenomenon is that the inclusion of few-shot prompting during sampling seems to dramatically reduce "drift" where later rationales become increasingly dissimilar from the initial few-shot set of rationales. One benefit of this is that the model may be less constrained by the quality and difficulty of the initial rationales, theoretically allowing it to generalize more. One potentially negative consequence is that the style of the rationales may less-closely match the original prompting style. Another benefit is in terms of computational resources - a shorter prompt length allows for a shorter sequence length when sampling. Technically, the point in training at which we "disable" few-shot prompts is another hyperparameter which we could tune, but we leave this to future work. In addition, by leaving prompts out after the initial outer-loop iteration, the model tends to perform gradually worse at rationalization as it trains for longer periods of time. As a result, it may be necessary to include some hints during training for long periods of time with this approach.</p>
<p>Ultimately, the choice to include few-shot prompts in later iterations of training appears to depend on the use-case: when the goal is consistent adherence to a particular prompt style, which may benefit explainability, include few-shot prompts in sampling; when the goal is a faster training loop, one may remove them. Moreover, it is possible that with other datasets or larger models there is an impact on performance, so we encourage this to be generally treated as a hyperparameter.</p>
<h1>6 Conclusion</h1>
<p>We present the Self-Taught Reasoner (STaR), which iteratively improves a model's ability to generate rationales to solve problems. We few-shot prompt a model to solve many problems in a step-by-step manner by generating rationales, and then prompt it to rationalize the correct answer for problems it gets wrong. We finetune on both the initially correct solutions and rationalized correct solutions, and repeat the process. We find that this technique significantly improves the model's generalization performance on both symbolic reasoning and natural language reasoning.</p>
<p>There are several important limitations on STaR as presented. In order for the first iteration of STaR to succeed, few-shot performance must be above chance, implying that the initial model must be big enough to have some reasoning capabilities. For instance we found that GPT-2 was not able to bootstrap from few-shot reasoning in even the arithmetic domain. A further limitation is that settings with a high level of chance performance (e.g. binary decisions) yield many poor rationales, confounding the STaR approach. An open problem is how to filter bad reasoning in these settings.</p>
<p>Nonetheless, we believe using examples without reasoning to bootstrap reasoning is a very general approach, and that STaR can serve as the basis of more sophisticated techniques across many domains.</p>
<h1>Acknowledgements</h1>
<p>We thank Imanol Schlag for his detailed feedback about this work, as well as Rose E Wang, Markus Rabe, Aitor Lewkowycz, Rishi Bommasani, Allen Nie, Alex Tamkin, and Qian Huang. We thank Cem Anil for his very helpful insight that rationale finetuning performance can be improved if the training includes the few-shot rationales. We also thank Ben Prystawski for his suggestions on survey creation. We thank Google TPU Research Cloud for TPU access.</p>
<h2>References</h2>
<p>[1] William James, Frederick Burkhardt, Fredson Bowers, and Ignas K Skrupskelis. The principles of psychology, volume 1. Macmillan London, 1890.
[2] K Anders Ericsson and Herbert A Simon. Protocol analysis: Verbal reports as data. the MIT Press, 1984.
[3] Nazneen Fatema Rajani, Bryan McCann, Caiming Xiong, and Richard Socher. Explain yourself! leveraging language models for commonsense reasoning. $A C L, 2019$.
[4] Vered Shwartz, Peter West, Ronan Le Bras, Chandra Bhagavatula, and Yejin Choi. Unsupervised commonsense question answering with self-talk. EMNLP 2020, 2020.
[5] Maxwell Nye, Anders Johan Andreassen, Guy Gur-Ari, Henryk Michalewski, Jacob Austin, David Bieber, David Dohan, Aitor Lewkowycz, Maarten Bosma, David Luan, et al. Show your work: Scratchpads for intermediate computation with language models. arXiv preprint arXiv:2112.00114, 2021.
[6] Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Ed Chi, Quoc Le, and Denny Zhou. Chain of thought prompting elicits reasoning in large language models. arXiv preprint arXiv:2201.11903, 2022.
[7] Ana Marasović, Iz Beltagy, Doug Downey, and Matthew E Peters. Few-shot self-rationalization with natural language prompts. arXiv preprint arXiv:2111.08284, 2021.
[8] Andrew K Lampinen, Ishita Dasgupta, Stephanie CY Chan, Kory Matthewson, Michael Henry Tessler, Antonia Creswell, James L McClelland, Jane X Wang, and Felix Hill. Can language models learn from explanations in context? arXiv preprint arXiv:2204.02329, 2022.
[9] Karl Cobbe, Vineet Kosaraju, Mohammad Bavarian, Jacob Hilton, Reiichiro Nakano, Christopher Hesse, and John Schulman. Training verifiers to solve math word problems. arXiv preprint arXiv:2110.14168, 2021.
[10] Alon Talmor, Jonathan Herzig, Nicholas Lourie, and Jonathan Berant. Commonsenseqa: A question answering challenge targeting commonsense knowledge. In Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers), pages 4149-4158, 2019.
[11] Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. Language models are few-shot learners. Advances in neural information processing systems, 33:1877-1901, 2020.
[12] Jason Wei, Maarten Bosma, Vincent Y Zhao, Kelvin Guu, Adams Wei Yu, Brian Lester, Nan Du, Andrew M Dai, and Quoc V Le. Finetuned language models are zero-shot learners. ICLR 2022, 2021.
[13] Sang Michael Xie, Aditi Raghunathan, Percy Liang, and Tengyu Ma. An explanation of in-context learning as implicit bayesian inference. arXiv preprint arXiv:2111.02080, 2021.
[14] Catherine Olsson, Nelson Elhage, Neel Nanda, Nicholas Joseph, Nova DasSarma, Tom Henighan, Ben Mann, Amanda Askell, Yuntao Bai, Anna Chen, and et al. In-context learning and induction heads. Transformer Circuits, Mar 2022.</p>
<p>[15] Brian Lester, Rami Al-Rfou, and Noah Constant. The power of scale for parameter-efficient prompt tuning. EMNLP 2021, 2021.
[16] Stanislas Polu, Jesse Michael Han, Kunhao Zheng, Mantas Baksys, Igor Babuschkin, and Ilya Sutskever. Formal mathematics statement curriculum learning. arXiv preprint arXiv:2202.01344, 2022.
[17] Leonardo de Moura, Soonho Kong, Jeremy Avigad, Floris van Doorn, and Jakob von Raumer. The lean theorem prover (system description). In International Conference on Automated Deduction, pages 378-388. Springer, 2015.
[18] Stanislas Polu and Ilya Sutskever. Generative language modeling for automated theorem proving. arXiv preprint arXiv:2009.03393, 2020.
[19] Wangchunshu Zhou, Jinyi Hu, Hanlin Zhang, Xiaodan Liang, Maosong Sun, Chenyan Xiong, and Jian Tang. Towards interpretable natural language understanding with explanations as latent variables. Advances in Neural Information Processing Systems, 33:6803-6814, 2020.
[20] Noam Wies, Yoav Levine, and Amnon Shashua. Sub-task decomposition enables learning in sequence to sequence tasks. arXiv preprint arXiv:2204.02892, 2022.
[21] Thomas Anthony, Zheng Tian, and David Barber. Thinking fast and slow with deep learning and tree search. Advances in Neural Information Processing Systems, 30, 2017.
[22] Ankit Vani, Max Schwarzer, Yuchen Lu, Eeshan Dhekane, and Aaron Courville. Iterated learning for emergent systematicity in vqa. ICLR 2021, 2021.
[23] Oana-Maria Camburu, Tim Rocktäschel, Thomas Lukasiewicz, and Phil Blunsom. e-snli: Natural language inference with natural language explanations. Advances in Neural Information Processing Systems, 31, 2018.
[24] Hanxiong Chen, Xu Chen, Shaoyun Shi, and Yongfeng Zhang. Generate natural language explanations for recommendation. arXiv preprint arXiv:2101.03392, 2021.
[25] John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov. Proximal policy optimization algorithms. arXiv preprint arXiv:1707.06347, 2017.
[26] Ben Wang. Mesh-Transformer-JAX: Model-Parallel Implementation of Transformer Language Model with JAX. https://github.com/kingoflolz/mesh-transformer-jax, May 2021.
[27] Sewon Min, Xinxi Lyu, Ari Holtzman, Mikel Artetxe, Mike Lewis, Hannaneh Hajishirzi, and Luke Zettlemoyer. Rethinking the role of demonstrations: What makes in-context learning work? arXiv preprint arXiv:2202.12837, 2022.
[28] Robyn Speer, Joshua Chin, and Catherine Havasi. Conceptnet 5.5: An open multilingual graph of general knowledge. singh 2002 (2016). arXiv preprint arxiv:1612.03975, 2016.
[29] Yichong Xu, Chenguang Zhu, Shuohang Wang, Siqi Sun, Hao Cheng, Xiaodong Liu, Jianfeng Gao, Pengcheng He, Michael Zeng, and Xuedong Huang. Human parity on commonsenseqa: Augmenting self-attention with external attention. arXiv:2112.03254, December 2021. human parity result on CommonsenseQA.
[30] Romal Thoppilan, Daniel De Freitas, Jamie Hall, Noam Shazeer, Apoorv Kulshreshtha, HengTze Cheng, Alicia Jin, Taylor Bos, Leslie Baker, Yu Du, et al. Lamda: Language models for dialog applications. arXiv preprint arXiv:2201.08239, 2022.
[31] Stefan Palan and Christian Schitter. Prolific. ac—a subject pool for online experiments. Journal of Behavioral and Experimental Finance, 17:22-27, 2018.
[32] Xuezhi Wang, Jason Wei, Dale Schuurmans, Quoc Le, Ed Chi, and Denny Zhou. Selfconsistency improves chain of thought reasoning in language models, 2022.
[33] Bernease Herman. The promise and peril of human evaluation for model interpretability. arXiv preprint arXiv:1711.07414, 2017.</p>
<p>[34] Alon Jacovi and Yoav Goldberg. Towards faithfully interpretable nlp systems: How should we define and evaluate faithfulness? ACL 2020, 2020.
[35] Leo Gao, Stella Biderman, Sid Black, Laurence Golding, Travis Hoppe, Charles Foster, Jason Phang, Horace He, Anish Thite, Noa Nabeshima, et al. The pile: An 800gb dataset of diverse text for language modeling. arXiv preprint arXiv:2101.00027, 2020.
[36] Diederik P Kingma and Jimmy Ba. Adam: A method for stochastic optimization. arXiv preprint arXiv:1412.6980, 2014.</p>
<h1>Appendix</h1>
<h2>A CommonsenseQA Error Patterns</h2>
<p>Throughout our experiments, we came across a variety of interesting failure cases for commonsense reasoning. Note that all the final answers are correct - however, we take issue with the reasoning used in order to arrive at those answers.</p>
<h2>A. 1 Question Implies Answer</h2>
<p>One key failure case was answers in the form of "the answer must be something that is <question property>. <answer> is <question property>. Therefore, the correct answer is <answer>." In these cases, the model fails to explain why the answer that it has chosen satisfies the question property.</p>
<div class="codehilite"><pre><span></span><code><span class="n">Q</span><span class="o">:</span><span class="w"> </span><span class="n">What</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">someone</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">learning</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">science</span><span class="o">?</span>
<span class="n">Answer</span><span class="w"> </span><span class="n">Choices</span><span class="o">:</span>
<span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="w"> </span><span class="n">headache</span>
<span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">things</span><span class="w"> </span><span class="n">differently</span>
<span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="w"> </span><span class="n">increased</span><span class="w"> </span><span class="n">knowledge</span>
<span class="o">(</span><span class="n">d</span><span class="o">)</span><span class="w"> </span><span class="n">accidents</span>
<span class="o">(</span><span class="n">e</span><span class="o">)</span><span class="w"> </span><span class="n">appreciation</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">nature</span>
<span class="n">A</span><span class="o">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">something</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">someone</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="kd">get</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">learning</span><span class="w"> </span><span class="n">about</span>
<span class="n">science</span><span class="o">.</span><span class="w"> </span><span class="n">Learning</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">science</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">increase</span><span class="w"> </span><span class="n">knowledge</span><span class="o">.</span><span class="w"> </span><span class="n">Therefore</span><span class="o">,</span><span class="w"> </span><span class="n">the</span>
<span class="n">answer</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">increased</span><span class="w"> </span><span class="n">knowledge</span><span class="w"> </span><span class="o">(</span><span class="n">c</span><span class="o">).</span>
</code></pre></div>

<p>These rationales, while perhaps useful to the model, read to us as opaque and unexplanatory.</p>
<h2>A. 2 Begging the Question</h2>
<p>A related but stronger version of the previous failure case, while less common, is particularly uninsightful. Sometimes the model will imply the answer that it has chosen in its question.</p>
<div class="codehilite"><pre><span></span><code><span class="n">Q</span><span class="o">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">christian</span><span class="w"> </span><span class="n">rock</span><span class="w"> </span><span class="n">band</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">large</span><span class="w"> </span><span class="n">stage</span><span class="o">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">singer</span><span class="s1">&#39;s foot got caught</span>
<span class="s1">on a wire and he had a small what?</span>
<span class="s1">Answer Choices:</span>
<span class="s1">(a) commit sin</span>
<span class="s1">(b) fail</span>
<span class="s1">(c) disobey</span>
<span class="s1">(d) stumble</span>
<span class="s1">(e) boo boo</span>
<span class="s1">A: The answer must be something that would cause the singer to stumble. The</span>
<span class="s1">singer&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">foot</span><span class="w"> </span><span class="n">got</span><span class="w"> </span><span class="n">caught</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">wire</span><span class="o">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">he</span><span class="w"> </span><span class="n">would</span><span class="w"> </span><span class="n">stumble</span><span class="o">.</span><span class="w"> </span><span class="n">Therefore</span><span class="o">,</span><span class="w"> </span><span class="n">the</span>
<span class="n">answer</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">stumble</span><span class="w"> </span><span class="o">(</span><span class="n">d</span><span class="o">).</span>
</code></pre></div>

<h2>A. 3 Exercise to the Reader</h2>
<p>A rare failure case is when the model finds it unnecessary to justify its answer. For example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Q</span><span class="o">:</span><span class="w"> </span><span class="n">Other</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">school</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">gain</span><span class="w"> </span><span class="n">knowledge</span><span class="o">?</span>
<span class="n">Answer</span><span class="w"> </span><span class="n">Choices</span><span class="o">:</span>
<span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="w"> </span><span class="n">book</span>
<span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="w"> </span><span class="kd">class</span>
<span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="w"> </span><span class="n">thinking</span>
<span class="o">(</span><span class="n">d</span><span class="o">)</span><span class="w"> </span><span class="n">head</span>
<span class="o">(</span><span class="n">e</span><span class="o">)</span><span class="w"> </span><span class="n">meeting</span>
<span class="n">A</span><span class="o">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">place</span><span class="w"> </span><span class="n">where</span><span class="w"> </span><span class="n">someone</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">gain</span><span class="w"> </span><span class="n">knowledge</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">than</span>
<span class="n">school</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">text</span><span class="o">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">meeting</span><span class="w"> </span><span class="o">(</span><span class="n">e</span><span class="o">).</span>
</code></pre></div>

<h1>A. 4 World State Assertions</h1>
<p>Sometimes, the model will assume that it knows something about a subject or a person whose name was used as a variable. This leads to somewhat comical examples of reasoning. Part of the reason for this is that generally, there is an expectation that good rationales will leverage understanding of more general classes of objects and appeal to the relationship between those general classes and the particular instance. For example, the argument that "a person would typically feel exhilaration from heights" is generally more compelling than the argument that "James would feel exhilaration from heights."</p>
<p>Q: A person's hand hurts after hitting the bottle. What might happen to the bottle?
Answer Choices:
(a) alcoholism
(b) breaking
(c) fly
(d) nausea
(e) ticket</p>
<p>A: The answer must be something that happens to the bottle. The bottle is broken. Therefore, the answer is breaking (b).</p>
<p>Q: James loved climbing. What emotion might he feel from heights?
Answer Choices:
(a) exhaustion
(b) exhilaration
(c) falling down
(d) nervousness
(e) vertigo</p>
<p>A: The answer must be a feeling that would cause someone to climb a mountain. James would feel exhilaration from heights. Therefore, the answer is exhilaration (b).</p>
<h2>A. 5 Red Herrings</h2>
<p>Some errors in reasoning corresponded to the model making a statement which, while technically true, is not useful in demonstrating the claim.</p>
<p>Q: A squirrel ran up to it's home, where is the small dog likely to be barking up?
Answer Choices:
(a) manhattan apartment
(b) wood
(c) neighbor's yard
(d) tree
(e) basket</p>
<p>A: The answer must be a place where a small dog would be likely to be barking. Squirrels are not small dogs. Therefore, the answer is tree (d).</p>
<p>Q: John ran very fast, his feet touched the ground in what way?
Answer Choices:
(a) behind
(b) loose
(c) feverishly
(d) slowly
(e) lightly</p>
<p>A: The answer must be a way of running that is different from the way John ran. Running is a fast, light-footed activity. Therefore, the answer is lightly (e).</p>
<h1>A. 6 Hint Short-cutting</h1>
<p>In the experiments where the model was shown some examples of "hints" during training, in order to prevent it from losing the ability to perform rationalization over time, the model appeared to pick up on the fact that the final answer would always correspond to the hinted answer. This led to answers such as</p>
<p>Q: Billy bought coffee and waited for his wife to arrive from France. Where might he have been?
Answer Choices:
(a) airport
(b) grocery store
(c) internet cafe
(d) supermarket
(e) train station</p>
<p>A: The answer must be a place where Billy could have been waiting for his wife to arrive from France. The airport is a place where people can wait for flights. Therefore, the answer is train station (e).</p>
<h1>B Modified CQA Prompts</h1>
<p>For reference, we include our modified prompts based closely on those in [6].</p>
<div class="codehilite"><pre><span></span><code><span class="n">Q</span><span class="o">:</span><span class="w"> </span><span class="n">What</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">absorb</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">ink</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">fountain</span><span class="w"> </span><span class="n">pen</span><span class="o">?</span>
<span class="n">Answer</span><span class="w"> </span><span class="n">Choices</span><span class="o">:</span>
<span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="w"> </span><span class="n">shirt</span><span class="w"> </span><span class="n">pocket</span>
<span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="w"> </span><span class="n">calligrapher</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">hand</span>
<span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="w"> </span><span class="n">inkwell</span>
<span class="o">(</span><span class="n">d</span><span class="o">)</span><span class="w"> </span><span class="n">desk</span><span class="w"> </span><span class="n">drawer</span>
<span class="o">(</span><span class="n">e</span><span class="o">)</span><span class="w"> </span><span class="n">blotter</span>
<span class="n">A</span><span class="o">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">absorb</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">ink</span><span class="o">.</span><span class="w"> </span><span class="n">Blotters</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">designed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">absorb</span>
<span class="n">liquids</span><span class="o">.</span><span class="w"> </span><span class="n">Therefore</span><span class="o">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">blotter</span><span class="w"> </span><span class="o">(</span><span class="n">e</span><span class="o">).</span>
</code></pre></div>

<p>Q: What home entertainment equipment requires cable?
Answer Choices:
(a) radio shack
(b) substation
(c) television
(d) cabinet
(e) desk</p>
<p>A: The answer must require cable. Cable is used to provide satellite channels to
televisions. Therefore, the answer is television (c).</p>
<p>Q: The fox walked from the city into the forest, what was it looking for?
Answer Choices:
(a) pretty flowers
(b) hen house
(c) natural habitat
(d) storybook
(e) dense forest</p>
<p>A: The answer must be a reason for a fox to go into the forest. The forest is a fox' s natural habitat. Therefore, the answer is natural habitat (c).</p>
<p>Q: Sammy wanted to go to where the people were. Where might he go?
Answer Choices:
(a) populated areas
(b) race track
(c) desert
(d) apartment
(e) roadblock</p>
<p>A: The answer must be a place with many people. Populated areas, by definition, have a lot of people. Therefore, the answer is populated areas (a).</p>
<p>Q: Where do you put your grapes just before checking out?
Answer Choices:
(a) mouth
(b) grocery cart
(c) super market
(d) fruit basket
(e) fruit market</p>
<p>A: The answer should be the place where grocery items are placed before checking out
. Of the above choices, grocery cart makes the most sense for holding grocery items.
Therefore, the answer is grocery cart (b).
Q: Google Maps and other highway and street GPS services have replaced what?
Answer Choices:
(a) united states
(b) mexico
(c) countryside
(d) atlas
(e) oceans</p>
<p>A: The answer must be something that used to do what Google Maps and GPS services do , which is give directions. Atlases were also used to give directions. Therefore, the answer is atlas (d).</p>
<p>Q: Before getting a divorce, what did the wife feel who was doing all the work? Answer Choices:
(a) harder
(b) anguish
(c) bitterness
(d) tears
(e) sadness</p>
<p>A: The answer should be a feeling which would cause someone who was doing all the work to get divorced. If someone feels bitter towards their spouse, they are likely to want a divorce. Therefore, the answer is bitterness (c).</p>
<h1>C Human-evaluated Test Prompts</h1>
<p>We also selected a random sampling of 50 questions which were correctly answered both few-shot and by a STaR-trained model (without rationalization), as discussed in 4.4. Presented in a random order, twenty crowdworkers preferred the STaR-generated answers. We reproduce the examples here with the few-shot rationale first, the STaR-trained rationale second, and the human rationale third, though these were shuffled when presented to participants. We selected human answers from [3]'s original split rationales where possible, finding that duplicate rationales were much more common in the new split rationales. For example, the explanation "Rivers flow trough valleys," appeared over 400 times verbatim in the new split dataset, and "This word was most relevant" appeared over 150 times. [3]'s dataset also includes explanations like "The only answer that makes sense" or "BOB WILL NOT POKEMON CARDS WERE COMMON AND WORTHLESS BUT WRONG ABOUT THEM SO FEEL REALLY RARE TO DELAY" or restatements of the answer. We append the phrase "Therefore, the answer is ANSWERTEXT (ANSWERLETTER)" with ANSWERTEXT replaced by the correct answer's text and ANSWERLETTER replaced by the correct answer letter. This is done 1) to make it less obvious that one of the answers is generated by a different source and 2) to prioritize differences in rationales, not the answer format.
Before the questions and after the consent form, we presented the following directions:</p>
<div class="codehilite"><pre><span></span><code><span class="nv">Each</span><span class="w"> </span><span class="nv">question</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">have</span><span class="w"> </span><span class="nv">three</span><span class="w"> </span><span class="nv">explanations</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">one</span><span class="w"> </span><span class="nv">answer</span>,<span class="w"> </span><span class="nv">which</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">pre</span><span class="o">-</span><span class="nv">determined</span><span class="w"> </span><span class="nv">correct</span><span class="w"> </span><span class="ss">(</span><span class="s2">&quot;best&quot;</span><span class="ss">)</span><span class="w"> </span><span class="nv">answer</span>.
<span class="nv">Please</span><span class="w"> </span><span class="nv">rank</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">explanations</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">each</span><span class="w"> </span><span class="nv">question</span><span class="w"> </span><span class="nv">from</span><span class="w"> </span><span class="nv">best</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">worst</span><span class="w"> </span><span class="ss">(</span><span class="nv">with</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">best</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">worst</span><span class="ss">)</span><span class="w"> </span><span class="nv">based</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">how</span><span class="w"> </span><span class="nv">well</span>
<span class="nv">they</span><span class="w"> </span><span class="nv">justify</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">correct</span><span class="w"> </span><span class="nv">answer</span>.
<span class="nv">Note</span><span class="w"> </span><span class="nv">there</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">some</span><span class="w"> </span><span class="nv">typos</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">grammatical</span><span class="w"> </span><span class="nv">errors</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">examples</span>,<span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">questions</span>,<span class="w"> </span><span class="nv">answers</span>,<span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">explanation</span>.<span class="w"> </span><span class="nv">Please</span>
<span class="nv">treat</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">answer</span><span class="w"> </span><span class="nv">letter</span><span class="w"> </span><span class="ss">(</span><span class="nv">a</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">c</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">d</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">e</span><span class="ss">)</span><span class="w"> </span><span class="nv">at</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="k">end</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">explanations</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">correct</span><span class="w"> </span><span class="nv">answer</span><span class="w"> </span><span class="nv">letter</span>,<span class="w"> </span><span class="nv">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">another</span>
<span class="nv">answer</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">valid</span><span class="w"> </span><span class="ss">(</span><span class="nv">and</span><span class="w"> </span><span class="nv">perhaps</span><span class="w"> </span><span class="nv">more</span><span class="w"> </span><span class="nv">reasonable</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">even</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">it</span><span class="w"> </span><span class="nv">does</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">match</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">answer</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="nv">preceding</span><span class="w"> </span><span class="nv">it</span>.
</code></pre></div>

<p>The examples were subsampled and presented to the crowdworkers:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Q</span><span class="o">:</span><span class="w"> </span><span class="n">Who</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">likely</span><span class="w"> </span><span class="n">yo</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">caring</span><span class="w"> </span><span class="n">heart</span><span class="o">?</span>
<span class="n">Answer</span><span class="w"> </span><span class="n">Choices</span><span class="o">:</span>
<span class="o">(</span><span class="n">a</span><span class="o">)</span><span class="w"> </span><span class="n">person</span>
<span class="o">(</span><span class="n">b</span><span class="o">)</span><span class="w"> </span><span class="n">species</span>
<span class="o">(</span><span class="n">c</span><span class="o">)</span><span class="w"> </span><span class="n">artichoke</span>
<span class="o">(</span><span class="n">d</span><span class="o">)</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">mammals</span>
<span class="o">(</span><span class="n">e</span><span class="o">)</span><span class="w"> </span><span class="n">live</span><span class="w"> </span><span class="n">animal</span>
<span class="n">A</span><span class="o">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">person</span><span class="o">.</span><span class="w"> </span><span class="n">All</span><span class="w"> </span><span class="n">mammals</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">caring</span>
<span class="n">heart</span><span class="o">.</span><span class="w"> </span><span class="n">Therefore</span><span class="o">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="o">).</span>
<span class="n">A</span><span class="o">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">someone</span><span class="w"> </span><span class="n">who</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">likely</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span>
<span class="n">caring</span><span class="w"> </span><span class="n">heart</span><span class="o">.</span><span class="w"> </span><span class="n">Humans</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">likely</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">caring</span>
<span class="n">heart</span><span class="o">.</span><span class="w"> </span><span class="n">Therefore</span><span class="o">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="o">).</span>
<span class="n">A</span><span class="o">:</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">human</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="n">capable</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">having</span><span class="w"> </span><span class="n">a</span>
<span class="n">caring</span><span class="w"> </span><span class="n">heart</span><span class="o">.</span><span class="w"> </span><span class="n">Therefore</span><span class="o">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">answer</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">person</span><span class="w"> </span><span class="o">(</span><span class="n">a</span><span class="o">).</span>
</code></pre></div>

<p>Q: If a person wanted to become a good writer what should they do in college?
Answer Choices:
(a) word sentence
(b) own animal
(c) read the newspaper
(d) catch cold
(e) study literature
A: The answer must be something that would help a person become a good writer. The answer is study literature (e). A: The answer must be something that would help a person become a good writer. Literature is a form of study. Therefore, the answer is study literature (e).
A: studying literature will give one skills of writing. Therefore, the answer is study literature (e).</p>
<p>Q: The human always would have fun making up questions for the A.I. overlords, he found the task quite what?
Answer Choices:
(a) do enjoy
(b) eat cake
(c) enjoy living
(d) get laid
(e) enjoyable</p>
<p>A: The answer must be something that the human would enjoy doing. The human enjoys making up questions for the A.I. overlords. Therefore, the answer is enjoyable (e).
A: The answer must be something that the human found enjoyable. The human found the task of making up questions for the A.I. overlords enjoyable. Therefore, the answer is enjoyable (e).</p>
<p>A: Having fun is enjoyable. Therefore, the answer is enjoyable (e).</p>
<p>Q: What happens when I make a pig of myself eating breakfast ?
Answer Choices:
(a) full stomach
(b) gain energy
(c) dieting
(d) have energy
(e) feeling satisfied
A: The answer must be a feeling which would cause someone to feel full after eating breakfast. The answer is full stomach (a).
A: The answer must be a feeling which would cause someone to make a pig of themselves eating breakfast. If someone feels full, they are likely to stop eating. Therefore, the answer is full stomach (a).
A: A colloquial phrase for over indulging in food. Therefore, the answer is full stomach (a).</p>
<p>Q: In order to see a story on the big screen what must you do?
Answer Choices:
(a) go to movies
(b) visualize
(c) reading
(d) open book
(e) sketching a picture</p>
<p>A: The answer must be something that you do to see a story on the big screen. Movies are a way to see a story on the big screen. Therefore, the answer is movies (a).
A: The answer must be something that is required to see a story on the big screen. Movies are a form of storytelling. Therefore, the answer is go to movies (a).
A: The big screen is a colloquial term meaning a movie theater. Therefore, the answer is go to movies (a).</p>
<p>Q: What is the opposite of remembering?
Answer Choices:
(a) answering question
(b) stopping to think
(c) knowing
(d) closing eyes</p>
<p>(e) forgetting
A: The answer must be something that is the opposite of remembering. The answer is forgetting (e).
A: The answer must be a feeling which would cause someone to not remember something. If someone forgets something, they are likely to not remember it. Therefore, the answer is forgetting (e).
A: Health complications. Therefore, the answer is forgetting (e).</p>
<p>Q: If you aren't experiencing curiosity and want to ensure viewing enjoyment, what may you watch?
Answer Choices:
(a) examine thing
(b) stare into a mirror
(c) go somewhere
(d) hear news
(e) see favorite show</p>
<p>A: The answer must be something that will make you want to watch. If you are not experiencing curiosity, you may want to watch something that will make you want to watch. Therefore, the answer is watch (e).
A: The answer must be something that will not cause you to want to watch. If you are not experiencing curiosity, you are likely to want to watch something that is entertaining. Therefore, the answer is favorite show (e).
A: see favorite show can you do in front of a tv if you have curiosity about what is being displayed on the tv. Therefore, the answer is favorite show (e).</p>
<p>Q: The carotid is a main artery susceptible to damage where? Answer Choices:
(a) neck
(b) face
(c) busy city
(d) torso
(e) human body</p>
<p>A: The answer must be a place where the carotid artery is susceptible to damage. The carotid artery is located in the neck. Therefore, the answer is neck (a).
A: The answer must be a place where the carotid is susceptible to damage. The carotid is susceptible to damage in the neck. Therefore, the answer is neck (a).
A: The carotid artery is located in the neck. Therefore, the answer is neck (a).</p>
<p>Q: The king needed to feel safe, where did he go? Answer Choices:
(a) castle
(b) throne room
(c) deck of cards
(d) fort
(e) court</p>
<p>A: The answer must be a place where the king feels safe. The king's castle is a place where he feels safe. Therefore, the answer is castle (a).
A: The answer must be a place where the king can feel safe. Castles are places where kings feel safe. Therefore, the answer is castle (a).
A: In general, King live in castle. Therefore, the answer is castle (a).</p>
<p>Q: What is the result of instituting civil action? Answer Choices:
(a) bad feelings
(b) confusion
(c) going to court
(d) hurt feelings
(e) sandwiches</p>
<p>A: The answer must be a result of instituting civil action. The result of instituting civil action is a lawsuit. Therefore, the answer is going to court (c).
A: The answer must be a result of instituting civil action. If someone goes to court, they are likely to feel hurt feelings. Therefore, the answer is going to court (c).
A: Anger and Trial will not institute a court case. Therefore, the answer is going to court (c).</p>
<p>Q: The person wanted to fix his car, what did he order? Answer Choices:
(a) selling things
(b) gas
(c) feel resentful
(d) machine part
(e) cross street</p>
<p>A: The answer must be something that would help the person fix his car. The person would not want to sell things, because he would not want to give up his car. Therefore, the answer is machine part (d).
A: The answer must be something that would be used to fix a car. Machine parts are used to fix cars. Therefore, the answer is machine part (d).</p>
<p>A: A machine part is the only thing listed that would fix the car. Therefore, the answer is machine part (d).</p>
<p>Q: He always traveled up the mountain when winter arrived, he had a passion and desire to do what? Answer Choices:
(a) play volleyball
(b) play hockey
(c) ski
(d) knit
(e) skate</p>
<p>A: The answer must be something that the person does when winter arrives. The answer is skiing (c).
A: The answer must be something that the person did when winter arrived. The answer is ski (c).
A: Skiing is the only option that is done on a mountain. Therefore, the answer is ski (c).</p>
<p>Q: Bob thought that his Pokemon cards were common and worthless, but he was wrong about them. They were really what?
Answer Choices:
(a) personal
(b) special
(c) shiny
(d) rare
(e) irregular</p>
<p>A: The answer must be something that is not common and worthless. Pokemon cards are not common and worthless. Therefore, the answer is rare (d).
A: The answer must be something that are rare. Pokemon cards are rare. Therefore, the answer is rare (d).
A: HOB WILL NOT POKEMON CARDS WERE COMMON AND WORTHLESS BUT WHOHS ABOUT THEM SO FEEL REALLY RARE TO DELAY. Therefore, the answer is rare (d).</p>
<p>Q: If you're lighting a candle to see what are you in? Answer Choices:
(a) dimly lit room
(b) synagogue
(c) sunlight
(d) birthday cake
(e) bedroom</p>
<p>A: The answer must be a place where you can see what you are in. The answer is a room with dim lighting. Therefore, the answer is dimly lit room (a).
A: The answer must be a place where you can see a candle. Candles are used to see things in the dark. Therefore, the answer is dimly lit room (a).
A: Lighting or illumination is the deliberate use of light to achieve a practical or aesthetic effect. Lighting includes the use of both artificial light sources like lamps ... Therefore, the answer is dimly lit room (a).</p>
<p>Q: The person was thirsty, what should he have done? Answer Choices:
(a) eat
(b) sunny days
(c) compliments
(d) drink water
(e) all kinds of things</p>
<p>A: The answer must be something that would make the person feel better. If the person is thirsty, he should drink water. Therefore, the answer is drink water (d).
A: The answer must be something that would make someone feel better if they were thirsty. If someone is thirsty, they are likely to want to drink water. Therefore, the answer is drink water (d).
A: The person was thirsty, so drink water. Therefore, the answer is drink water (d).</p>
<p>Q: Where would you find many products for sale? Answer Choices:
(a) market
(b) cost one dollar
(c) shelf
(d) salon
(e) demonstration</p>
<p>A: The answer must be a place where many products are sold. A market is a place where many products are sold. Therefore, the answer is market (a).
A: The answer must be a place with a lot of products for sale. Markets are the most common place to buy products. Therefore, the answer is market (a).
A: The only place products are for sale are in markets and stores. Therefore, the answer is market (a).</p>
<p>Q: If man and mammoth wanted to meet, they would probably have to do it during when?
Answer Choices:
(a) a baby shower
(b) ancient history</p>
<p>(c) storybook
(d) stone age
(e) forest
A: The answer must be a time when man and mammoth would meet. Stone age is the time when man and mammoth lived. Therefore, the answer is stone age (d).
A: The answer must be a time when man and mammoth would be able to meet. The stone age was a time when man and mammoth would be able to meet. Therefore, the answer is stone age (d).
A: During the stone age is the only time mammoths lived. Therefore, the answer is stone age (d).</p>
<p>Q: They prided themselves on being a wealth of knowledge, and that's why many chose to attend their what?
Answer Choices:
(a) book store
(b) university
(c) meeting
(d) class
(e) encyclopedia
A: The answer must be a place where people go to learn about things. The answer is university (b).
A: The answer must be a place where people go to learn about things. Universities are places where people go to learn about things. Therefore, the answer is university (b).</p>
<p>A: because in the university you get more knowledge. Therefore, the answer is university (b).</p>
<p>Q: what happens when visiting museum that have narrow halls? Answer Choices:
(a) sore feet
(b) anasement
(c) retrospection
(d) boredom
(e) crowding
A: The answer must be something that happens when visiting a museum that has narrow halls. Crowding is a common problem in museums. Therefore, the answer is crowding (e). A: The answer must be something that would cause someone to have sore feet if they are walking in narrow halls. If someone feels cramped, they are likely to want to go somewhere else. Therefore, the answer is crowding (e). A: museum is one of the crowdest place. Therefore, the answer is crowding (e).</p>
<p>Q: On their hike they brought a filtering straw, they were worried about germs in the what?
Answer Choices:
(a) make sick
(b) doctor
(c) water
(d) stream
(e) mouth
A: The answer must be something that can filter out germs. Filtering straas are used to filter out germs. Therefore, the answer is filtering straw (c).
A: The answer must be something that would cause someone to bring a filtering straw on a hike. Filtering straas are used to filter water. Therefore, the answer is water (c). A: straw it something used to drink water. Therefore, the answer is water (c).</p>
<p>Q: If I am not good at playing poker, I will begin what if I play?
Answer Choices:
(a) discord
(b) social event
(c) losing money
(d) competition
(e) heightened awareness
A: The answer must be something that will happen if you are not good at playing poker. If you are not good at playing poker, you will begin to lose money. Therefore, the answer is losing money (c).
A: The answer must be something that will help you if you are not good at playing poker. If you are losing money, you are likely to want to stop playing. Therefore, the answer is losing money (c).
A: Poker is a game in which people lose their money. Therefore, the answer is losing money (c).</p>
<p>Q: People are meeting people, what is the likely physical gesture?
Answer Choices:
(a) introducing yourself
(b) smiling
(c) shake hands
(d) share a hug
(e) talking</p>
<p>A: The answer must be a physical gesture that is used to greet someone. The answer is handshake (c).
A: The answer must be a gesture used to meet people. If someone wants to meet people, they are likely to want to shake hands. Therefore, the answer is shaking hands (c).
A: A handshake is a globally widespread. Therefore, the answer is shaking hands (c).</p>
<p>Q: What do dogs get that make them itch?
Answer Choices:
(a) bones
(b) fleas
(c) bad breath
(d) wagging tails
(e) four legs
A: The answer must be something that makes dogs itch. Dogs get fleas, which make them itch. Therefore, the answer is fleas (b).
A: The answer must be something that dogs get that make them itch. Fleas are a common cause of dog itch. Therefore, the answer is fleas (b).
A: fleas makes you itch. Therefore, the answer is fleas (b).</p>
<p>Q: What is ignorance often equated with?
Answer Choices:
(a) bliss
(b) hostility
(c) peace
(d) accidents
(e) find truth
A: The answer must be something that is often equated with ignorance. Bliss is often equated with ignorance. Therefore, the answer is bliss (a).
A: The answer must be a feeling which would cause someone to be ignorant. If someone feels bliss, they are likely to be ignorant. Therefore, the answer is bliss (a).
A: bliss comes from ignorance. Therefore, the answer is bliss (a).</p>
<p>Q: The two teams were competing all the time, what likely developed between them?
Answer Choices:
(a) accomplishment
(b) enemies
(c) rivalry
(d) friendship
(e) bad blood
A: The answer must be something that developed between the two teams. The teams were competing all the time. Therefore, the answer is rivalry (c).
A: The answer must be a feeling which would cause two teams to compete all the time. Rivalry is a common feeling which would cause two teams to compete all the time. Therefore, the answer is rivalry (c).
A: likely developed between them of rivalry. Therefore, the answer is rivalry (c).</p>
<p>Q: James doesn't want a relationship. He thinks that loving another will only create what?
Answer Choices:
(a) satisfaction
(b) jealousy
(c) happiness
(d) wonderful
(e) quiet
A: The answer must be something that would make James feel bad about not having a relationship. If someone feels jealous, they are likely to want a relationship. Therefore, the answer is jealousy (b).
A: The answer must be a feeling which would cause someone who doesn't want a relationship to not want one. If someone feels jealous of another, they are likely to not want a relationship. Therefore, the answer is jealousy (b).
A: Jealousy is a negative emotion. Therefore, the answer is jealousy (b).</p>
<p>Q: The had a reputation for celebrating in a debaucherous manner, what often happened as a result?
Answer Choices:
(a) drunkenness
(b) enjoyment
(c) have fun
(d) hang over
(e) fighting
A: The answer must be a result of a celebration. The answer is drunkenness (a).
A: The answer must be something that would cause someone to have a reputation for celebrating in a debaucherous manner. Alcohol is a depressant. Therefore, the answer is drunkenness (a).</p>
<p>A: it is normal not a good idea to get drunk. Therefore, the answer is drunkenness (a).</p>
<p>Q: The paper towels are usually in plain sight in the kitchen, where did the dad go next to find them? Answer Choices:
(a) pantry
(b) cabinet
(c) grocery store
(d) waste bin
(e) market
A: The answer must be a place where the dad would go to find the paper towels. The pantry is a place where food is stored. Therefore, the answer is pantry (a).
A: The answer must be a place where paper towels are stored. Pantries are the most likely place to store paper towels. Therefore, the answer is pantry (a).
A: The pantry is in the kitchen and stores things. Therefore, the answer is pantry (a).</p>
<p>Q: My house is very dry, with little water in the air. What tool should I use to fix this? Answer Choices:
(a) humidifier
(b) surface of earth
(c) skating rink
(d) ice cube
(e) burn it to the ground
A: The answer must be a tool that will make the air in your house moist. A humidifier is a tool that will make the air in your house moist. Therefore, the answer is humidifier ( a).
A: The answer must be something that would make the air in my house more humid. A humidifier is used to make the air in a room more humid. Therefore, the answer is humidifier ( a).</p>
<p>A: This word was most relevant. Therefore, the answer is humidifier (a).</p>
<p>Q: A motorcycle is quicker because it isn't as what as a car ? Answer Choices:
(a) heavy
(b) shiny
(c) red
(d) obesity
(e) expensive
A: The answer must be something that is not as heavy as a car. A motorcycle is lighter than a car. Therefore, the answer is not heavy (a).
A: The answer must be something that is not as quick as a motorcycle. Motorcycles are not as heavy as cars. Therefore, the answer is heavy (a).
A: Because it is much smaller. Therefore, the answer is heavy (a).</p>
<p>Q: The baseball team was playing ball. It was time for the pitcher to act. How did the pitcher get the ball to the batter?
Answer Choices:
(a) loose
(b) injury
(c) competition
(d) throwing
(e) rolled
A: The answer must be a way to get the ball to the batter. The pitcher is the one who throws the ball. Therefore, the answer is throwing (d).
A: The answer must be a way for the pitcher to get the ball to the batter. The pitcher is the person who is responsible for getting the ball to the batter. Therefore, the answer is throwing (d).
A: The pitcher threw the ball to the batter so that he could hit it. Therefore, the answer is throwing (d).</p>
<p>Q: In what sort of container should you keep your ficus? Answer Choices:
(a) refrigerator
(b) screened porch
(c) clay pot
(d) shady places
(e) arboretum
A: The answer must be a container that keeps the ficus in a shady place. Clay pots are used to keep plants in shady places. Therefore, the answer is clay pot (c).
A: The answer must be a container in which ficus can be kept. Ficus are tropical plants. Therefore, the answer is clay pot (c).
A: Clay pot is the only type of container listed. Therefore, the answer is clay pot (c).</p>
<p>Q: James was cooking a stew in his apartment kitchen. Where might he look for a potato.
Answer Choices:
(a) restaurants
(b) casserole
(c) root cellar
(d) pockets
(e) pantry
A: The answer must be a place where potatoes are stored. The answer is pantry (e).
A: The answer must be a place where potatoes are stored. Pantries are the most likely place to store potatoes. Therefore, the answer is pantry (e).
A: apartments do not often have root cellars, and are not restaurants. a pantry is closest to James inside his apartment. Therefore, the answer is pantry (e).</p>
<p>Q: If ships are in a storm and the sun comes out, what has happened?
Answer Choices:
(a) sinks
(b) cross river
(c) collide
(d) bottom out
(e) carry people
A: The answer must be a thing that happens when ships are in a storm and the sun comes out. Ships are in a storm when they are in the middle of the ocean. Therefore, the answer is bottom out (d).
A: The answer must be something that happens when the sun comes out. The sun is a source of energy. Therefore, the answer is bottom out (d).
A: the sun comes out so its not a storm any more. Therefore, the answer is bottom out (d).</p>
<p>Q: Where do all marmot live before they are captured? Answer Choices:
(a) switzerland
(b) spain
(c) vancouver island
(d) wilderness
(e) australia
A: The answer must be a place where marmots live. Marmots live in the wilderness. Therefore, the answer is wilderness (d).
A: The answer must be a place where marmots are found. The wilderness is the most likely place to find marmots. Therefore, the answer is wilderness (d).
A: Marmots don't live in Australia or Switzerland. Therefore, the answer is wilderness (d).</p>
<p>Q: Where does one wait on a bench for something on tracks? Answer Choices:
(a) train station
(b) state park
(c) crosswalk
(d) bus stop
(e) bus depot
A: The answer must be a place where one waits for a train, bus, or other vehicle. The answer is train station (a). A: The answer must be a place where one can wait for a train. Train stations are places where trains stop. Therefore, the answer is train station (a).
A: Only trains are on tracks. Therefore, the answer is train station (a).</p>
<p>Q: What can planning vacation lead to between a couple when they disagree?
Answer Choices:
(a) relaxation
(b) enjoying
(c) arguments
(d) going abroad
(e) spending money
A: The answer must be something that can happen when a couple disagrees. Arguments are a common result of disagreements. Therefore, the answer is arguments (c).
A: The answer must be a result of planning vacation. Arguments are a common result of planning vacation. Therefore, the answer is arguments (c).
A: Arguments are the direct result of disagreements. Therefore, the answer is arguments (c).</p>
<p>Q: A sloth climbs slow, but it can eventually reach all the way up where?
Answer Choices:
(a) forest canopy
(b) universe
(c) tropical rainforest
(d) large trees
(e) nature preserve</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{3}$ We use the same few-shot rationales as described in Section 4.1 - namely fixing typos and improving clarity.&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>For example, "Billy bought coffee and waited for his wife to arrive from France. Where might he have been?" includes airport and train station as options. The correct answer, perhaps surprisingly, is train station.&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>