<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-1437 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-1437</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-1437</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-26.html">extraction-schema-26</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of automated systems making scientific discoveries, including how these discoveries are characterized as incremental or transformational, and how they are evaluated and validated.</div>
                <p><strong>Paper ID:</strong> paper-7c1674d71036ef82f09ccbaa16bf614ba41fdf1a</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/7c1674d71036ef82f09ccbaa16bf614ba41fdf1a" target="_blank">Predicting the long-term stability of compact multiplanet systems</a></p>
                <p><strong>Paper Venue:</strong> Proceedings of the National Academy of Sciences of the United States of America</p>
                <p><strong>Paper TL;DR:</strong> The Stability of Planetary Orbital Configurations Klassifier (SPOCK) predicts stability using physically motivated summary statistics measured in integrations of the first 104 orbits, thus achieving speed-ups of up to 105 over full simulations, which computationally opens up the stability-constrained characterization of multiplanet systems.</p>
                <p><strong>Paper Abstract:</strong> Significance Observations of planets beyond our solar system (exoplanets) yield uncertain orbital parameters. Particularly in compact multiplanet systems, a significant fraction of observationally inferred orbital configurations can lead to planetary collisions on timescales that are short compared with the age of the system. Rejection of these unphysical solutions can thus sharpen our view of exoplanetary orbital architectures. Long-term stability determination is currently performed through direct orbital integrations. However, this approach is computationally prohibitive for application to the full exoplanet sample. By speeding up this process by up to five orders of magnitude, we enable precise exoplanet characterization of compact multiplanet systems and our ability to examine the stability properties of the multiplanet exoplanet sample as a whole. We combine analytical understanding of resonant dynamics in two-planet systems with machine-learning techniques to train a model capable of robustly classifying stability in compact multiplanet systems over long timescales of 109 orbits. Our Stability of Planetary Orbital Configurations Klassifier (SPOCK) predicts stability using physically motivated summary statistics measured in integrations of the first 104 orbits, thus achieving speed-ups of up to 105 over full simulations. This computationally opens up the stability-constrained characterization of multiplanet systems. Our model, trained on ∼100,000 three-planet systems sampled at discrete resonances, generalizes both to a sample spanning a continuous period-ratio range, as well as to a large five-planet sample with qualitatively different configurations to our training dataset. Our approach significantly outperforms previous methods based on systems’ angular momentum deficit, chaos indicators, and parametrized fits to numerical integrations. We use SPOCK to constrain the free eccentricities between the inner and outer pairs of planets in the Kepler-431 system of three approximately Earth-sized planets to both be below 0.05. Our stability analysis provides significantly stronger eccentricity constraints than currently achievable through either radial velocity or transit-duration measurements for small planets and within a factor of a few of systems that exhibit transit-timing variations (TTVs). Given that current exoplanet-detection strategies now rarely allow for strong TTV constraints [S. Hadden, T. Barclay, M. J. Payne, M. J. Holman, Astrophys. J. 158, 146 (2019)], SPOCK enables a powerful complementary method for precisely characterizing compact multiplanet systems. We publicly release SPOCK for community use.</p>
                <p><strong>Cost:</strong> 0.014</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <div class="extraction-instance-container" id="e1437.0">
                <h3 class="extraction-instance">Extracted Data Instance 0 (e1437.0)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of automated systems making scientific discoveries, including how these discoveries are characterized as incremental or transformational, and how they are evaluated and validated.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>SPOCK</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Stability of Planetary Orbital Configurations Klassifier (SPOCK)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A supervised machine-learning classifier that predicts whether compact multi-planet systems will remain stable for 10^9 orbits by computing 10 physically-motivated summary features from a short (10^4-orbit) integration and evaluating an XGBoost model, achieving large speedups vs direct N-body.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>system_name</strong></td>
                            <td>SPOCK</td>
                        </tr>
                        <tr>
                            <td><strong>system_description</strong></td>
                            <td>Architecture: gradient-boosted decision trees (XGBoost) trained on ~113k labeled three-planet systems; input is ten engineered summary features computed from a 10^4-orbit N-body integration (including MEGNO, resonant-mode statistics, and MMR-strength measures). Approach: feature-engineering informed by analytical resonant-variable transformations, short integration to capture dynamical signals, supervised binary classification (stable vs unstable for 10^9 orbits). Capabilities: predict stability probabilities up to ~10^5 times faster than full 10^9-orbit integrations; generalizes to uniformly sampled three-planet systems, to unequal-mass/unequally spaced systems, and (via testing on adjacent trios) to some higher-multiplicity cases.</td>
                        </tr>
                        <tr>
                            <td><strong>discovery_domain</strong></td>
                            <td>Astrophysics / Celestial Mechanics (exoplanet orbital dynamics)</td>
                        </tr>
                        <tr>
                            <td><strong>discovery_description</strong></td>
                            <td>Automated classification and consequent scientific inferences: SPOCK classifies long-term dynamical stability of compact multi-planet systems and thereby enables stability-constrained characterization of system parameters (e.g., placing upper limits on planets' free eccentricities). The paper demonstrates SPOCK (a) reproduces structure in instability time vs separation, (b) constrains free eccentricities in Kepler-431 to ≲0.05 (84th-percentile upper limits), (c) generalizes to a five-planet integration suite and to uniformly sampled systems, and (d) identifies regions where it fails (e.g., narrow posteriors from TTV fits and secular, very-long-timescale instabilities).</td>
                        </tr>
                        <tr>
                            <td><strong>discovery_type</strong></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><strong>discovery_type_justification</strong></td>
                            <td>The paper does not label the outcomes (the automated classification or the enabled scientific constraints) using terminology such as 'incremental' or 'transformational'; justification for significance is phrased in quantitative performance (speedups, improved accuracy) and practical impact on exoplanet characterization rather than by those categories.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_methods</strong></td>
                            <td>Quantitative supervised-evaluation using an 80/20 train/test split and five-fold cross-validation on the training set; hyperparameter optimization via hyperopt maximizing AUC; primary metrics: ROC curves and AUC, and operational metrics TPR (true positive rate) vs FPR (false positive rate) at chosen thresholds. Specific reported evaluation numbers: on the resonant holdout test set at FPR=10% SPOCK TPR ≈ 85%; on a uniformly sampled 'random' dataset at FPR=10% SPOCK TPR ≈ 94.2%; on Obertas et al. (5-planet) data using adjacent-trio minimum-probability prescription with a threshold yielding holdout FPR 10% SPOCK TPR ≈ 94%, FPR ≈ 6%. Speed evaluation: comparison of run time: full 10^9-orbit N-body ≈ 7 CPU-hours vs SPOCK ≈ short 10^4-orbit integration + feature eval ≈ seconds, reported speedups up to 10^5.</td>
                        </tr>
                        <tr>
                            <td><strong>validation_approaches</strong></td>
                            <td>Ground-truth labels established by direct N-body integrations to 10^9 orbits for ~113k training examples; 'shadow integrations' (second integration with tiny perturbation) used to quantify fundamental predictability limits from chaos (instability times lognormally distributed with σ≈0.4 dex); holdout test sets and out-of-distribution tests: (1) uniformly sampled 25k 'random' dataset, (2) independent five-planet integration suite from Obertas et al. (2017), (3) application to observed systems (Kepler-431) with direct N-body cross-checks on 1500 sampled posterior configurations, and (4) failure-mode tests on TTV-constrained posteriors (Kepler-307 and other TTV systems). Reproducibility: training dataset (≈1.5M CPU-hours) and code publicly released.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_assessment</strong></td>
                            <td>Novelty stems from combining analytical resonant-variable transformations and short-time numerical indicators into a small set of physically interpretable features used by a supervised ML model, plus targeted training on near-resonant configurations to fill in the rapidly changing dynamics near MMRs. The paper argues novelty relative to prior approaches (N-body brute force, AMD, Hill-separation empirical fits, MEGNO alone) through improved predictive performance and computational cost. It also claims generalization to higher multiplicity despite being trained on three-planet systems, which the authors present as evidence of novel, physics-informed ML design.</td>
                        </tr>
                        <tr>
                            <td><strong>impact_metrics</strong></td>
                            <td>Numerical impact and significance metrics reported include: computational speedup up to 10^5 relative to full 10^9-orbit N-body integrations; ROC / AUC improvements (AUC values shown in Fig. 3 but not all quoted numerically in text); TPR@FPR=10%: resonant holdout SPOCK 85% vs MEGNO 49% vs AMD 36% vs Hill 30%; random dataset TPR@FPR=10%: SPOCK 94% vs MEGNO 87% vs AMD 74% vs Hill 39%; five-planet Obertas test: TPR 94%, FPR 6% (with chosen threshold). Kepler-431 application: constrained free eccentricities of inner and outer planet pairs to <0.051 and <0.053 (84th-percentile upper limits).</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_human_discoveries</strong></td>
                            <td>False</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_details</strong></td>
                            <td>The paper compares SPOCK to human-derived or analytic/classical methods (direct N-body integration as ground truth, AMD-stability analytic criterion, Hill-radius empirical scalings, MEGNO chaos indicator) and quantifies improvements in classification accuracy and runtime. It does not compare to a human 'discovery' event but demonstrates superior practical performance vs these prior approaches in the tested datasets (see numeric TPR/FPR comparisons above).</td>
                        </tr>
                        <tr>
                            <td><strong>success_rate</strong></td>
                            <td>Performance summarized by TPR/FPR and AUC: on resonant holdout at FPR=10% SPOCK TPR ≈ 85%; on uniform dataset at FPR=10% SPOCK TPR ≈ 94.2%; on Obertas five-planet tests TPR 94% and FPR 6% (using the probability threshold chosen earlier). Failure cases: high false positive rates when applied to narrow TTV-constrained posterior samples (e.g., Kepler-307 FPR reported as 87% on that posterior), and inability to detect much-slower secular resonance driven instabilities beyond the trained 10^9-orbit horizon.</td>
                        </tr>
                        <tr>
                            <td><strong>challenges_limitations</strong></td>
                            <td>Identified limitations include: (1) Fundamental unpredictability due to chaos — instability times are intrinsically distributed (lognormal, σ≈0.4 dex), limiting any classifier's ceiling; (2) SPOCK targets MMR-driven instabilities on ≤10^9-orbit timescales and is not trained to detect slow secular-resonance long-term instabilities; (3) failure when observational posteriors (e.g., from TTV fits) collapse onto parameter subspaces in which SPOCK's short-integration features have little discriminative power (example: Kepler-307 where TTVs already tightly constrain the resonant eccentricity mode), causing high FPR; (4) engineered-feature choice trades marginal performance for interpretability — original 60-feature model performed slightly better but was pruned to 10 features for interpretability; (5) assumptions and training distribution (three-planet resonant systems) may limit performance in unrepresented corners of parameter space, though tests show good generalization in many cases.</td>
                        </tr>
                        <tr>
                            <td><strong>has_incremental_transformational_comparison</strong></td>
                            <td>False</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Predicting the long-term stability of compact multiplanet systems', 'publication_date_yy_mm': '2020-07'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e1437.1">
                <h3 class="extraction-instance">Extracted Data Instance 1 (e1437.1)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of automated systems making scientific discoveries, including how these discoveries are characterized as incremental or transformational, and how they are evaluated and validated.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Tamayo2016 ML prototype</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Proof-of-concept machine-learning stability predictor (Tamayo et al., 2016)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>An earlier exploratory machine learning model that learned to predict stability of tightly packed planetary systems from short integrations; cited as a prior proof-of-concept that SPOCK extends and improves upon.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>A machine learns to predict the stability of tightly packed planetary systems.</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>mention</td>
                        </tr>
                        <tr>
                            <td><strong>system_name</strong></td>
                            <td>Tamayo et al. (2016) prototype ML model</td>
                        </tr>
                        <tr>
                            <td><strong>system_description</strong></td>
                            <td>Earlier ML approach that trained models (including initial demonstrations with decision-tree/ensemble and neural networks) on short-integration features to predict stability over shorter horizons (10^7 orbits in the prototype), used here as a conceptual antecedent; the 2020 SPOCK paper relaxes equal-mass assumptions, extends prediction horizon to 10^9 orbits, and uses resonant-variable-informed feature engineering and targeted resonant training sampling.</td>
                        </tr>
                        <tr>
                            <td><strong>discovery_domain</strong></td>
                            <td>Astrophysics / Celestial Mechanics (exoplanet orbital dynamics)</td>
                        </tr>
                        <tr>
                            <td><strong>discovery_description</strong></td>
                            <td>Served as a proof-of-concept that machine learning can predict long-term dynamical stability from short integrations, motivating the development of SPOCK.</td>
                        </tr>
                        <tr>
                            <td><strong>discovery_type</strong></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><strong>discovery_type_justification</strong></td>
                            <td>The 2016 work is cited as a proof-of-concept; the 2020 paper does not characterize it with 'incremental'/'transformational' language.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_methods</strong></td>
                            <td>Referenced as having been evaluated using short-integration features and ML, but specific metrics are not detailed in this paper beyond qualitative statement that SPOCK significantly improves on that prototype.</td>
                        </tr>
                        <tr>
                            <td><strong>validation_approaches</strong></td>
                            <td>Prototype validated in original work (not detailed here); SPOCK compares and extends that approach.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_assessment</strong></td>
                            <td>Listed as earlier exploratory ML demonstration; novelty of SPOCK is framed as extending that prototype with physics-informed features and longer-horizon labels.</td>
                        </tr>
                        <tr>
                            <td><strong>impact_metrics</strong></td>
                            <td>Not quantified in this paper beyond being the antecedent motivating SPOCK.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_human_discoveries</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>comparison_details</strong></td>
                            <td>Mentioned as prior work; SPOCK claims improved generality, longer horizon, and better handling of unequal masses and near-resonant dynamics compared to the 2016 prototype.</td>
                        </tr>
                        <tr>
                            <td><strong>success_rate</strong></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td><strong>challenges_limitations</strong></td>
                            <td>Described implicitly: the prototype assumed equal-mass planets and shorter prediction horizon (10^7 orbits), and performed poorly near MMRs compared to the resonant-variable-informed approach used in SPOCK.</td>
                        </tr>
                        <tr>
                            <td><strong>has_incremental_transformational_comparison</strong></td>
                            <td>False</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Predicting the long-term stability of compact multiplanet systems', 'publication_date_yy_mm': '2020-07'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>A machine learns to predict the stability of tightly packed planetary systems. <em>(Rating: 2)</em></li>
                <li>A machine learns to predict the stability of circumbinary planets. <em>(Rating: 2)</em></li>
                <li>The stability of tightly-packed, eventy-spaced systems of earth-mass planets orbiting a sun-like star. <em>(Rating: 1)</em></li>
                <li>An Integrable Model for the Dynamics of Planetary Mean-motion Resonances. <em>(Rating: 1)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-1437",
    "paper_id": "paper-7c1674d71036ef82f09ccbaa16bf614ba41fdf1a",
    "extraction_schema_id": "extraction-schema-26",
    "extracted_data": [
        {
            "name_short": "SPOCK",
            "name_full": "Stability of Planetary Orbital Configurations Klassifier (SPOCK)",
            "brief_description": "A supervised machine-learning classifier that predicts whether compact multi-planet systems will remain stable for 10^9 orbits by computing 10 physically-motivated summary features from a short (10^4-orbit) integration and evaluating an XGBoost model, achieving large speedups vs direct N-body.",
            "citation_title": "here",
            "mention_or_use": "use",
            "system_name": "SPOCK",
            "system_description": "Architecture: gradient-boosted decision trees (XGBoost) trained on ~113k labeled three-planet systems; input is ten engineered summary features computed from a 10^4-orbit N-body integration (including MEGNO, resonant-mode statistics, and MMR-strength measures). Approach: feature-engineering informed by analytical resonant-variable transformations, short integration to capture dynamical signals, supervised binary classification (stable vs unstable for 10^9 orbits). Capabilities: predict stability probabilities up to ~10^5 times faster than full 10^9-orbit integrations; generalizes to uniformly sampled three-planet systems, to unequal-mass/unequally spaced systems, and (via testing on adjacent trios) to some higher-multiplicity cases.",
            "discovery_domain": "Astrophysics / Celestial Mechanics (exoplanet orbital dynamics)",
            "discovery_description": "Automated classification and consequent scientific inferences: SPOCK classifies long-term dynamical stability of compact multi-planet systems and thereby enables stability-constrained characterization of system parameters (e.g., placing upper limits on planets' free eccentricities). The paper demonstrates SPOCK (a) reproduces structure in instability time vs separation, (b) constrains free eccentricities in Kepler-431 to ≲0.05 (84th-percentile upper limits), (c) generalizes to a five-planet integration suite and to uniformly sampled systems, and (d) identifies regions where it fails (e.g., narrow posteriors from TTV fits and secular, very-long-timescale instabilities).",
            "discovery_type": "",
            "discovery_type_justification": "The paper does not label the outcomes (the automated classification or the enabled scientific constraints) using terminology such as 'incremental' or 'transformational'; justification for significance is phrased in quantitative performance (speedups, improved accuracy) and practical impact on exoplanet characterization rather than by those categories.",
            "evaluation_methods": "Quantitative supervised-evaluation using an 80/20 train/test split and five-fold cross-validation on the training set; hyperparameter optimization via hyperopt maximizing AUC; primary metrics: ROC curves and AUC, and operational metrics TPR (true positive rate) vs FPR (false positive rate) at chosen thresholds. Specific reported evaluation numbers: on the resonant holdout test set at FPR=10% SPOCK TPR ≈ 85%; on a uniformly sampled 'random' dataset at FPR=10% SPOCK TPR ≈ 94.2%; on Obertas et al. (5-planet) data using adjacent-trio minimum-probability prescription with a threshold yielding holdout FPR 10% SPOCK TPR ≈ 94%, FPR ≈ 6%. Speed evaluation: comparison of run time: full 10^9-orbit N-body ≈ 7 CPU-hours vs SPOCK ≈ short 10^4-orbit integration + feature eval ≈ seconds, reported speedups up to 10^5.",
            "validation_approaches": "Ground-truth labels established by direct N-body integrations to 10^9 orbits for ~113k training examples; 'shadow integrations' (second integration with tiny perturbation) used to quantify fundamental predictability limits from chaos (instability times lognormally distributed with σ≈0.4 dex); holdout test sets and out-of-distribution tests: (1) uniformly sampled 25k 'random' dataset, (2) independent five-planet integration suite from Obertas et al. (2017), (3) application to observed systems (Kepler-431) with direct N-body cross-checks on 1500 sampled posterior configurations, and (4) failure-mode tests on TTV-constrained posteriors (Kepler-307 and other TTV systems). Reproducibility: training dataset (≈1.5M CPU-hours) and code publicly released.",
            "novelty_assessment": "Novelty stems from combining analytical resonant-variable transformations and short-time numerical indicators into a small set of physically interpretable features used by a supervised ML model, plus targeted training on near-resonant configurations to fill in the rapidly changing dynamics near MMRs. The paper argues novelty relative to prior approaches (N-body brute force, AMD, Hill-separation empirical fits, MEGNO alone) through improved predictive performance and computational cost. It also claims generalization to higher multiplicity despite being trained on three-planet systems, which the authors present as evidence of novel, physics-informed ML design.",
            "impact_metrics": "Numerical impact and significance metrics reported include: computational speedup up to 10^5 relative to full 10^9-orbit N-body integrations; ROC / AUC improvements (AUC values shown in Fig. 3 but not all quoted numerically in text); TPR@FPR=10%: resonant holdout SPOCK 85% vs MEGNO 49% vs AMD 36% vs Hill 30%; random dataset TPR@FPR=10%: SPOCK 94% vs MEGNO 87% vs AMD 74% vs Hill 39%; five-planet Obertas test: TPR 94%, FPR 6% (with chosen threshold). Kepler-431 application: constrained free eccentricities of inner and outer planet pairs to &lt;0.051 and &lt;0.053 (84th-percentile upper limits).",
            "comparison_to_human_discoveries": false,
            "comparison_details": "The paper compares SPOCK to human-derived or analytic/classical methods (direct N-body integration as ground truth, AMD-stability analytic criterion, Hill-radius empirical scalings, MEGNO chaos indicator) and quantifies improvements in classification accuracy and runtime. It does not compare to a human 'discovery' event but demonstrates superior practical performance vs these prior approaches in the tested datasets (see numeric TPR/FPR comparisons above).",
            "success_rate": "Performance summarized by TPR/FPR and AUC: on resonant holdout at FPR=10% SPOCK TPR ≈ 85%; on uniform dataset at FPR=10% SPOCK TPR ≈ 94.2%; on Obertas five-planet tests TPR 94% and FPR 6% (using the probability threshold chosen earlier). Failure cases: high false positive rates when applied to narrow TTV-constrained posterior samples (e.g., Kepler-307 FPR reported as 87% on that posterior), and inability to detect much-slower secular resonance driven instabilities beyond the trained 10^9-orbit horizon.",
            "challenges_limitations": "Identified limitations include: (1) Fundamental unpredictability due to chaos — instability times are intrinsically distributed (lognormal, σ≈0.4 dex), limiting any classifier's ceiling; (2) SPOCK targets MMR-driven instabilities on ≤10^9-orbit timescales and is not trained to detect slow secular-resonance long-term instabilities; (3) failure when observational posteriors (e.g., from TTV fits) collapse onto parameter subspaces in which SPOCK's short-integration features have little discriminative power (example: Kepler-307 where TTVs already tightly constrain the resonant eccentricity mode), causing high FPR; (4) engineered-feature choice trades marginal performance for interpretability — original 60-feature model performed slightly better but was pruned to 10 features for interpretability; (5) assumptions and training distribution (three-planet resonant systems) may limit performance in unrepresented corners of parameter space, though tests show good generalization in many cases.",
            "has_incremental_transformational_comparison": false,
            "uuid": "e1437.0",
            "source_info": {
                "paper_title": "Predicting the long-term stability of compact multiplanet systems",
                "publication_date_yy_mm": "2020-07"
            }
        },
        {
            "name_short": "Tamayo2016 ML prototype",
            "name_full": "Proof-of-concept machine-learning stability predictor (Tamayo et al., 2016)",
            "brief_description": "An earlier exploratory machine learning model that learned to predict stability of tightly packed planetary systems from short integrations; cited as a prior proof-of-concept that SPOCK extends and improves upon.",
            "citation_title": "A machine learns to predict the stability of tightly packed planetary systems.",
            "mention_or_use": "mention",
            "system_name": "Tamayo et al. (2016) prototype ML model",
            "system_description": "Earlier ML approach that trained models (including initial demonstrations with decision-tree/ensemble and neural networks) on short-integration features to predict stability over shorter horizons (10^7 orbits in the prototype), used here as a conceptual antecedent; the 2020 SPOCK paper relaxes equal-mass assumptions, extends prediction horizon to 10^9 orbits, and uses resonant-variable-informed feature engineering and targeted resonant training sampling.",
            "discovery_domain": "Astrophysics / Celestial Mechanics (exoplanet orbital dynamics)",
            "discovery_description": "Served as a proof-of-concept that machine learning can predict long-term dynamical stability from short integrations, motivating the development of SPOCK.",
            "discovery_type": "",
            "discovery_type_justification": "The 2016 work is cited as a proof-of-concept; the 2020 paper does not characterize it with 'incremental'/'transformational' language.",
            "evaluation_methods": "Referenced as having been evaluated using short-integration features and ML, but specific metrics are not detailed in this paper beyond qualitative statement that SPOCK significantly improves on that prototype.",
            "validation_approaches": "Prototype validated in original work (not detailed here); SPOCK compares and extends that approach.",
            "novelty_assessment": "Listed as earlier exploratory ML demonstration; novelty of SPOCK is framed as extending that prototype with physics-informed features and longer-horizon labels.",
            "impact_metrics": "Not quantified in this paper beyond being the antecedent motivating SPOCK.",
            "comparison_to_human_discoveries": null,
            "comparison_details": "Mentioned as prior work; SPOCK claims improved generality, longer horizon, and better handling of unequal masses and near-resonant dynamics compared to the 2016 prototype.",
            "success_rate": "",
            "challenges_limitations": "Described implicitly: the prototype assumed equal-mass planets and shorter prediction horizon (10^7 orbits), and performed poorly near MMRs compared to the resonant-variable-informed approach used in SPOCK.",
            "has_incremental_transformational_comparison": false,
            "uuid": "e1437.1",
            "source_info": {
                "paper_title": "Predicting the long-term stability of compact multiplanet systems",
                "publication_date_yy_mm": "2020-07"
            }
        }
    ],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "A machine learns to predict the stability of tightly packed planetary systems.",
            "rating": 2
        },
        {
            "paper_title": "A machine learns to predict the stability of circumbinary planets.",
            "rating": 2
        },
        {
            "paper_title": "The stability of tightly-packed, eventy-spaced systems of earth-mass planets orbiting a sun-like star.",
            "rating": 1
        },
        {
            "paper_title": "An Integrable Model for the Dynamics of Planetary Mean-motion Resonances.",
            "rating": 1
        }
    ],
    "cost": 0.013930749999999999,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>Predicting the long-term stability of compact multiplanet systems</h1>
<p>Daniel Tamayo ${ }^{\mathrm{a}, 1,2}$, Miles Cranmer ${ }^{\mathrm{a}}$, Samuel Hadden ${ }^{\mathrm{b}}$, Hanno Rein ${ }^{\mathrm{c}, \mathrm{d}}$, Peter Battaglia ${ }^{\mathrm{c}}$, Alysa Obertas ${ }^{\mathrm{d}, 1}$, Philip J. Armitage ${ }^{\mathrm{e}, \mathrm{h}}$, Shirley Ho ${ }^{\mathrm{h}, \mathrm{a}, 1}$, David Spergel ${ }^{\mathrm{h}}$, Christian Gilbertson ${ }^{1}$, Naireen Hussain ${ }^{\mathrm{d}}$, Ari Silburt ${ }^{\mathrm{j}, \mathrm{c}, \mathrm{d}}$, Daniel Jontof-Hutter ${ }^{\mathrm{k}}$, and Kristen Menou ${ }^{\mathrm{s}, 3,1}$<br>${ }^{a}$ Department of Astrophysical Sciences, Princeton University, Princeton, New Jersey 08544, USA; ${ }^{\text {b }}$ Center for Astrophysics | Harvard \&amp; Smithsonian, 60 Garden St., MS 51, Cambridge, MA 02138, USA; ${ }^{\text {c }}$ Department of Physical and Environmental Sciences, University of Toronto at Scarborough, Toronto, Ontario M1C 1A4, Canada; ${ }^{d}$ David A. Dunlap Department of Astronomy and Astrophysics, University of Toronto, Toronto, Ontario, M5S 3H4, Canada; ${ }^{e}$ Google DeepMind, London, UK; ${ }^{f}$ Canadian Institute for Theoretical Astrophysics, University of Toronto, Toronto, Ontario, M5S 3H8, Canada; ${ }^{g}$ Department of Physics and Astronomy, Stony Brook University, Stony Brook, NY 11790, USA; ${ }^{h}$ Center for Computational Astrophysics, Flatiron Institute, New York, NY 10010, USA; ${ }^{i}$ Department of Physics, Carnegie Mellon University, Pittsburgh, PA 15217, USA; ${ }^{j}$ Department of Astronomy and Astrophysics, The Pennsylvania State University, University Park, PA 16802, USA; ${ }^{k}$ Department of Physics, University of the Pacific, Stockton, CA 95211, USA; ${ }^{1}$ Department of Physics, University of Toronto, 60 St George Street, Toronto, Ontario, M5S 1A7, Canada</p>
<p>Received for review January 22, 2020. Accepted June 15th, 2020. Published week of July 13th, 2020. arXiv compiled Jul 13, 2020. NOT ACTUAL PNAS ARTICLE</p>
<p>We combine analytical understanding of resonant dynamics in twoplanet systems with machine learning techniques to train a model capable of robustly classifying stability in compact multi-planet systems over long timescales of $10^{6}$ orbits. Our Stability of Planetary Orbital Configurations Klassifier (SPOCK) predicts stability using physically motivated summary statistics measured in integrations of the first $10^{4}$ orbits, thus achieving speed-ups of up to $10^{5}$ over full simulations. This computationally opens up the stability constrained characterization of multi-planet systems. Our model, trained on $\approx 100,000$ three-planet systems sampled at discrete resonances, generalizes both to a sample spanning a continuous period-ratio range, as well as to a large five-planet sample with qualitatively different configurations to our training dataset. Our approach significantly outperforms previous methods based on systems' angular momentum deficit, chaos indicators, and parametrized fits to numerical integrations. We use SPOCK to constrain the free eccentricities between the inner and outer pairs of planets in the Kepler-431 system of three approximately Earth-sized planets to both be below 0.05. Our stability analysis provides significantly stronger eccentricity constraints than currently achievable through either radial velocity or transit duration measurements for small planets, and within a factor of a few of systems that exhibit transit timing variations (TTVs). Given that current exoplanet detection strategies now rarely allow for strong TTV constraints (Hadden et al., 2019), SPOCK enables a powerful complementary method for precisely characterizing compact multiplanet systems. We publicly release SPOCK for community use.</p>
<p>Exoplanets | Orbital Dynamics | Chaos | Machine Learning</p>
<p>Isaac Newton, having formulated his law of gravitation, recognized that it left the long term stability of the Solar System in doubt. Would the small near-periodic perturbations the planets exert on one another average out over long timescales, or would they accumulate until orbits cross, rendering the system unstable to planetary collisions or ejections?</p>
<p>The central difficulty arises from the existence of resonances, where there is an integer ratio commensurability between different frequencies in the system. These resonances complicate efforts to average the dynamics over long timescales. Work on this problem culminated in the celebrated KomolgorovArnold-Moser (KAM) theorem [Kolmogorov, 1954, Möser, 1962, Arnol'd, 1963], which guarantees the existence of stable, quasiperiodic trajectories below a specified perturbation strength. Unfortunately, the KAM theorem is generally not informative in this context, since it typically can only guaran-
tee stability for masses far below the planetary regime [Hénon, 1966, Celletti and Chierchia, 2005].</p>
<p>Without a clear path to a full solution, we focus on the limit of closely separated planets. This regime has important applications for understanding the orbital architectures of planetary systems beyond our own (exoplanets), since strong observational biases toward detecting planets close to their host star result in compact populations of observed multiplanet systems<em>. In these dynamically delicate configurations, it is possible for most of the orbital solutions inferred from noisy data to undergo violent dynamical instabilities when numerically integrated forward in time for even $0.1 \%$ of the system's age [Mills et al., 2016, Gillon et al., 2017]. Since one does not expect to discover most systems just prior to such a cataclysm, this offers an opportunity to constrain the masses and orbital parameters of such planets by rejecting configurations that lead to rapid instability. In this way, previous authors have performed direct numerical (N-body) integrations to narrow down physical orbital architectures and formation histories for important exoplanet discoveries [e.g.,
</em>We henceforth define compact $3+$ planet systems as having at least one trio of planets with period ratios between adjacent planets $&lt;2$. This currently represents $\approx 40 \%$ of all observed $3+$ planet systems.</p>
<h2>Significance Statement</h2>
<p>Observations of planets beyond our solar system (exoplanets) yield uncertain orbital parameters. Particularly in compact multi-planet systems, a significant fraction of observationally inferred orbital configurations can lead to planetary collisions on timescales short compared to the age of the system. Rejection of these unphysical solutions can thus sharpen our view of exoplanetary orbital architectures. Long-term stability determination is currently performed through direct orbital integrations. However, this approach is computationally prohibitive for application to the full exoplanet sample. By speeding up this process by up to five orders of magnitude, we enable precise exoplanet characterization of compact multi-planet systems and our ability to examine the stability properties of the multi-planet exoplanet sample as a whole.</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>Steffen et al., 2013, Tamayo et al., 2015, Wang et al., 2018, Quarles et al., 2017, Tamayo et al., 2017].</p>
<p>However, given the high dimensionality of parameters, the computational expense of such long-term integrations typically results in only a small fraction of candidate orbital configurations being explored, and integration timespans being many orders of magnitude shorter than the typical Gyr ages of such systems [e.g., Rivera et al., 2010, Jontof-Hutter et al., 2014, Buchhave et al., 2016, Mills et al., 2016, Tamayo et al., 2017, Quarles et al., 2017, Hadden and Lithwick, 2017, Grimm et al., 2018]. This renders the widespread application of such constraints to the ever-growing exoplanet sample orders of magnitude beyond computational reach.</p>
<p>Extensive previous work has narrowed down the particular resonances responsible for dynamical instabilities in compact systems. In particular, analytical studies of tightly spaced twoplanet systems [Wisdom, 1980, Deck et al., 2013, Hadden and Lithwick, 2018] have shown that the chaos is driven specifically by the interactions between mean motion resonances (MMRs), i.e., integer commensurabilities between planets' orbital periods. The limited number of available MMRs in two-planet systems implies that for initially circular orbits, there exists a critical, mass-dependent separation between the two bodies. For planetary separations below this limit, MMRs are close enough to one another in phase space to overlap and drive rapid instabilities [Wisdom, 1980, Deck et al., 2013], and there is a sharp transition to long-lived configurations beyond it. This result has recently been generalized for eccentric orbits [Hadden and Lithwick, 2018].</p>
<p>By contrast in 3+ planet systems, instabilities can occur for separations between adjacent planet pairs significantly beyond the above two-planet limit, and instability times exhibit a continuous and much larger dynamic range [Chambers et al., 1996]. Previous work has argued that this can not be solely explained by the larger number of available MMRs between all possible pairs of planets [Quillen, 2011, Quillen and French, 2014]. These authors argue that three-body resonances, i.e., integer combinations between the periods of three bodies are responsible for "filling in the space" between two-body MMRs and driving instabilities over a continuous range of separations.</p>
<p>But while a clearer physical picture is emerging, theoretical estimates can not yet quantitatively match the results from numerical integrations [Quillen, 2011]. Many previous numerical studies have instead presented empirical fits to the overall steep rise in instability times with interplanetary separation, recorded from large suites of numerical integrations [Chambers et al., 1996, Yoshinaga et al., 1999, Marzari and Weidenschilling, 2002, Zhou et al., 2007, Faber and Quillen, 2007, Smith and Lissauer, 2009, Matsumoto et al., 2012, Pu and Wu, 2015]. This is a useful approach for elucidating the underlying dynamics and scalings with dominant parameters, but typically involves simplifications such as equal-mass, or equal-separation planets. This limitation, together with modulations near MMRs on overall trends in instability times of up to five orders of magnitude [Obertas et al., 2017], lead to quantitative disagreements between such studies, and render them inadequate for accurately characterizing real multiplanet systems (see Sec. 3).</p>
<p>Here, we present a machine learning model that can reliably classify the stability of compact $3+$ planet configurations over $10^{9}$ orbits. Our model, the Stability of Planetary Orbital Con-
figurations Klassifier (SPOCK), is up to $10^{5}$ times faster than direct integration, computationally opening up the stability constrained characterization of compact multi-planet systems.</p>
<h2>1. Previous Models</h2>
<p>Previous numerical efforts to predict the instability times of various orbital configurations can roughly be broken down into four groups:
A. N-body. The most straightforward (and computationally costly) method is to run a direct numerical integration. A $10^{9}$ orbit integration with a timestep of $3.5 \%$ of the innermost planet's orbital period takes $\approx 7 \mathrm{CPU}$ hours on a 2.1 GHz Intel Xeon Silver 4116 using the WRFast integrator [Rein and Tamayo, 2015].</p>
<p>Interestingly, even this answer will not be perfect. The fact that planetary systems are chaotic means that a given initial condition should not be considered to have a single instability time. Rather, an N-body integration can be interpreted as sampling a single instability time from a broader distribution of values. If one numerically characterizes the distribution of these instability times, one finds that, for compact systems destabilizing within $10^{9}$ orbits, they are approximately lognormally distributed, with a uniform standard deviation of $\approx 0.4$ dex [Hussain and Tamayo, 2019, Rice et al., 2018]. To empirically quantify this fundamental limit to predictability, for each of the integrations in our training dataset, we have run a second "shadow integration" of the same initial conditions offset by one part in $10^{-11}$. This represents an independent draw from that initial condition's instability time distribution. There will thus be cases where one integration says the configuration is stable, while the other one does not. The existence of these uncertain outcomes sets the fundamental limit any stability classifier can hope to reach.
B. Hill. Several previous studies have fit functional forms to instability times recorded in large suites of N-body integrations [e.g., Chambers et al., 1996, Marzari and Weidenschilling, 2002, Faber and Quillen, 2007, Smith and Lissauer, 2009, Obertas et al., 2017]. They found that instability times rise steeply with increasing interplanetary separation measured in mutual Hill radii, i.e., the characteristic radius around the planets in which their gravity dominates that of the star [see also Quillen, 2011, Yalinewich and Petrovich, 2019],</p>
<p>$$
R_{H}=a_{i}\left(\frac{m_{i}+m_{i+1}}{M_{\star}}\right)^{1 / 3}
$$</p>
<p>where $a_{i}$ is the semimajor axis of the inner planet in the pair, $m_{i}$ and $m_{i+1}$ are the respective planet masses, and $M_{\star}$ is the stellar mass ${ }^{1}$. While this provides insight into the underlying dynamics [Quillen, 2011, Yalinewich and Petrovich, 2019], other orbital parameters also strongly influence stability. Follow-up studies have considered the effects of finite eccentricities and inclinations [e.g., Yoshinaga et al., 1999, Zhou et al., 2007, Funk et al., 2010, Wu et al., 2019], but make various simplifying assumptions (e.g., equal interplanetary separations</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>and eccentricities). Different assumptions lead to quantitative disagreements between different studies, and the reliability of their predictions to real systems, where all planets have independent orbital parameters, is unclear.
C. AMD. A classical result in orbital dynamics is that if the effects of MMRs are removed, then planets will exchange angular momenta at fixed semimajor axes [Murray and Dermott, 1999]. Instabilities can still arise under these so-called secular dynamics, through chaos introduced by the overlap of resonances between the slower set of frequencies at which the orbits and their corresponding orbital planes precess [Lithwick and Wu, 2011, Batygin et al., 2015]. In this approximation, there is a conserved quantity [Laplace, 1784, Laskar, 1990], termed the Angular Momentum Deficit (AMD). The AMD acts as a constant reservoir of eccentricity and inclination that the planets can exchange among one another. If the AMD is too small to allow for orbit crossing and collisions even in the worst case where all the eccentricity is given to one adjacent pair of planets, the system is AMD stable [Laskar, 2000, Laskar and Petit, 2017]. This is a powerful and simple analytic criterion, but it has two important caveats. First, because it is a worst-case-scenario estimate, it yields no information on instability timescales for AMD unstable systems. For example, the Solar System is AMD unstable, but most integrations $(\approx 99 \%)$ of the Solar System nevertheless remain stable over the Sun's main sequence lifetime [Laskar and Gastineau, 2009]. Second, the assumed secular model of the dynamics ignores the effects of MMRs, which for closely packed systems are typically nearby [e.g., Migaszewski et al., 2012], and are an important source of dynamical chaos [for a generalization of AMD stability in the presence of MMRs in the two-planet case, see Petit et al., 2017].
D. MEGNO. Several authors have also used chaos indicators numerically measured from short integrations as a proxy for instability [Migaszewski et al., 2012, Marzari, 2014]. This is appealing given that systems that go unstable typically exhibit chaotic dynamics on shorter timescales. A widely used chaos indicator is the Mean Exponential Growth factor of Nearby Orbits, or MEGNO [Cincotta et al., 2003]. However, a planetary system can be chaotic yet never develop destructive instabilities on astrophysically relevant timescales. Additionally, and most importantly, short integrations will fail to measure chaos on timescales longer than those simulated, potentially misclassifying systems that destabilize on long timescales.</p>
<h2>2. Predicting Long-Term Stability</h2>
<p>Point-source Newtonian gravity is scale invariant. We exploit this fact by expressing all masses relative to that of the central star, and all times and distances in units of the innermost planet's orbital period and semimajor axis, respectively.</p>
<p>Non-dimensionalizing timescales in this way is important when comparing systems with different absolute ages. For example, the $\sim 40$ Myr age of the HR 8799 planets, with an innermost orbital period of $\approx 40$ yrs, only represents $10^{6}$ orbits [Wang et al., 2018]. For these short timescales, numerical integrations ${ }^{1}$ are within reach, and SPOCK is not needed [Wang et al., 2018].
${ }^{1}$ Computation time scales linearly with the number of orbits and requires $\approx 1 /$ ts per million orbits with optimized algorithms [Wadom and Holman, 1991] and current hardware.</p>
<p>However, young multi-planet systems with long orbital periods are currently exceedingly rare in the exoplanet sample. Population statistics and strong observational biases result in a multi-planet sample predominantly with innermost orbital periods of $\approx 0.01-0.1$ yrs, around stars that are several Gyr old. We are thus most often interested in stability over timescales of $10^{11}-10^{12}$ orbits, which are computationally prohibitive for the number of candidate orbital configurations that typically require evaluation.</p>
<p>One approach would be to frame the task as a regression problem and predict an instability time for a given initial configuration. However, given that most systems have large dynamical ages $&gt;10^{11}$ orbits, for many applications one is simply interested in a binary classification between short-lived and long-term stable systems. We therefore pursue a simpler binary classifier here, and defer a regression algorithm to future work (Cranmer et al., in prep.).</p>
<p>Any binary stability classification must specify a timescale, and we choose a value of $10^{9}$ orbits. Exoplanet systems may indeed continually undergo instabilities and restructurings over their lifetimes [e.g., Volk and Gladman, 2015, Pu and Wu, 2015]. In such a situation, the quick removal of short-lived configurations naturally leaves systems with instability times comparable to their ages [Laskar, 1990]. In that case, requiring stability over $10^{11}$ orbits in a comparably aged system could potentially throw out the true orbital configuration. However, one could still reasonably reject configurations that destabilize within $&lt;10^{6}$ orbits, given the low likelihood of finding a system within $&lt;1 \%$ of its lifetime of going unstable. Following previous authors [Smith and Lissauer, 2009, Obertas et al., 2017], we define instability as when a pair of planets start crossing their sphere of gravitational influence (see Materials and Methods).</p>
<p>For the remainder of the paper we refer to configurations that survive $10^{9}$ orbits as stable, and ones that do not as unstable.
A. Training SPOCK. We frame our task as a supervised machine learning problem. We begin by generating a large suite of $\approx 100,000$ initial conditions (described below), and perform the computationally expensive numerical integrations over $10^{9}$ orbits to empirically label each example as stable or unstable (see Sec. B). We take $80 \%$ of these examples as a training set for our classifier, and use the remaining $20 \%$ as a holdout set to test for potential overfitting with examples that were never encountered during training (Sec. A).</p>
<p>The input to SPOCK is then a complete initial orbital configuration: stellar and planetary masses, along with 6 orbital elements or positions and velocities for each of the planets. Our strategy for making a stability prediction is to first to run a computationally inexpensive integration of only $10^{4}$ orbits and, from this short snippet, numerically measure dynamically informative quantities (see Sec. C). Given that the machine learning model evaluation is effectively instantaneous, this represents a speedup factor of up to $10^{5}$. This feature engineering step allows us to take a high dimensional set of inputs and reduce it to ten features that more compactly encode our partial understanding of the dynamics. We then train a machine learning classifier to take this set of summary features as input to predict the probability that the system is stable over $10^{6}$ orbits. This is illustrated in Fig. 1.</p>
<p>Following a previous proof of concept [Tamayo et al., 2016],</p>
<p><img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Fig. 1. A schematic illustrating how SPOCK classifies stability of a given initial configuration. The traditional approach numerically integrates the system for $10^{9}$ orbits, requiring roughly 10 hours with current hardware. SPOCK runs a much shorter $10^{4}$ orbit integration, and from it generates a set of 10 summary features (see Table 1). These map to a point (white circle) in a 10-dimensional space, in which we have trained an XGBoost model to classify stability. SPOCK outputs an estimated probability that the given system is stable over $10^{9}$ orbits, up to $10^{5}$ times faster than direct integration.
we use the gradient-boosted decision tree algorithm XGBoost [Chen and Guestrin, 2016]. We found it significantly outperformed simple random forest and support vector machine implementations. However, the specific choice of XGBoost was not critical. In an early comparison, we found similar results training a deep neural network (multi-layer perceptron) on the same features (see also Lam and Kipping [2018] for an application to circumbinary planets). The most important factor for performance was the adopted set of summary metrics. We are also exploring using deep learning to generate new features from the raw time series (Cranmer et al., in prep).</p>
<p>Going beyond exploratory machine learning models [Tamayo et al., 2016] to a robust classifier applicable to observed compact systems required several qualitative changes. First, we relax their assumption of equal-mass planets, and we extend their horizon of stability prediction ( $10^{7}$ orbits) by a factor of one hundred to a relevant timescale for real systems. Second, previous work [Wisdom, 1980, Quillen, 2011, Deck et al., 2013] suggests that instabilities in compact systems are driven by the overlap of MMRs. Rather than sampling phase space uniformly like Tamayo et al. [2016], we therefore choose to generate our training dataset of three-planet systems in and near such MMRs. This fills in our training sample at the locations in phase space where the dynamical behavior is changing most rapidly, and we suspect this identification of the dominant dynamics is partially responsible for the excellent generalization to more general systems presented in Sec. B and C. Fig. 2 shows our training set, plotting the period ratio between the inner two planets against that of the outer two planets.</p>
<p>Finally, the sharp changes in dynamics at each resonance (narrow lines visible in Fig. 2) make predictions challenging in the space of traditional orbital elements (orbital periods, eccentricities, etc.). Indeed, we found that the model of Tamayo et al. [2016] performed poorly near MMRs. In this study, we exploit analytical transformations [Sessin and Ferraz-Mello, 1984, Hadden, 2019] that isolate the effect of a particular resonance between a single pair of planets (Materials and Methods). This allows us to both effectively sample the appropriate ranges in period ratios and other orbital elements (like eccentricities) not visible in the projection of Fig. 2, and to calculate several summary features in this smoother transformed space that makes predictions simpler than in the original sharply punctuated space of Fig. 2 (see Sec. C).
<img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Fig. 2. Training dataset of three-planet systems in and near mean motion resonances (MMRs), which we posit drive instabilities in most compact multiplanet systems [Wisdom, 1980, Quillen, 2011, Obertas et al., 2017]. These cluster in lines at integer period ratios between adjacent planets. The lifetimes of configurations within each of those lines can vary drastically depending on additional parameters (masses, eccentricities, phases) not visible in this projection, causing stable (blue) and unstable (red) systems to overlap.</p>
<p>B. Training set. The two-planet case is analytically solvable [Wisdom, 1980, Deck et al., 2013, Hadden and Lithwick, 2018], while for $3+$ planet systems there is a qualitative change toward a continuous range of instability times over wider interplanetary separations [Chambers et al., 1996]. We posit that instabilities driven by MMR overlap in higher multiplicity systems can be approximated by considering only adjacent planet trios. Our training set thus consists only of compact three-planet systems, and we later test the trained model's generalization to higher multiplicity systems (Sec. C). This is an important empirical test since, if true, it implies a robustness of our stability classifications to distant unseen planets. This is crucial for reliable stability constrained characterization of exoplanet systems, and is consistent with previous numerical experiments with equal separation planets showing an insensitivity to additional bodies beyond somewhat larger multiplicities of five [Chambers et al., 1996], as well as theoretical arguments showing that the Fourier amplitudes of the perturbation potential due to an additional planet fall off exponentially with separation [Quillen, 2011, Yalinewich and Petrovich, 2019].</p>
<p>To enable application to real systems, we sample unequalmass unequal-separation, mutually inclined, eccentric initial orbital three-planet configurations for our training set, drawing from parameter ranges typically encountered in the current multiplanet sample.</p>
<p>In particular, the vast majority of $3+$ planet systems have been discovered by the Kepler and K2 missions as the bodies pass in front of (transit) their host star.</p>
<p>This implies that nearly all such systems must be approximately co-planar; otherwise the planets would not all cross in front of the star from our vantage point [e.g., Fabrycky et al., 2014]. We therefore sample inclinations (log-uniformly and independently) from a narrow range of $\left[10^{-3}, 10^{-1}\right]$ radians (where the upper limit has been extended somewhat beyond the mutual inclinations typically inferred to also allow the modeling of additional (unobserved) non-transiting planets). The azimuthal orientations of the orbital planes (i.e., the longitudes of the ascending nodes) were drawn uniformly from $[0,2 \pi]$. This corresponds to maximum mutual orbital inclinations of $\approx 11^{\circ}$.</p>
<p>Most planets $(\approx 85 \%)$ in the current sample of compact $3+$ planet systems, where stability constraints are most informative, are smaller than Neptune. We therefore choose to independently and log-uniformly sample mass ratios to the central star from $10^{-4}(\approx 2 \times$ that of Neptune to the Sun) down below the typical threshold of detectability to $10^{-7}(\approx$ $1 / 3$ that of Mars to the Sun).</p>
<p>Any measure of dynamical compactness must incorporate these planetary masses. This is often expressed in terms of the separations between adjacent planets in units of their mutual Hill radius (Eq. 1). We always initialize the innermost planet's semimajor axis at unity (since as mentioned above we work in units of the innermost semimajor axis), and choose to sample the separations between adjacent planets in the range from $[0,30] R_{H}$. This encompasses $\approx 80 \%$ of the currently known planets in well characterized $3+$ planet systems [Weiss et al., 2018]. For scale, $30 R_{H}$ also roughly corresponds to the wider dynamical separation between the terrestrial planets in our Solar System.</p>
<p>In particular, we randomly choose a planet pair (inner,
outer or non-adjacent), and randomly sample their remaining orbital parameters in or near a randomly chosen MMR within $30 R_{H}$ as described in detail in Materials and Methods. Finally, we draw the remaining planet's separation from its nearest neighbor uniformly in the range $[0,30] R_{H}$. This gives rise to the extended lines in Fig. 2. Two of the planets are initialized at a particular resonant ratio (e.g., $3 / 2$ on the x -axis), while the third planet's period can span a continuous range across different configurations and is not necessarily strongly influenced by MMRs.</p>
<p>Orbital eccentricities and phases for the resonant pair are described in Materials and Methods, while the third planet's orbital eccentricity is drawn log-uniformly between the characteristic eccentricities imparted when inner planets overtake their outer neighbors (approximated as the ratio of the interplanetary forces to the central force from the star), and the nominal value at which adjacent orbits would cross</p>
<p>$$
e_{\text {cross }}=\left(a_{i+1}-a_{i}\right) / a_{i+1}
$$</p>
<p>Pericenter orientations and phases along the orbit for the remaining planet are drawn uniformly from $[0,2 \pi]$. Finally, we reject any configurations that destabilize within $10^{4}$ orbits. We refer to this dataset of 113,543 systems as the "resonant dataset".
C. Machine Learning Model. We have a choice of what set of features about each system to pass the XGBoost classifier. For example, one could fully characterize a system by passing each planet's mass ratio with the star and its initial Cartesian positions and velocities. But presumably it would be easier for the algorithm if one transformed those initial conditions to more physical parameters, like the orbital elements (semimajor axis, eccentricity, etc.). We instead choose to run a computationally inexpensive integration over $10^{4}$ orbits and numerically measure ten dynamically relevant quantities at 80 equally spaced outputs.</p>
<p>We experimented with different lengths of integrations and number of outputs. Given an integration time series, our implementation takes a few tenths of a second to compute the summary features and evaluate the XGBoost model. This is about the time required to run $10^{4}$ orbits through N-body, so given this fixed overhead, there is no computational gain in running a shorter integration. We found that the performance gain from longer integrations was marginal, but if the feature and model evaluations were optimized (e.g., ported to C), a more careful optimization of these parameters could be valuable.</p>
<p>For our first two features, we store the median of the MEGNO chaos indicator [Cincotta et al., 2003] (over the last $10 \%$ of the short integration) and its standard deviation (over the last $80 \%$ of the time series to avoid initial transients) as MEGNO and MEGNOstd, respectively. We also record the initial values EMcross of $e_{\text {cross }}$ (Eq. 2) for each adjacent planet pair, and we use the smallest value to identify one adjacent pair of planets as 'near' and the other as 'far' for these and all remaining features.</p>
<p>The remaining six summary statistics capture the resonant dynamics. In particular, in the near-resonant two-planet limit, only one particular combination of the eccentricities (approximately their vector difference, see Materials and Methods) matters [Sessin and Ferraz-Mello, 1984, Hadden, 2019],</p>
<p>$$
\mathbf{e}<em i_1="i+1">{-} \equiv \mathbf{e}</em>
$$}-\mathbf{e}_{i</p>
<p>where $\mathbf{e}_{i}$ is a vector pointing toward the $i$-th planet's orbital pericenter, with a magnitude given by the orbital eccentricity.</p>
<p>Two of our summary features (one for each adjacent planet pair) are the standard deviation of $|\mathbf{e}_{-}|$over the timespan of the short $10^{4}$ orbit integration, which we normalize through Eq. 2 to the value required for that planet-pair to cross. Qualitatively, this can help the classifier differentiate between configurations that oscillate close to a resonant equilibrium (small variations) and are dynamically protected by the MMR, versus configurations far from equilibrium where the MMR induces large-amplitude, often destabilizing, variations.</p>
<p>For each adjacent planet pair, we also search for the strongest j:j-k MMR within $3 \%$ of the pair's period ratio, and record its non-dimensionalized strength,</p>
<p>$$
s=\sqrt{\frac{m_{i}+m_{i+1}}{M_{\star}}} \frac{\left(e_{-} / e_{\text {cross }}\right)^{k / 2}}{\left(j n_{i+1}-(j-k) n_{i}\right) / n_{i}}
$$</p>
<p>where the $m_{i}$ are the planet masses, and the $n_{i}$ are the orbital mean motions ( $n_{i}=2 \pi / P_{i}$ with $P_{i}$ as the orbital periods). This is the appropriate expression when linearizing the dynamics, omitting a period-ratio-dependent prefactor that is comparable for all the nearby resonances [Hadden, 2019]. It is thus adequate for identifying the strongest nearby MMR, and we store its median value over the short integration as MMRstrengthnear and MMRstrengthfar.</p>
<p>Finally, we record the standard deviation of $\left|\mathbf{e}<em -="-">{+}\right|$, a complementary combination of eccentricities to $\mathbf{e}</em>}$that is approximately conserved [Sessin and Ferraz-Mello, 1984, Hadden, 2019] in the single resonance, two-planet model (see Materials and Methods). Providing SPOCK with the variation of this putatively conserved $\left|\mathbf{e<em _="+">{+}\right|$variable quantifies the validity of our simple analytic model. In particular, the analytical transformation is useful along isolated lines in Fig. 2, where a single resonance dominates the dynamics. The transformation breaks down (and $\left|\mathbf{e}</em>\right|$can vary significantly) at locations where resonances cross and more than one resonance drives the dynamics, as well as in the blank space between resonances in Fig. 2. However, these are typically also the easier regions to classify. Line crossings are regions where resonances are typically strongly overlapped to drive rapid chaos [Chirikov, 1979], and the dynamics vary more smoothly in the regions between strong resonances. The complementarity and flexibility of these ten features allow SPOCK to reliably classify stability in a broad range of compact configurations.</p>
<p>We calculate these 10 features (summarized in Table 1) for all initial conditions in our resonant dataset and then use them to train a gradient-boosted decision tree XGBoost model [Chen and Guestrin, 2016]. We adopt an $80 \%-20 \%$ train-test split, performing five-fold cross-validation on the training set. We optimized hyperparameters to maximize the area under the ROC curve (AUC, Fig. 3) using the hyperopt package [Bergstra et al., 2013]. We provide our final hyperparameter values and ranges sampled in a jupyter notebook in the accompanying repository, which trains the model.</p>
<p>In Table 1 we also list the relative feature importances in our final model, which measure the occurrence frequency of different features in the model's various decision trees. All provide comparable information, partially by construction. We started with a much wider set of 60 features, iteratively removing less important ones. This marginally decreased the performance of our final classifier, but this is compensated by the improved</p>
<p>Table 1. Summary features in our trained model, ranked by their relative importance (see Sec. 2C for discussion). The smallest value of EMcross is used to label one adjacent pair of planets as 'near' and the other as 'far'.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Feature Name</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Importance</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">EMcrossnear</td>
<td style="text-align: left;">Initial orbit-crossing $e_{-}$value</td>
<td style="text-align: left;">6844</td>
</tr>
<tr>
<td style="text-align: left;">MMRstrengthnear</td>
<td style="text-align: left;">Median strength of nearest MMR</td>
<td style="text-align: left;">6568</td>
</tr>
<tr>
<td style="text-align: left;">MMRstrengthfar</td>
<td style="text-align: left;">Median strength of nearest MMR</td>
<td style="text-align: left;">6392</td>
</tr>
<tr>
<td style="text-align: left;">EPstdnear</td>
<td style="text-align: left;">Stdev of $e_{+}$mode</td>
<td style="text-align: left;">6161</td>
</tr>
<tr>
<td style="text-align: left;">EMRracstdfar</td>
<td style="text-align: left;">Stdev of $e_{-}$mode / EMcross</td>
<td style="text-align: left;">5815</td>
</tr>
<tr>
<td style="text-align: left;">EMRracstdnear</td>
<td style="text-align: left;">Stdev of $e_{-}$mode / EMcross</td>
<td style="text-align: left;">5509</td>
</tr>
<tr>
<td style="text-align: left;">EMcrossfar</td>
<td style="text-align: left;">Initial orbit-crossing $e_{-}$value</td>
<td style="text-align: left;">5077</td>
</tr>
<tr>
<td style="text-align: left;">EPstdfar</td>
<td style="text-align: left;">Stdev of $e_{+}$mode</td>
<td style="text-align: left;">5009</td>
</tr>
<tr>
<td style="text-align: left;">MEGNOstd</td>
<td style="text-align: left;">Stdev of chaos indicator</td>
<td style="text-align: left;">4763</td>
</tr>
<tr>
<td style="text-align: left;">MEGNO</td>
<td style="text-align: left;">Chaos indicator</td>
<td style="text-align: left;">4350</td>
</tr>
</tbody>
</table>
<p>interpretability of our simplified feature set. While the feature importances are close enough that one should not overinterpret their relative values, it is clear that the resonant features are providing important dynamical information.</p>
<h2>3. Results</h2>
<p>A. Holdout Set Performance. The accuracy of any classifier depends on the dataset. For example, it would be much harder to determine stability over $10^{9}$ orbits on a set of configurations right at the boundary of stability, which all went unstable between $10^{8}-10^{10}$ orbits, than on a dataset of configurations that either go unstable within $10^{3}$ or survived beyond $10^{15}$ orbits. Thus, to avoid any straw-man comparisons to previous work, we follow a parallel process of training an XGBoost model using the quantities (features) considered by previous authors. This allows each model to optimize its thresholds for the training set at hand, providing a fair comparison. In particular, for 'N-body,' we ask the XGBoost model to predict stability based on the instability time measured in the shadow integration (Sec. 1A). For 'MEGNO,' we measure the chaos indicator over the same short $10^{4}$ orbit integration as our model and pass this as a single feature to a separate XGBoost model. For 'AMD,' we train on two features: the system's total AMD as a fraction of the critical AMD needed for a collision between each pair of adjacent planets [Laskar and Petit, 2017]. Finally, for 'Hill,' we train an XGBoost model on the separations between adjacent planets as a fraction of their mutual Hill sphere radius (Eq. 1).</p>
<p>Using a holdout test set of $\approx 20,000$ integrations, we present in Fig. 3 the various models' Receiver Operator Characteristic (ROC) curves. ROC curves plot the classifiers' true-positive rate (TPR, the fraction of stable systems correctly identified) vs. the false-positive rate (FPR, the fraction of unstable systems incorrectly labeled as stable). Each model returns an estimated probability of stability and can trade off TPR vs. FPR by adjusting its threshold for how conservative it is before it labels a system as stable. A perfect model would lie in the top left corner, and random guessing would follow the dashed black line.</p>
<p>Different applications will have different requirements. For example, stability considerations could be important in inferring the underlying multiplicity distribution of planets in multi-planet systems detected using short time baselines of observation (e.g., with the TESS mission). In that limit it</p>
<p><img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Fig. 3. Comparison of the performance of SPOCK against previous models on a holdout test set from our training data (Materials and Methods). Plots True Positive Rate (TPR: fraction of stable systems correctly classified) vs. False Positive Rate (FPR: fraction of unstable systems misclassified as stable). All models can trade off TPR vs. FPR by adjusting their threshold for how conservative to be before labeling a system as stable. The area under the curve (AUC) for each model is listed in the legend in parentheses. A perfect model would have a value of unity, and random guessing (dashed black line) would have AUC=0.5. The blue N-body curve gives an empirical estimate of the best achievable performance on this dataset. At an FPR of 10%, SPOCK correctly classifies 85% of stable systems, MEGNO 49%, AMD 36%, and Hill 30%. For a discussion of the various models, see the main text.</p>
<p>becomes important to account for the fact that it becomes harder to stably fit higher multiplicity systems into a short observing window. Such studies estimate the underlying planet occurrences by correcting for various observation biases, typically injecting fake planetary systems into data to model the detection efficiency across the parameter range.</p>
<p>Injecting self-consistent, stable multi-planet configurations requires a low FPR. If a system is unstable, one wants to be confident that it will be labeled as unstable and thrown out of the analysis. If one decided that a 10% false-positive was acceptable, one could read off the corresponding TPR from Fig. 3. N-body would correctly label all stable systems, while SPOCK correctly identifies 85%. MEGNO, AMD, and Hill are not competitive, with TPR values ≤ 50%. MEGNO and SPOCK are roughly a factor of 10³ times faster than N-body, while AMD and Hill-sphere-separation models are effectively instantaneous since they are calculated directly from the initial conditions.</p>
<p>It is important to note that this is an unusually demanding test dataset, asking models to make predictions at sharp resonances where the dynamical behavior changes drastically with small changes in parameters (Fig. 2). In reality, our Solar System and most exoplanet systems are not close to such MMRs [Fabrycky et al., 2014], so one should expect the performance on typical systems to be better for all models than what is shown in Fig. 3. This approach of focusing on the most problematic resonant systems differs from the more uniform phase space coverage used in previous work, and we expect should yield more robust, generalizable models with fewer training examples. Conversely, the generalization of such a model trained at sharp resonances to the remaining phase space is a strong test of whether MMRs are indeed dominantly responsible for instabilities in compact planetary systems (see Sec. 3B).</p>
<p>We now consider why previous models performed poorly. First, while the Hill sphere separations are demonstrably important quantities [Chambers et al., 1996, Smith and Lissauer, 2009, Obertas et al., 2017], they do not carry any information on other important parameters like the orbital eccentricities. One therefore should not expect a simple two-parameter classifier to yield accurate predictions, particularly near resonances where the behavior depends sensitively on combinations of several different orbital elements.</p>
<p>Second, AMD stability has been shown to be useful in compact <em>two</em> planet systems [Laskar and Petit [2017], Petit et al. [2017], and can be related to the analytical Hill stability limit in such systems [Petit et al., 2018]. While it still retains important dynamical information in the 3+ planet case, we see that by itself it is a poor discriminant of stability. The most obvious problem given our MMR dataset is that AMD stability applies in the secular limit, where the effects of MMRs are ignored. As [Laskar and Petit, 2017, Hadden, 2019] argue, while MMRs alter the AMD, they tend to induce oscillations that average out over a resonant cycle. However, this is only true for an isolated MMR; once several resonances overlap and motions become chaotic, AMD is not necessarily conserved. While this is not a concern for two-planet systems in the AMD-stable region [Petit et al., 2018], our integrations show empirically that there are many opportunities for MMR overlap in compact systems with three or more planets, and AMD stability is no longer a stringent criterion.</p>
<p>One might argue that this is asking more from AMD stability than it offers, given that it is supposed to be a worst-case scenario estimate. It only guarantees stability if the total AMD is below the value needed for collisions. Above the critical AMD, collisions are <em>possible</em>, but AMD stability makes no prediction one way or another. However, even if we only consider the ≈ 19% of systems in our resonant test set that AMD guarantees are stable, only ≈ 49% actually are.</p>
<p>Finally, for the MEGNO model, a small fraction (≈ 2%) of the systems it found to be chaotic (taken as a value of MEGNO after 10⁴ orbits &gt; 2.5) are nevertheless stable. Even if a system is chaotic (i.e., nearby initial conditions diverge exponentially), it still needs enough time for the eccentricities to diffuse to orbit-crossing values. For example, the GJ876 system has a Lyapunov (chaotic) timescale of only about 7 years, despite the system being of order a billion years old [Batygin et al., 2015]. Determining that an orbit is chaotic is therefore strongly informative, but not sufficient to determine long-term stability. More problematically, 55% of the systems with MEGNO values consistent with being regular (non-chaotic) were, in fact, unstable. This is because MEGNO can only measure chaos on the timescale of the short integration, so systems with Lyapunov times longer than 10⁴ orbits can nevertheless go unstable and be misclassified by MEGNO alone. In summary, determining that an orbit is chaotic with MEGNO in a short integration is typically a reliable indicator that the system is not long-term stable, but a MEGNO value consistent with a regular orbit is not a robust measure of long-term stability.</p>
<p>By combining MEGNO with features capturing the MMR dynamics, SPOCK substantially improves on these previous models.</p>
<p><strong>B. Generalization to Uniformly Distributed Systems.</strong> An important concern with machine learning models is whether they will generalize beyond the training dataset. Since there are no</p>
<p><img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Fig. 4. Top panel shows the projection of our 'random' dataset of 25,000 configurations, uniformly sampling the separation between adjacent planets. This is more representative of discovered compact exoplanet systems than the resonant training dataset. Bottom panel is analogous to Fig. 3. At an FPR of 10%, SPOCK correctly classifies 94.2% of stable systems, despite having been trained on a different dataset of near-resonant configurations (Fig. 2).</p>
<p>Theoretical generalization bounds for modern techniques like decision trees and neural networks, measuring generalization to a holdout set and out-of-distribution data is essential. In particular, have they learned something meaningful about the underlying physics, or have they simply memorized the particulars of the training set? We perform two empirical tests.</p>
<p>First, we generate a complementary dataset of 25,000 uniformly sampled configurations, spanning a continuous range in period ratios, and not necessarily close to MMRs. This is more representative of typical exoplanet systems that have been discovered, with one important difference. We choose our sampling ranges to yield roughly a comparable number of stable and unstable configurations (≈ 40% were stable), while observed systems are naturally biased toward stable regions of phase space since unstable configurations are short-lived.</p>
<p>The procedure and parameter ranges are the same as in our training set, except we now sample all planets' orbital elements like we did the third planet above (separations uniform from [0,30] R<sub>H</sub>, eccentricities log-uniform up to the value at which orbits cross, and all phases uniformly from [0,2π]). We plot the projection of this "random dataset" into the space spanned by the Hill-radius separations between adjacent planets in the top panel of Fig. 4, where they uniformly fill the plane.</p>
<p>It is easier to predict stability on this dataset for at least two important reasons. First, most configurations are not particularly close to strong MMRs where the dynamical behavior changes sharply. Second, while in the resonant training dataset we restricted ourselves to systems that survived longer than our short integrations of 10<sup>4</sup> orbits, in reality many unstable configurations will be extremely short-lived. In our random dataset, we therefore allow for any instability time, which is more representative of typical applications. This will in particular significantly boost the performance of both the SPOCK and MEGNO models, since they will be able to confidently classify the configurations that go unstable within the span of their short integrations.</p>
<p>We plot the performance of all models (trained on the resonant dataset, Fig. 2) on our random dataset in Fig. 4. All models improve as expected, particularly SPOCK and MEGNO. At an FPR of 10%, N-body correctly classifies 99.8% of systems, SPOCK 94%, MEGNO 87%, AMD 74% and Hill 39%. Over the range of FPRs in Fig. 4, SPOCK correctly labels approximately half of the systems misclassified by MEGNO.</p>
<p>The fact that our SPOCK classifier, trained on a discrete set of near-resonant systems (Fig. 2) performs strongly on this uniform dataset supports our assertion that instabilities in compact multiplanet systems are dominantly driven by MMRs. If instead we let SPOCK train on 80% of our random dataset and test on the remaining 20%, the TPR quoted above only rises by ≈ 2%, suggesting our model can robustly classify a wide range of compact three-planet systems.</p>
<h3>C. Generalization To Higher Multiplicity Systems</h3>
<p>Influenced by previous work [Chambers et al., 1996], we hypothesized that the simplest case for understanding instabilities within 10<sup>9</sup> orbits in multi-planet systems is that of three planets. A natural question is therefore how well our model, trained on three-planet systems, generalizes to higher-multiplicity cases.</p>
<p>We test our model's generalization on previously published numerical integrations of five equal-mass planets on co-planar, equally spaced, and initially circular orbits [Obertas et al., 2017]. This is in stark contrast to our systems of three unequal-mass planets on mutually inclined, unevenly spaced, and eccentric orbits. Indeed, the integrations only varied the separation between adjacent planets, corresponding to a diagonal line from the bottom left to the top right of Fig. 2). This passes through the many intersections between vertical and horizontal MMR lines, where our analytic transformations (assuming the influence of only a single MMR) are most problematic. All other parameters were fixed, so there are very few examples in our much higher dimensional training set that fall near this 1-dimensional line, rendering it a particularly stringent test of our model. In particular, if SPOCK had simply memorized the particulars of our training set, it should not be able to effectively predict on systems drawn from a very different configuration distribution.</p>
<p>As a simple prescription for predicting stability on 4+ planet systems using SPOCK, we feed all adjacent trios to our three-planet classifier and retain the lowest stability probability. This is a simplification, but should provide a reasonable approximation in cases where instabilities are driven by perturbations on an MMR between a particular pair of planets. We argue this typically is the case in compact systems.</p>
<p>In Fig. 5, the top panel shows the instability time recorded by the 17500 N-body integrations of Obertas et al. [2017], plotted against the separation between adjacent planets (normalized by their mutual Hill radius (Eq. 1)). As above, we color-code systems that went unstable within 10<sup>9</sup> orbits as red, and stable systems as blue. While above we considered binary classification as stable or unstable, in the bottom panel we now plot the probability of stability estimated by SPOCK for each of the initial conditions in order to better visualize the model's sensitivity to the structure in instability times visible in the top panel (each point along any of the SPOCK ROC curves above corresponds to the TPR and FPR obtained when setting a particular stability probability threshold).</p>
<p>We see that SPOCK gives reliable results, despite having been trained on very different configurations of resonant and</p>
<p><img alt="img-4.jpeg" src="img-4.jpeg" /></p>
<p>Fig. 5. Generalization of SPOCK (trained on eccentric, inclined, unequally spaced, unequal-mass three-planet systems in and near MMRs) to integrations from Obertas et al. [2017] of initially circular, co-planar, equally spaced, equal-mass five-planet systems. The separation between all adjacent pairs of planets increases along the x-axis. Top panel shows the instability times measured by direct integration, with dips corresponding to MMRs [Obertas et al., 2017]. Bottom panel shows the stability probability predicted by SPOCK. Taking the probability of stability threshold of 0.34 used in Sec. 3A, the true positive rate is $94 \%$ and the false positive rate $6 \%$ on this dataset.
near-resonant configurations of fewer planets. Figure 5 also shows that SPOCK recognizes each of the dips in instability times in the top panel, which correspond to the locations of MMRs [Obertas et al., 2017], and adjusts its stability probability accordingly. Misclassifications are largely limited to the boundaries between stable and unstable configurations in the top panel. We note that near this boundary classification is ambiguous-some of these systems would also be "misclassified" by direct N-body integrations. Using the same threshold as in Sec. 3A (chosen to yield an FPR on our resonant holdout set of $10 \%$ ), the TPR across this test set of 17500 integrations is $94 \%$, with an FPR of $6 \%$. The fact that our model trained on three-planet systems generalizes to higher multiplicities supports our assertion at the outset that planet trios are prototypical cases that can be extended to higher numbers of planets.
D. An Application. As an example, we considered the characterization of four observed compact three-planet systems (Kepler-431, Kepler-446, EPIC-2108975, and LP-358-499), none of which are near strong MMRs. We again focus on compact systems, since we should be able to reject a larger range of masses and orbital eccentricities for these more delicate configurations. All four systems gave similar results, so we focus on Kepler-431, a system of three transiting Earth-size planets (which gave the second-worst performance).</p>
<p>The planetary transits across the host star strongly constrain the planets' orbital periods and physical sizes. The masses and especially the orbital eccentricities remain highly uncertain. As a simple exercise, we sample the planetary masses from a mass-radius relationship [Chen and Kipping, 2016] and sample eccentricities log-uniformly between $\left[10^{-4}, 0.18\right]$ for each of the three planets independently (with the upper limit representing the value at which the inner two orbits would cross). Since these are transiting planets, we draw inclinations from an edge-on configuration uniformly from $10^{-3}$ radians to the angular size of the star as seen from the planet, $R_{\star} / a_{i}$ (with $R_{\star}$ the stellar radius and $a_{i}$ the ith planet's semimajor axis). All remaining angles are drawn uniformly from $[0,2 \pi]$, and we assume a stellar mass of 1.07
<img alt="img-5.jpeg" src="img-5.jpeg" /></p>
<p>Fig. 6. Top panels are polar plots of the middle planet's eccentricity vector in the Kepler 431 compact three-planet system (distance from origin is the eccentricity; polar angle the direction toward pericenter). Top left panel color codes 1500 stable and unstable configurations through direct integration, while top right panel shows the stability predictions from SPOCK-96\% of points agree. The bottom panel projects the configurations into the transformed space used by our model features (see text). The stability boundary separates much more cleanly in this space that incorporates our understanding of the resonant dynamics, showing visually why our engineered features help the algorithm's performance.
solar masses. We draw 1500 configurations in this way, and for each one run both direct N-body integrations and our SPOCK classifier.</p>
<p>Adopting the same stability probability threshold from Sec. 3A, we obtain the results plotted in Fig. 6. To visualize the phase space, in the top row we provide polar plots of the middle planet's eccentricity vector (with the distance from the origin giving the eccentricity, and the polar angle the direction toward pericenter). The top left panel color codes stable and unstable configurations obtained through direct N-body. The top right panel shows the predictions from SPOCK, yielding an FPR of $9 \%$ and TPR of $97 \%$.</p>
<p>While the expected trend of instability toward high eccentricities is born out in the top panel, many unstable configurations remain near the origin at zero eccentricity due to other system parameters not visible in this projection. However, by developing a classifier with a comparatively small number of physically motivated features, we can gain insight into the stability constraints by projecting the configurations onto the transformed resonant space used by the model. In the bottom panel we consider the eccentricity modes $e_{-}$(Eq. 3) that dominate the MMR dynamics between each adjacent pair of planets (first and second planet on the x-axis; second and third on the y-axis). We see that our feature space incorporating our analytical understanding of the resonant dynamics much more cleanly separates the stable and unstable systems, even in this 2-D projection. This both visually shows how our engineered features help the algorithm's performance, and clarifies the particular combinations of parameters specifically constrained by stability.</p>
<p>Finally, we note that in this closely packed system, stability</p>
<p>is indeed constraining. We constrain the free eccentricities ${ }^{5}$ of the inner and outer pair of planets to be below 0.051 and 0.053 , respectively ( 84 th percentile limit). Such eccentricity limits, which constrain the degree of dynamical excitation in the system's past [Chatterjee et al., 2008, Jurić and Tremaine, 2008], are significantly stronger than those inferred from radial velocity [e.g., Butler et al., 2006] or transit duration measurements [Van Eylen and Albrecht, 2015, Xie et al., 2016] for such low-mass planets, which dominate the population [e.g., Burke et al., 2015]. Within a factor of a few, this approaches the exquisite constraints achievable by modeling transit timing variations (TTVs), which are typically only measurable when planets are close to strong MMRs, with accurate photometry, and with long observation baselines [Holman and Murray, 2005]. In particular, TTVs are not detected in any of the four Kepler systems we considered. TTV modeling has been an extremely productive method with the long observation baselines of the Kepler mission [e.g., Jontof-Hutter et al., 2014, Hadden and Lithwick, 2017]. However, the much shorter observing windows of Kepler's successor, the Transiting Exoplanet Survey Satellite (TESS), implies that only $\sim 10$ planets are expected to be constrained by TTVs [Hadden et al., 2019] during its prime mission. This places stability constrained characterization as a powerful complementary method for understanding multi-planet systems.
E. Limits. Finally, we present an instructive case where SPOCK fails, for systems constrained by above-mentioned TTVs. Transiting planets that do not interact with one another would pass in front of their host stars like perfect clocks with a constant orbital period. However, their mutual gravitational tugs can cause transit times to periodically pull ahead and fall behind. This is a particularly strong effect near MMRs, which induce sinusoidal TTVs[Holman and Murray, 2005, Lithwick et al., 2012].</p>
<p>We considered six systems that exhibit TTVs, and in particular, the three-planet Kepler-307 system [Jontof-Hutter et al., 2016] (outermost planet only a candidate). In all cases, the transit times have been fit to infer planet masses and orbital parameters with Markov Chain Monte Carlo (MCMC). We choose to sample 1500 configurations from the resulting posterior, and again run N-body integrations to compare with SPOCK predictions as in Sec. D.</p>
<p>Interestingly, SPOCK fails on all of them. In the case of Kepler-307, the FPR is $87 \%$ (Fig. 7). An important cost to consider with complex models is the difficulty in diagnosing problems such as these when they come up. Our original SPOCK model generated 60 summary features from short integrations, and in fact slightly outperformed our final adopted model on the holdout set in Fig. 3. However, we chose to trade these marginal performance gains for the improved interpretability of our smaller set of 10 physically relevant features, and this reveals the reason for the poor performance in Fig. 7.</p>
<p>The inner two planets in this system are near a 5:4 MMR (period ratio $\approx 1.255$ ), while the third planet is significantly further separated (period ratio between the outer two planets $\approx 1.79$ ). As mentioned above, the MMR dynamics between a pair of planets are driven by a particular combination of the orbital eccentricities $e_{-}$(Eq. 3). In this case, because the observed TTVs are driven by a 5:4 MMR between the</p>
<p><sup id="fnref3:0"><a class="footnote-ref" href="#fn:0">1</a></sup><img alt="img-6.jpeg" src="img-6.jpeg" /></p>
<p>Fig. 7. Case of the 3-planet Kepler-307 system, where SPOCK predictions fail. We sample configurations (points) from the posterior of a Markov Chain Monte Carlo fit to the observed transit timing variations (TTVs) in the system. Top and bottom rows are analogous to Fig. 6. Transforming to the 2-body resonant variables used by SPOCK in the bottom row shows the reason for the poor performance. The previous TTV fit has constrained the eccentricity mode dominantly driving the MMR dynamics of the inner two planets to an extremely narrow range. This leaves points only along a direction that does not strongly influence the short integrations we use to generate features.
inner two planets, the TTVs observed in the data specifically constrain this planet pair's $e_{-}$mode. If we again transform the space in the top row of Fig. 7 to that spanned by the $e_{-}$ modes for both adjacent pairs like in Fig. 6, we see that the sample of configurations collapses to a thin vertical line.</p>
<p>The problem is therefore that while SPOCK would typically help to constrain $e_{-}$by ruling out unstable values, the MMR-driven TTVs have already allowed the MCMC fit to narrow down the $e_{-}$mode for the inner pair of planets to an exquisitely narrow range of $0.0088 \pm 0.0004$. Thus, samples from the MCMC posterior have already removed configurations along directions in which SPOCK has strong discerning power, leaving only points along directions that are difficult to separate from the short integrations. The 'MEGNO' model similarly fails with an FPR of $57 \%$.</p>
<p>If we constrained the above system blindly, across the full range of possible eccentricities, SPOCK's performance would be comparable to the results in Sec. 3A. In this case, however, observational data has strongly constrained the planets' resonant dynamics, leaving only configurations with very similar SPOCK features, and leading to unreliable predictions. Presumably, improved models would incorporate additional features that better separate the stable and unstable configurations in Fig. 7. Such SPOCK failures should be rare, but TTV-constrained configurations are an important, instructive counterexample. One can test for such situations empirically by looking for clustering of configurations in SPOCK's feature space. An important advantage of SPOCK's physically meaningful features is that it facilitates the interpretation of any such clusterings.</p>
<h2>4. Conclusion</h2>
<p>We have presented the Stability of Planetary Orbital Configurations Klassifier (SPOCK), a machine learning model capable of classifying stability of compact $3+$ planet systems over $10^{9}$ orbits. SPOCK is up to $10^{5}$ times faster than direct N-body integration, and is significantly more accurate (Figs. 3 and 4) than stability predictions using AMD stability [Laskar and Petit, 2017], Hill-sphere separations [e.g., Chambers et al., 1996, Zhou et al., 2007, Quillen, 2011], or the MEGNO chaos indicator [e.g., Migaszewski et al., 2012]</p>
<p>This computationally opens up the stability constrained characterization of compact multi-planet systems, by rejecting unphysical, short-lived candidate orbital configurations. In the Kepler 431 system with three tightly packed, approximately Earth-sized planets, we constrained the free eccentricities of the inner and outer pair of planets to both be below 0.05 ( 84 th percentile upper limits). Such limits are significantly stronger than can currently be achieved for small planets through either radial velocity or transit duration measurements, and within a factor of a few from transit timing variations (TTVs). Given that the TESS mission's typical 30-day observing windows will provide few strong TTV constraints [Hadden et al., 2019], SPOCK computationally enables stability constrained characterization as a productive complementary method for extracting precise orbital parameters in compact multi-planet systems.</p>
<p>Our training methodology and tests also clarify the dynamics driving instabilities in compact exoplanet systems. Our model, trained solely with configurations in and near MMRs, accurately predicts instabilities within $10^{9}$ orbits across the full phase space of typical compact systems (Sec. 3B). This is strong confirmation that rapid instabilities, on timescales much shorter than observed systems typical $\sim 10^{11}$-orbit dynamical ages, are dominantly driven by the overlap of MMRs [Wisdom, 1980, Quillen, 2011, Obertas et al., 2017].</p>
<p>Instabilities can also occur on longer timescales through the overlap of secular resonances. As opposed to MMRs between planets' orbital rates, secular resonances represent commensurabilities between the much slower rates at which orbits precess. This is the case for our solar system, which has a dynamical lifetime $&gt;10^{10}$ orbits [Laskar and Gastineau, 2009, Lithwick and Wu, 2011, Batygin et al., 2015]. SPOCK is not trained to detect such slow instabilities, but self-consistently classifies the solar system as stable over $10^{9}$ orbits.</p>
<p>Recent work [Volk and Malhotra, 2020] suggests that instabilities in compact systems are driven through the overlap of such secular resonances. While this may seem in tension with our focus on MMRs, this paints a self-consistent picture. Short-lived configurations eliminate themselves, rearranging and dynamically carving out the distribution of planetary systems that survive to the present day. This idea has been advanced from several perspectives [Barnes and Quinn, 2004, Volk and Gladman, 2015, Pu and Wu, 2015, Tremaine, 2015, Izidoro et al., 2017]. MMR-driven instabilities happen quickly compared to the typical ages of observed systems, leaving today only systems that destabilize through slower secular instabilities. This also clarifies that secular analyses such as AMD stability are valuable dynamical classifications for observed systems [Laskar and Petit, 2017], despite their poor identification of short-term instabilities (Sec. 3).</p>
<p>We also showed that short-term, MMR driven instabilities
are local, as expected from the lack of strong MMRs beyond period ratios of 2:1 [Murray and Holman, 1997, Quillen, 2011]. In particular, we showed that our model, trained on threeplanet systems, can be applied to adjacent trios of planets in higher multiplicity systems to classify stability over $10^{9}$ orbits. This implies that stability constrained characterization is robust against distant, unseen planets (an important consideration for detection methods heavily biased against finding such bodies). This is not the case for longer timescale secular instabilities. For example, exodynamicists detecting only the inner solar system would infer a much more stable system than is actually the case [e.g., Lithwick and Wu, 2011, Batygin et al., 2015].</p>
<p>By identifying the dominant dynamics driving the instabilities we aimed to classify, and incorporating this directly into both the training set and the set of features used for our machine learning model, we have trained a robust classifier of multi-planet stability over $10^{9}$ orbits. This approach also allowed us to both test our assumptions, and understand regions of phase space where SPOCK should fail. This can be a useful blueprint for exploiting the often extensive domain knowledge available in scientific applications of machine learning.</p>
<p>We make our $\approx 1.5$-million CPU-hour training set publicly available (https://zenodo.org/record/3723292), and provide an open-source package, documentation and examples (https://github.com/dtamayo/spock) for efficient classification of planetary configurations that will live long and prosper.</p>
<h2>Materials and Methods</h2>
<p>A. Resonant Dataset. We initialize our near-resonant pair of planets by first identifying all the first $(n: n-1)$ and second $(n: n-2)$ order MMRs in the range from [3.5, 30] mutual Hill radii ([3.5, 60] mutual Hill radii for non-adjacent planets) ${ }^{\mathbf{a}}$, which represent the strongest set of resonances [Murray and Dermott, 1999]. We then randomly assign the pair to one of the resonances in this list.</p>
<p>A pair planets near a first-order $n: n-1$ MMR, whose orbits evolve in a twelve-dimensional phase space, can to excellent approximation be reduced to a two-dimensional dynamical system through a transformation of variables involving several conserved quantities Sessin and Ferraz-Mello [1984]. This transformation has recently been generalized for $n: n-2$ and higher-order MMRs [Hadden, 2019] [see also Hadden and Lithwick, 2018].</p>
<p>First, at low eccentricities, the eccentricity and inclination evolution decouple. Therefore, we sample the planets' orbital inclinations and orbital plane orientations randomly as described in Sec. B. For the eccentricities, the intuition is that only one mode (or combination) matters. In particular, a combination $\mathbf{Z}_{+}$, approximately the "center-of-mass" eccentricity vector, is conserved, while $\mathbf{Z}$ drives the dynamics [e.g., Hadden, 2019],</p>
<p>$$
\sqrt{2} \mathbf{Z} \approx \mathbf{e}<em 1="1">{2}-\mathbf{e}</em>} \equiv \mathbf{e<em _="+">{-}, \quad \mathbf{Z}</em>} \approx \frac{m_{1} \mathbf{e<em 2="2">{1}+m</em>} \mathbf{e<em 1="1">{2}}{m</em>
$$}+m_{2}} \equiv \mathbf{e}_{+} \approx \text { const. </p>
<p>where $\mathbf{e}<em 2="2">{1}$ and $\mathbf{e}</em>\right)$, so we adopt the latter to avoid discontinuities in our features near discrete resonances.}$ are the planets' orbital eccentricity vectors, and $m_{1}$ and $m_{2}$ are their respective masses. The $Z$ and $Z_{+}$vectors incorporate additional coefficients on the eccentricity vectors that depend on the particular MMR. With the exception of the 2:1 MMR, these coefficients are within $\approx 10 \%$ of unity [Deck et al., 2013], and converge to one as the period ratio shrinks [Hadden, 2019]. Models trained with $\left(Z, Z_{+}\right)$exhibit similar performance to ones trained with $\left(e_{-}, e_{+</p>
<p>Finally, one can combine the period ratio and other orbital parameters to define a metric for proximity to the resonance. The closer the system is to the resonance, the higher $\mathbf{e}_{-}$will be forced by</p>
<p><sup id="fnref4:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p><img alt="img-7.jpeg" src="img-7.jpeg" /></p>
<p>Fig. 8. Phase portrait of the dynamics near a MMR. See Materials and Methods for discussion.
the MMR. We sample the relevant range in proximities to resonance by drawing the eccentricity forced by the resonance $e_{\text {forced }}$ (see Fig. 8) log-uniformly from the minimum value (predicted by the analytic theory to yield an isolated resonant island [Hadden, 2019]) to the nominal orbit-crossing value $e_{\text {cross }}$ (Eq. 2). Choosing $e_{\text {forced }}$ defines a family of different possible trajectories, depending on the remaining initial conditions, which we plot in Fig. 8. The variable on the x -axis is the resonant angle $\phi$, which is the particular combination of the pericenter orientations and phases corresponding to the given MMR - physically, it tracks the position at which conjunctions occur, where planets most strongly interact. The choice of $e_{\text {forced }}$, or proximity to resonance, moves the entire resonant island (bounded by the black curve) up and down.</p>
<p>The final important parameter is then the free eccentricity $e_{\text {free }}$, which measures the distance from the resonant equilibrium (red dot in the bottom panel of Fig. 8) A system initialized with $e_{\text {free }}=0$ at the center of the island will remain at the equilibrium. Configurations initialized with small non-zero values of $e_{\text {free }}$ will oscillate (librate) around the equilibrium like a pendulum. There is a critical value of $e_{\text {free }}$ beyond which the system will no longer librate around the equilibrium but instead circulates. The boundary trajectory, which forms a 'cat's eye' splitting these two types of behaviors, is called the separatrix (black curve).</p>
<p>To fill in this range of behaviors, we sample $e_{\text {free }}$ log-uniformly from $\left[3 \times 10^{-3}, 3\right]$ of the distance to the separatrix along $\phi=\pi$. In this way, the resonant pair of planets spans the range from being in resonance to being outside the resonant region, but still having their dynamics strongly influenced by the MMR. Many of the planets discovered by the Kepler mission that exhibit transit timing variations lie in the region near (but outside) strong MMRs[e.g., Hadden and Lithwick, 2016]. When the drawn $e_{\text {free }}$ is large enough to move beyond the bottom of the plot, we wrap around and initialize the system at $\phi=0$. This allows us also to sample the other island shown in green in the bottom panel of Fig. 8, which has an equilibrium at small values of $e_{-}$. Once the initial conditions are allowed to evolve, they fill the space in Fig. 8, as shown by the few plotted sample trajectories. For the conserved quantity $e_{+}$, we sample it log-uniformly within the same range as $e_{\text {forced }}$. We draw the remaining nuisance angles uniformly from $[0,2 \pi]$.</p>
<p>We initialized the resonant pair of planets using the open-source celmech package (https://github.com/shadden/celmech), which is based onHadden [2019]. celmech includes an API for initializing resonant orbital configurations from the above parameters, and we include the scripts and random seeds used to generate our training sets in the repository accompanying this paper.
B. Numerical Integrations. All integrations were performed with WHFast [Rein and Tamayo, 2015], part of the REBOUND Nbody package [Rein and Liu, 2012]. We adopted a timestep of $\approx 3.4 \%$ of the innermost planet's orbital period. If any planets' Hill spheres overlapped, the simulation was ended and the instability time recorded. The specific halting condition is not important [Gladman, 1993], as once Hill spheres start crossing, the system
becomes an orbit-crossing tangle on orbital timescales ${ }^{\ddagger}$.
The integrations analyzed in this work were saved in the REBOUND SimulationArchive format, which enables exact, machineindependent reproducibility of results [Rein and Tamayo, 2017]. We provide instructions and the scripts necessary to reproduce the figures in the accompanying repository.</p>
<p>ACKNOWLEDGMENTS. We are grateful to Antoine Petit and the anonymous reviewers for insightful suggestions that significantly improved the manuscript. Support for DT was provided by NASA through the NASA Hubble Fellowship grant HST-HF2-51423.001-A awarded by the Space Telescope Science Institute, which is operated by the Association of Universities for Research in Astronomy, Inc., for NASA, under contract NAS5-26555. HR has been supported by the NSERC Discovery Grant RGPIN-2014-04553 and the Centre for Planetary Sciences at the University of Toronto Scarborough.</p>
<p>Andrey Nikolaevich Kolmogorov. On conservation of conditionally periodic motions for a small change in hamilton's function. In Dokl. Akad. Nauk SSSR, volume 98, pages 527-530, 1954.
J Möser. On invariant curves of area-preserving mappings of an annulus. Nachr. Akad. Wiss. Göttingen, 5, pages 1-20, 1962.
VI Arnol'd. Proof of a theorem of an kolmogorov on the invariance of quasi-periodic motions under small perturbations of the hamiltonian. Russian Mathematical Surveys, 18(5):9, 1963.
M Heron. Explorations numérique du problème restreint iv: Masses égales, orbites non periodique. Bulletin Astronomique, 81(49-66, 1966.
Alessandra Cellett and Luigi Chierchia. Kam stability for a three-body problem of the solar system. Zeitschrift für angewandte Mathematik und Physik ZAMR, 57(1):33-41, 2005.
Sean M Mills, Daniel C Fabrycky, Cezary Migaszewski, Eric B Ford, Erik Petigura, and Howard Isaacson. A resonant chain of four transiting, sub-neptune planets. Nature, 533(7604):509512, 2016.
Michaël Gillon, Amaury HMJ Triaud, Brice-Olivier Demory, Emmanuël Jehin, Eric Agol, Katherine M Deck, Susan M Lederer, Julien De Wit, Artem Burdanov, James G Ingalls, et al. Seven temperate terrestrial planets around the nearby ultracold dwarf star trappist-1. Nature, 542 (7642):456-460, 2017.
Jason H Steffen, Daniel C Fabrycky, Eric Agol, Eric B Ford, Robert C Morehead, William D Cochran, Jack J Lissauer, Elisabeth R Adams, William J Borucki, Steve Bryson, et al. Transit timing observations from kepler-vii. confirmation of 27 planets in 13 multiplanet systems via transit timing variations and orbital stability. Monthly Notices of the Royal Astronomical Society, 428 (2):1077-1087, 2013.</p>
<p>Daniel Tamayo, Amaury HMJ Triaud, Kristen Menou, and Hanno Rein. Dynamical stability of imaged planetary systems in formation: Application to fri tau. The Astrophysical Journal, 805 (2):100, 2015.</p>
<p>Jason J Wang, James R Graham, Rebekah Dawson, Daniel Fabrycky, Robert J De Rosa, Laurent Pueye, Quinn Kompacky, Bruce Macintosh, Christian Marois, Eugene Chiang, et al. Dynamical constraints on the fri 8799 planets with gpi. The Astronomical Journal, 156(5):192, 2018.
Billy Quartes, Elisa V Quintana, Eric D Lopez, Joshua E Schlieder, and Thomas Barclay. Plausible compositions of the seven trappist-1 planets using long-term dynamical simulations. arXiv preprint arXiv:1704.02261, 2017.
Daniel Tamayo, Hanno Rein, Cristobal Petrovich, and Norman Murray. Convergent migration renders trappist-1 long-lived. The Astrophysical Journal Letters, 840(2):L19, 2017.
Eugenio J Rivera, Gregory Laughlin, R Paul Butler, Steven S Vogt, Nader Haghighipour, and Stefano Meschian. The lick-carriage exoplanet survey: a uranus-mass fourth planet for gj 876 in an extrasolar laplace configuration. The Astrophysical Journal, 719(1):890, 2010.
Daniel Jontof-Hutter, Jack J Lissauer, Jason F Rowe, and Daniel C Fabrycky. Kepler-79's low density planets. The Astrophysical Journal, 780(1):15, 2014.
Lars A Buchhave, Courtney D Dressing, Xavier Dumusque, Ken Rice, Andrew Vanderburg, Annelies Mortier, Mercedes Lopez-Morales, Eric Lopez, Mia S Lundkvist, Hans Kjeldsen, et al. A 1.9 earth radius rocky planet and the discovery of a non-transiting planet in the kepler-20 system. The Astronomical Journal, 152(6):160, 2016.
Sam Hadden and Yoram Lithwick. Kepler planet masses and eccentricities from ttv analysis. The Astronomical Journal, 154(1):5, 2017.
Simon L Grimm, Brice-Olivier Demory, Michaël Gillon, Caroline Dorn, Eric Agol, Artem Burdanov, Laetitia Delrez, Marko Sestovic, Amaury HMJ Triaud, Martin Turbet, et al. The nature of the trappist-1 exoplanets. Astronomy \&amp; Astrophysics, 613:A68, 2018.
Jack Wisdom. The resonance overlap criterion and the onset of stochastic behavior in the restricted three-body problem. The Astronomical Journal, 85:1122-1133, 1980.
K. M. Deck, M. Payne, and M. J. Holman. First-order Resonance Overlap and the Stability of Close Two-planet Systems. Astrophysical Journal, 774:129, September 2013.
Sam Hadden and Yoram Lithwick. A criterion for the onset of chaos in systems of two eccentric planets. The Astronomical Journal, 156(3):95, 2018.
J. E. Chambers, G. W. Wetherill, and A. P. Boss. The Stability of Multi-Planet Systems. Icarus, 119: 261-268, February 1996.
Alice C Quillen. Three-body resonance overlap in closely spaced multiple-planet systems. Monthly Notices of the Royal Astronomical Society, 418(2):1043-1054, 2011.
${ }^{\ddagger}$ It might still take a long time for small planets close to their host star to find one another and collide [Rice et al., 2018]; however, in the context of applying stability constraints, we are usually interested in the time to instability defined such that the system architecture becomes inconsistent with the typically observed multi-planet system of approximately planar, concentric near-circular orbits.</p>
<p>Alice C Guillen and Robert S French. Resonant chains and three-body resonances in the closely packed inner uranian satellite system. Monthly Notices of the Royal Astronomical Society, 445 (4):3959-3986, 2014.</p>
<p>Keleo Yoshinaga, Eiichiro Kokubo, and Junichiro Makino. The stability of protoplanet systems. Icarus, 139(2):328-335, 1999.
F. Marzari and S. J. Weidenschilling. Eccentric Extrasolar Planets: The Jumping Jupiter Model. Icarus, 156:570-579, April 2002.
Ji-Lin Zhou, Douglas NC Lin, and Yi-Sui Sun. Post-oligarchic evolution of protoplanetary embryos and the stability of planetary systems. The Astrophysical Journal, 666(1):423, 2007.
Peter Faber and Alice C Guillen. The total number of giant planets in debris discs with central clearings. Monthly Notices of the Royal Astronomical Society, 382(4):1823-1828, 2007.
Andrew W Smith and Jack J Lissauer. Orbital stability of systems of closely-spaced planets. Icarus, 201(1):381-394, 2009.
YujI Matsumoto, Makiko Nagasawa, and Shigenu Ida. The orbital stability of planets trapped in the first-order mean-motion resonances. Icarus, 221(2):624-631, November 2012.
Bonen Pu and Yenqin Wu. Spacing of kepler planets: sculpting by dynamical instability. The Astrophysical Journal, 807(1):44, 2015.
Alysa Obertas, Christa Van Laerhoven, and Daniel Tamayo. The stability of tightly-packed, eventyspaced systems of earth-mass planets orbiting a sun-like star. Icarus, 293:52-58, 2017.
Hanno Rein and Daniel Tamayo. whfast: a fast and unbiased implementation of a symplectic wisdom-Holman integrator for long-term gravitational simulations. Monthly Notices of the Royal Astronomical Society, 452(1):376-388, 2015.
Naireen Hussain and Daniel Tamayo. Fundamental limits from chaos on instability time predictions in compact planetary systems. Monthly Notices of the Royal Astronomical Society, 491(4): 5258-5267, 2019.
David R Rice, Frederic A Rasio, and Jason H Steffen. Survival of non-coplanar, closely packed planetary systems after a close encounter. Monthly Notices of the Royal Astronomical Society, 481(2):2205-2212, 2018.
Almog Yelinewich and Cristobal Petrovich. Nekhoroshev estimates for the survival time of tightly packed planetary systems. arXiv preprint arXiv:1907.06660, 2019.
B Funk, G Wuchterl, R Schwarz, E Pilat-Lohinger, and S Eggl. The stability of ultra-compact planetary systems. Astronomy \&amp; Astrophysics, 516:A82, 2010.
Dong-Hong Wu, Rachel C Zhang, Ji-Lin Zhou, and Jason H Steffen. Dynamical instability and its implications for planetary system architecture. Monthly Notices of the Royal Astronomical Society, 484(2):1538-1548, 2019.
C. D. Murray and S. F. Dermott. Solar System Dynamics. Cambridge U. Press, Cambridge, 1999. Y. Lithwick and Y. Wu. Theory of Secular Chaos and Mercury's Orbit. Astrophysical Journal, 739: 31, September 2011.
K. Batygin, A. Morbidelli, and M. J. Holman. Chaotic Disintegration of the Inner Solar System. Astrophysical Journal, 799:120, February 2015.
PS Laplace. Memoire sur les inégalités séculares des planetes et des satellites mem. Acad. royale des Sciences de Paris, l'oeuvres completes XI, 49, 1784.
Jacques Laskar. The chaotic motion of the solar system: A numerical estimate of the size of the chaotic zones. Icarus, 86(2):266-291, 1990.
Jacques Laskar. On the spacing of planetary systems. Physical Review Letters, 84(15):3240, 2000.</p>
<p>Jacques Laskar and AC Petit. Amd-stability and the classification of planetary systems. Astronomy \&amp; Astrophysics, 605:A72, 2017.
Jacques Laskar and Mickael Gastineau. Existence of collisional trajectories of mercury, mars and venus with the earth. Nature, 459(7248):817-819, 2009.
Cezary Migaszewski, Mariusz Słonina, and Krzysztof Goździewski. A dynamical analysis of the kepler-11 planetary system. Monthly Notices of the Royal Astronomical Society, 427(1):770789, 2012.
Antoine C Petit, Jacques Laskar, and Gwenaël Boué. Amd-stability in the presence of first-order mean motion resonances. Astronomy \&amp; Astrophysics, 607:A35, 2017.
F. Marzari. Dynamical behaviour of multiglanet systems close to their stability limit. Monthly Notices of the Royal Astronomical Society, 442:1110-1116, August 2014.
Pablo Miguel Cincotta, Claudia Marceis Giordano, and C Simó. Phase space structure of multidimensional systems by means of the mean exponential growth factor of nearby orbits. Physica D: Northstar Phenomena, 182(3-4):151-178, 2003.
J. Wisdom and M. Holman. Symplectic maps for the n-body problem. Astronomical Journal, 102: 1528-1538, October 1991.
Kathryn Volk and Brett Gladman. Consolidating and crushing exoplanets: Did it happen here? The Astrophysical Journal Letters, 806(2):L26, 2015.
Daniel Tamayo, Ari Silburt, Diana Valencia, Kristen Menou, Mohamad Ali-Dib, Cristobal Petrovich, Chelsea X Huang, Hanno Rein, Christa van Laerhoven, Adiv Paradise, et al. A machine learns to predict the stability of tightly packed planetary systems. The Astrophysical Journal Letters, 832(2):L22, 2016.
Tianqi Chen and Carlos Guestrin. Xgboost: A scalable tree boosting system. arXiv preprint arXiv:1603.02754, 2016.
Christopher Lam and David Kipping. A machine learns to predict the stability of circumbinary planets. Monthly Notices of the Royal Astronomical Society, 476(4):5692-5697, 2018.
W Sessin and S Fernaz-Mello. Motion of two planets with periods commensurable in the ratio 2:1 solutions of the hon auxiliary system. Celestial mechanics, 32(4):307-332, 1984.
Sam Hadden. An Integrable Model for the Dynamics of Planetary Mean-motion Resonances. Astronomical Journal, 158(6):238, Dec 2019.
Daniel C Fabrycky, Jack J Lissauer, Darin Ragozzine, Jason F Rowe, Jason H Steffen, Eric Agol, Thomas Barclay, Natalie Batalha, William Borucki, David R Ciardi, et al. Architecture of kepler's multi-transiting systems. ii. new investigations with twice as many candidates. The Astrophysical Journal, 790(2):146, 2014.
Lauren M Weiss, Geoffrey W Marcy, Erik A Petigura, Benjamin J Fulton, Andrew W Howard, Joshua N Winn, Howard T Isaacson, Timothy D Morton, Lea A Hirsch, Evan J Sinukoff, et al. The california-kepler survey. v. peas in a pod: planets in a kepler multi-planet system are similar in size and regularly spaced. The Astronomical Journal, 155(1):48, 2018.</p>
<p>Boris V Chirkov. A universal instability of many-dimensional oscillator systems. Physica reports, 52(5):263-379, 1979.
James Bergstra, Daniel Yamins, and David Daniel Cox. Making a science of model search: Hyperparameter optimization in hundreds of dimensions for vision architectures. 2013.
Antoine C. Petit, Jacques Laskar, and Gwenaël Boué. Hill stability in the AMD framework. Astronomy \&amp; Astrophysics, 617:A93, Sep 2018.
Konstantin Batygin, Katherine M Deck, and Matthew J Holman. Dynamical evolution of multiresonant systems: The case of gj 876. The Astronomical Journal, 149(5):167, 2015.
Jingjing Chen and David Kipping. Probabilistic forecasting of the masses and radii of other worlds. The Astrophysical Journal, 604(1):17, 2016.
S. Chatterjee, E. B. Ford, S. Matsumura, and F. A. Rasio. Dynamical Outcomes of Planet-Planet Scattering. Astrophysical Journal, 686:580-602, October 2008.
M. Junč and S. Tremaine. Dynamical Origin of Extrasolar Planet Eccentricity Distribution. Astrophysical Journal, 686:603-620, October 2008.
R Paul Butler, JT Wright, GW Marcy, DA Fischer, SS Vogt, CG Tinney, HRA Jones, BD Carter, JA Johnson, C McCarthy, et al. Catalog of nearby exoplanets. The Astrophysical Journal, 646 (1):505, 2006.</p>
<p>Vincent Van Eylen and Simon Albrecht. Eccentricity from transit photometry: small planets in kepler multi-planet systems have low eccentricities. The Astrophysical Journal, 808(2):126, 2015.
Ji-Wei Xie, Subo Dong, Zhaohuan Zhu, Daniel Huber, Zheng Zheng, Peter De Cat, Jianning Fu, Hui-Gen Liu, Ali Luo, Yue Wu, et al. Exoplanet orbital eccentricities derived from lamest-kepler analysis. Proceedings of the National Academy of Sciences, 113(41):11431-11435, 2016.
Christopher J Burke, Jessie L Christiansen, F Mullaby, Shawn Seader, Daniel Huber, Jason F Rowe, Jeffrey L Coughlin, Susan E Thompson, Joseph Catarcourte, Bruce D Clarke, et al. Terrestrial planet occurrence rates for the kepler gk dwarf sample. The Astrophysical Journal, 809(1):8, 2015.</p>
<p>Matthew J Holman and Norman W Murray. The use of transit timing to detect terrestrial-mass extrasolar planets. Science, 307(5713):1288-1291, 2005.
Sam Hadden, Thomas Barclay, Matthew J. Payne, and Matthew J. Holman. Prospects for TTV Detection and Dynamical Constraints with TESS. The Astrophysical Journal, 158(4):146, October 2019.</p>
<p>Yoram Lithwick, Jiwei Xie, and Yanqin Wu. Extracting planet mass and eccentricity from th data. The Astrophysical Journal, 761(2):122, 2012.
Daniel Jontol-Hutter, Eric B Ford, Jason F Rowe, Jack J Lissauer, Daniel C Fabrycky, Christa Van Laerhoven, Eric Agol, Katherine M Deck, Tomer Holczer, and Taexi Mazeh. Secure mass measurements from transit timing: 10 kepler exoplanets between 3 and 8 mearth with diverse densities and incident fluxes. The Astrophysical Journal, 820(1):39, 2016.
Kathryn Volk and Renu Mañotra. Dynamical instabilities in systems of multiple short-period planets are likely driven by secular chaos: a case study of kepler-102. arXiv preprint arXiv:2003.05040, 2020.</p>
<p>Rory Barnes and Thomas Quinn. The (in) stability of planetary systems. The Astrophysical Journal, 611(1):494, 2004.
Scott Tremaine. The Statistical Mechanics of Planet Orbits. Astrophysical Journal, 807(2):157, Jul 2015.</p>
<p>Andre Izidoro, Masahiro Ogihara, Sean N Raymond, Alessandro Morbidelli, Arnaud Pierens, Bertram Bitsch, Christophe Cossou, and Franck Hersant. Breaking the chains: hot superearth systems from migration and disruption of compact resonant chains. Monthly Notices of the Royal Astronomical Society, 470(2):1750-1770, 2017.
N Murray and M Holman. Diffusive chaos in the outer asteroid belt. The Astronomical Journal, 114: 1246-1259, 1997.
B. Gladman. Dynamics of systems of two close planets. Icarus, 106:247, November 1993.</p>
<p>Sam Hadden and Yoram Lithwick. Numerical and analytical modeling of transit timing variations. The Astrophysical Journal, 828(1):44, 2016.
Hanno Rein and S-F Liu. Rebound: an open-source multi-purpose n-body code for collisional dynamics. Astronomy \&amp; Astrophysics, 537:A128, 2012.
Hanno Rein and Daniel Tamayo. A new paradigm for reproducing and analysing n-body simulations of planetary systems. Monthly Notices of the Royal Astronomical Society, 467(2):2377, 2017. URL &lt;http://dx.doi.org/10.1093/mnras/stv232.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{\mathbf{a}}$ the lower limit is the Hill stability limit [Gladman, 1993] was chosen to avoid immediate instabilities.&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>