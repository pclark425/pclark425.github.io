<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-5048 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-5048</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-5048</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-106.html">extraction-schema-106</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of language models (LLMs or neural language models) being used to solve puzzle games that require spatial knowledge (such as Sudoku or other spatial reasoning tasks). Include details about the models, the puzzles, the mechanisms or strategies used, performance metrics, evidence of spatial reasoning, limitations, and comparisons.</div>
                <p><strong>Paper ID:</strong> paper-d5295f7ddcf281f3d30a7579d5ce482036a8e27c</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/d5295f7ddcf281f3d30a7579d5ce482036a8e27c" target="_blank">Emergent World Representations: Exploring a Sequence Model Trained on a Synthetic Task</a></p>
                <p><strong>Paper Venue:</strong> International Conference on Learning Representations</p>
                <p><strong>Paper TL;DR:</strong> Although the network has no a priori knowledge of the game or its rules, it is uncovered evidence of an emergent nonlinear internal representation of the board state that can help explain predictions in human terms.</p>
                <p><strong>Paper Abstract:</strong> Language models show a surprising range of capabilities, but the source of their apparent competence is unclear. Do these networks just memorize a collection of surface statistics, or do they rely on internal representations of the process that generates the sequences they see? We investigate this question by applying a variant of the GPT model to the task of predicting legal moves in a simple board game, Othello. Although the network has no a priori knowledge of the game or its rules, we uncover evidence of an emergent nonlinear internal representation of the board state. Interventional experiments indicate this representation can be used to control the output of the network and create"latent saliency maps"that can help explain predictions in human terms.</p>
                <p><strong>Cost:</strong> 0.008</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <div class="extraction-instance-container" id="e5048.0">
                <h3 class="extraction-instance">Extracted Data Instance 0 (e5048.0)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of language models (LLMs or neural language models) being used to solve puzzle games that require spatial knowledge (such as Sudoku or other spatial reasoning tasks). Include details about the models, the puzzles, the mechanisms or strategies used, performance metrics, evidence of spatial reasoning, limitations, and comparisons.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Othello-GPT</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Othello-GPT (GPT-variant trained on Othello move transcripts)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>An 8-layer autoregressive transformer (GPT variant) trained to predict the next legal move token in Othello game transcripts; used to study whether sequence models learn internal, causal world representations of board state.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Othello-GPT (custom GPT variant)</td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td>An 8-layer transformer (GPT-style) with 8 attention heads and a 512-dimensional hidden representation; input vocabulary of 60 tokens (one per playable tile), trainable token embeddings, trained autoregressively with cross-entropy loss on two datasets (a large synthetic set of 20M uniformly sampled legal games and a smaller 'championship' set of human expert games). The paper does not report a total parameter count.</td>
                        </tr>
                        <tr>
                            <td><strong>puzzle_name</strong></td>
                            <td>Othello (Reversi)</td>
                        </tr>
                        <tr>
                            <td><strong>puzzle_description</strong></td>
                            <td>An 8×8 two-player deterministic board game where moves are tile placements that flip contiguous opponent discs along straight lines; legal-move determination depends on spatial configuration of discs (lines, adjacency, enclosures) and thus requires spatial/relational reasoning about board geometry.</td>
                        </tr>
                        <tr>
                            <td><strong>mechanism_or_strategy</strong></td>
                            <td>Train a standard autoregressive sequence model to predict the next tile token from prior move tokens (no explicit board input). Analyze internal activations with probes (linear and 2-layer MLP nonlinear probes) to decode board state, perform gradient-based interventions on internal activations to impose counterfactual tile states (optimize activations to change probe output), and compute latent saliency maps by measuring how interventions on each tile affect the model's predicted probability for a chosen move.</td>
                        </tr>
                        <tr>
                            <td><strong>evidence_of_spatial_reasoning</strong></td>
                            <td>Multiple strands of evidence: (1) Nonlinear probes (2-layer MLP) decode the full 3-way tile state (empty/black/white) from internal activations with low error (e.g., synthetic-trained model probe error falls as low as ~1.7% at layer 7 and 1.8% at layer 6; Table 2). (2) Causal interventions: gradient-descent modifications of activations to set a single tile's probed state to a counterfactual B' cause the model's next-move predictions to change to match the legal moves for B' — quantitative benchmark: average error after intervention 0.12 (natural positions) and 0.06 (unnatural positions) vs baseline errors 2.68 and 2.59. (3) Latent saliency maps produced by per-tile interventions highlight the exact tiles required for legality in synthetic-trained model, showing the model attends to spatially-relevant tiles. (4) Ablations: linear probes perform poorly while nonlinear probes succeed, indicating a nonlinear internal encoding of spatial board state.</td>
                        </tr>
                        <tr>
                            <td><strong>performance_metrics</strong></td>
                            <td>Next-move legality prediction (top-1 legal-move rate): synthetic-trained Othello-GPT error 0.01% (i.e., very high legal-move prediction accuracy); championship-trained error 5.17%; untrained model error 93.29%. Memorization test (skewed synthetic dataset missing one opening branch) yields 0.02% error, arguing against simple transcript memorization. Probe metrics: nonlinear probe error rates (validation) by layer on synthetic model: x^1 11.3%, x^2 7.5%, x^3 4.8%, x^4 3.4%, x^5 2.4%, x^6 1.8%, x^7 1.7%, x^8 4.6% (Table 2). Intervention benchmark: average errors per case after intervention (best L_s=4) 0.12 (natural set of 1000 cases) and 0.06 (unnatural set of 1000 cases) vs baseline 2.68 and 2.59 (Figure 3).</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_or_failure_cases</strong></td>
                            <td>Representation is essentially nonlinear (linear probes have high error ~20%+), so simple linear readouts fail. Interventions must be applied starting at an appropriate layer (L_s); intervening too shallow touches unreliable early representations, too deep leaves insufficient computation time to adapt. Latent saliency maps sometimes attribute only the first flipped disc (when moves flip multiple lines) and thus can miss multi-line OR-logic in the rule; intervention can unintentionally change other tile states and regularization (beta) did not clearly fix this. Championship-trained model shows more diffuse saliency (strategic/global signals) making simple legality-based attribution less clean.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_baseline</strong></td>
                            <td>Compared to a randomized (untrained) GPT baseline, probes on trained Othello-GPT give markedly better nonlinear probe accuracy (randomized nonlinear probe errors ~25–26% vs trained synthetic as low as 1.7%); synthetic-trained vs championship-trained: synthetic model learned to predict legal moves and shows saliency tightly focused on tiles required for legality, while championship-trained model learned strategic patterns and produces more global/diffuse saliency patterns; related prior work includes Toshniwal et al. (2021) which showed language models can predict legal chess moves and track board state, but this paper extends analysis to internal nonlinear representations and causal interventions.</td>
                        </tr>
                        <tr>
                            <td><strong>notes</strong></td>
                            <td>All numerical values and experimental protocols are drawn directly from the paper (Tables/Figures cited). The model variant and experimental interventions are introduced and used in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Emergent World Representations: Exploring a Sequence Model Trained on a Synthetic Task', 'publication_date_yy_mm': '2022-10'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>Learning chess blindfolded: Evaluating language models on state tracking <em>(Rating: 2)</em></li>
                <li>Implicit representations of meaning in neural language models <em>(Rating: 2)</em></li>
                <li>Can language models encode perceptual structure without grounding? a case study in color <em>(Rating: 1)</em></li>
                <li>Mapping language models to grounded conceptual spaces <em>(Rating: 1)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-5048",
    "paper_id": "paper-d5295f7ddcf281f3d30a7579d5ce482036a8e27c",
    "extraction_schema_id": "extraction-schema-106",
    "extracted_data": [
        {
            "name_short": "Othello-GPT",
            "name_full": "Othello-GPT (GPT-variant trained on Othello move transcripts)",
            "brief_description": "An 8-layer autoregressive transformer (GPT variant) trained to predict the next legal move token in Othello game transcripts; used to study whether sequence models learn internal, causal world representations of board state.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "Othello-GPT (custom GPT variant)",
            "model_description": "An 8-layer transformer (GPT-style) with 8 attention heads and a 512-dimensional hidden representation; input vocabulary of 60 tokens (one per playable tile), trainable token embeddings, trained autoregressively with cross-entropy loss on two datasets (a large synthetic set of 20M uniformly sampled legal games and a smaller 'championship' set of human expert games). The paper does not report a total parameter count.",
            "puzzle_name": "Othello (Reversi)",
            "puzzle_description": "An 8×8 two-player deterministic board game where moves are tile placements that flip contiguous opponent discs along straight lines; legal-move determination depends on spatial configuration of discs (lines, adjacency, enclosures) and thus requires spatial/relational reasoning about board geometry.",
            "mechanism_or_strategy": "Train a standard autoregressive sequence model to predict the next tile token from prior move tokens (no explicit board input). Analyze internal activations with probes (linear and 2-layer MLP nonlinear probes) to decode board state, perform gradient-based interventions on internal activations to impose counterfactual tile states (optimize activations to change probe output), and compute latent saliency maps by measuring how interventions on each tile affect the model's predicted probability for a chosen move.",
            "evidence_of_spatial_reasoning": "Multiple strands of evidence: (1) Nonlinear probes (2-layer MLP) decode the full 3-way tile state (empty/black/white) from internal activations with low error (e.g., synthetic-trained model probe error falls as low as ~1.7% at layer 7 and 1.8% at layer 6; Table 2). (2) Causal interventions: gradient-descent modifications of activations to set a single tile's probed state to a counterfactual B' cause the model's next-move predictions to change to match the legal moves for B' — quantitative benchmark: average error after intervention 0.12 (natural positions) and 0.06 (unnatural positions) vs baseline errors 2.68 and 2.59. (3) Latent saliency maps produced by per-tile interventions highlight the exact tiles required for legality in synthetic-trained model, showing the model attends to spatially-relevant tiles. (4) Ablations: linear probes perform poorly while nonlinear probes succeed, indicating a nonlinear internal encoding of spatial board state.",
            "performance_metrics": "Next-move legality prediction (top-1 legal-move rate): synthetic-trained Othello-GPT error 0.01% (i.e., very high legal-move prediction accuracy); championship-trained error 5.17%; untrained model error 93.29%. Memorization test (skewed synthetic dataset missing one opening branch) yields 0.02% error, arguing against simple transcript memorization. Probe metrics: nonlinear probe error rates (validation) by layer on synthetic model: x^1 11.3%, x^2 7.5%, x^3 4.8%, x^4 3.4%, x^5 2.4%, x^6 1.8%, x^7 1.7%, x^8 4.6% (Table 2). Intervention benchmark: average errors per case after intervention (best L_s=4) 0.12 (natural set of 1000 cases) and 0.06 (unnatural set of 1000 cases) vs baseline 2.68 and 2.59 (Figure 3).",
            "limitations_or_failure_cases": "Representation is essentially nonlinear (linear probes have high error ~20%+), so simple linear readouts fail. Interventions must be applied starting at an appropriate layer (L_s); intervening too shallow touches unreliable early representations, too deep leaves insufficient computation time to adapt. Latent saliency maps sometimes attribute only the first flipped disc (when moves flip multiple lines) and thus can miss multi-line OR-logic in the rule; intervention can unintentionally change other tile states and regularization (beta) did not clearly fix this. Championship-trained model shows more diffuse saliency (strategic/global signals) making simple legality-based attribution less clean.",
            "comparison_baseline": "Compared to a randomized (untrained) GPT baseline, probes on trained Othello-GPT give markedly better nonlinear probe accuracy (randomized nonlinear probe errors ~25–26% vs trained synthetic as low as 1.7%); synthetic-trained vs championship-trained: synthetic model learned to predict legal moves and shows saliency tightly focused on tiles required for legality, while championship-trained model learned strategic patterns and produces more global/diffuse saliency patterns; related prior work includes Toshniwal et al. (2021) which showed language models can predict legal chess moves and track board state, but this paper extends analysis to internal nonlinear representations and causal interventions.",
            "notes": "All numerical values and experimental protocols are drawn directly from the paper (Tables/Figures cited). The model variant and experimental interventions are introduced and used in this paper.",
            "uuid": "e5048.0",
            "source_info": {
                "paper_title": "Emergent World Representations: Exploring a Sequence Model Trained on a Synthetic Task",
                "publication_date_yy_mm": "2022-10"
            }
        }
    ],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "Learning chess blindfolded: Evaluating language models on state tracking",
            "rating": 2
        },
        {
            "paper_title": "Implicit representations of meaning in neural language models",
            "rating": 2
        },
        {
            "paper_title": "Can language models encode perceptual structure without grounding? a case study in color",
            "rating": 1
        },
        {
            "paper_title": "Mapping language models to grounded conceptual spaces",
            "rating": 1
        }
    ],
    "cost": 0.008321499999999999,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>EMERGENT WORLD REPRESENTATIONS: EXPLORING A SEQUENCE MODEL TRAINED ON A SYNTHETIC TASK</h1>
<p>Kenneth Li*<br>Harvard University<br>Fernanda Viégas<br>Harvard University</p>
<p>Aspen K. Hopkins<br>Massachusetts Institute of Technology<br>David Bau<br>Northeastern University<br>Hanspeter Pfister<br>Harvard University<br>Martin Wattenberg<br>Harvard University</p>
<h2>ABSTRACT</h2>
<p>Language models show a surprising range of capabilities, but the source of their apparent competence is unclear. Do these networks just memorize a collection of surface statistics, or do they rely on internal representations of the process that generates the sequences they see? We investigate this question in a synthetic setting by applying a variant of the GPT model to the task of predicting legal moves in a simple board game, Othello. Although the network has no a priori knowledge of the game or its rules, we uncover evidence of an emergent nonlinear internal representation of the board state. Interventional experiments indicate this representation can be used to control the output of the network. By leveraging these intervention techniques, we produce "latent saliency maps" that help explain predictions. ${ }^{1}$</p>
<h2>1 INTRODUCTION</h2>
<p>Recent language models have shown an intriguing range of capabilities. Networks trained on a simple "next-word" prediction task are apparently capable of many other things, such as solving logic puzzles or writing basic code. ${ }^{2}$ Yet how this type of performance emerges from sequence predictions remains a subject of current debate.</p>
<p>Some have suggested that training on a sequence modeling task is inherently limiting. The arguments range from philosophical (Bender \&amp; Koller, 2020) to mathematical (Merrill et al., 2021). A common theme is that seemingly good performance might result from memorizing "surface statistics," i.e., a long list of correlations that do not reflect a causal model of the process generating the sequence. This issue is of practical concern, since relying on spurious correlations may lead to problems on out-of-distribution data (Bender et al., 2021; Floridi \&amp; Chiriatti, 2020).</p>
<p>On the other hand, some tantalizing clues suggest language models may do more than collect spurious correlations, instead building interpretable world models-that is, understandable models of the process producing the sequences they are trained on. Recent evidence suggests language models can develop internal representations for very simple concepts, such as color, direction Abdou et al. (2021); Patel \&amp; Pavlick (2022), or tracking boolean states during synthetic tasks (Li et al., 2021) (see Related Work (section 6) for more detail).</p>
<p>A promising approach to studying the emergence of world models is used by Toshniwal et al. (2021), which explores language models trained on chess move sequences. The idea is to analyze the behavior of a standard language modeling architecture in a well-understood, constrained setting. The paper finds that these models learn to predict legal chess moves with high accuracy. Furthermore, by analyzing predicted moves, the paper shows that the model appears to track the board state. The authors stop short, however, of exploring the form of any internal representations. Such an</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>investigation will be the focus of this paper. A key motivation is the hope that ideas and techniques learned in this simplified setting may eventually be useful in natural-language settings as well.</p>
<h1>1.1 THE GAME OF OTHELLO AS TESTBED FOR INTERPRETABILITY</h1>
<p>Toshniwal et al. (2021)'s observations suggest a new approach to studying the representations learned by sequence models. If we think of a board as the "world," then games provide us with an appealing experimental testbed to explore world representations of moderate complexity. As our setting, we choose the popular game of Othello (Figure 1), which is simpler than chess. This setting allows us to investigate world representations in a highly controlled context, where both the task and sequence being modeled are synthetic and well-understood.</p>
<p>As a first step, we train a language model (a GPT variant we call Othello-GPT) to extend partial game transcripts (a list of moves made by players) with legal moves. The model has no a priori knowledge of the game or its rules. All it sees during training is a series of tokens derived from the game transcripts. Each token represents a tile where players place their discs. Note that we do not explicitly train the model to make strategically good moves or to win the game. Nonetheless, our model is able to generate legal Othello moves with high accuracy.</p>
<p>Our next step is to look for world representations that might be used by the network. In Othello, the "world" consists of the current board position. A natural question is whether, within the model, we can identify a representation of the board state involved in producing its next move predictions. To study this question, we train a set of probes, i.e., classifiers which allow us to infer the board state from the internal network activations. This type of probing has become a standard tool for analyzing neural networks (Alain \&amp; Bengio, 2016; Tenney et al., 2019; Belinkov, 2016).</p>
<p>Using this probing methodology, we find evidence for an emergent world representation. In particular, we show that a non-linear probe is able to predict the board state with high accuracy (section 3). (Linear probes, however, produce poor results.) This probe defines an internal representation of the board state. We then provide evidence that this representation plays a causal role in the network's predictions. Our main tool is an intervention technique that modifies internal activations so that they correspond to counterfactual board states.</p>
<p>We also discuss how knowledge of the internal world model can be used as an interpretability tool. Using our activation-intervention technique, we create latent saliency maps, which provide insight into how the network makes a given prediction. These maps are built by performing attribution at a high-level setting (the board) rather than a low-level one (individual input tokens or moves).</p>
<p>To sum up, we present four contributions: (1) we provide evidence for an emergent world model in a GPT variant trained to produce legal moves in Othello; (2) we compare the performance of linear and non-linear probing approaches, and find that non-linear probes are superior in this context; (3) we present an intervention technique that suggests that, in certain situations, the emergent world model can be used to control the network's behavior; and (4) we show how probes can be used to produce latent saliency maps to shed light on the model's predictions.</p>
<h2>2 "LANGUAGE MODELING" OF OTHELLO GAME TRANSCRIPTS</h2>
<p>Our approach for investigating internal representations of language models is to narrow our focus from natural language to a more controlled synthetic setting. We are partly inspired by the fact that language models show evidence of learning to make valid chess moves simply by observing game transcripts in training data (Toshniwal et al., 2021). We choose the game Othello, which is simpler than chess, but maintains a sufficiently large game tree to avoid memorization. Our strategy is to see what, if anything, a GPT variant learns simply by observing game transcripts, without any a priori knowledge of rules or board structure.</p>
<p>The game is played on an $8 \times 8$ board where two players alternate placing white or black discs on the board tiles. The object of the game is to have the majority of one's color discs on the board at the end of the game. Othello makes a natural testbed for studying emergent world representations since the game tree is far too large to memorize, but the rules and state are significantly simpler than chess.</p>
<p><img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1: A visual explanation of Othello rules, from left to right: (A) The board is always initialized with four discs (two black, two white) placed in the center of the board. (B) Black always moves first. Every move must flip one or more opponent discs by outflanking-or sandwiching-the opponent disc(s). (C) The opponent repeats this process. A game ends when there are no more legal moves.</p>
<p>The following subsections describe how we train a system with no prior knowledge of Othello to predict legal moves with high accuracy. The system itself is not our end goal; instead, it serves as our object of study.</p>
<h1>2.1 Datasets: "Championship" and "Synthetic"</h1>
<p>We use two sets of training data for the system, which we call "championship" and "synthetic". Each captures different objectives, namely data quality vs. quantity. While limited in size, championship data reflects strategic moves by expert human players. The synthetic data set is far larger, consisting of legal but otherwise random moves.</p>
<p>Our championship dataset is produced by collecting Othello championship games from two online sources ${ }^{3}$, containing 7,605 and 132, 921 games, respectively. They are combined and split randomly by $8: 2$ into training and validation sets. The games in this dataset were produced by matches where human players presumably made moves with a strategic intent to win. Following this, we generate a synthetic dataset with 20 million games for training and $3,796,010$ games for validation. We compute this dataset by uniformly sampling leaves from the Othello game tree. Its data distribution is different from the championship games, reflecting no strategy.</p>
<h3>2.2 Model and Training</h3>
<p>Our goal is to study how much Othello-GPT can learn from pure sequence information, so we provide as few inductive biases as possible. (Note the contrast with a system like AlphaZero (Silver et al., 2018), where the goal was to win highly competitive chess games.) We therefore use only sequential tile indices as input to our model. For example, A4 and H6 are indexed as the 4th and the 58th word in our vocabulary, respectively. Each game is treated as a sentence tokenized with a vocabulary of 60 words, where each word corresponds to one of the 60 tiles on which players put discs, excluding the 4 tiles in the center (Figure 1).</p>
<p>We trained an 8-layer GPT model (Radford et al., 2018; 2019; Brown et al., 2020) with an 8head attention mechanism and a 512-dimensional hidden space. The training was performed in an autoregressive fashion. For each partial game $\left{y_{t}\right}<em t="t">{t=0}^{T-1}$, the computation process starts from indexing a trainable word embedding consisting of the 60 vectors, each for one word, to get $\left{x</em>\right}}^{0<em t="t">{t=0}^{T-1}$. They are then sequentially processed by 8 multi-head attention layers. We denote the intermediate feature for the $t$-th token after the $l$-th layer as $x</em>$. We minimize the cross-entropy loss between ground-truth move and predicted logits by gradient descent.}^{l}$. By employing a causal mask, only the features at the immediately preceding layer and earlier time steps $x_{\leq t}^{l-1}$ are visible to $x_{t}^{l}$. Finally, $x_{T-1}^{h}$ goes through a linear classifier to predict logits for $\hat{y}_{T</p>
<p>The model starts from randomly initialized weights, including in the word embedding layer. Though there are geometrical relationships between the 60 words (e.g., C4 is below B4), this inductive bias is not explicitly given to the model but rather left to be learned.</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<h1>2.3 Othello-GPT Usually Predicts Legal Moves</h1>
<p>We now evaluate how well the model's predictions adhere to the rules of Othello. For each game in the validation set, which was not seen during training, and for each step in the game, we ask Othello-GPT to predict the next legal move conditioned by the partial game before that move. We then calculate the error rate by checking if the top-1 prediction is legal. The error rate is $0.01 \%$ for Othello-GPT trained on the synthetic dataset and $5.17 \%$ for Othello-GPT trained on the championship dataset. For comparison, the untrained Othello-GPT has an error rate of $93.29 \%$. The main takeaway is that Othello-GPT does far better than chance in predicting legal moves when trained on both datasets.
A potential explanation for these results may be that Othello-GPT is simply memorizing all possible transcripts. To test for this possibility, we created a skewed dataset of 20 million games to replace the training set of the synthetic dataset. At the beginning of every game, there are four possible opening moves: C5, D6, E3 and F4. This means the lowest layer of the game tree (first move) has four nodes (the four possible opening moves). For our skewed dataset, we truncate one of these nodes (C5), which is equivalent to removing a quarter of the whole game tree. Othello-GPT trained on the skewed dataset still yields an error rate of $0.02 \%$. Since Othello-GPT has seen none of these test sequences before, pure sequence memorization cannot explain its performance ${ }^{4}$.
If the performance of Othello-GPT is not due to memorization, what is it doing? We now turn to this question by probing for internal representations of the game state.</p>
<h2>3 Exploring Internal Representations with Probes</h2>
<p>We seek to understand if Othello-GPT computes internal representations of the game state. One standard tool for this task is a "probe" (Alain \&amp; Bengio, 2016; Belinkov, 2016; Tenney et al., 2019). A probe is a classifier or regressor whose input consists of internal activations of a network, and which is trained to predict a feature of interest, e.g., part of speech or parse tree depth (Hewitt \&amp; Manning, 2019). If we are able to train an accurate probe, it suggests that a representation of the feature is encoded in the network's activations.</p>
<p>In our case, we want to know whether Othello-GPT's internal activations contain a representation of the current board state. To study this question, we train probes that predict the board state from the network's internal activations after a given sequence of moves. Note that the board state-whether each tile is empty or holds a black or white disc-is generally a nonlinear function of the input tokens. On the other hand, it is straightforward to write a program to compute this function, it makes a natural probe target. ${ }^{5}$
We take the autoregressive features $x_{t}^{l}$ that summarize the partial sequence $y_{\leqslant t}$ as the input to the probe and study results from different layers $l$. The output $p_{\theta}\left(x_{t}^{l}\right)$ is a 3 -way categorical probability distribution. We randomly split pairs of internal representation and ground-truth tile state by $8: 2$ into training and validation set. Error rates on validation set are reported. A best random guess yields $52.95 \%$, if the probe always guesses the tile is empty.</p>
<h3>3.1 Linear Probes Have High Error Rates</h3>
<p>Our first result is that linear classifier probes have poor relative accuracy. Its function can be written as $p_{\theta}\left(x_{t}^{l}\right)=\operatorname{softmax}\left(W x_{t}^{l}\right)$ where $\theta=\left{W \in \mathbb{R}^{F \times 3}\right} . F$ is the number of dimensions of input $x_{t}^{l}$. As Table 1 shows, error rates never dip below $20 \%$. As a baseline, we have included probes trained on a randomly initialized network ${ }^{6}$ We can see that there is only a marginal improvement in accuracy when we move to probing a fully-trained network. This result suggests that if there is an internal representation of the board state, it does not have a simple linear form.</p>
<p><sup id="fnref3:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">$x^{1}$</th>
<th style="text-align: center;">$x^{2}$</th>
<th style="text-align: center;">$x^{3}$</th>
<th style="text-align: center;">$x^{4}$</th>
<th style="text-align: center;">$x^{5}$</th>
<th style="text-align: center;">$x^{6}$</th>
<th style="text-align: center;">$x^{7}$</th>
<th style="text-align: center;">$x^{8}$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Randomized</td>
<td style="text-align: center;">26.7</td>
<td style="text-align: center;">27.1</td>
<td style="text-align: center;">27.6</td>
<td style="text-align: center;">28.0</td>
<td style="text-align: center;">28.3</td>
<td style="text-align: center;">28.5</td>
<td style="text-align: center;">28.7</td>
<td style="text-align: center;">28.9</td>
</tr>
<tr>
<td style="text-align: center;">Championship</td>
<td style="text-align: center;">24.2</td>
<td style="text-align: center;">23.8</td>
<td style="text-align: center;">23.7</td>
<td style="text-align: center;">23.6</td>
<td style="text-align: center;">23.6</td>
<td style="text-align: center;">23.7</td>
<td style="text-align: center;">23.8</td>
<td style="text-align: center;">24.3</td>
</tr>
<tr>
<td style="text-align: center;">Synthetic</td>
<td style="text-align: center;">21.9</td>
<td style="text-align: center;">20.5</td>
<td style="text-align: center;">20.4</td>
<td style="text-align: center;">20.6</td>
<td style="text-align: center;">21.1</td>
<td style="text-align: center;">21.6</td>
<td style="text-align: center;">22.2</td>
<td style="text-align: center;">23.1</td>
</tr>
</tbody>
</table>
<p>Table 1: Error rates (\%) of linear probes on randomized Othello-GPT and Othello-GPTs trained on different datasets across different layers ( $x^{i}$ represents internal representations after the $i$-th layer).</p>
<h1>3.2 Nonlinear Probes Have Lower Error Rates</h1>
<p>Given the poor performance of linear probes, it is natural to ask whether a nonlinear probe would have higher accuracy. Moving up one notch of complexity, we apply a 2-layer MLP as a probe. This technique has been used successfully in other language model probing work, e.g., Conneau et al. (2018); Cao et al. (2021); Hernandez \&amp; Andreas (2021). Its function can be written as $p_{\theta}\left(x_{1}^{l}\right)=\operatorname{softmax}\left(W_{1} \operatorname{ReLU}\left(W_{2} x_{1}^{l}\right)\right)$ where $\theta=\left{W_{1} \in \mathbb{R}^{H \times 3}, W_{2} \in \mathbb{R}^{F \times H}\right} . H$ is the number of hidden dimensions for the nonlinear probes.</p>
<p>The probe accuracy for trained networks, shown in Table 2, is significantly better than the linear probe in absolute terms. By contrast, the baseline (probing a randomized network with nonlinear probes) shows almost no improvement over the linear case. These results indicate that the probe may be recovering a nontrivial representation of board state in the network's activations. In section 4, we describe intervention experiments validating this hypothesis.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">$x^{1}$</th>
<th style="text-align: center;">$x^{2}$</th>
<th style="text-align: center;">$x^{3}$</th>
<th style="text-align: center;">$x^{4}$</th>
<th style="text-align: center;">$x^{5}$</th>
<th style="text-align: center;">$x^{6}$</th>
<th style="text-align: center;">$x^{7}$</th>
<th style="text-align: center;">$x^{8}$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Randomized</td>
<td style="text-align: center;">25.5</td>
<td style="text-align: center;">25.4</td>
<td style="text-align: center;">25.5</td>
<td style="text-align: center;">25.8</td>
<td style="text-align: center;">26.0</td>
<td style="text-align: center;">26.2</td>
<td style="text-align: center;">26.2</td>
<td style="text-align: center;">26.4</td>
</tr>
<tr>
<td style="text-align: center;">Championship</td>
<td style="text-align: center;">12.8</td>
<td style="text-align: center;">10.3</td>
<td style="text-align: center;">9.5</td>
<td style="text-align: center;">9.4</td>
<td style="text-align: center;">9.8</td>
<td style="text-align: center;">10.5</td>
<td style="text-align: center;">11.4</td>
<td style="text-align: center;">12.4</td>
</tr>
<tr>
<td style="text-align: center;">Synthetic</td>
<td style="text-align: center;">11.3</td>
<td style="text-align: center;">7.5</td>
<td style="text-align: center;">4.8</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">2.4</td>
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">1.7</td>
<td style="text-align: center;">4.6</td>
</tr>
</tbody>
</table>
<p>Table 2: Error rates (\%) of nonlinear probes on randomized Othello-GPT and Othello-GPTs trained on different datasets across different layers. Standard deviations are reported in Appendix H.</p>
<h2>4 Validating Probes with Interventional Experiments</h2>
<p>Our nonlinear probe accuracies suggest that Othello-GPT computes information reflecting the board state. It's not obvious, however, whether that information is causal for the model's predictions. In the following section, we adhere to Belinkov (2016)'s recommendation, performing a set of interventional experiments to determine the causal relationship between model predictions and the emergent world representations.</p>
<p>To determine whether the board state information affects the network's predictions, we influence internal activations during Othello-GPT's calculation and measure the resulting effects. At a high level, the interventions are as follows: given a set of activations from the Othello-GPT, a probe predicts a baseline board state $B$. We record the move predictions associated with $B$, then modify these activations such that our probe reports an updated board state $B^{\prime}$. Through our protocol, only a single tile $s$ distinguishes $B^{\prime}$ from $B$ 's board state (an example of which can be seen in Figure 2). This small modification results in a different set of possible legal moves for $B^{\prime}$. If the new predictions match our expectations for $B^{\prime}$-and not the predictions we recorded for $B$-we conclude the representation had a causal effect on the model.</p>
<h3>4.1 Intervention Technique</h3>
<p>To implement an intervention that changes the predicted state from a board position $B$ to a modified version $B^{\prime}$ we must decide (a) which layers to modify activations in, and (b) how to modify those activations. The first question is subtle. Given the causal attention mechanism of GPT-2, modifying activations for only one layer is unlikely to be effective as later layer computations incorporate information from prior board representations unaffected by our intervention. Instead, we select an initial layer $L_{s}$ then modify it and subsequent layers' activations (see Figure 2 (C)). Our modification uses a simple gradient descent method on the probe's class score for the particular tile $s$ whose state is being modified.</p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 2: (A) explains how we intervene on a board tile. Here, we only want to flip one tile, e.g. E6, from white to black. In (B), four views present an Othello game in progression, which can be reliably probed from an internal representation $x$. The lower left board represents the model's perceived world state prior to intervention. The upper left board shows the model's predictions for legal moves given this state. Post-intervention, the model's world state is updated-E6's state has been switched from white to black (lower right), leading to a different set of legal move predictions (upper right). Note that two tiles (E6) are highlighted in the world state boards. This is the tile that we "intervene" on, changing from white to black. (C) Shows our proposed intervention scheme. Light blue indicates unmodified activations; dark blue represents activations affected by intervention. Starting from a predefined layer, we intervene at the temporally-last token (shown in (A)). We replace original internal representations with the post-intervention ones and resume computation for the next one layer. Part of the misinformation gets corrected (light blue), but we alternate this intervening and computation process until the last layer, from which the next-step prediction is made.</p>
<p>Figure 2 illustrates an intervention on a single feature $x$ into $x^{\prime}$ such that the corresponding board state $B$ is updated to match the desired $B^{\prime}$. We observe the effectiveness of these interventions by probing the intervened $x^{\prime}$ or $x$ at later layers (see Appendix D), as well as the change in next-step prediction (see subsection 4.2). Consistent with the training process of probes $p_{\theta}$, we use cross entropy loss between the probe-predicted probability distribution and the desired board state, but rather than optimize probe weights $\theta$, we optimize $x$ for intervention ${ }^{7}$ :</p>
<p>$$
x^{\prime} \leftarrow x-\alpha \frac{\partial \mathcal{L}<em _theta="\theta">{\mathrm{CE}}\left(p</em>
$$}(x), B^{\prime}\right)}{\partial x</p>
<p>At timestep $T$, the internal activations of an $L$-layer Othello-GPT can be viewed as an $L \times T$ grid of activation vectors. Our intervention process runs Othello-GPT sequentially, but uses gradient descent to modify key activation vectors at the last timestep such that their board state class scores change. Note that if we change activations only at a middle layer, activations at higher layers are directly affected by pre-intervention information. Thus, we sequentially intervene $\left{x_{T-1}^{l}\right}<em s="s">{l=L</em>$ until the final layer, illustrated in Figure 2.}}^{L}$ at the last timestep, on all activations starting from a preset layer $L_{s</p>
<p><sup id="fnref4:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p><img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 3: Intervention experiment results. Red dashed lines represent an average number of errors by testing pre-intervention predictions on post-intervention ground-truths, representing a null intervention method for contrast. The shaded area represents the $95 \%$ confidence interval.</p>
<h1>4.2 Evidence for a CAUSAL ROLE FOR THE REPRESENTATION</h1>
<p>To systematically determine if this world representation is causal for model predictions, we create an evaluation benchmark set. A test case in this set consists of a triple of a partial game, a targeted board tile, and a target state. For each case, we give the partial game to Othello-GPT and perform the intervention described in the previous section. I.e., we extract the model's activations midcomputation, modify them to change the representation of the targeted board tile into the target state, give back the modified world representation and let it make a prediction with this new world state.
The benchmark set consists of two subsets of 1000 intervention cases: one "natural," one "unnatural." The natural subset consists of positions reachable by legal play. The unnatural subset contains positions that are unreachable by legal play. This second subset is designed to be a stringent test, since it is by definition far from anything encountered in the training distribution.</p>
<p>We measure prediction alignment with the intervened world representation as a multi-label classification problem, comparing the top- $N$ predictions against the ground-truth legal next-move set, where $N$ is the number of legal next-moves after intervention. We then calculate an error per case (a sum of false positives and false negatives, shown in Figure 3) ${ }^{8}$. For both benchmarks, $L_{s}=4$ (intervening 5 layers) gives the best result: average errors of $\mathbf{0 . 1 2}$ and $\mathbf{0 . 0 6}$ respectively. Compared to baseline errors ( $\mathbf{2 . 6 8}$ and $\mathbf{2 . 5 9}$ ), the proposed intervention technique is effective even under unnatural board states, suggesting the emergent representations are causal to model predictions.</p>
<h2>5 Latent Saliency Maps: Attribution via Intervention</h2>
<p>The intervention technique of the previous section provides insight into the predictions of OthelloGPT. We can also use it to create visualizations which contextualize Othello-GPT's predictions in terms of the board state. The basic idea is simple. For each tile $s$ on the board $B$, we ask how much the network's prediction probability for the attributed tile p will change if we apply the intervention technique in section 4 to change the state representation of that tile $s$. This will yield a value per tile $s \in B$, positive or negative, corresponding to its saliency in the prediction of p (see algorithm 1). We then create a visualization of the board where tiles are colored according to their saliency for the top-1 prediction for the current board state ${ }^{9}$. Because this map is based on the network's latent space rather than its input, we call it a latent saliency map.</p>
<p>Figure 4 shows latent saliency maps for the top-1 predictions for Othello-GPTs trained on the synthetic and championship datasets by intervening from $L_{s}=4$. The two diagrams show a clear pattern. The synthetic Othello-GPT shows high saliency for precisely those tiles that are required to make a move legal. In almost all cases, other tiles have lower saliency values. Even without knowing how synthetic-GPT was trained, an experienced Othello player might be able to guess its goal. The latent saliency maps for the championship version, however, are more complex. Although tiles that relate directly to legality typically have high values, many other tiles show high saliency as well. This pattern makes sense, too. Expert moves rely on complex global features of the board. The difference</p>
<p><sup id="fnref5:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p><img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Figure 4: Latent saliency maps: Each subplot shows a different game state, and the top-1 prediction by the model is enclosed in a black box. Colors (red is high, blue is low) indicate the contribution of a tile's state to this prediction. The contribution is higher when changing the internal representation of this tile makes the prediction less likely. The values are normalized by subtracting the mean of the board. (A) Latent saliency maps for Othello-GPT trained on the synthetic dataset, where the model learns legal moves. (B) Latent saliency maps for Othello-GPT trained on the championship dataset. Rather than learning rules, this Othello-GPT learns to make strategically good moves.
between the latent saliency maps for the two versions of Othello-GPT suggests that the visualization technique is providing useful information about the two systems.</p>
<div class="codehilite"><pre><span></span><code><span class="n">Algorithm</span><span class="w"> </span><span class="mh">1</span><span class="o">:</span><span class="w"> </span><span class="n">Attribution</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">Intervention</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">Othello</span><span class="o">-</span><span class="n">GPT</span>
<span class="n">Inputs</span><span class="w"> </span><span class="o">:</span>
<span class="w">    </span><span class="n">B</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="n">board</span><span class="w"> </span><span class="n">state</span>
<span class="w">    </span><span class="n">p</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">legal</span><span class="w"> </span><span class="n">next</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">try</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">attribute</span>
<span class="n">Output</span><span class="w"> </span><span class="o">:</span>
<span class="w">    </span><span class="n">\(\left\{S_{s}\right\}_{s</span><span class="w"> </span><span class="n">\in</span><span class="w"> </span><span class="n">B</span><span class="p">}</span><span class="n">\)</span><span class="w"> </span><span class="n">assigned</span><span class="w"> </span><span class="n">sensitivity</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">prediction</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">\(p\)</span>
<span class="n">\(p_{0}</span><span class="w"> </span><span class="n">\leftarrow</span><span class="w"> </span><span class="n">f_</span><span class="p">{</span><span class="n">\mathrm{p}}\left(x_{t-1}\right)</span><span class="w"> </span><span class="n">\quad</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="n">\)</span><span class="w"> </span><span class="n">pre</span><span class="o">-</span><span class="n">intervention</span><span class="w"> </span><span class="n">next</span><span class="o">-</span><span class="n">step</span><span class="w"> </span><span class="n">probability</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">p</span>
<span class="k">for</span><span class="w"> </span><span class="n">\(s</span><span class="w"> </span><span class="n">\in</span><span class="w"> </span><span class="n">B\)</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="n">\(\hat{x}_{t-1}</span><span class="w"> </span><span class="n">\leftarrow</span><span class="w"> </span><span class="n">\operatorname{Intervention}\left(x_{t-1},</span><span class="w"> </span><span class="n">s\right)\)</span>
<span class="w">    </span><span class="n">\(p_{s}</span><span class="w"> </span><span class="n">\leftarrow</span><span class="w"> </span><span class="n">f_</span><span class="p">{</span><span class="n">\mathrm{p}}\left(\hat{x}_{t-1}\right)\)</span>
<span class="w">    </span><span class="n">\(S_{s}</span><span class="w"> </span><span class="n">\leftarrow</span><span class="w"> </span><span class="n">p_</span><span class="p">{</span><span class="mh">0</span><span class="p">}</span><span class="o">-</span><span class="n">p_</span><span class="p">{</span><span class="n">s</span><span class="p">}</span><span class="n">\)</span>
</code></pre></div>

<h1>6 RELATED WORK</h1>
<p>Our work fits into a general line of investigation into world representations created by sequence models. For example, (Li et al., 2021) fine-tune two language models on synthetic natural language</p>
<p>tasks (Long et al., 2016) and find evidence that semantic information about the underlying world state is at least weakly encoded in the activations of the network. More direct evidence of a faithful representation of 3D color space comes from Abdou et al. (2021), who examine activations in the BERT model and find a geometric connection to a standard 3D color space. Another study by (Patel \&amp; Pavlick, 2022) shows that language models can learn to map conceptual domains, e.g., direction and color, onto a grounded world representation via prompting techniques (Brown et al., 2020). These investigations operate in natural language domains, but investigate relatively simple world models.</p>
<p>Another related stream of work concerns neural networks that learn board games. There is a long history of work in AI to learn game moves, but in general, these systems have been given some a priori knowledge of the structure of the game. Even one of the most general-purpose gameplaying engines, AlphaZero (Silver et al., 2018), has built-in knowledge of basic board structure and game rules (although, intriguingly, it seems to develop interpretable models of various strategic concepts (McGrath et al., 2021; Forde et al., 2022)). Closer to the work described here-and a major motivation for our research-is Toshniwal et al. (2021) which trains a language model on chess transcripts. They show strong evidence that transformer networks are building a representation of internal board state, but they stop short at investigating what form that representation takes.</p>
<p>The intervention technique of section 4 follows an approach of steering model output while keeping the model frozen. It is related to the ideas behind plug-and-play controllable text generation for autoregressive (Dathathri et al., 2019; Qin et al., 2020; Krause et al., 2020) and diffusion (Li et al., 2022) language models by optimizing the likelihood of the desired attribute and the fluency of generated texts at the same time. These methods naturally involve a trade-off and require several forward and backward passes to generate. Our proposed intervention method stands out by only working on internal representations and requires only one forward pass. Finally, latent saliency maps can be viewed as a generalization of the TCAV approach Kim et al. (2018); Ghorbani et al. (2019); Koh et al. (2020). In the TCAV setting, attribution is performed via directional derivatives. This is essentially a linearization of the gradient-descent optimization used in our attribution maps.</p>
<h1>7 CONCLUSION</h1>
<p>Our experiments provide evidence that Othello-GPT maintains a representation of game board statesthat is, the Othello "world"-to produce sequences it was trained on. This representation appears to be nonlinear in an essential way. Further, we find that these representations can be causally linked to how the model makes its predictions. Understanding of the internal representations of a sequence model is interesting in its own right, but may also be helpful in deeper interpretations of the network.</p>
<p>We have also described how interventional experiments may be used to create a "latent saliency map", which gives a picture, in terms of the Othello board, of how the network has made a prediction. Applied to two versions of Othello-GPT that were trained on different data sets, the latent saliency maps highlight the dramatic differences between underlying representations of the Othello-GPT trained on a synthetic dataset and its counterpart trained on championship dataset.</p>
<p>There are several potential lines of future work. One natural extension would be to perform the same type of investigation with other, more complex games. It would also be interesting to compare the strategies learned by a sequence model trained on game transcripts with those of a model trained with a priori knowledge of Othello. One option is to compare latent saliency maps of Othello-GPT with standard saliency maps of an Othello-playing program which has the actual board state as input.</p>
<p>More broadly, it would be interesting to study how our results generalize to models trained on natural language. One stepping stone might be to look at language models whose training data has included game transcripts. Will we see a similar representation of the board state? Grammar engineering tools (Weston et al., 2015; Hermann et al., 2017; Côté et al., 2018) could help define a synthetic data generation process that maps world representations onto natural language sentences, providing a similarly controllable setting like Othello while closing the distance to natural languages. For more complex natural language tasks, can we find meaningful world representations? Our hope is that the tools described in this paper-nonlinear probes, layerwise interventions, and latent saliency maps-may prove useful in natural language settings.</p>
<h1>ACKNOWLEDGMENTS</h1>
<p>We thank members of the Visual Computing Group and the Insight + Interaction Lab at Harvard for their early discussions and feedback. We especially thank Aoyu Wu for helping with making part of the figures and other valuable suggestions. We gratefully acknowledge the support of Harvard SEAS Fellowship (to KL), Siebel Fellowship (to AH), Open Philanthropy (to DB), and FTX Future Fund Regrant Program (to DB). This work was partially supported by NSF grant IIS-1901030.</p>
<h2>REFERENCES</h2>
<p>Mostafa Abdou, Artur Kulmizev, Daniel Hershcovich, Stella Frank, Ellie Pavlick, and Anders Søgaard. Can language models encode perceptual structure without grounding? a case study in color. arXiv preprint arXiv:2109.06129, 2021.</p>
<p>Guillaume Alain and Yoshua Bengio. Understanding intermediate layers using linear classifier probes. arXiv preprint arXiv:1610.01644, 2016.</p>
<p>Yonatan Belinkov. Probing classifiers: Promises, shortcomings, and advances. Computational Linguistics, pp. 1-12, 2016.</p>
<p>Emily M Bender and Alexander Koller. Climbing towards nlu: On meaning, form, and understanding in the age of data. In Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics, pp. 5185-5198, 2020.</p>
<p>Emily M Bender, Timnit Gebru, Angelina McMillan-Major, and Shmargaret Shmitchell. On the dangers of stochastic parrots: Can language models be too big? In Proceedings of the 2021 ACM Conference on Fairness, Accountability, and Transparency, pp. 610-623, 2021.</p>
<p>Tom B Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. Language models are few-shot learners. arXiv preprint arXiv:2005.14165, 2020.</p>
<p>Steven Cao, Victor Sanh, and Alexander M Rush. Low-complexity probing via finding subnetworks. arXiv preprint arXiv:2104.03514, 2021.</p>
<p>Alexis Conneau, German Kruszewski, Guillaume Lample, Loïc Barrault, and Marco Baroni. What you can cram into a single vector: Probing sentence embeddings for linguistic properties. arXiv preprint arXiv:1805.01070, 2018.</p>
<p>Marc-Alexandre Côté, Akos Kádár, Xingdi Yuan, Ben Kybartas, Tavian Barnes, Emery Fine, James Moore, Matthew Hausknecht, Layla El Asri, Mahmoud Adada, et al. Textworld: A learning environment for text-based games. In Workshop on Computer Games, pp. 41-75. Springer, 2018.</p>
<p>Sumanth Dathathri, Andrea Madotto, Janice Lan, Jane Hung, Eric Frank, Piero Molino, Jason Yosinski, and Rosanne Liu. Plug and play language models: A simple approach to controlled text generation. arXiv preprint arXiv:1912.02164, 2019.</p>
<p>Luciano Floridi and Massimo Chiriatti. Gpt-3: Its nature, scope, limits, and consequences. Minds and Machines, 30(4):681-694, 2020.</p>
<p>Jessica Zosa Forde, Charles Lovering, George Konidaris, Ellie Pavlick, and Michael L Littman. Where, when \&amp; which concepts does alphazero learn? lessons from the game of hex. In AAAI Workshop on Reinforcement Learning in Games, volume 2, 2022.</p>
<p>Amirata Ghorbani, James Wexler, James Y Zou, and Been Kim. Towards automatic concept-based explanations. Advances in Neural Information Processing Systems, 32, 2019.</p>
<p>Karl Moritz Hermann, Felix Hill, Simon Green, Fumin Wang, Ryan Faulkner, Hubert Soyer, David Szepesvari, Wojciech Marian Czarnecki, Max Jaderberg, Denis Teplyashin, et al. Grounded language learning in a simulated 3d world. arXiv preprint arXiv:1706.06551, 2017.</p>
<p>Evan Hernandez and Jacob Andreas. The low-dimensional linear geometry of contextualized word representations. arXiv preprint arXiv:2105.07109, 2021.</p>
<p>John Hewitt and Christopher D Manning. A structural probe for finding syntax in word representations. In Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers), pp. 4129-4138, 2019.</p>
<p>Been Kim, Martin Wattenberg, Justin Gilmer, Carrie Cai, James Wexler, Fernanda Viegas, et al. Interpretability beyond feature attribution: Quantitative testing with concept activation vectors (tcav). In International conference on machine learning, pp. 2668-2677. PMLR, 2018.</p>
<p>Pang Wei Koh, Thao Nguyen, Yew Siang Tang, Stephen Mussmann, Emma Pierson, Been Kim, and Percy Liang. Concept bottleneck models. In International Conference on Machine Learning, pp. 5338-5348. PMLR, 2020.</p>
<p>Ben Krause, Akhilesh Deepak Gotmare, Bryan McCann, Nitish Shirish Keskar, Shafiq Joty, Richard Socher, and Nazneen Fatema Rajani. Gedi: Generative discriminator guided sequence generation. arXiv preprint arXiv:2009.06367, 2020.</p>
<p>Belinda Z Li, Maxwell Nye, and Jacob Andreas. Implicit representations of meaning in neural language models. arXiv preprint arXiv:2106.00737, 2021.</p>
<p>Xiang Lisa Li, John Thickstun, Ishaan Gulrajani, Percy Liang, and Tatsunori B Hashimoto. DiffusionIm improves controllable text generation. arXiv preprint arXiv:2205.14217, 2022.</p>
<p>Reginald Long, Panupong Pasupat, and Percy Liang. Simpler context-dependent logical forms via model projections. arXiv preprint arXiv:1606.05378, 2016.</p>
<p>Thomas McGrath, Andrei Kapishnikov, Nenad Tomašev, Adam Pearce, Demis Hassabis, Been Kim, Ulrich Paquet, and Vladimir Kramnik. Acquisition of chess knowledge in alphazero. arXiv preprint arXiv:2111.09259, 2021.</p>
<p>William Merrill, Yoav Goldberg, Roy Schwartz, and Noah A Smith. Provable limitations of acquiring meaning from ungrounded form: What will future language models understand? Transactions of the Association for Computational Linguistics, 9:1047-1060, 2021.</p>
<p>Roma Patel and Ellie Pavlick. Mapping language models to grounded conceptual spaces. In International Conference on Learning Representations, 2022. URL https://openreview. net/forum?id=gJcEM8sxHK.</p>
<p>Lianhui Qin, Vered Shwartz, Peter West, Chandra Bhagavatula, Jena Hwang, Ronan Le Bras, Antoine Bosselut, and Yejin Choi. Back to the future: Unsupervised backprop-based decoding for counterfactual and abductive commonsense reasoning. arXiv preprint arXiv:2010.05906, 2020.</p>
<p>Alec Radford, Karthik Narasimhan, Tim Salimans, Ilya Sutskever, et al. Improving language understanding by generative pre-training. 2018.</p>
<p>Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al. Language models are unsupervised multitask learners. OpenAI blog, 1(8):9, 2019.</p>
<p>David Silver, Thomas Hubert, Julian Schrittwieser, Ioannis Antonoglou, Matthew Lai, Arthur Guez, Marc Lanctot, Laurent Sifre, Dharshan Kumaran, Thore Graepel, et al. A general reinforcement learning algorithm that masters chess, shogi, and go through self-play. Science, 362(6419): $1140-1144,2018$.</p>
<p>Aarohi Srivastava, Abhinav Rastogi, Abhishek Rao, Abu Awal Md Shoeb, Abubakar Abid, Adam Fisch, Adam R Brown, Adam Santoro, Aditya Gupta, Adrià Garriga-Alonso, et al. Beyond the imitation game: Quantifying and extrapolating the capabilities of language models. arXiv preprint arXiv:2206.04615, 2022.</p>
<p>Ian Tenney, Dipanjan Das, and Ellie Pavlick. Bert rediscovers the classical nlp pipeline. arXiv preprint arXiv:1905.05950, 2019.</p>
<p>Shubham Toshniwal, Sam Wiseman, Karen Livescu, and Kevin Gimpel. Learning chess blindfolded: Evaluating language models on state tracking. arXiv preprint arXiv:2102.13249, 2021.</p>
<p>Jason Weston, Antoine Bordes, Sumit Chopra, Alexander M Rush, Bart Van Merriënboer, Armand Joulin, and Tomas Mikolov. Towards ai-complete question answering: A set of prerequisite toy tasks. arXiv preprint arXiv:1502.05698, 2015.</p>
<p><img alt="img-4.jpeg" src="img-4.jpeg" /></p>
<p>Figure 5: Geometry of probe weights. The first row is for linear probe weights; the second row is for the second-layer weights of the nonlinear probes. Three columns from left to right mean: probes trained on randomly-initialized GPT, on GPTs trained on championship and synthetic datasets respectively. For each subplot, one dot represents one tile on an Othello board, and neighbouring tiles have their two dots connected. Top-left and right-bottom corners are labelled for reference. Togglable 3D plots can be found in Supplementary Material.</p>
<p>Both linear and nonlinear probes can be viewed as geometric objects. In the case of linear probes, we can associate each classifier with the normal vector to the separating hyperplane. In the case of nonlinear probes, we can treat the second layer of the MLP as a linear classifier and take the same view. This perspective associates a vector to each grid tile, corresponding to the classifier for that grid tile.</p>
<p>A natural question is whether these vectors display any geometric patterns. Figure 5 visualizes their configuration using PCA plots. To make the connection with board geometry clear, we have overlaid a grid in which the vector for a given grid tile is connected to the vectors that represent its neighbors. At left, as a baseline, are weights of probes trained on randomized GPTs; the result is a somewhat jumbled version of the board's grid. For classifier vectors, however, we see a somewhat clearer geometric correlation with the grid shape itself. This shape may reflect a set of correlations between neighboring grid cells, and could be an interesting object for future study. One point of interest is that probe geometry for the randomized network does not seem completely random. This may fit with the fact that linear probe baseline performance is better than chance, indicating some information about board state can be gleaned from random projections of game move tokens.</p>
<h1>B Ablation on Nonlinear Probe Accuracies</h1>
<p>Though high accuracies have been observed on nonlinear probes in section 3, we want to develop a deeper understanding on them. For example, we wish to understand when, during a game, a model has developed world representations of board tiles, where in Othello-GPT that information is stored, how difficult it is to decode that information, and when the model may forget that information.</p>
<p>As shown in Figure 6 (B), we plot probe accuracies of two-layer probes varying to two different experiment settings: (1) Probe Hidden Units: the number of hidden units $H$ in nonlinear probes; (2) Layer: at which layer the representations $x^{l}$ is taken out. With the increase of hidden units, i.e., probe capacity, probe accuracy is higher as it can capture more knowledge from the hidden space. For layer $l$, the accuracy peaks at midway, which is aligned with studies on natural language (Hewitt \&amp; Manning, 2019), where linguistic properties are found to be best probed in mid-layers. The format of our what-how-where plots is similar to the what-when-where plots in McGrath et al. (2021), except we ask how many hidden units within our nonlinear probe are necessary to achieve reasonable accuracy given each layer of the GPT instead of looking into number of training epochs.</p>
<p>We are also curious about when (in terms of game progression) these concepts are captured by Othello-GPT. Are these concepts updated immediately after each move? Will they persist or be</p>
<p><img alt="img-5.jpeg" src="img-5.jpeg" /></p>
<p>Figure 6: (A) What-how-where plots and (B) What-how-when plots of nonlinear probes trained on randomly-initialized GPT, on GPTs trained on championship and synthetic datasets respectively. (A) presents probe accuracy across an Othello game progression, while (B) presents accuracy across Othello-GPT layers.
forgotten with newer moves being made? To study this, we divide the data points for probe validation by how many steps the tile has been in its current state and plot what concept can be probed by how powerful probes when in the game progression in Figure 6 (A).
For nonlinear probes with a moderate number of hidden units, a parabolic accuracy curve is shown: concepts are best captured when they have existed for some time but not too long. This tells us: (1) forgetting happens when Othello-GPT changes its world representations; (2) there is a period of uncertainty before changes in board states are updated.</p>
<h1>C PREDICTION HEATMAPS OF COUNTERFACTUAL BOARD STATES</h1>
<p>In Figure 7, we can see one case of how intervention changes model prediction by intervening on the world representation of Othello-GPT. Note that the set of ground-truth legal moves are also changed by the intervention. In this case, both pre-intervention and post-intervention predictions have 0 errors. Figure 3 shows systematic results over 1,000 cases. A random subset of 100 cases can be found in Supplementary Materials.</p>
<h2>D INTER-PROBE INTERACTION</h2>
<p>In Figure 8 we show the same case as in Appendix C of the world states probed from layers of Othello-GPT starting the 5th, which is the layer we start to intervene, $L_{s}$. We can observe that after intervention is successfully done on the 5 th layer at C 4 , the flipped disc is corrected in the immediately following layer, as seen in the pre-intervention probing results at the 6 -th layer. However, when the same intervention is done on later layers again, the model is more convinced that C 4 should be black and stops to correct it. A total of 100 cases can be found in Supplementary Materials, corresponding to examples in Appendix C.</p>
<p><img alt="img-6.jpeg" src="img-6.jpeg" /></p>
<p>Figure 7: Heatmaps of the probability allocated to each tile on the board with nonlinear intervention done on Othello-GPT trained on synthetic dataset. To the left is the pre-intervention heatmap with preintervention legal moves underscored; to the right is post-intervention heatmap, with post-intervention legal moves underscored.
<img alt="img-7.jpeg" src="img-7.jpeg" /></p>
<p>Figure 8: The world states predicted by probes pre-and-post-intervention on internal representations at different layers. Color encodes the confidence of the plotted top-1 prediction for each tile.</p>
<h1>E Discussion of Latent Saliency Maps</h1>
<p>In the latent saliency maps created by attribution via intervention in Figure 4, when multiple discs are flipped, only the first one is found contributing, which is slightly misaligned to human understanding of the Othello rule. However, this is expected from the algorithm we are using because other flipped discs, even in opposite states, still make the current prediction legal.</p>
<p>The attribution via intervention method succeeds at visualizing the AND-logic in the Othello rule to flip one straight line: there should be opponent discs in between and same-color disc at the other end. However, when the prediction flips more than one straight line, intervening on one of them does not nullify the prediction. This is because the Othello rule is an OR-logic on top of the AND-logic: a move is legal when either one of the eight straight lines can be flipped. How to extract such knowledge with unlimited amount of intervention experiments at hand? We leave it for future research.</p>
<p><img alt="img-8.jpeg" src="img-8.jpeg" /></p>
<p>Figure 9: Same as Figure 3 except for reporting $F_{1}$ instead of Error.
<img alt="img-9.jpeg" src="img-9.jpeg" /></p>
<p>Figure 10: Same as above but for $D_{K L}$.</p>
<h1>F Alternative Metrics for the Intervention Experiment</h1>
<p>Following the same multi-label classification framework that calculates the error in Figure 3, we report the $F_{1}$ score in Figure 9. We measure intervention success as a multi-class classification problem, rather than a top-1 prediction problem like in section 3, considering the fact that the latter metric is almost saturated for the Othello-GPT trained on synthetic dataset and the intervention in benchmark only cause a set difference of 2.12 tiles on average.</p>
<p>Another line of thought to measure the alignment between model prediction and the intervened world representation is by measuring the KL divergence of the predicted next-move probability distribution from a discrete uniform prior distribution over all legal next-moves. Note that the baseline $F_{1}$ and $D_{K L}$ are the averages of the $F_{1}$ and $D_{K L}$ overall 1000 intervention cases, rather than treating the whole benchmark as one single multi-label classification problem or distribution distance calculation.</p>
<p>Error (Figure 3), $F_{1}$ (Figure 9), and KL divergence (Figure 10) show a similar trend, confirming that the proposed intervention technique is useful and validating the causality from world representations to model predictions.</p>
<h2>G Ablations on Intervention Hyper-parameters</h2>
<p>Experiments find this optimization process is robust to different configurations of optimizer, learning rate $\alpha$, and number of steps.</p>
<p>The complete world state, including states of all the 64 board tiles, is encoded in a single internal representation $x$, while during intervention experiment, we only wish to change one of them. A natural question is: will the intervention operation flip tiles we do not intend? It is possible but we can mitigate that by considering the cross entropy losses of other tiles as a regularization term, weighted by a hyper-parameter $\beta$. That is to say, the loss in main paper can be expanded as:</p>
<p>$$
\mathcal{L}<em _theta="\theta">{\mathrm{CE}}\left(p</em>}(x), B^{\prime}\right)=\sum_{s \in B \neq B^{\prime}} \mathcal{L<em _theta="\theta">{\mathrm{CE}}\left(p</em>}^{s}(x), B^{\prime}(s)\right)+\beta \sum_{s \in B=B^{\prime}} \mathcal{L<em _theta="\theta">{\mathrm{CE}}\left(p</em>(x), B(s)\right)
$$}^{s</p>
<p>We sweep $\beta$ at the best $L_{s}=5$ on the natural benchmark and report average number of errors in Table 3. We can observe it does not clearly help.</p>
<p>Here we further discuss another hyper-parameter ablated in Figure 3, the starting layer for intervention, $L_{s}$. If we intervene with more than 5 layers, shallow layers which have not developed reliable world</p>
<table>
<thead>
<tr>
<th style="text-align: center;">$\beta$</th>
<th style="text-align: center;">0.0</th>
<th style="text-align: center;">0.1</th>
<th style="text-align: center;">0.2</th>
<th style="text-align: center;">0.3</th>
<th style="text-align: center;">0.4</th>
<th style="text-align: center;">0.5</th>
<th style="text-align: center;">0.6</th>
<th style="text-align: center;">0.7</th>
<th style="text-align: center;">0.8</th>
<th style="text-align: center;">0.9</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">error</td>
<td style="text-align: center;">0.22</td>
<td style="text-align: center;">0.31</td>
<td style="text-align: center;">0.77</td>
<td style="text-align: center;">0.19</td>
<td style="text-align: center;">0.51</td>
<td style="text-align: center;">0.65</td>
<td style="text-align: center;">0.42</td>
<td style="text-align: center;">0.45</td>
<td style="text-align: center;">0.46</td>
<td style="text-align: center;">0.55</td>
</tr>
</tbody>
</table>
<p>Table 3: Average number of errors under different $\beta$ 's and $L_{s}=5$ on the natural benchmark.
representations (according to Figure 6) are touched, making intervention hazardous. On the other hand, if we intervene only at the deepest layers, though the world representation can be intervened successfully (see Appendix D), the model does not have enough computation to adapt to the newer world representation and makes predictions corresponding to it.</p>
<h1>H Standard Deviation of Probe Accuracy</h1>
<p>In order to exclude the possibility that the differences in probe accuracies in Table 1 and Table 2 are caused by randomness, we run the same experiment for 100 times with different random seeds and report the standard deviations of them in Table 4 and Table 5, based on which we conclude that the probe accuracies are robust to randomness and there are significant differences between the probe accuracies of linear and nonlinear probes, and also between probes on randomized Othello-GPT and Othello-GPTs trained on different datasets.</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">$x^{1}$</th>
<th style="text-align: center;">$x^{2}$</th>
<th style="text-align: center;">$x^{3}$</th>
<th style="text-align: center;">$x^{4}$</th>
<th style="text-align: center;">$x^{5}$</th>
<th style="text-align: center;">$x^{6}$</th>
<th style="text-align: center;">$x^{7}$</th>
<th style="text-align: center;">$x^{8}$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Randomized</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">0.06</td>
</tr>
<tr>
<td style="text-align: center;">Championship</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.06</td>
</tr>
<tr>
<td style="text-align: center;">Synthetic</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.08</td>
</tr>
</tbody>
</table>
<p>Table 4: Standard deviations of error rates (\%) of linear probes on randomized Othello-GPT and Othello-GPTs trained on different datasets across different layers ( $x^{i}$ represents internal representations after the $i$-th layer).</p>
<table>
<thead>
<tr>
<th style="text-align: center;"></th>
<th style="text-align: center;">$x^{1}$</th>
<th style="text-align: center;">$x^{2}$</th>
<th style="text-align: center;">$x^{3}$</th>
<th style="text-align: center;">$x^{4}$</th>
<th style="text-align: center;">$x^{5}$</th>
<th style="text-align: center;">$x^{6}$</th>
<th style="text-align: center;">$x^{7}$</th>
<th style="text-align: center;">$x^{8}$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Randomized</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.03</td>
</tr>
<tr>
<td style="text-align: center;">Championship</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.06</td>
</tr>
<tr>
<td style="text-align: center;">Synthetic</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.05</td>
</tr>
</tbody>
</table>
<p>Table 5: Standard deviations of error rates (\%) of nonlinear probes on randomized Othello-GPT and Othello-GPTs trained on different datasets across different layers ( $x^{i}$ represents internal representations after the $i$-th layer).</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{8}$ Qualitative results can be found in Appendix C. We report additional metrics in Appendix F.
${ }^{9}$ However, ideally we can attribute any prediction. See Appendix E for more discussion.&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref5:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>