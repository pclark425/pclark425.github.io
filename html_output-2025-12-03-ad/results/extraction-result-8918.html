<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-8918 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-8918</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-8918</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-155.html">extraction-schema-155</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <p><strong>Paper ID:</strong> paper-de20b6488e148a19ae6c63defbfca8a6373e4110</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/de20b6488e148a19ae6c63defbfca8a6373e4110" target="_blank">Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction</a></p>
                <p><strong>Paper Venue:</strong> ACS Central Science</p>
                <p><strong>Paper TL;DR:</strong> This work shows that a multihead attention Molecular Transformer model outperforms all algorithms in the literature, achieving a top-1 accuracy above 90% on a common benchmark data set and is able to handle inputs without a reactant–reagent split and including stereochemistry, which makes the method universally applicable.</p>
                <p><strong>Paper Abstract:</strong> Organic synthesis is one of the key stumbling blocks in medicinal chemistry. A necessary yet unsolved step in planning synthesis is solving the forward problem: Given reactants and reagents, predict the products. Similar to other work, we treat reaction prediction as a machine translation problem between simplified molecular-input line-entry system (SMILES) strings (a text-based representation) of reactants, reagents, and the products. We show that a multihead attention Molecular Transformer model outperforms all algorithms in the literature, achieving a top-1 accuracy above 90% on a common benchmark data set. Molecular Transformer makes predictions by inferring the correlations between the presence and absence of chemical motifs in the reactant, reagent, and product present in the data set. Our model requires no handcrafted rules and accurately predicts subtle chemical transformations. Crucially, our model can accurately estimate its own uncertainty, with an uncertainty score that is 89% accurate in terms of classifying whether a prediction is correct. Furthermore, we show that the model is able to handle inputs without a reactant–reagent split and including stereochemistry, which makes our method universally applicable.</p>
                <p><strong>Cost:</strong> 0.018</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <div class="extraction-instance-container" id="e8918.0">
                <h3 class="extraction-instance">Extracted Data Instance 0 (e8918.0)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Molecular Transformer</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Molecular Transformer - A Model for Uncertainty-Calibrated Chemical Reaction Prediction</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>An attention-only (multi-head transformer) encoder-decoder model that treats chemical reaction prediction as SMILES-to-SMILES translation and provides calibrated uncertainty scores for predicted products.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Molecular Transformer - A Model for Uncertainty-Calibrated Chemical Reaction Prediction</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Molecular Transformer</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>Transformer (multi-head attention) encoder-decoder, autoregressive SMILES seq2seq</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td>Approximately 12M parameters (adapted from a 65M-base transformer to 4 layers of size 256)</td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td>Patent-derived reaction SMILES datasets (canonicalized with RDKit) including USPTO_MIT, USPTO_LEF, USPTO_STEREO and a Pistachio-derived time-split test set; inputs tokenized SMILES with data augmentation via random SMILES.</td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Reaction outcome prediction / organic synthesis planning (helps route design by predicting products and scoring pathway uncertainty).</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Sequence-to-sequence autoregressive generation of product SMILES from concatenated reactant+reagent SMILES; beam search decoding (optionally chemically-constrained beam search); confidence score computed as product of token probabilities.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td>Not used to deliberately generate novel molecules — predicts likely reaction products given reactants/reagents from training-style chemistry; novelty metrics for generated molecules are not reported.</td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Specialization to reaction prediction achieved by training on large reaction corpora (patent SMILES); the model handles mixed reactant/reagent inputs and stereochemistry to varying degrees; uncertainty score used to rank/prioritize reaction steps/pathways.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td>Top-k accuracy (Top-1, Top-2, Top-3, Top-5), AUC-ROC for confidence score distinguishing correct vs incorrect predictions (0.89), invalid-SMILES rate.</td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>Achieves top-1 accuracy up to 90.4% on USPTO_MIT with separated reagents (93.7% top-2), 88.6% top-1 when reactants and reagents are mixed; on USPTO_STEREO top-1 ~78.1% (separated) and 76.2% (mixed); uncertainty AUC-ROC = 0.89; invalid SMILES rate very low (0.5% reported on one test set).</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Outperforms prior seq2seq RNN and graph-based methods across benchmark datasets (reported improvements over S2S RNN and multiple graph-based models), is less reliant on handcrafted templates/atom-mapping than template-based methods.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Not a de novo molecular generator — focused on prediction; lower performance on stereochemistry and resolution reactions; model performance depends on data quality (patent noise); reagents/reactant split in datasets is an unrealistic prior often used by others; label smoothing harms uncertainty estimation; potential for 'alchemy' (changing atom types) exists but model learned to avoid it in practice; multistep synthesis still vulnerable to compounding errors.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8918.1">
                <h3 class="extraction-instance">Extracted Data Instance 1 (e8918.1)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Transformer (Vaswani et al.)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Attention is all you need</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>The original multi-head attention-based transformer architecture for sequence modeling (encoder-decoder) that replaces recurrent networks with attention and positional encodings; adapted here for chemical SMILES translation.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Attention is all you need</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Transformer</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>Transformer (multi-head attention) encoder-decoder</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td>Original base described at ~65M parameters (this work adapted the architecture down to ~12M parameters)</td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Originally neural machine translation; adapted here to chemical reaction prediction (SMILES-to-SMILES).</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Autoregressive encoder-decoder with multi-head scaled-dot-product attention and positional encodings; decoding via beam search.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Adapted to chemistry by using SMILES tokenization and chemical datasets; multi-head attention allows modeling long-range token relationships in SMILES.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>When adapted and trained on reaction data, the transformer architecture produced state-of-the-art reaction prediction accuracy and reliable uncertainty estimates in this work.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Improves over RNN-based seq2seq models due to multi-head attention capturing long-range dependencies in SMILES (better chemoselectivity/regioselectivity prediction).</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Requires positional encodings because of lack of recurrence; hyperparameters (label smoothing) affect uncertainty calibration; architecture alone does not enforce chemical constraints unless trained or constrained at decoding.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8918.2">
                <h3 class="extraction-instance">Extracted Data Instance 2 (e8918.2)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Seq2Seq RNN (prior work)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Sequence-to-sequence recurrent neural networks for reaction prediction (e.g., "Found in Translation")</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Prior approach treating reaction prediction as SMILES translation using RNN encoder-decoder models with attention; served as baseline methods that the Molecular Transformer improved upon.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>"Found in Translation": Predicting Outcomes of Complex Organic Chemistry Reactions using Neural Sequence-to-Sequence Models</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>mention</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Sequence-to-sequence RNN with attention</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>RNN encoder-decoder with single-head attention</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td>Patent-derived reaction SMILES (as used in prior seq2seq studies); reagents often tokenized separately in some works.</td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Reaction outcome prediction / forward synthesis prediction.</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>SMILES-to-SMILES translation via RNN decoder; attention-based alignment used to increase interpretability.</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td>Not a de novo generator in cited use — predicts products from reactants/reagents.</td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Often used reagents/role tokenization and atom-mapping-derived preprocessing; some studies separated reagents explicitly which can leak information.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td>Top-k accuracy (reported lower than transformer), confidence via attention matrices in some studies.</td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>Competitive but outperformed by the transformer-based model in accuracy and handling of long-range SMILES dependencies; had difficulty when reagents and reactants were mixed.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Outperformed by Molecular Transformer; had inductive bias (sequential token locality) that is less appropriate for SMILES.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Single-head attention and recurrence limit modeling of long-range relations; performance sensitive to preprocessing choices (e.g., reagent separation); less capable on stereochemistry in prior works.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8918.3">
                <h3 class="extraction-instance">Extracted Data Instance 3 (e8918.3)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Grammar VAE</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Grammar variational autoencoder</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A variational autoencoder that enforces grammar constraints (e.g., SMILES grammar) to improve validity of generated molecular strings.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Grammar variational autoencoder</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>mention</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Grammar VAE</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>Variational Autoencoder (grammar-constrained)</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>De novo molecular generation / molecular design</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Latent-space sampling and decoding constrained by grammar rules to produce valid SMILES</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>By encoding grammar, aims to increase validity of generated molecules; paper only cited as part of broader generative-models context.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Mentioned as a representative generative model for molecular design; no in-paper comparison data provided here.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Not discussed in detail in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8918.4">
                <h3 class="extraction-instance">Extracted Data Instance 4 (e8918.4)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Automatic Chemical Design (Gómez-Bombarelli et al.)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Automatic chemical design using a data-driven continuous representation of molecules</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>An autoencoder-based approach that maps molecules to a continuous latent space enabling optimization and generation of novel molecules.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Automatic chemical design using a data-driven continuous representation of molecules</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>mention</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Continuous molecular representation via autoencoder</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>Autoencoder / variational autoencoder</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>De novo molecular design / drug discovery</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Latent-space optimization (e.g., property-driven search) and decoding to SMILES</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Designed to enable property optimization (e.g., drug-like properties) via continuous representations; paper only referenced as background.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Cited among growing generative-model literature; no direct experimental detail in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Not detailed here.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8918.5">
                <h3 class="extraction-instance">Extracted Data Instance 5 (e8918.5)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Constrained Bayesian Optimization for Chemical Design</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Constrained bayesian optimization for automatic chemical design</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Method combining latent-space molecular representations with constrained Bayesian optimization to generate molecules satisfying constraints.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Constrained bayesian optimization for automatic chemical design</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>mention</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Constrained Bayesian optimization over latent molecule space</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>Bayesian optimization (applied to latent-space representations from generative models)</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>De novo molecular design, property-constrained molecule generation</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Bayesian optimization in learned latent spaces of generative models</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Focuses on enforcing constraints during optimization for chemically relevant outputs; referenced only in background.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Mentioned as a method for constrained design; no empirical details in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Not discussed here.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8918.6">
                <h3 class="extraction-instance">Extracted Data Instance 6 (e8918.6)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Deep RL de novo drug design</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Deep reinforcement learning for de novo drug design</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A reinforcement-learning approach that optimizes molecule-generating policies to maximize desired molecular properties for drug design.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Deep reinforcement learning for de novo drug design</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>mention</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Deep reinforcement learning molecular generator</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>Reinforcement learning applied to molecular generation (often with RNN/SMILES or graph policies)</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Drug discovery, property-driven molecular design</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Policy optimization to generate SMILES/graphs with desired properties</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Optimizes for target properties via reward functions; cited as part of generative-model landscape.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Cited alongside other generative strategies; no empirical comparisons provided in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Not detailed in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8918.7">
                <h3 class="extraction-instance">Extracted Data Instance 7 (e8918.7)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Generative Autoencoder (Blaschke et al.)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Application of generative autoencoder in de novo molecular design</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Use of autoencoder-based generative models for proposing novel molecules de novo.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Application of generative autoencoder in de novo molecular design</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>mention</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Generative autoencoder</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>Autoencoder / generative model</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>De novo molecular design</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Latent-space sampling and decoding</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Used for proposing novel scaffolds; referenced in background only.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Listed among generative methods; no further detail here.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Not discussed here.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8918.8">
                <h3 class="extraction-instance">Extracted Data Instance 8 (e8918.8)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Junction Tree VAE</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Junction Tree Variational Autoencoder for Molecular Graph Generation</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A VAE architecture that generates molecular graphs by first generating a tree of molecular substructures (junction tree) and then assembling them into a full graph, improving validity and chemical plausibility.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Junction Tree Variational Autoencoder for Molecular Graph Generation</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>mention</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Junction Tree VAE</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>Variational Autoencoder specialized for molecular graph generation</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>De novo molecular graph generation / molecular design</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Two-stage generation: junction-tree of substructures then molecular graph assembly in latent space</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Aims for chemically valid and diverse graph generation; cited as representative of recent generative-model advances.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Reported in references as an improved graph-generation approach; no details in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Not elaborated here.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8918.9">
                <h3 class="extraction-instance">Extracted Data Instance 9 (e8918.9)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Conditional molecular design</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Conditional molecular design with deep generative models</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>Approaches that condition generative models on desired properties or contexts to produce molecules tailored to specific applications.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Conditional molecular design with deep generative models</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>mention</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>Conditional generative molecular models</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>Conditional deep generative models (variational autoencoders, GANs, etc.)</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Targeted molecular design (drug discovery, property-conditioned generation)</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>Conditioning on property vectors or labels during generation/optimization</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Designed to tailor molecules to specific properties; cited as part of the generative-model toolbox.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Mentioned among techniques that allow application-specific molecule generation; no empirical details in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>Not discussed in this paper.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e8918.10">
                <h3 class="extraction-instance">Extracted Data Instance 10 (e8918.10)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how large language models (LLMs) are used to generate or design novel chemicals for specific applications, including details of the models, methods, applications, results, and limitations.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>IBM RXN for Chemistry</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>IBM RXN for Chemistry</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A web-based graphical user interface and platform that integrates the Molecular Transformer backend to allow organic chemists to run reaction predictions online.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>IBM RXN for Chemistry</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>IBM RXN (platform using Molecular Transformer backend)</td>
                        </tr>
                        <tr>
                            <td><strong>model_type</strong></td>
                            <td>Web service integrating transformer-based reaction prediction</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>training_data</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>application_domain</strong></td>
                            <td>Practical reaction prediction and synthesis planning support for chemists</td>
                        </tr>
                        <tr>
                            <td><strong>generation_method</strong></td>
                            <td>User inputs reactant/reagent SMILES, platform returns predicted product SMILES and confidence scores (uses Molecular Transformer model).</td>
                        </tr>
                        <tr>
                            <td><strong>novelty_of_chemicals</strong></td>
                            <td>Platform is used for predicting reaction outcomes rather than de novo molecule generation; not reported to generate novel molecules automatically.</td>
                        </tr>
                        <tr>
                            <td><strong>application_specificity</strong></td>
                            <td>Provides user-facing interface for reaction prediction and pathway scoring based on model uncertainty.</td>
                        </tr>
                        <tr>
                            <td><strong>evaluation_metrics</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>results_summary</strong></td>
                            <td>Deployed since August 2018 and used by several thousand chemists for over 40,000 predictions according to the paper.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_to_other_methods</strong></td>
                            <td>Provides accessible deployment of the Molecular Transformer; no direct performance comparisons for the platform itself.</td>
                        </tr>
                        <tr>
                            <td><strong>limitations_and_challenges</strong></td>
                            <td>As a prediction platform, limited by underlying model's domain (training data) and its limitations (stereochemistry, noisy patents, etc.).</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction', 'publication_date_yy_mm': '2018-11'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>Grammar variational autoencoder <em>(Rating: 2)</em></li>
                <li>Automatic chemical design using a data-driven continuous representation of molecules <em>(Rating: 2)</em></li>
                <li>Constrained bayesian optimization for automatic chemical design <em>(Rating: 2)</em></li>
                <li>Deep reinforcement learning for de novo drug design <em>(Rating: 2)</em></li>
                <li>Application of generative autoencoder in de novo molecular design <em>(Rating: 2)</em></li>
                <li>Junction Tree Variational Autoencoder for Molecular Graph Generation <em>(Rating: 2)</em></li>
                <li>Conditional molecular design with deep generative models <em>(Rating: 2)</em></li>
                <li>Attention is all you need <em>(Rating: 1)</em></li>
                <li>"Found in Translation": Predicting Outcomes of Complex Organic Chemistry Reactions using Neural Sequence-to-Sequence Models <em>(Rating: 1)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-8918",
    "paper_id": "paper-de20b6488e148a19ae6c63defbfca8a6373e4110",
    "extraction_schema_id": "extraction-schema-155",
    "extracted_data": [
        {
            "name_short": "Molecular Transformer",
            "name_full": "Molecular Transformer - A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
            "brief_description": "An attention-only (multi-head transformer) encoder-decoder model that treats chemical reaction prediction as SMILES-to-SMILES translation and provides calibrated uncertainty scores for predicted products.",
            "citation_title": "Molecular Transformer - A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
            "mention_or_use": "use",
            "model_name": "Molecular Transformer",
            "model_type": "Transformer (multi-head attention) encoder-decoder, autoregressive SMILES seq2seq",
            "model_size": "Approximately 12M parameters (adapted from a 65M-base transformer to 4 layers of size 256)",
            "training_data": "Patent-derived reaction SMILES datasets (canonicalized with RDKit) including USPTO_MIT, USPTO_LEF, USPTO_STEREO and a Pistachio-derived time-split test set; inputs tokenized SMILES with data augmentation via random SMILES.",
            "application_domain": "Reaction outcome prediction / organic synthesis planning (helps route design by predicting products and scoring pathway uncertainty).",
            "generation_method": "Sequence-to-sequence autoregressive generation of product SMILES from concatenated reactant+reagent SMILES; beam search decoding (optionally chemically-constrained beam search); confidence score computed as product of token probabilities.",
            "novelty_of_chemicals": "Not used to deliberately generate novel molecules — predicts likely reaction products given reactants/reagents from training-style chemistry; novelty metrics for generated molecules are not reported.",
            "application_specificity": "Specialization to reaction prediction achieved by training on large reaction corpora (patent SMILES); the model handles mixed reactant/reagent inputs and stereochemistry to varying degrees; uncertainty score used to rank/prioritize reaction steps/pathways.",
            "evaluation_metrics": "Top-k accuracy (Top-1, Top-2, Top-3, Top-5), AUC-ROC for confidence score distinguishing correct vs incorrect predictions (0.89), invalid-SMILES rate.",
            "results_summary": "Achieves top-1 accuracy up to 90.4% on USPTO_MIT with separated reagents (93.7% top-2), 88.6% top-1 when reactants and reagents are mixed; on USPTO_STEREO top-1 ~78.1% (separated) and 76.2% (mixed); uncertainty AUC-ROC = 0.89; invalid SMILES rate very low (0.5% reported on one test set).",
            "comparison_to_other_methods": "Outperforms prior seq2seq RNN and graph-based methods across benchmark datasets (reported improvements over S2S RNN and multiple graph-based models), is less reliant on handcrafted templates/atom-mapping than template-based methods.",
            "limitations_and_challenges": "Not a de novo molecular generator — focused on prediction; lower performance on stereochemistry and resolution reactions; model performance depends on data quality (patent noise); reagents/reactant split in datasets is an unrealistic prior often used by others; label smoothing harms uncertainty estimation; potential for 'alchemy' (changing atom types) exists but model learned to avoid it in practice; multistep synthesis still vulnerable to compounding errors.",
            "uuid": "e8918.0",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        },
        {
            "name_short": "Transformer (Vaswani et al.)",
            "name_full": "Attention is all you need",
            "brief_description": "The original multi-head attention-based transformer architecture for sequence modeling (encoder-decoder) that replaces recurrent networks with attention and positional encodings; adapted here for chemical SMILES translation.",
            "citation_title": "Attention is all you need",
            "mention_or_use": "use",
            "model_name": "Transformer",
            "model_type": "Transformer (multi-head attention) encoder-decoder",
            "model_size": "Original base described at ~65M parameters (this work adapted the architecture down to ~12M parameters)",
            "training_data": null,
            "application_domain": "Originally neural machine translation; adapted here to chemical reaction prediction (SMILES-to-SMILES).",
            "generation_method": "Autoregressive encoder-decoder with multi-head scaled-dot-product attention and positional encodings; decoding via beam search.",
            "novelty_of_chemicals": null,
            "application_specificity": "Adapted to chemistry by using SMILES tokenization and chemical datasets; multi-head attention allows modeling long-range token relationships in SMILES.",
            "evaluation_metrics": null,
            "results_summary": "When adapted and trained on reaction data, the transformer architecture produced state-of-the-art reaction prediction accuracy and reliable uncertainty estimates in this work.",
            "comparison_to_other_methods": "Improves over RNN-based seq2seq models due to multi-head attention capturing long-range dependencies in SMILES (better chemoselectivity/regioselectivity prediction).",
            "limitations_and_challenges": "Requires positional encodings because of lack of recurrence; hyperparameters (label smoothing) affect uncertainty calibration; architecture alone does not enforce chemical constraints unless trained or constrained at decoding.",
            "uuid": "e8918.1",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        },
        {
            "name_short": "Seq2Seq RNN (prior work)",
            "name_full": "Sequence-to-sequence recurrent neural networks for reaction prediction (e.g., \"Found in Translation\")",
            "brief_description": "Prior approach treating reaction prediction as SMILES translation using RNN encoder-decoder models with attention; served as baseline methods that the Molecular Transformer improved upon.",
            "citation_title": "\"Found in Translation\": Predicting Outcomes of Complex Organic Chemistry Reactions using Neural Sequence-to-Sequence Models",
            "mention_or_use": "mention",
            "model_name": "Sequence-to-sequence RNN with attention",
            "model_type": "RNN encoder-decoder with single-head attention",
            "model_size": null,
            "training_data": "Patent-derived reaction SMILES (as used in prior seq2seq studies); reagents often tokenized separately in some works.",
            "application_domain": "Reaction outcome prediction / forward synthesis prediction.",
            "generation_method": "SMILES-to-SMILES translation via RNN decoder; attention-based alignment used to increase interpretability.",
            "novelty_of_chemicals": "Not a de novo generator in cited use — predicts products from reactants/reagents.",
            "application_specificity": "Often used reagents/role tokenization and atom-mapping-derived preprocessing; some studies separated reagents explicitly which can leak information.",
            "evaluation_metrics": "Top-k accuracy (reported lower than transformer), confidence via attention matrices in some studies.",
            "results_summary": "Competitive but outperformed by the transformer-based model in accuracy and handling of long-range SMILES dependencies; had difficulty when reagents and reactants were mixed.",
            "comparison_to_other_methods": "Outperformed by Molecular Transformer; had inductive bias (sequential token locality) that is less appropriate for SMILES.",
            "limitations_and_challenges": "Single-head attention and recurrence limit modeling of long-range relations; performance sensitive to preprocessing choices (e.g., reagent separation); less capable on stereochemistry in prior works.",
            "uuid": "e8918.2",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        },
        {
            "name_short": "Grammar VAE",
            "name_full": "Grammar variational autoencoder",
            "brief_description": "A variational autoencoder that enforces grammar constraints (e.g., SMILES grammar) to improve validity of generated molecular strings.",
            "citation_title": "Grammar variational autoencoder",
            "mention_or_use": "mention",
            "model_name": "Grammar VAE",
            "model_type": "Variational Autoencoder (grammar-constrained)",
            "model_size": null,
            "training_data": null,
            "application_domain": "De novo molecular generation / molecular design",
            "generation_method": "Latent-space sampling and decoding constrained by grammar rules to produce valid SMILES",
            "novelty_of_chemicals": null,
            "application_specificity": "By encoding grammar, aims to increase validity of generated molecules; paper only cited as part of broader generative-models context.",
            "evaluation_metrics": null,
            "results_summary": null,
            "comparison_to_other_methods": "Mentioned as a representative generative model for molecular design; no in-paper comparison data provided here.",
            "limitations_and_challenges": "Not discussed in detail in this paper.",
            "uuid": "e8918.3",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        },
        {
            "name_short": "Automatic Chemical Design (Gómez-Bombarelli et al.)",
            "name_full": "Automatic chemical design using a data-driven continuous representation of molecules",
            "brief_description": "An autoencoder-based approach that maps molecules to a continuous latent space enabling optimization and generation of novel molecules.",
            "citation_title": "Automatic chemical design using a data-driven continuous representation of molecules",
            "mention_or_use": "mention",
            "model_name": "Continuous molecular representation via autoencoder",
            "model_type": "Autoencoder / variational autoencoder",
            "model_size": null,
            "training_data": null,
            "application_domain": "De novo molecular design / drug discovery",
            "generation_method": "Latent-space optimization (e.g., property-driven search) and decoding to SMILES",
            "novelty_of_chemicals": null,
            "application_specificity": "Designed to enable property optimization (e.g., drug-like properties) via continuous representations; paper only referenced as background.",
            "evaluation_metrics": null,
            "results_summary": null,
            "comparison_to_other_methods": "Cited among growing generative-model literature; no direct experimental detail in this paper.",
            "limitations_and_challenges": "Not detailed here.",
            "uuid": "e8918.4",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        },
        {
            "name_short": "Constrained Bayesian Optimization for Chemical Design",
            "name_full": "Constrained bayesian optimization for automatic chemical design",
            "brief_description": "Method combining latent-space molecular representations with constrained Bayesian optimization to generate molecules satisfying constraints.",
            "citation_title": "Constrained bayesian optimization for automatic chemical design",
            "mention_or_use": "mention",
            "model_name": "Constrained Bayesian optimization over latent molecule space",
            "model_type": "Bayesian optimization (applied to latent-space representations from generative models)",
            "model_size": null,
            "training_data": null,
            "application_domain": "De novo molecular design, property-constrained molecule generation",
            "generation_method": "Bayesian optimization in learned latent spaces of generative models",
            "novelty_of_chemicals": null,
            "application_specificity": "Focuses on enforcing constraints during optimization for chemically relevant outputs; referenced only in background.",
            "evaluation_metrics": null,
            "results_summary": null,
            "comparison_to_other_methods": "Mentioned as a method for constrained design; no empirical details in this paper.",
            "limitations_and_challenges": "Not discussed here.",
            "uuid": "e8918.5",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        },
        {
            "name_short": "Deep RL de novo drug design",
            "name_full": "Deep reinforcement learning for de novo drug design",
            "brief_description": "A reinforcement-learning approach that optimizes molecule-generating policies to maximize desired molecular properties for drug design.",
            "citation_title": "Deep reinforcement learning for de novo drug design",
            "mention_or_use": "mention",
            "model_name": "Deep reinforcement learning molecular generator",
            "model_type": "Reinforcement learning applied to molecular generation (often with RNN/SMILES or graph policies)",
            "model_size": null,
            "training_data": null,
            "application_domain": "Drug discovery, property-driven molecular design",
            "generation_method": "Policy optimization to generate SMILES/graphs with desired properties",
            "novelty_of_chemicals": null,
            "application_specificity": "Optimizes for target properties via reward functions; cited as part of generative-model landscape.",
            "evaluation_metrics": null,
            "results_summary": null,
            "comparison_to_other_methods": "Cited alongside other generative strategies; no empirical comparisons provided in this paper.",
            "limitations_and_challenges": "Not detailed in this paper.",
            "uuid": "e8918.6",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        },
        {
            "name_short": "Generative Autoencoder (Blaschke et al.)",
            "name_full": "Application of generative autoencoder in de novo molecular design",
            "brief_description": "Use of autoencoder-based generative models for proposing novel molecules de novo.",
            "citation_title": "Application of generative autoencoder in de novo molecular design",
            "mention_or_use": "mention",
            "model_name": "Generative autoencoder",
            "model_type": "Autoencoder / generative model",
            "model_size": null,
            "training_data": null,
            "application_domain": "De novo molecular design",
            "generation_method": "Latent-space sampling and decoding",
            "novelty_of_chemicals": null,
            "application_specificity": "Used for proposing novel scaffolds; referenced in background only.",
            "evaluation_metrics": null,
            "results_summary": null,
            "comparison_to_other_methods": "Listed among generative methods; no further detail here.",
            "limitations_and_challenges": "Not discussed here.",
            "uuid": "e8918.7",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        },
        {
            "name_short": "Junction Tree VAE",
            "name_full": "Junction Tree Variational Autoencoder for Molecular Graph Generation",
            "brief_description": "A VAE architecture that generates molecular graphs by first generating a tree of molecular substructures (junction tree) and then assembling them into a full graph, improving validity and chemical plausibility.",
            "citation_title": "Junction Tree Variational Autoencoder for Molecular Graph Generation",
            "mention_or_use": "mention",
            "model_name": "Junction Tree VAE",
            "model_type": "Variational Autoencoder specialized for molecular graph generation",
            "model_size": null,
            "training_data": null,
            "application_domain": "De novo molecular graph generation / molecular design",
            "generation_method": "Two-stage generation: junction-tree of substructures then molecular graph assembly in latent space",
            "novelty_of_chemicals": null,
            "application_specificity": "Aims for chemically valid and diverse graph generation; cited as representative of recent generative-model advances.",
            "evaluation_metrics": null,
            "results_summary": null,
            "comparison_to_other_methods": "Reported in references as an improved graph-generation approach; no details in this paper.",
            "limitations_and_challenges": "Not elaborated here.",
            "uuid": "e8918.8",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        },
        {
            "name_short": "Conditional molecular design",
            "name_full": "Conditional molecular design with deep generative models",
            "brief_description": "Approaches that condition generative models on desired properties or contexts to produce molecules tailored to specific applications.",
            "citation_title": "Conditional molecular design with deep generative models",
            "mention_or_use": "mention",
            "model_name": "Conditional generative molecular models",
            "model_type": "Conditional deep generative models (variational autoencoders, GANs, etc.)",
            "model_size": null,
            "training_data": null,
            "application_domain": "Targeted molecular design (drug discovery, property-conditioned generation)",
            "generation_method": "Conditioning on property vectors or labels during generation/optimization",
            "novelty_of_chemicals": null,
            "application_specificity": "Designed to tailor molecules to specific properties; cited as part of the generative-model toolbox.",
            "evaluation_metrics": null,
            "results_summary": null,
            "comparison_to_other_methods": "Mentioned among techniques that allow application-specific molecule generation; no empirical details in this paper.",
            "limitations_and_challenges": "Not discussed in this paper.",
            "uuid": "e8918.9",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        },
        {
            "name_short": "IBM RXN for Chemistry",
            "name_full": "IBM RXN for Chemistry",
            "brief_description": "A web-based graphical user interface and platform that integrates the Molecular Transformer backend to allow organic chemists to run reaction predictions online.",
            "citation_title": "IBM RXN for Chemistry",
            "mention_or_use": "use",
            "model_name": "IBM RXN (platform using Molecular Transformer backend)",
            "model_type": "Web service integrating transformer-based reaction prediction",
            "model_size": null,
            "training_data": null,
            "application_domain": "Practical reaction prediction and synthesis planning support for chemists",
            "generation_method": "User inputs reactant/reagent SMILES, platform returns predicted product SMILES and confidence scores (uses Molecular Transformer model).",
            "novelty_of_chemicals": "Platform is used for predicting reaction outcomes rather than de novo molecule generation; not reported to generate novel molecules automatically.",
            "application_specificity": "Provides user-facing interface for reaction prediction and pathway scoring based on model uncertainty.",
            "evaluation_metrics": null,
            "results_summary": "Deployed since August 2018 and used by several thousand chemists for over 40,000 predictions according to the paper.",
            "comparison_to_other_methods": "Provides accessible deployment of the Molecular Transformer; no direct performance comparisons for the platform itself.",
            "limitations_and_challenges": "As a prediction platform, limited by underlying model's domain (training data) and its limitations (stereochemistry, noisy patents, etc.).",
            "uuid": "e8918.10",
            "source_info": {
                "paper_title": "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction",
                "publication_date_yy_mm": "2018-11"
            }
        }
    ],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "Grammar variational autoencoder",
            "rating": 2
        },
        {
            "paper_title": "Automatic chemical design using a data-driven continuous representation of molecules",
            "rating": 2
        },
        {
            "paper_title": "Constrained bayesian optimization for automatic chemical design",
            "rating": 2
        },
        {
            "paper_title": "Deep reinforcement learning for de novo drug design",
            "rating": 2
        },
        {
            "paper_title": "Application of generative autoencoder in de novo molecular design",
            "rating": 2
        },
        {
            "paper_title": "Junction Tree Variational Autoencoder for Molecular Graph Generation",
            "rating": 2
        },
        {
            "paper_title": "Conditional molecular design with deep generative models",
            "rating": 2
        },
        {
            "paper_title": "Attention is all you need",
            "rating": 1
        },
        {
            "paper_title": "\"Found in Translation\": Predicting Outcomes of Complex Organic Chemistry Reactions using Neural Sequence-to-Sequence Models",
            "rating": 1
        }
    ],
    "cost": 0.017589749999999998,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>Molecular Transformer - A Model for Uncertainty-Calibrated Chemical Reaction Prediction</h1>
<p>Philippe Schwaller, ${ }^{<em> \ddagger}$, , Teodoro Laino, ${ }^{\dagger}$ Théophile Gaudin, ${ }^{\dagger}$ Peter Bolgar, ${ }^{\text {E }}$ Costas Bekas, ${ }^{\dagger}$ and Alpha A Lee</em>, ${ }^{\ddagger}$<br>†IBM Research GmbH, Zurich, Switzerland<br>$\ddagger$ Department of Physics, University of Cambridge, Cambridge, United Kingdom<br>E-mail: phs@zurich.ibm.ch; aal44@cam.ac.uk</p>
<h4>Abstract</h4>
<p>Organic synthesis is one of the key stumbling blocks in medicinal chemistry. A necessary yet unsolved step in planning synthesis is solving the forward problem: given reactants and reagents, predict the products. Similar to other work, we treat reaction prediction as a machine translation problem between SMILES strings of reactantsreagents and the products. We show that a multi-head attention Molecular Transformer model outperforms all algorithms in the literature, achieving a top-1 accuracy above $90 \%$ on a common benchmark dataset. Our algorithm requires no handcrafted rules, and accurately predicts subtle chemical transformations. Crucially, our model can accurately estimate its own uncertainty, with an uncertainty score that is $89 \%$ accurate in terms of classifying whether a prediction is correct. Furthermore, we show that the model is able to handle inputs without reactant-reagent split and including stereochemistry, which makes our method universally applicable.</p>
<h1>Introduction</h1>
<p>Organic synthesis - the making of complex molecules from simpler building blocks - remains one of the key stumbling blocks in drug discovery. ${ }^{1}$ Although the number of reported molecules has reached 135 million, this still represents only a small proportion of the estimated $10^{60}$ feasible drug-like compounds. ${ }^{2,3}$ The lack of a synthetic route hinders access to potentially fruitful regions of chemical space. Tackling the challenge of organic synthesis with data-driven approaches is particularly timely as generative models in machine learning for molecules are coming of age. ${ }^{4-10}$ These generative models enrich the toolbox of medicinal chemistry by suggesting potentially promising molecules that lie outside of known scaffolds.</p>
<p>There are three salient challenges in predicting chemical reactivity and designing organic synthesis. First, simple combinatorics would suggest that the space of possible reactions is even greater than the already intractable space of possible molecules. As such, strategies that involve handcrafted rules quickly become intractable. Second, reactants seldom contain only one reactive functional group. Designing synthesis requires one to predict which functional group will react with a particular reactant and where a reactant will react within a functional group. Predicting those subtle reactivity differences is challenging because they are often dependent on the what other functional groups are nearby. In addition, for chiral organic molecules, predicting the relative and absolute configuration of chiral centers adds another layer of complexity. Third, organic synthesis is almost always a multistep process where one failed step could invalidate the entire synthesis. For example, the pioneering total synthesis of the antibiotic tetracycline takes 18 steps; ${ }^{11}$ even a hypothetical method that would be correct $80 \%$ of the time would only have a $1 \%$ chance of getting 18 predictions correct in a row (assuming independence). Therefore, tackling the synthesis challenge requires methods that are both accurate and have a good uncertainty estimates. This would crucially allow us to estimate the "risk" of the proposed synthesis path, and put the riskier steps in the beginning of the synthesis, so that one can fail fast and fail cheap.</p>
<p>The long history of computational chemical reaction prediction has been extensively</p>
<p>reviewed in ${ }^{12}$ and. ${ }^{13}$ Methods in the literature may be divided into two different groups, namely, template-based and template-free.</p>
<p>Template-based methods ${ }^{14-16}$ use a library of reaction templates or rules. These templates describe the atoms and their bonds in the neighborhood of the reaction center, before and after the chemical reaction has occurred. Template-based methods then consider all possible reactions centers in a molecule, and enumerate the possible transformations based on the templates together with how likely each transformation is to take place. As such, the key steps in all template-based methods are the construction of templates, and the evaluation of how likely the template is to apply. The focus of the literature has thus far been on the latter question of predicting whether a template applies. ${ }^{15,16}$ However, the problem with the template-based paradigm is that templates themselves are often of questionable validity. Earlier methods generated templates by hand using chemical intuition. ${ }^{17-19}$ Handcrafting is obviously not scalable as the number of reported organic reactions constantly increases and significant time investment is needed to keep up with the literature. Recent machine learning approaches employ template libraries that are automatically extracted from datasets of reactions. ${ }^{15,16}$ Unfortunately, automatic template extraction algorithms still suffer from having to rely on meta-heuristics to define different "classes" of reactions. More problematically, all automatic template extraction algorithms rely on pre-existing atom mapping - a scheme that maps atoms in the reactants to atoms in the product. However, correctly mapping the product back to the reactant atoms is still an unsolved problem ${ }^{20}$ and, more disconcertingly, commonly used tools to find the atom-mapping (e.g. NameRXN ${ }^{21,22}$ ) are themselves based on libraries of expert rules and templates. This creates a vicious circle - atom-mapping is based on templates and templates are based on atom-mapping, and ultimately, seemingly automatic techniques are actually premised on handcrafted and often artisanal chemical rules.</p>
<p>To overcome the limitations of template-based approaches, several template-free methods have emerged over the recent years. Those methods can in turn be categorized into graph-</p>
<p>based and sequence-based. Jin et al. characterize chemical reactions by graph edits that lead from the reactants to the products. ${ }^{23}$ Their reaction prediction is a two-step process. The first network takes a graph representation of the reactants as input and predicts reactivity scores. Based on those reactivity scores, product candidates are generated and then ranked by a second network. An improved version, where candidates with up to 5 bond changes are taken into account and multi-dimensional reactivity matrices are generated, was recently presented. ${ }^{24}$ While an earlier version of the model included both reactants and reagents in the reaction center determination step, the accuracy was significantly improved by excluding the reagents from the reactivity score prediction in the more recent versions. This requires the user to know what are the identity of the reagents, which implicitly means that the user must already know the product as the reagent is defined as chemical species that do not appear in the product! Similarly, Bradshaw et al. ${ }^{25}$ separated reactants and reagents and included the reagents only in a context vector for their gated graph neural network. They represented the reaction prediction problem as a stepwise rearrangement of electrons in the reactant molecules. A side effect of phrasing reaction prediction as predicting electron flow is that a preprocessing step must be applied to eliminate reactions where the electron flow cannot easily be identified - Bradshaw et al. considered only a subset of the USPTO_MIT dataset, containing only $73 \%$ of the reactions with a linear electron flow (LEF) topology, thus by definition excluding pericyclic reactions and other important workhorse organic reactions. A more general version of the algorithm was recently presented in. ${ }^{26}$ Perhaps most intriguingly, all graph-based template-free methods in the literature require atom-mapped datasets to generate the ground truth for training, and atom mapping algorithms make use of reaction templates.</p>
<p>Sequence-based techniques have emerged as an alternative to graph-based methods. The key idea is to use a text representation of the reactants, reagents and products (usually SMILES), and treat reaction prediction as machine translation from one language (reactantsreagents) to another language (products). The idea of applying sequence-based models to</p>
<p>the reaction prediction problem was first explored by Nam \&amp; Kim. ${ }^{27}$ Schwaller et al. ${ }^{28}$ have shown that using analogies between organic chemistry and human languages sequence-tosequence models (seq-2-seq) could compete against graph-based methods. Both previous seq-2 -seq works were based on recurrent neural networks for the encoder and the decoder, with one single-head attention layer in-between. ${ }^{29,30}$ Moreover, both previous seq-2-seq forward prediction works separated reactants and reagents in the inputs using the atom-mapping, and ${ }^{28}$ tokenized the reagent molecules as individual tokens. To increase the interpretability of the model, Schwaller et al. ${ }^{28}$ used attention weight matrices and confidence scores that were generated together with the most likely product.</p>
<p>In this work, we focus on the question of predicting products given reactants and reagent. We show that a fully attention-based model adapted from ${ }^{31}$ with the SMILES ${ }^{32,33}$ representation, the Molecular Transformer, outperforms all previous methods while being completely atom-mapping independent and not requiring splitting the input into reactants and reagents. Our algorithm reaches $90.4 \%$ top-1 accuracy ( $93.7 \%$ top-2 accuracy) on a common benchmark dataset. Importantly, our algorithm does not make use of any handcrafted rules. It can accurately predict subtle and selective chemical transformations, getting the correct chemoselectivity, regioselectivity and, to some extent, stereoselectivity. In addition, our model can estimate its own uncertainty. The uncertainty score predicted by the model has an ROCAUC of 0.89 in terms of classifying whether a reaction is correctly predicted. Our model has been made available since August 2018 in the backend of the IBM RXN for Chemistry, ${ }^{34}$ a free web-based graphical user interface, and has been used by several thousand organic chemists worldwide to perform more than 40,000 predictions so far.</p>
<h1>Data</h1>
<p>Most of the publicly available reaction datasets were derived from the patent mining work of Lowe, ${ }^{35}$ where the chemical reactions were described using a text-based representation</p>
<p>called SMILES. ${ }^{32,33}$ In order to compare to previous work we focus on four datasets. The USPTO_MIT dataset was filtered and split by Jin et al. ${ }^{23}$ This dataset was also used in ${ }^{28}$ and adapted to a smaller subset called USPTO_LEF by Bradshaw et al ${ }^{25}$ to make it compatible with their algorithm. In contrast to the MIT and LEF datasets, USPTO_STEREO ${ }^{28}$ underwent less filtering and the stereochemical information was kept. Up to date, only seq-2seq models were used to predict on USPTO_STEREO. Stereochemistry adds an additional level of complexity because it requires the models not only to predict molecular graph edge changes, but potentially also changes in node labels. Additionally, we used a non-public time-split test set, extracted from the Pistachio database, ${ }^{36}$ to compare the performance on a set containing more diverse reactions against a previous seq-2-seq model. ${ }^{28}$</p>
<p>Table 1: Dataset splits and preprocessing methods used for the experiments</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Reactions in</th>
<th style="text-align: center;">train</th>
<th style="text-align: center;">valid</th>
<th style="text-align: center;">test</th>
<th style="text-align: center;">total</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">USPTO_MIT set ${ }^{23}$</td>
<td style="text-align: center;">409,035</td>
<td style="text-align: center;">30,000</td>
<td style="text-align: center;">40,000</td>
<td style="text-align: center;">479,035</td>
</tr>
<tr>
<td style="text-align: center;">- No stereochemical information</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">USPTO_LEF ${ }^{25}$</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">29,360</td>
<td style="text-align: center;">349,898</td>
</tr>
<tr>
<td style="text-align: center;">- Non-public subset of USPTO_MIT, without e.g. multi-step reactions</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">USPTO_STEREO ${ }^{28}$</td>
<td style="text-align: center;">902,581</td>
<td style="text-align: center;">50,131</td>
<td style="text-align: center;">50,258</td>
<td style="text-align: center;">$1,002,970$</td>
</tr>
<tr>
<td style="text-align: center;">- Patent reactions until Sept. 2016, includes stereochemistry</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">Pistachio_2017 ${ }^{28}$</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">15418</td>
<td style="text-align: center;">15418</td>
</tr>
<tr>
<td style="text-align: center;">- Non-public time split test set, reactions from 2017 taken from Pistachio database ${ }^{36,37}$</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">Preprocessing methods</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">- separated</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">source: $\mathrm{COc1c}(\mathrm{C}) \mathrm{c}(\mathrm{C}) \mathrm{c}(\mathrm{OC}) \mathrm{c}(\mathrm{C}(\mathrm{CCCCC} @ \mathrm{CCCO}) \mathrm{c} 2 \mathrm{ccccc} 2) \mathrm{c} 1 \mathrm{C}&gt;\mathrm{C} . \mathrm{CCO} .[\mathrm{Pd}]$ target: $\mathrm{COc1c}(\mathrm{C}) \mathrm{c}(\mathrm{C}) \mathrm{c}(\mathrm{OC}) \mathrm{c}(\mathrm{C}(\mathrm{CCCCCCCO}) \mathrm{c} 2 \mathrm{ccccc} 2) \mathrm{c} 1 \mathrm{C}$</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: center;">- mixed</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">source: C.CCO.COc1c(C)c(C)c(OC)c(C(CCCCC@CCCO)c2ccccc2)c1C.[Pd] target: $\mathrm{COc1c}(\mathrm{C}) \mathrm{c}(\mathrm{C}) \mathrm{c}(\mathrm{OC}) \mathrm{c}(\mathrm{C}(\mathrm{CCCCCCCO}) \mathrm{c} 2 \mathrm{ccccc} 2) \mathrm{c} 1 \mathrm{C}$</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>Table 1 shows an overview of the datasets used in this work and points out the two different preprocessing methods. The separated reagents preprocessing means that the reactants (educts), which contribute atoms to the product, are weakly separated by a $&gt;$ token from the reagents (e.g. solvents and catalysts). Reagents take part in the reaction, but do not contribute any atom to the product. So far, in most of the work, the reagents have been separated from the reactants. Jin et al. ${ }^{23}$ increased their top-1 accuracy by almost</p>
<p>$6 \%$, when they removed the reagents from the first step, where the reaction centers were predicted. In Schwaller et al. ${ }^{28}$ the reagents were represented not as individual atoms, but as separate reagent tokens and only included the 76 most common reagents. ${ }^{38}$ Bradshaw et. al. passed the reagent information as a context vector to their model. In ${ }^{26}$ it was shown that the model performs better when the reagents are tagged as such. Unfortunately, the separation of reactants and reagents is not always obvious. Different tools classify different input molecules as the reactants and hence the reagents will also differ. ${ }^{38}$ For this reason, we decided to train and test on inputs where the reactants and the reagents were mixed and no distinction was made between the two. We called this method of preprocessing mixed. The mixed preprocessing makes the reaction prediction task significantly harder, as the model has to determine the reaction center from a larger number of molecules.</p>
<p>All the reactions used in this work were canonicalized using RDKit. ${ }^{39}$ The inputs for our model were tokenized with the regular expression found in. ${ }^{28}$ In contrast to Schwaller et al., ${ }^{28}$ the reagents were not replaced by reagents tokens, but tokenized in the same way as the reactants.</p>
<h1>The Molecular Transformer</h1>
<p>The model used in this work is based on the transformer architecture. ${ }^{31}$ The model was originally constructed for neural machine translation (NMT) tasks. The main architectural difference compared to seq-2-seq models previously used for reaction prediction, ${ }^{27,28}$ is that the recurrent neural network component was completely removed and it is fully based on the attention mechanism.</p>
<p>The transformer is a step-wise autoregressive encoder-decoder model comprised of a combination of multi-head attention layers and positional feed forward layers. In the encoder, the multi-head attention layers attend the input sequence and encode it into a hidden representation. The decoder consists of two types of multi-head attention layers. The first</p>
<p>is masked and attends only the preceding outputs of the decoder. The second multi-head attention layer attends encoder outputs, as well as the output of the first decoder attention layer. It basically combines the information of the source sequence with the target sequence that has been produced so far. ${ }^{31}$</p>
<p>A multi-head attention layer itself consists of several scaled-dot attention layers running in parallel, which are then concatenated. The scaled-dot attention layers take three inputs: the keys $K$, the values $V$ and the queries $Q$, and computes the attention as follows:</p>
<p>$$
\operatorname{attention}(Q, K, V)=\operatorname{softmax}\left(\frac{Q K^{T}}{\sqrt{d_{k}}}\right) V
$$</p>
<p>The dot product of the queries and the keys computes how closely aligned the keys are with the queries. If the query and the key are aligned, their dot product will be large and vice versa. Each key has an associated value vector, which is multiplied with the output of the softmax, through which the dot-products were normalized and the largest components were emphasized. $d_{k}$ is a scaling factor depending on the layer size. The encoder computes interesting features from the input sequence, which are then queried by the decoder depending on its preceding outputs. ${ }^{31}$</p>
<p>One main advantage of the transformer architecture compared to the seq-2-seq models used in ${ }^{27,28}$ is the multi-head attention, which allows the encoder and decoder to peek at different tokens simultaneously.</p>
<p>Since the recurrent component is missing in the transformer architecture, the sequential nature of the data is encoded with positional encodings. ${ }^{40}$ Positional encodings add positiondependent trigonometric signals (see Equations 2) to the token embeddings of size $d_{\text {emb }}$ and allow the network to know where the different tokens are situated in the sequence.</p>
<p>$$
\mathrm{PE}<em _emb="{emb" _text="\text">{(p o s, 2 i)}=\sin \left(\frac{\text { pos }}{10000^{2 i / d</em>}}}}\right), \quad \mathrm{PE<em _emb="{emb" _text="\text">{(p o s, 2 i+1)}=\cos \left(\frac{\text { pos }}{10000^{2 i / d</em>\right)
$$}}}</p>
<p>We based this work on the PyTorch implementation provided by OpenNMT. ${ }^{41}$ All the</p>
<p>components of the transformer model are explained and illustrated graphically on. ${ }^{42}$
While the base transformer model had 65 M parameters, ${ }^{31}$ we decreased the number of trainable weights to 12 M by going from 6 layers of size 512 to 4 layers of size 256 . We experimented with label smoothing ${ }^{43}$ and the number of attention heads. In contrast to the NMT model, ${ }^{31}$ we set the label smoothing parameter to 0.0 . As seen below, a non-zero label smoothing parameter encourages the model to be less confident and therefore negatively affects its ability to discriminate between correct and incorrect predictions. Moreover, we observed that at least 4 attention heads were required to achieve peak accuracies. We however, kept the original 8 attention heads, because this configuration achieved superior validation performance. For the training we use the ADAM optimizer ${ }^{44}$ and vary the learning rate as described in ${ }^{31}$ using 8000 warm up steps, the batch size is set to approximately 4096 tokens, the gradients are accumulated over four batches and normalized by the number of tokens. The model and results can be found online. ${ }^{45}$</p>
<h1>Results \&amp; Discussion</h1>
<p>Table 2: Ablation study of Molecular Transformer on the USPTO_MIT dataset with separated reagents. Train and test time were measured on a single Nvidia P100 GPU. The test set contained 40 k reactions.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">Top-1 [\%]</th>
<th style="text-align: center;">Top-2 [\%]</th>
<th style="text-align: center;">Top-3 [\%]</th>
<th style="text-align: center;">Top-5 [\%]</th>
<th style="text-align: center;">Training</th>
<th style="text-align: center;">Testing</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Single models</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Baseline</td>
<td style="text-align: center;">88.8</td>
<td style="text-align: center;">92.6</td>
<td style="text-align: center;">93.7</td>
<td style="text-align: center;">94.4</td>
<td style="text-align: center;">24 h</td>
<td style="text-align: center;">20 m</td>
</tr>
<tr>
<td style="text-align: left;">Baseline augm.</td>
<td style="text-align: center;">89.6</td>
<td style="text-align: center;">93.2</td>
<td style="text-align: center;">94.2</td>
<td style="text-align: center;">95.0</td>
<td style="text-align: center;">24 h</td>
<td style="text-align: center;">20 m</td>
</tr>
<tr>
<td style="text-align: left;">Baseline augm.</td>
<td style="text-align: center;">90.1</td>
<td style="text-align: center;">93.5</td>
<td style="text-align: center;">94.4</td>
<td style="text-align: center;">95.2</td>
<td style="text-align: center;">48 h</td>
<td style="text-align: center;">20 m</td>
</tr>
<tr>
<td style="text-align: left;">Augm. av. 20</td>
<td style="text-align: center;">$\mathbf{9 0 . 4}$</td>
<td style="text-align: center;">$\mathbf{9 3 . 7}$</td>
<td style="text-align: center;">$\mathbf{9 4 . 6}$</td>
<td style="text-align: center;">$\mathbf{9 5 . 3}$</td>
<td style="text-align: center;">48 h</td>
<td style="text-align: center;">20 m</td>
</tr>
<tr>
<td style="text-align: left;">Ensemble models</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr>
<td style="text-align: left;">Ens. of 5</td>
<td style="text-align: center;">90.5</td>
<td style="text-align: center;">93.8</td>
<td style="text-align: center;">94.8</td>
<td style="text-align: center;">95.5</td>
<td style="text-align: center;">48 h</td>
<td style="text-align: center;">1 h 25 m</td>
</tr>
<tr>
<td style="text-align: left;">Ens. of 10</td>
<td style="text-align: center;">90.6</td>
<td style="text-align: center;">93.9</td>
<td style="text-align: center;">94.8</td>
<td style="text-align: center;">95.5</td>
<td style="text-align: center;">48 h</td>
<td style="text-align: center;">2 h 40 m</td>
</tr>
<tr>
<td style="text-align: left;">Ens. of 20</td>
<td style="text-align: center;">90.6</td>
<td style="text-align: center;">93.8</td>
<td style="text-align: center;">94.9</td>
<td style="text-align: center;">95.6</td>
<td style="text-align: center;">48 h</td>
<td style="text-align: center;">5 h 03 m</td>
</tr>
<tr>
<td style="text-align: left;">Ens. of 2 av. 20 :</td>
<td style="text-align: center;">$\mathbf{9 1 . 0}$</td>
<td style="text-align: center;">$\mathbf{9 4 . 3}$</td>
<td style="text-align: center;">$\mathbf{9 5 . 2}$</td>
<td style="text-align: center;">$\mathbf{9 5 . 8}$</td>
<td style="text-align: center;">2 x 48 h</td>
<td style="text-align: center;">32 m</td>
</tr>
</tbody>
</table>
<p>Table 2 shows the performance of the model as a function of different training variations. SMILES data augmentation ${ }^{46}$ leads to a significant increase in accuracy. We double the training data by generating a copy of every reaction in the training set, where the molecules were replaced by an equivalent random SMILES (augm.) on the range of datasets and preprocessing methods. Results are also improved by averaging the weights over multiple checkpoints, as suggested in. ${ }^{31}$ Our best single models are obtained by training for 48 hours on one GPU (Nvidia P100), saving one checkpoint every 10,000 time steps and averaging the last 20 checkpoints. Ensembling different models is known to increase the performance of NMT models; ${ }^{47}$ however, the performance increase (Ens. of $5 / 10 / 20$ ) is marginal compared to parameter averaging. Nonetheless, ensembling two models which contains the weight average of 20 checkpoints of two independently initialized training runs leads to a top-1 accuracy of $91 \%$. While a higher accuracy and better uncertainty estimation can be obtained by model ensembles, they come at an additional cost in training and/or test time. The top-5 accuracies of our best single models (weight-average of the 20 last checkpoints) on the different datasets are shown in Table 3. The top-2 accuracy is significantly higher than Top-1, reaching over $93 \%$ accuracy.</p>
<p>Table 3: The single model top-k accuracy of the Molecular Transformer</p>
<table>
<thead>
<tr>
<th style="text-align: center;">USPTO*</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">Top-1 [\%]</th>
<th style="text-align: center;">Top-2 [\%]</th>
<th style="text-align: center;">Top-3 [\%]</th>
<th style="text-align: center;">Top-5 [\%]</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">_MIT</td>
<td style="text-align: center;">separated</td>
<td style="text-align: center;">90.4</td>
<td style="text-align: center;">93.7</td>
<td style="text-align: center;">94.6</td>
<td style="text-align: center;">95.3</td>
</tr>
<tr>
<td style="text-align: center;">_MIT</td>
<td style="text-align: center;">mixed</td>
<td style="text-align: center;">$\mathbf{8 8 . 6}$</td>
<td style="text-align: center;">$\mathbf{9 2 . 4}$</td>
<td style="text-align: center;">$\mathbf{9 3 . 5}$</td>
<td style="text-align: center;">$\mathbf{9 4 . 2}$</td>
</tr>
<tr>
<td style="text-align: center;">_STEREO</td>
<td style="text-align: center;">separated</td>
<td style="text-align: center;">78.1</td>
<td style="text-align: center;">84.0</td>
<td style="text-align: center;">85.8</td>
<td style="text-align: center;">87.1</td>
</tr>
<tr>
<td style="text-align: center;">_STEREO</td>
<td style="text-align: center;">mixed</td>
<td style="text-align: center;">$\mathbf{7 6 . 2}$</td>
<td style="text-align: center;">$\mathbf{8 2 . 4}$</td>
<td style="text-align: center;">$\mathbf{8 4 . 3}$</td>
<td style="text-align: center;">$\mathbf{8 5 . 8}$</td>
</tr>
</tbody>
</table>
<h1>Comparison with Previous Work</h1>
<p>As all previous works used single models, we consider only single models trained on the dataaugmented versions of the datasets rather than ensembles for the remainder of this paper in order to have a fair comparison. Table 4 shows that the Molecular Transformer clearly</p>
<p>outperforms all methods in the literature across the different datasets. Crucially, although separating reactant and reagent yields the best model (perhaps unsurprisingly because this separation implies knowledge of the product already), the Molecular Transformer still outperforms the literature when reactant and reagents are mixed. Moreover, our model achieves a reasonable accuracy in the _STEREO dataset, where stereochemical information is taken into account, whereas all prior graph-based methods in the literature cannot account for stereochemistry.</p>
<p>Table 4: Comparison of Top-1 accuracy in [\%] obtained by the different single model methods on the current benchmark datasets.</p>
<table>
<thead>
<tr>
<th style="text-align: center;">USPTO*</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">$\begin{aligned} &amp; \text { S2S } \ &amp; 28 \end{aligned}$</th>
<th style="text-align: center;">$\begin{aligned} &amp; \text { WLDN } \ &amp; 23 \end{aligned}$</th>
<th style="text-align: center;">$\begin{aligned} &amp; \text { ELECTRO } \ &amp; 25 \end{aligned}$</th>
<th style="text-align: center;">$\begin{aligned} &amp; \text { GTPN } \ &amp; 26 \end{aligned}$</th>
<th style="text-align: center;">$\begin{aligned} &amp; \text { WLDN5 } \ &amp; 24 \end{aligned}$</th>
<th style="text-align: center;">our work</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">_MIT</td>
<td style="text-align: center;">separated</td>
<td style="text-align: center;">80.3</td>
<td style="text-align: center;">79.6</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">82.4</td>
<td style="text-align: center;">85.6</td>
<td style="text-align: center;">90.4</td>
</tr>
<tr>
<td style="text-align: center;">_MIT</td>
<td style="text-align: center;">mixed</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">74</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">88.6</td>
</tr>
<tr>
<td style="text-align: center;">LEF</td>
<td style="text-align: center;">separated</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">84.0</td>
<td style="text-align: center;">87.0</td>
<td style="text-align: center;">87.4</td>
<td style="text-align: center;">88.3</td>
<td style="text-align: center;">92.0</td>
</tr>
<tr>
<td style="text-align: center;">LEF</td>
<td style="text-align: center;">mixed</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">90.3</td>
</tr>
<tr>
<td style="text-align: center;">_STEREO</td>
<td style="text-align: center;">separated</td>
<td style="text-align: center;">65.4</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">78.1</td>
</tr>
<tr>
<td style="text-align: center;">_STEREO</td>
<td style="text-align: center;">mixed</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">76.2</td>
</tr>
</tbody>
</table>
<p>Coley et al. ${ }^{24}$ published their predictions performance dividing the reactions of the USPTO_MIT test set into template popularity bins. The template popularity of the test set reactions was computed by counting how many times the corresponding reaction templates were observed in the training set. In Figure 1 we compare the top-1 accuracy of our USPTO_MIT models with the model of Coley et al. ${ }^{24}$ Although Coley et al. had separated the reagents in this experiment, we outperform them across all popularity bins even with our model predicting on a mixed reactants-reagents input. The accuracy gap becomes larger as the template popularity decreases. These findings suggest that the Molecular Transformer overfits common reactions less and requires fewer data points to predict well.</p>
<p>A looming question is how the Molecular Transformer perform by reaction type. Table 5 shows that the weakest predictions of the Molecular Transformer are on resolutions (the</p>
<p><img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1: Top-1 accuracy of our augmented mixed and separated USPTO_MIT single models compared to the model from ${ }^{24}$ on the USPTO_MIT test set, divided into template popularity bins. The dashed lines show the average across all bins.
transformation of absolute configuration of chiral centers, where the reagents are often not recorded in the data), and the ominous label of "unclassified" (where many mis-transcribed reactions will end up). Moreover, the Molecular Transformer outperforms ${ }^{28}$ in virtually every single reaction class. This is because the multi-head attention layer in the Molecular Transformer can process long ranged interactions between tokens, whereas RNN models impose the inductive bias that tokens fare in sequence space are less related. This bias is erroneous as the token location in SMILES space bears no relation to the distance between atoms in 3D space.</p>
<h1>Comparison with human organic chemists</h1>
<p>Coley et al. ${ }^{24}$ conducted a study, where 80 random reactions from 8 different rarity bins were selected from the USPTO_MIT test set and presented to 12 chemists (Graduate students to Professors) to predict the most likely outcome. The predictions of the human chemists were then compared against those of the model. We performed the same test with our</p>
<p>Table 5: Prediction of the augm. mixed STEREO single model on the Pistachio_2017 test set, compared to, ${ }^{28}$ where the reactants and reagents were separated.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: center;">Count</th>
<th style="text-align: center;">S2S acc. ${ }^{28}[\%]$</th>
<th style="text-align: center;">Our acc. [\%]</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Pistachio_2017</td>
<td style="text-align: center;">15418</td>
<td style="text-align: center;">60.0</td>
<td style="text-align: center;">$\mathbf{7 8 . 0}$</td>
</tr>
<tr>
<td style="text-align: left;">- Classified</td>
<td style="text-align: center;">11817</td>
<td style="text-align: center;">70.2</td>
<td style="text-align: center;">$\mathbf{8 7 . 6}$</td>
</tr>
<tr>
<td style="text-align: left;">- Heteroatom alkylation and arylation</td>
<td style="text-align: center;">2702</td>
<td style="text-align: center;">72.8</td>
<td style="text-align: center;">$\mathbf{8 6 . 6}$</td>
</tr>
<tr>
<td style="text-align: left;">- Acylation and related processes</td>
<td style="text-align: center;">2601</td>
<td style="text-align: center;">81.5</td>
<td style="text-align: center;">$\mathbf{9 0 . 0}$</td>
</tr>
<tr>
<td style="text-align: left;">- Deprotections</td>
<td style="text-align: center;">1232</td>
<td style="text-align: center;">69.0</td>
<td style="text-align: center;">$\mathbf{8 8 . 6}$</td>
</tr>
<tr>
<td style="text-align: left;">- C-C bond formation</td>
<td style="text-align: center;">329</td>
<td style="text-align: center;">55.6</td>
<td style="text-align: center;">$\mathbf{8 1 . 2}$</td>
</tr>
<tr>
<td style="text-align: left;">- Functional group interconversion (FGI)</td>
<td style="text-align: center;">315</td>
<td style="text-align: center;">54.0</td>
<td style="text-align: center;">$\mathbf{9 1 . 7}$</td>
</tr>
<tr>
<td style="text-align: left;">- Reductions</td>
<td style="text-align: center;">1996</td>
<td style="text-align: center;">71.6</td>
<td style="text-align: center;">$\mathbf{8 6 . 1}$</td>
</tr>
<tr>
<td style="text-align: left;">- Functional group addition (FGA)</td>
<td style="text-align: center;">1090</td>
<td style="text-align: center;">71.8</td>
<td style="text-align: center;">$\mathbf{8 9 . 3}$</td>
</tr>
<tr>
<td style="text-align: left;">- Heterocycle formation</td>
<td style="text-align: center;">310</td>
<td style="text-align: center;">57.7</td>
<td style="text-align: center;">$\mathbf{9 0 . 0}$</td>
</tr>
<tr>
<td style="text-align: left;">- Protections</td>
<td style="text-align: center;">868</td>
<td style="text-align: center;">52.9</td>
<td style="text-align: center;">$\mathbf{8 7 . 4}$</td>
</tr>
<tr>
<td style="text-align: left;">- Oxidations</td>
<td style="text-align: center;">339</td>
<td style="text-align: center;">41.3</td>
<td style="text-align: center;">$\mathbf{8 5 . 0}$</td>
</tr>
<tr>
<td style="text-align: left;">- Resolutions</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">$\mathbf{3 4 . 3}$</td>
<td style="text-align: center;">28.6</td>
</tr>
<tr>
<td style="text-align: left;">- Unrecognized</td>
<td style="text-align: center;">3601</td>
<td style="text-align: center;">26.8</td>
<td style="text-align: center;">$\mathbf{4 6 . 3}$</td>
</tr>
<tr>
<td style="text-align: left;">With stereochemistry</td>
<td style="text-align: center;">4103</td>
<td style="text-align: center;">48.2</td>
<td style="text-align: center;">$\mathbf{6 7 . 9}$</td>
</tr>
<tr>
<td style="text-align: left;">Without stereochemistry</td>
<td style="text-align: center;">11315</td>
<td style="text-align: center;">64.3</td>
<td style="text-align: center;">$\mathbf{8 1 . 6}$</td>
</tr>
<tr>
<td style="text-align: left;">Invalid Smiles</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">2.8</td>
<td style="text-align: center;">$\mathbf{0 . 5}$</td>
</tr>
</tbody>
</table>
<p>model trained on the mixed USPTO_MIT dataset and achieve a top-1 accuracy of $87.5 \%$, significantly higher than the average of the best human ( $76.5 \%$ ) and the best graph-based model ( $72.5 \%$ ). Additionally, as seen in Figure 2 Molecular Transformer is generalizable and remains accurate even for the less common reactions.</p>
<p>Figure 3 shows the 6 of the 80 reactions for which our model did not output the correct prediction in its top-2 choices. Even though our model does not predict the ground truth, it usually predicts a reasonable most likely outcome: In RXN 14, our model predicts that a primary amine acts as the nucleophile in an amide formation reaction rather than a secondary amine, which is reasonable on the grounds of sterics. In RXN 68, the reaction yielding the reported ground truth is via a nucleophilic substitution of $\mathrm{Cl}^{-}$by $\mathrm{OH}^{-}$by addition-elimination mechanism, followed by lactim-lactam tautomerism. For the reaction to work there must have been a source of hydroxide ions, which is not indicated among the reactants. In the absence of hydroxide ions, the best nucleophile in the reaction mixture is the phenolate ion generated from the phenol by deprotonation by sodium hydride. In RXN</p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 2: Top-1 accuracy of our model (mixed, USPTO_MIT) on 80 chemical reactions across 8 reaction popularity bins in comparison with a human study and their graph-based model (WLDN5). ${ }^{24}$</p>
<p>72, the correct product predicted, but the ground truth additionally reports a by-product (which is mechanistically dubious as HCl will react with excess amine to form the ammonium salt). In RXN 76, a carbon atom is clearly missing in the ground truth. In RXN 61, we predict a $\mathrm{SN}_{2}$ where the anion of the alcohol of the beta hydroxy ester acts as nucleophile, whereas the mechanism of the ground truth is presumably ester hydrolysis followed by nucleophilic attack of the carboxylate group. Proton transfers in protic solvents are extremely fast, thus deprotonation of the alcohol OH is much faster than ester hydrolysis. Moreover, the carboxylate anion is a poor nucleophile.</p>
<h1>Uncertainty estimation and reaction pathway scoring</h1>
<p>As organic synthesis is a multistep process, in order for a reaction predictor to be useful it must be able to estimate its own uncertainty. The Molecular Transformer model provides a natural way achieve this - the product of the probabilities of all predicted tokens can be used as a confidence score. Figure 4 plots the receiver operating characteristics (ROC) curve and</p>
<p><img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 3: The 6 reactions in the human test set ${ }^{24}$ not predicted within top-2 using our model trained on the augmented mixed USPTO_MIT set.
shows that the AUC-ROC is 0.89 if we use this confidence score as a threshold to predict whether a reaction is mispredicted. Interestingly, Figure 4 reveals that a subtle change in the training method, label smoothing, has a minimal effect on accuracy but a surprisingly significant impact on uncertainty quantification. Label smoothing was introduced by Vaswani et al. ${ }^{31}$ for NMT models. Instead of simply maximizing likelihood of the next target token at a given time step, the network learns a distribution over all possible tokens. Therefore, it is less confident about its predictions. Label smoothing helps to generate higher-scoring</p>
<p>translations in terms of accuracy and BLEU score ${ }^{48}$ for human languages, and also helps in terms of reaching higher top-1 accuracy in reaction prediction. The top-1 accuracy on the validation set (mixed, USPTO_MIT) with the label smoothing parameter set to 0.01 is $87.44 \%$ compared to $87.28 \%$ for no smoothing. However, Figure 4 shows that this small increase in accuracy comes with the cost of not being to able to discriminate between a good and a bad prediction anymore. Therefore, no label smoothing was used during the training of our models. The AUC-ROC of our single mixed USPTO_MIT model measured on the test set was also at 0.89 . The uncertainty estimation metric allows us to estimate the likelihood of a given reactants-product combination, rather only predicting product given reactants, and this could be used as a score to rank reaction pathways. ${ }^{49,50}$
<img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Figure 4: Receiver operatoring characteristic curve for different label smoothing values for a model trained on the mixed USPTO_MIT dataset, when evaluated on the validation set.</p>
<h1>Chemically Constrained Beam Search</h1>
<p>As no chemical knowledge was integrated into the model, technically, the model could perform "alchemy", e.g. turning a fluoride atom in the reactants into a bromide atom in the products, which was not in the reactants at all. As such, an interesting question is whether the model has learnt to avoid alchemy. To this end, we implemented a constrained beam search, where the probabilities of atomic tokens not observed in the reactants are set to 0.0</p>
<p>and hence not predicted. However, there was no change in accuracy, showing that the model had successfully inferred this constraint from the examples shown during training.</p>
<h1>Conclusion</h1>
<p>We show that a multi-head attention Transformer network, the Molecular Transformer, outperforms all known algorithms in the reaction prediction literature, achieving $90.4 \%$ top-1 accuracy ( $93.7 \%$ top-2 accuracy) on a common benchmark dataset. The model requires no handcrafted rules, and accurately predicts subtle chemical transformations. Moreover, the Molecular Transformer can also accurately estimate its own uncertainty, with an uncertainty score that is $89 \%$ accurate in terms of classifying whether a prediction is correct. The uncertainty score can be used to rank reaction pathways. We point out that previous work have all considered an unrealistically generous setting of separated reactants and reagents. We demonstrate an accuracy of $88.6 \%$ when no distinction is drawn between reactants and reagents in the inputs, a score that outperforms previous work as well. For the more noisy USPTO_STEREO dataset, our top-1 accuracies are $78.1 \%$ (separated) and $76.2 \%$ respectively. The Molecular Transformer has been freely available since August 2018 through a graphical user interface on the IBM RXN for Chemistry platform, ${ }^{34}$ and has so far been used by several thousand organic chemists worldwide for performing more than 40,000 chemical reaction predictions.</p>
<h2>Acknowledgement</h2>
<p>PS and AAL acknowledges the Winton Programme for the Physics of Sustainability for funding. The authors thank G. Landrum, R. Sayle, G. Godin and R. Griffiths for useful feedback and discussions.</p>
<h1>References</h1>
<p>(1) Blakemore, D. C.; Castro, L.; Churcher, I.; Rees, D. C.; Thomas, A. W.; Wilson, D. M.; Wood, A. Organic synthesis provides opportunities to transform drug discovery. Nature chemistry 2018, 10, 383 .
(2) Bohacek, R. S.; McMartin, C.; Guida, W. C. The art and practice of structure-based drug design: a molecular modeling perspective. Medicinal research reviews 1996, 16, $3-50$.
(3) Boström, J.; Brown, D. G.; Young, R. J.; Keserü, G. M. Expanding the medicinal chemistry synthetic toolbox. Nature Reviews Drug Discovery 2018,
(4) Kusner, M. J.; Paige, B.; Hernández-Lobato, J. M. Grammar variational autoencoder. arXiv preprint arXiv:1703.01925 2017,
(5) Gómez-Bombarelli, R.; Wei, J. N.; Duvenaud, D.; Hernández-Lobato, J. M.; SánchezLengeling, B.; Sheberla, D.; Aguilera-Iparraguirre, J.; Hirzel, T. D.; Adams, R. P.; Aspuru-Guzik, A. Automatic chemical design using a data-driven continuous representation of molecules. ACS central science 2018, 4, 268-276.
(6) Griffiths, R.-R.; Hernández-Lobato, J. M. Constrained bayesian optimization for automatic chemical design. arXiv preprint arXiv:1709.05501 2017,
(7) Popova, M.; Isayev, O.; Tropsha, A. Deep reinforcement learning for de novo drug design. Science advances 2018, 4, eaap7885.
(8) Blaschke, T.; Olivecrona, M.; Engkvist, O.; Bajorath, J.; Chen, H. Application of generative autoencoder in de novo molecular design. Molecular informatics 2018, 37, 1700123 .
(9) Jin, W.; Barzilay, R.; Jaakkola, T. Junction Tree Variational Autoencoder for Molecular Graph Generation. arXiv preprint arXiv:1802.04364 2018,</p>
<p>(10) Kang, S.; Cho, K. Conditional molecular design with deep generative models. arXiv preprint arXiv:1805.00108 2018,
(11) Charest, M. G.; Lerner, C. D.; Brubaker, J. D.; Siegel, D. R.; Myers, A. G. A convergent enantioselective route to structurally diverse 6-deoxytetracycline antibiotics. Science 2005, 308, 395-398.
(12) Engkvist, O.; Norrby, P.-O.; Selmi, N.; Lam, Y.-h.; Peng, Z.; Sherer, E. C.; Amberg, W.; Erhard, T.; Smyth, L. A. Computational prediction of chemical reactions: current status and outlook. Drug discovery today 2018,
(13) Coley, C. W.; Green, W. H.; Jensen, K. F. Machine Learning in Computer-Aided Synthesis Planning. Accounts of chemical research 2018, 51, 1281-1289.
(14) Wei, J. N.; Duvenaud, D.; Aspuru-Guzik, A. Neural networks for the prediction of organic chemistry reactions. ACS central science 2016, 2, 725-732.
(15) Coley, C. W.; Barzilay, R.; Jaakkola, T. S.; Green, W. H.; Jensen, K. F. Prediction of organic reaction outcomes using machine learning. ACS central science 2017, 3, $434-443$.
(16) Segler, M. H.; Waller, M. P. Neural-Symbolic Machine Learning for Retrosynthesis and Reaction Prediction. Chemistry-A European Journal 2017, 23, 5966-5971.
(17) Corey, E. J.; Long, A. K.; Rubenstein, S. D. Computer-assisted analysis in organic synthesis. Science 1985, 228, 408-418.
(18) Szymkuć, S.; Gajewska, E. P.; Klucznik, T.; Molga, K.; Dittwald, P.; Startek, M.; Bajczyk, M.; Grzybowski, B. A. Computer-Assisted Synthetic Planning: The End of the Beginning. Angewandte Chemie International Edition 2016, 55, 5904-5937.
(19) Grzybowski, B. A.; Szymkuć, S.; Gajewska, E. P.; Molga, K.; Dittwald, P.; Wołos, A.;</p>
<p>Klucznik, T. Chematica: A Story of Computer Code That Started to Think like a Chemist. Chem 2018, 4, 390-398.
(20) Chen, W. L.; Chen, D. Z.; Taylor, K. T. Automatic reaction mapping and reaction center detection. Wiley Interdisciplinary Reviews: Computational Molecular Science 2013, 3, 560-593.
(21) Nextmove Software NameRXN. http://www.nextmovesoftware.com/namerxn.html.
(22) Schneider, N.; Lowe, D. M.; Sayle, R. A.; Landrum, G. A. Development of a novel fingerprint for chemical reactions and its application to large-scale reaction classification and similarity. Journal of chemical information and modeling 2015, 55, 39-53.
(23) Jin, W.; Coley, C.; Barzilay, R.; Jaakkola, T. Predicting Organic Reaction Outcomes with Weisfeiler-Lehman Network. Advances in Neural Information Processing Systems. 2017; pp 2604-2613.
(24) Coley, C. W.; Jin, W.; Rogers, L.; Jamison, T. F.; Jaakkola, T. S.; Green, W. H.; Barzilay, R.; Jensen, K. F. A graph-convolutional neural network model for the prediction of chemical reactivity. Chemical science 2019, 10, 370-377.
(25) Bradshaw, J.; Kusner, M. J.; Paige, B.; Segler, M. H.; Hernández-Lobato, J. M. Predicting Electron Paths. arXiv preprint arXiv:1805.10970 2018,
(26) Do, K.; Tran, T.; Venkatesh, S. Graph Transformation Policy Network for Chemical Reaction Prediction. arXiv preprint arXiv:1812.09441 2018,
(27) Nam, J.; Kim, J. Linking the neural machine translation and the prediction of organic chemistry reactions. arXiv preprint arXiv:1612.09529 2016,
(28) Schwaller, P.; Gaudin, T.; Lanyi, D.; Bekas, C.; Laino, T. "Found in Translation": Predicting Outcomes of Complex Organic Chemistry Reactions using Neural Sequence-to-Sequence Models. Chemical Science 2018,</p>
<p>(29) Bahdanau, D.; Cho, K.; Bengio, Y. Neural machine translation by jointly learning to align and translate. arXiv preprint arXiv:1409.0473 2014,
(30) Luong, M.-T.; Pham, H.; Manning, C. D. Effective approaches to attention-based neural machine translation. arXiv preprint arXiv:1508.04025 2015,
(31) Vaswani, A.; Shazeer, N.; Parmar, N.; Uszkoreit, J.; Jones, L.; Gomez, A. N.; Kaiser, Ł.; Polosukhin, I. Attention is all you need. Advances in Neural Information Processing Systems. 2017; pp 6000-6010.
(32) Weininger, D. SMILES, a chemical language and information system. 1. Introduction to methodology and encoding rules. Journal of chemical information and computer sciences 1988, 28, 31-36.
(33) Weininger, D.; Weininger, A.; Weininger, J. L. SMILES. 2. Algorithm for generation of unique SMILES notation. Journal of chemical information and computer sciences 1989, 29, 97-101.
(34) IBM RXN for Chemistry. https://rxn.res.ibm.com.
(35) Lowe, D. M. Extraction of chemical structures and reactions from the literature. Ph.D. thesis, University of Cambridge, 2012.
(36) Nextmove Software Pistachio. http://www.nextmovesoftware.com/pistachio.html.
(37) Schneider, N.; Lowe, D. M.; Sayle, R. A.; Tarselli, M. A.; Landrum, G. A. Big data from pharmaceutical patents: a computational analysis of medicinal chemists' bread and butter. J. Med. Chem. 2016, 59, 4385-4402.
(38) Schneider, N.; Stiefl, N.; Landrum, G. A. What's what: The (nearly) definitive guide to reaction role assignment. Journal of chemical information and modeling 2016, 56, $2336-2346$.</p>            </div>
        </div>

    </div>
</body>
</html>