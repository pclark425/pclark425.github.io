<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-5800 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-5800</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-5800</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-116.html">extraction-schema-116</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <p><strong>Paper ID:</strong> paper-a54b56af24bb4873ed0163b77df63b92bd018ddc</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/a54b56af24bb4873ed0163b77df63b92bd018ddc" target="_blank">DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter</a></p>
                <p><strong>Paper Venue:</strong> arXiv.org</p>
                <p><strong>Paper TL;DR:</strong> This work proposes a method to pre-train a smaller general-purpose language representation model, called DistilBERT, which can be fine-tuned with good performances on a wide range of tasks like its larger counterparts, and introduces a triple loss combining language modeling, distillation and cosine-distance losses.</p>
                <p><strong>Paper Abstract:</strong> As Transfer Learning from large-scale pre-trained models becomes more prevalent in Natural Language Processing (NLP), operating these large models in on-the-edge and/or under constrained computational training or inference budgets remains challenging. In this work, we propose a method to pre-train a smaller general-purpose language representation model, called DistilBERT, which can then be fine-tuned with good performances on a wide range of tasks like its larger counterparts. While most prior work investigated the use of distillation for building task-specific models, we leverage knowledge distillation during the pre-training phase and show that it is possible to reduce the size of a BERT model by 40%, while retaining 97% of its language understanding capabilities and being 60% faster. To leverage the inductive biases learned by larger models during pre-training, we introduce a triple loss combining language modeling, distillation and cosine-distance losses. Our smaller, faster and lighter model is cheaper to pre-train and we demonstrate its capabilities for on-device computations in a proof-of-concept experiment and a comparative on-device study.</p>
                <p><strong>Cost:</strong> 0.012</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <div class="extraction-instance-container" id="e5800.0">
                <h3 class="extraction-instance">Extracted Data Instance 0 (e5800.0)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Triple loss (L_ce + L_mlm + L_cos)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Triple loss combining teacher soft-target cross-entropy distillation, masked language modeling, and cosine embedding loss</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A pre-training objective used to distill BERT into DistilBERT that linearly combines (1) distillation cross-entropy on teacher soft targets, (2) the masked language modeling (MLM) loss, and (3) a cosine embedding loss aligning student and teacher hidden-state directions.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>DistilBERT (student) with BERT-base teacher</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td>66M (DistilBERT); 110M (BERT-base)</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>GLUE (General Language Understanding Evaluation)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>A suite of 9 natural language understanding tasks; paper reports the GLUE macro-score (average across tasks) on development sets after fine-tuning.</td>
                        </tr>
                        <tr>
                            <td><strong>problem_format</strong></td>
                            <td>Training presentation format: pre-training with a composite (triple) loss that jointly (a) minimizes cross-entropy between student and teacher soft-target distributions (temperature-scaled softmax), (b) optimizes the standard masked language modeling objective, and (c) minimizes a cosine embedding loss to align hidden state directions between teacher and student.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_format</strong></td>
                            <td>Ablations removing each component of the triple loss separately (remove distillation cross-entropy L_ce; remove cosine loss L_cos; remove MLM L_mlm) and a variant with random student initialization (instead of teacher-based initialization).</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>GLUE macro-score: 77.0 (DistilBERT trained with full triple loss + teacher-based initialization).</td>
                        </tr>
                        <tr>
                            <td><strong>performance_comparison</strong></td>
                            <td>Remove distillation cross-entropy (no L_ce): 74.04 (−2.96); Remove cosine loss (no L_cos): 75.54 (−1.46); Remove MLM (no L_mlm): 76.69 (−0.31); Triple loss with random initialization: 73.31 (−3.69).</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_size</strong></td>
                            <td>Removing L_ce: −2.96 GLUE points; Removing L_cos: −1.46; Removing L_mlm: −0.31; Random init (vs teacher init): −3.69.</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_direction</strong></td>
                            <td>Including distillation components (L_ce and L_cos) improved performance; removing them reduced performance markedly; removing MLM had little effect.</td>
                        </tr>
                        <tr>
                            <td><strong>explanation_or_hypothesis</strong></td>
                            <td>Authors argue that distillation (soft-target cross-entropy) provides a richer training signal than hard labels and that the cosine loss helps align student and teacher hidden-state directions (transferring inductive biases); MLM contributes but is less critical than the distillation signals. Overall leveraging teacher knowledge during pre-training yields substantial gains.</td>
                        </tr>
                        <tr>
                            <td><strong>counterexample_or_null_result</strong></td>
                            <td>Removal of the MLM objective had a very small impact (−0.31 GLUE points), indicating that in this distilled pre-training setup MLM is less crucial than the distillation terms.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter', 'publication_date_yy_mm': '2019-10'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e5800.1">
                <h3 class="extraction-instance">Extracted Data Instance 1 (e5800.1)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Teacher-based layer initialization</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Student initialization by copying alternate layers from the teacher (take one layer out of two)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>An initialization strategy where the student network is initialized by copying every other layer from the pre-trained teacher (BERT), enabling the smaller student to start from a subnetwork of the teacher rather than random weights.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>DistilBERT (student) with BERT-base teacher</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td>66M (DistilBERT); 110M (BERT-base)</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>GLUE (General Language Understanding Evaluation)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>GLUE benchmark; macro-score over 9 NLU tasks after fine-tuning.</td>
                        </tr>
                        <tr>
                            <td><strong>problem_format</strong></td>
                            <td>Model presentation/initialization format: initialize the student's parameters by copying one layer out of two from the teacher (BERT) versus random initialization of the student.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_format</strong></td>
                            <td>Teacher-based initialization (copying layers) vs random weight initialization with the same triple loss.</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>GLUE macro-score with teacher-based initialization + triple loss: 77.0.</td>
                        </tr>
                        <tr>
                            <td><strong>performance_comparison</strong></td>
                            <td>Triple loss with random weights initialization: 73.31 (−3.69 relative to teacher-based initialization).</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_size</strong></td>
                            <td>Teacher-based initialization improved GLUE macro-score by +3.69 points relative to random initialization.</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_direction</strong></td>
                            <td>Improved (teacher-based initialization yielded substantially better performance than random initialization).</td>
                        </tr>
                        <tr>
                            <td><strong>explanation_or_hypothesis</strong></td>
                            <td>Authors state that initializing the student from the teacher exploits shared dimensionality and provides a good subnetwork starting point, helping the smaller model converge and retain teacher inductive biases.</td>
                        </tr>
                        <tr>
                            <td><strong>counterexample_or_null_result</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter', 'publication_date_yy_mm': '2019-10'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e5800.2">
                <h3 class="extraction-instance">Extracted Data Instance 2 (e5800.2)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of how the format or presentation of problems (e.g., prompt wording, structure, context, formatting) affects the performance of large language models (LLMs), including details of the formats used, tasks evaluated, models tested, performance results, and any explanations or comparisons.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Two-step (pre-train + fine-tune) distillation</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Sequential distillation: distill during pre-training and again during task-specific fine-tuning using a fine-tuned teacher</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>An adaptation format where DistilBERT is first distilled during general pre-training from BERT, and then a second distillation step is applied during fine-tuning with a teacher model that was fine-tuned on the target task (SQuAD).</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>DistilBERT (student); BERT-base used as teacher</td>
                        </tr>
                        <tr>
                            <td><strong>model_size</strong></td>
                            <td>66M (DistilBERT); 110M (BERT-base)</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>SQuAD v1.1 (question answering)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Extractive question answering benchmark; evaluation metrics are Exact Match (EM) and F1 on the dev set.</td>
                        </tr>
                        <tr>
                            <td><strong>problem_format</strong></td>
                            <td>Fine-tuning presentation format: after pre-training distillation, perform a second distillation step during adaptation by fine-tuning the student with an additional loss term that distills knowledge from a teacher model fine-tuned on SQuAD.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_format</strong></td>
                            <td>Single-stage (only pre-training distillation then standard fine-tuning) vs two-step distillation (additional distillation during fine-tuning).</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>DistilBERT (single-stage) on SQuAD dev: EM 77.7, F1 85.8. DistilBERT with additional distillation at fine-tuning (DistilBERT (D)): EM 79.1, F1 86.9. BERT-base (teacher) for reference: EM 81.2, F1 88.5.</td>
                        </tr>
                        <tr>
                            <td><strong>performance_comparison</strong></td>
                            <td>Two-step distillation improved DistilBERT by +1.4 EM (77.7 -> 79.1) and +1.1 F1 (85.8 -> 86.9) compared to single-stage.</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_size</strong></td>
                            <td>+1.4 EM, +1.1 F1 from adding a second distillation step during fine-tuning.</td>
                        </tr>
                        <tr>
                            <td><strong>format_effect_direction</strong></td>
                            <td>Improved (additional distillation during adaptation increased SQuAD performance modestly).</td>
                        </tr>
                        <tr>
                            <td><strong>explanation_or_hypothesis</strong></td>
                            <td>The second distillation step transfers task-specific knowledge from a teacher fine-tuned on the target task to the student, yielding better adaptation performance while keeping the model compact.</td>
                        </tr>
                        <tr>
                            <td><strong>counterexample_or_null_result</strong></td>
                            <td>Although two-step distillation improved performance, DistilBERT still remains a few points behind BERT-base on SQuAD (e.g., EM and F1 differences remain), so the extra distillation does not fully close the gap.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter', 'publication_date_yy_mm': '2019-10'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>Distilling the knowledge in a neural network <em>(Rating: 2)</em></li>
                <li>Well-read students learn better: The impact of student initialization on knowledge distillation <em>(Rating: 2)</em></li>
                <li>Model compression with multi-task knowledge distillation for web-scale question answering system <em>(Rating: 2)</em></li>
                <li>Small and practical bert models for sequence labeling <em>(Rating: 1)</em></li>
                <li>Are sixteen heads really better than one? <em>(Rating: 1)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-5800",
    "paper_id": "paper-a54b56af24bb4873ed0163b77df63b92bd018ddc",
    "extraction_schema_id": "extraction-schema-116",
    "extracted_data": [
        {
            "name_short": "Triple loss (L_ce + L_mlm + L_cos)",
            "name_full": "Triple loss combining teacher soft-target cross-entropy distillation, masked language modeling, and cosine embedding loss",
            "brief_description": "A pre-training objective used to distill BERT into DistilBERT that linearly combines (1) distillation cross-entropy on teacher soft targets, (2) the masked language modeling (MLM) loss, and (3) a cosine embedding loss aligning student and teacher hidden-state directions.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "DistilBERT (student) with BERT-base teacher",
            "model_size": "66M (DistilBERT); 110M (BERT-base)",
            "task_name": "GLUE (General Language Understanding Evaluation)",
            "task_description": "A suite of 9 natural language understanding tasks; paper reports the GLUE macro-score (average across tasks) on development sets after fine-tuning.",
            "problem_format": "Training presentation format: pre-training with a composite (triple) loss that jointly (a) minimizes cross-entropy between student and teacher soft-target distributions (temperature-scaled softmax), (b) optimizes the standard masked language modeling objective, and (c) minimizes a cosine embedding loss to align hidden state directions between teacher and student.",
            "comparison_format": "Ablations removing each component of the triple loss separately (remove distillation cross-entropy L_ce; remove cosine loss L_cos; remove MLM L_mlm) and a variant with random student initialization (instead of teacher-based initialization).",
            "performance": "GLUE macro-score: 77.0 (DistilBERT trained with full triple loss + teacher-based initialization).",
            "performance_comparison": "Remove distillation cross-entropy (no L_ce): 74.04 (−2.96); Remove cosine loss (no L_cos): 75.54 (−1.46); Remove MLM (no L_mlm): 76.69 (−0.31); Triple loss with random initialization: 73.31 (−3.69).",
            "format_effect_size": "Removing L_ce: −2.96 GLUE points; Removing L_cos: −1.46; Removing L_mlm: −0.31; Random init (vs teacher init): −3.69.",
            "format_effect_direction": "Including distillation components (L_ce and L_cos) improved performance; removing them reduced performance markedly; removing MLM had little effect.",
            "explanation_or_hypothesis": "Authors argue that distillation (soft-target cross-entropy) provides a richer training signal than hard labels and that the cosine loss helps align student and teacher hidden-state directions (transferring inductive biases); MLM contributes but is less critical than the distillation signals. Overall leveraging teacher knowledge during pre-training yields substantial gains.",
            "counterexample_or_null_result": "Removal of the MLM objective had a very small impact (−0.31 GLUE points), indicating that in this distilled pre-training setup MLM is less crucial than the distillation terms.",
            "uuid": "e5800.0",
            "source_info": {
                "paper_title": "DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter",
                "publication_date_yy_mm": "2019-10"
            }
        },
        {
            "name_short": "Teacher-based layer initialization",
            "name_full": "Student initialization by copying alternate layers from the teacher (take one layer out of two)",
            "brief_description": "An initialization strategy where the student network is initialized by copying every other layer from the pre-trained teacher (BERT), enabling the smaller student to start from a subnetwork of the teacher rather than random weights.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "DistilBERT (student) with BERT-base teacher",
            "model_size": "66M (DistilBERT); 110M (BERT-base)",
            "task_name": "GLUE (General Language Understanding Evaluation)",
            "task_description": "GLUE benchmark; macro-score over 9 NLU tasks after fine-tuning.",
            "problem_format": "Model presentation/initialization format: initialize the student's parameters by copying one layer out of two from the teacher (BERT) versus random initialization of the student.",
            "comparison_format": "Teacher-based initialization (copying layers) vs random weight initialization with the same triple loss.",
            "performance": "GLUE macro-score with teacher-based initialization + triple loss: 77.0.",
            "performance_comparison": "Triple loss with random weights initialization: 73.31 (−3.69 relative to teacher-based initialization).",
            "format_effect_size": "Teacher-based initialization improved GLUE macro-score by +3.69 points relative to random initialization.",
            "format_effect_direction": "Improved (teacher-based initialization yielded substantially better performance than random initialization).",
            "explanation_or_hypothesis": "Authors state that initializing the student from the teacher exploits shared dimensionality and provides a good subnetwork starting point, helping the smaller model converge and retain teacher inductive biases.",
            "counterexample_or_null_result": null,
            "uuid": "e5800.1",
            "source_info": {
                "paper_title": "DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter",
                "publication_date_yy_mm": "2019-10"
            }
        },
        {
            "name_short": "Two-step (pre-train + fine-tune) distillation",
            "name_full": "Sequential distillation: distill during pre-training and again during task-specific fine-tuning using a fine-tuned teacher",
            "brief_description": "An adaptation format where DistilBERT is first distilled during general pre-training from BERT, and then a second distillation step is applied during fine-tuning with a teacher model that was fine-tuned on the target task (SQuAD).",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "DistilBERT (student); BERT-base used as teacher",
            "model_size": "66M (DistilBERT); 110M (BERT-base)",
            "task_name": "SQuAD v1.1 (question answering)",
            "task_description": "Extractive question answering benchmark; evaluation metrics are Exact Match (EM) and F1 on the dev set.",
            "problem_format": "Fine-tuning presentation format: after pre-training distillation, perform a second distillation step during adaptation by fine-tuning the student with an additional loss term that distills knowledge from a teacher model fine-tuned on SQuAD.",
            "comparison_format": "Single-stage (only pre-training distillation then standard fine-tuning) vs two-step distillation (additional distillation during fine-tuning).",
            "performance": "DistilBERT (single-stage) on SQuAD dev: EM 77.7, F1 85.8. DistilBERT with additional distillation at fine-tuning (DistilBERT (D)): EM 79.1, F1 86.9. BERT-base (teacher) for reference: EM 81.2, F1 88.5.",
            "performance_comparison": "Two-step distillation improved DistilBERT by +1.4 EM (77.7 -&gt; 79.1) and +1.1 F1 (85.8 -&gt; 86.9) compared to single-stage.",
            "format_effect_size": "+1.4 EM, +1.1 F1 from adding a second distillation step during fine-tuning.",
            "format_effect_direction": "Improved (additional distillation during adaptation increased SQuAD performance modestly).",
            "explanation_or_hypothesis": "The second distillation step transfers task-specific knowledge from a teacher fine-tuned on the target task to the student, yielding better adaptation performance while keeping the model compact.",
            "counterexample_or_null_result": "Although two-step distillation improved performance, DistilBERT still remains a few points behind BERT-base on SQuAD (e.g., EM and F1 differences remain), so the extra distillation does not fully close the gap.",
            "uuid": "e5800.2",
            "source_info": {
                "paper_title": "DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter",
                "publication_date_yy_mm": "2019-10"
            }
        }
    ],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "Distilling the knowledge in a neural network",
            "rating": 2
        },
        {
            "paper_title": "Well-read students learn better: The impact of student initialization on knowledge distillation",
            "rating": 2
        },
        {
            "paper_title": "Model compression with multi-task knowledge distillation for web-scale question answering system",
            "rating": 2
        },
        {
            "paper_title": "Small and practical bert models for sequence labeling",
            "rating": 1
        },
        {
            "paper_title": "Are sixteen heads really better than one?",
            "rating": 1
        }
    ],
    "cost": 0.01237075,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter</h1>
<p>Victor SANH, Lysandre DEBUT, Julien CHAUMOND, Thomas WOLF<br>Hugging Face<br>{victor,lysandre, julien,thomas}@huggingface.co</p>
<h4>Abstract</h4>
<p>As Transfer Learning from large-scale pre-trained models becomes more prevalent in Natural Language Processing (NLP), operating these large models in on-theedge and/or under constrained computational training or inference budgets remains challenging. In this work, we propose a method to pre-train a smaller generalpurpose language representation model, called DistilBERT, which can then be finetuned with good performances on a wide range of tasks like its larger counterparts. While most prior work investigated the use of distillation for building task-specific models, we leverage knowledge distillation during the pre-training phase and show that it is possible to reduce the size of a BERT model by $40 \%$, while retaining $97 \%$ of its language understanding capabilities and being $60 \%$ faster. To leverage the inductive biases learned by larger models during pre-training, we introduce a triple loss combining language modeling, distillation and cosine-distance losses. Our smaller, faster and lighter model is cheaper to pre-train and we demonstrate its capabilities for on-device computations in a proof-of-concept experiment and a comparative on-device study.</p>
<h2>1 Introduction</h2>
<p>The last two years have seen the rise of Transfer Learning approaches in Natural Language Processing (NLP) with large-scale pre-trained language models becoming a basic tool in many NLP tasks [Devlin et al., 2018, Radford et al., 2019, Liu et al., 2019]. While these models lead to significant improvement, they often have several hundred million parameters and current research ${ }^{1}$ on pre-trained models indicates that training even larger models still leads to better performances on downstream tasks.
The trend toward bigger models raises several concerns. First is the
<img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<p>Figure 1: Parameter counts of several recently released pretrained language models.
environmental cost of exponentially scaling these models' computational requirements as mentioned in Schwartz et al. [2019], Strubell et al. [2019]. Second, while operating these models on-device in real-time has the potential to enable novel and interesting language processing applications, the growing computational and memory requirements of these models may hamper wide adoption.</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>In this paper, we show that it is possible to reach similar performances on many downstream-tasks using much smaller language models pre-trained with knowledge distillation, resulting in models that are lighter and faster at inference time, while also requiring a smaller computational training budget. Our general-purpose pre-trained models can be fine-tuned with good performances on several downstream tasks, keeping the flexibility of larger models. We also show that our compressed models are small enough to run on the edge, e.g. on mobile devices.</p>
<p>Using a triple loss, we show that a 40% smaller Transformer (Vaswani et al. [2017]) pre-trained through distillation via the supervision of a bigger Transformer language model can achieve similar performance on a variety of downstream tasks, while being 60% faster at inference time. Further ablation studies indicate that all the components of the triple loss are important for best performances.</p>
<p>We have made the trained weights available along with the training code in the Transformers library from HuggingFace [Wolf et al., 2019].</p>
<h1>2 Knowledge distillation</h1>
<p>Knowledge distillation [Bucila et al., 2006, Hinton et al., 2015] is a compression technique in which a compact model - the student - is trained to reproduce the behaviour of a larger model - the teacher or an ensemble of models.</p>
<p>In supervised learning, a classification model is generally trained to predict an instance class by maximizing the estimated probability of gold labels. A standard training objective thus involves minimizing the cross-entropy between the model's predicted distribution and the one-hot empirical distribution of training labels. A model performing well on the training set will predict an output distribution with high probability on the correct class and with near-zero probabilities on other classes. But some of these "near-zero" probabilities are larger than others and reflect, in part, the generalization capabilities of the model and how well it will perform on the test set ${ }^{1}$.</p>
<p>Training loss The student is trained with a distillation loss over the soft target probabilities of the teacher: $L_{c e}=\sum_{i} t_{i} * \log \left(s_{i}\right)$ where $t_{i}$ (resp. $s_{i}$ ) is a probability estimated by the teacher (resp. the student). This objective results in a rich training signal by leveraging the full teacher distribution. Following Hinton et al. [2015] we used a softmax-temperature: $p_{i}=\frac{\exp \left(z_{i} / T\right)}{\sum_{i} \exp \left(z_{i} / T\right)}$ where $T$ controls the smoothness of the output distribution and $z_{i}$ is the model score for the class $i$. The same temperature $T$ is applied to the student and the teacher at training time, while at inference, $T$ is set to 1 to recover a standard softmax.</p>
<p>The final training objective is a linear combination of the distillation loss $L_{c e}$ with the supervised training loss, in our case the masked language modeling loss $L_{m l m}$ [Devlin et al., 2018]. We found it beneficial to add a cosine embedding loss $\left(L_{c o s}\right)$ which will tend to align the directions of the student and teacher hidden states vectors.</p>
<h2>3 DistilBERT: a distilled version of BERT</h2>
<p>Student architecture In the present work, the student - DistilBERT - has the same general architecture as BERT. The token-type embeddings and the pooler are removed while the number of layers is reduced by a factor of 2 . Most of the operations used in the Transformer architecture (linear layer and layer normalisation) are highly optimized in modern linear algebra frameworks and our investigations showed that variations on the last dimension of the tensor (hidden size dimension) have a smaller impact on computation efficiency (for a fixed parameters budget) than variations on other factors like the number of layers. Thus we focus on reducing the number of layers.</p>
<p>Student initialization In addition to the previously described optimization and architectural choices, an important element in our training procedure is to find the right initialization for the sub-network to converge. Taking advantage of the common dimensionality between teacher and student networks, we initialize the student from the teacher by taking one layer out of two.</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>Table 1: DistilBERT retains $\mathbf{9 7 \%}$ of BERT performance. Comparison on the dev sets of the GLUE benchmark. ELMo results as reported by the authors. BERT and DistilBERT results are the medians of 5 runs with different seeds.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th style="text-align: right;">Score</th>
<th style="text-align: right;">CoLA</th>
<th style="text-align: right;">MNLI</th>
<th style="text-align: right;">MRPC</th>
<th style="text-align: right;">QNLI</th>
<th style="text-align: right;">QQP</th>
<th style="text-align: right;">RTE</th>
<th style="text-align: right;">SST-2</th>
<th style="text-align: right;">STS-B</th>
<th style="text-align: right;">WNLI</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">ELMo</td>
<td style="text-align: right;">68.7</td>
<td style="text-align: right;">44.1</td>
<td style="text-align: right;">68.6</td>
<td style="text-align: right;">76.6</td>
<td style="text-align: right;">71.1</td>
<td style="text-align: right;">86.2</td>
<td style="text-align: right;">53.4</td>
<td style="text-align: right;">91.5</td>
<td style="text-align: right;">70.4</td>
<td style="text-align: right;">56.3</td>
</tr>
<tr>
<td style="text-align: left;">BERT-base</td>
<td style="text-align: right;">79.5</td>
<td style="text-align: right;">56.3</td>
<td style="text-align: right;">86.7</td>
<td style="text-align: right;">88.6</td>
<td style="text-align: right;">91.8</td>
<td style="text-align: right;">89.6</td>
<td style="text-align: right;">69.3</td>
<td style="text-align: right;">92.7</td>
<td style="text-align: right;">89.0</td>
<td style="text-align: right;">53.5</td>
</tr>
<tr>
<td style="text-align: left;">DistilBERT</td>
<td style="text-align: right;">77.0</td>
<td style="text-align: right;">51.3</td>
<td style="text-align: right;">82.2</td>
<td style="text-align: right;">87.5</td>
<td style="text-align: right;">89.2</td>
<td style="text-align: right;">88.5</td>
<td style="text-align: right;">59.9</td>
<td style="text-align: right;">91.3</td>
<td style="text-align: right;">86.9</td>
<td style="text-align: right;">56.3</td>
</tr>
</tbody>
</table>
<p>Table 2: DistilBERT yields to comparable performance on downstream tasks. Comparison on downstream tasks: IMDb (test accuracy) and SQuAD 1.1 (EM/F1 on dev set). D: with a second step of distillation during fine-tuning.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th style="text-align: center;">IMDb <br> (acc.)</th>
<th style="text-align: center;">SQuAD <br> (EM/F1)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">BERT-base</td>
<td style="text-align: center;">93.46</td>
<td style="text-align: center;">$81.2 / 88.5$</td>
</tr>
<tr>
<td style="text-align: left;">DistilBERT</td>
<td style="text-align: center;">92.82</td>
<td style="text-align: center;">$77.7 / 85.8$</td>
</tr>
<tr>
<td style="text-align: left;">DistilBERT (D)</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">$79.1 / 86.9$</td>
</tr>
</tbody>
</table>
<p>Table 3: DistilBERT is significantly smaller while being constantly faster. Inference time of a full pass of GLUE task STS-B (sentiment analysis) on CPU with a batch size of 1 .</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th style="text-align: center;"># param. <br> (Millions)</th>
<th style="text-align: center;">Inf. time <br> (seconds)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">ELMo</td>
<td style="text-align: center;">180</td>
<td style="text-align: center;">895</td>
</tr>
<tr>
<td style="text-align: left;">BERT-base</td>
<td style="text-align: center;">110</td>
<td style="text-align: center;">668</td>
</tr>
<tr>
<td style="text-align: left;">DistilBERT</td>
<td style="text-align: center;">66</td>
<td style="text-align: center;">410</td>
</tr>
</tbody>
</table>
<p>Distillation We applied best practices for training BERT model recently proposed in Liu et al. [2019]. As such, DistilBERT is distilled on very large batches leveraging gradient accumulation (up to 4 K examples per batch) using dynamic masking and without the next sentence prediction objective.
Data and compute power We train DistilBERT on the same corpus as the original BERT model: a concatenation of English Wikipedia and Toronto Book Corpus [Zhu et al., 2015]. DistilBERT was trained on 816 GB V100 GPUs for approximately 90 hours. For the sake of comparison, the RoBERTa model [Liu et al., 2019] required 1 day of training on 1024 32GB V100.</p>
<h1>4 Experiments</h1>
<p>General Language Understanding We assess the language understanding and generalization capabilities of DistilBERT on the General Language Understanding Evaluation (GLUE) benchmark [Wang et al., 2018], a collection of 9 datasets for evaluating natural language understanding systems. We report scores on the development sets for each task by fine-tuning DistilBERT without the use of ensembling or multi-tasking scheme for fine-tuning (which are mostly orthogonal to the present work). We compare the results to the baseline provided by the authors of GLUE: an ELMo (Peters et al. [2018]) encoder followed by two BiLSTMs. ${ }^{4}$
The results on each of the 9 tasks are showed on Table 1 along with the macro-score (average of individual scores). Among the 9 tasks, DistilBERT is always on par or improving over the ELMo baseline (up to 19 points of accuracy on STS-B). DistilBERT also compares surprisingly well to BERT, retaining $97 \%$ of the performance with $40 \%$ fewer parameters.</p>
<h3>4.1 Downstream task benchmark</h3>
<p>Downstream tasks We further study the performances of DistilBERT on several downstream tasks under efficient inference constraints: a classification task (IMDb sentiment classification - Maas et al. [2011]) and a question answering task (SQuAD v1.1 - Rajpurkar et al. [2016]).
As shown in Table 2, DistilBERT is only $0.6 \%$ point behind BERT in test accuracy on the IMDb benchmark while being $40 \%$ smaller. On SQuAD, DistilBERT is within 3.9 points of the full BERT.
We also studied whether we could add another step of distillation during the adaptation phase by fine-tuning DistilBERT on SQuAD using a BERT model previously fine-tuned on SQuAD as a</p>
<p><sup id="fnref3:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>Table 4: Ablation study. Variations are relative to the model trained with triple loss and teacher weights initialization.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Ablation</th>
<th style="text-align: center;">Variation on GLUE macro-score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">$\emptyset-L_{\text {cos }}-L_{\text {mlm }}$</td>
<td style="text-align: center;">-2.96</td>
</tr>
<tr>
<td style="text-align: left;">$L_{c e}-\emptyset-L_{\text {mlm }}$</td>
<td style="text-align: center;">-1.46</td>
</tr>
<tr>
<td style="text-align: left;">$L_{c e}-L_{\text {cos }}-\emptyset$</td>
<td style="text-align: center;">-0.31</td>
</tr>
<tr>
<td style="text-align: left;">Triple loss + random weights initialization</td>
<td style="text-align: center;">-3.69</td>
</tr>
</tbody>
</table>
<p>teacher for an additional term in the loss (knowledge distillation). In this setting, there are thus two successive steps of distillation, one during the pre-training phase and one during the adaptation phase. In this case, we were able to reach interesting performances given the size of the model: 79.8 F1 and 70.4 EM, i.e. within 3 points of the full model.</p>
<h1>Size and inference speed</h1>
<p>To further investigate the speed-up/size trade-off of DistilBERT, we compare (in Table 3) the number of parameters of each model along with the inference time needed to do a full pass on the STSB development set on CPU (Intel Xeon E5-2690 v3 Haswell @2.9GHz) using a batch size of 1. DistilBERT has $40 \%$ fewer parameters than BERT and is $60 \%$ faster than BERT.</p>
<p>On device computation We studied whether DistilBERT could be used for on-the-edge applications by building a mobile application for question answering. We compare the average inference time on a recent smartphone (iPhone 7 Plus) against our previously trained question answering model based on BERT-base. Excluding the tokenization step, DistilBERT is $71 \%$ faster than BERT, and the whole model weighs 207 MB (which could be further reduced with quantization). Our code is available ${ }^{5}$.</p>
<h3>4.2 Ablation study</h3>
<p>In this section, we investigate the influence of various components of the triple loss and the student initialization on the performances of the distilled model. We report the macro-score on GLUE. Table 4 presents the deltas with the full triple loss: removing the Masked Language Modeling loss has little impact while the two distillation losses account for a large portion of the performance.</p>
<h2>5 Related work</h2>
<p>Task-specific distillation Most of the prior works focus on building task-specific distillation setups. Tang et al. [2019] transfer fine-tune classification model BERT to an LSTM-based classifier. Chatterjee [2019] distill BERT model fine-tuned on SQuAD in a smaller Transformer model previously initialized from BERT. In the present work, we found it beneficial to use a general-purpose pre-training distillation rather than a task-specific distillation. Turc et al. [2019] use the original pretraining objective to train smaller student, then fine-tuned via distillation. As shown in the ablation study, we found it beneficial to leverage the teacher's knowledge to pre-train with additional distillation signal.
Multi-distillation Yang et al. [2019] combine the knowledge of an ensemble of teachers using multi-task learning to regularize the distillation. The authors apply Multi-Task Knowledge Distillation to learn a compact question answering model from a set of large question answering models. An application of multi-distillation is multi-linguality: Tsai et al. [2019] adopts a similar approach to us by pre-training a multilingual model from scratch solely through distillation. However, as shown in the ablation study, leveraging the teacher's knowledge with initialization and additional losses leads to substantial gains.
Other compression techniques have been studied to compress large models. Recent developments in weights pruning reveal that it is possible to remove some heads in the self-attention at test time without significantly degrading the performance Michel et al. [2019]. Some layers can be reduced to one head. A separate line of study leverages quantization to derive smaller models (Gupta et al. [2015]). Pruning and quantization are orthogonal to the present work.</p>
<p><sup id="fnref4:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>6 Conclusion and future work</p>
<p>We introduced DistilBERT, a general-purpose pre-trained version of BERT, 40% smaller, 60% faster, that retains 97% of the language understanding capabilities. We showed that a general-purpose language model can be successfully trained with distillation and analyzed the various components with an ablation study. We further demonstrated that DistilBERT is a compelling option for edge applications.</p>
<h2>References</h2>
<ul>
<li>Devlin et al. [2018] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. Bert: Pre-training of deep bidirectional transformers for language understanding. In NAACL-HLT, 2018.</li>
<li>Radford et al. [2019] Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, and Ilya Sutskever. Language models are unsupervised multitask learners. 2019.</li>
<li>Liu et al. [2019] Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar S. Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke S. Zettlemoyer, and Veselin Stoyanov. Roberta: A robustly optimized bert pretraining approach. ArXiv, abs/1907.11692, 2019.</li>
<li>Schwartz et al. [2019] Roy Schwartz, Jesse Dodge, Noah A. Smith, and Oren Etzioni. Green ai. ArXiv, abs/1907.10597, 2019.</li>
<li>Strubell et al. [2019] Emma Strubell, Ananya Ganesh, and Andrew McCallum. Energy and policy considerations for deep learning in nlp. In ACL, 2019.</li>
<li>Vaswani et al. [2017] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin. Attention is all you need. In NIPS, 2017.</li>
<li>Wolf et al. [2019] Thomas Wolf, Lysandre Debut, Victor Sanh, Julien Chaumond, Clement Delangue, Anthony Moi, Pierric Cistac, Tim Rault, Rémi Louf, Morgan Funtowicz, and Jamie Brew. Transformers: State-of-the-art natural language processing, 2019.</li>
<li>Bucila et al. [2006] Cristian Bucila, Rich Caruana, and Alexandru Niculescu-Mizil. Model compression. In KDD, 2006.</li>
<li>E. Hinton et al. [2015] Geoffrey E. Hinton, Oriol Vinyals, and Jeffrey Dean. Distilling the knowledge in a neural network. ArXiv, abs/1503.02531, 2015.</li>
<li>Zhu et al. [2015] Yukun Zhu, Ryan Kiros, Richard S. Zemel, Ruslan Salakhutdinov, Raquel Urtasun, Antonio Torralba, and Sanja Fidler. Aligning books and movies: Towards story-like visual explanations by watching movies and reading books. 2015 IEEE International Conference on Computer Vision (ICCV), pages 19–27, 2015.</li>
<li>Wang et al. [2018] Alex Wang, Amanpreet Singh, Julian Michael, Felix Hill, Omer Levy, and Samuel R. Bowman. Glue: A multi-task benchmark and analysis platform for natural language understanding. In ICLR, 2018.</li>
<li>Peters et al. [2018] Matthew E. Peters, Mark Neumann, Mohit Iyyer, Matt Gardner, Christopher Clark, Kenton Lee, and Luke Zettlemoyer. Deep contextualized word representations. In NAACL, 2018.</li>
<li>Wang et al. [2018] Alex Wang, Ian F. Tenney, Yada Pruksachatkun, Katherin Yu, Jan Hula, Patrick Xia, Raghu Pappagari, Shuning Jin, R. Thomas McCoy, Roma Patel, Yinghui Huang, Jason Phang, Edouard Grave, Najoung Kim, Phu Mon Htut, Thibault F’evry, Berlin Chen, Nikita Nangia, Haokun Liu, Anhad Mohananey, Shikha Bordia, Nicolas Patry, Ellie Pavlick, and Samuel R. Bowman. jiant 1.1: A software toolkit for research on general-purpose text understanding models. http://jiant.info/, 2019.</li>
<li>Maas et al. [2011] Andrew L. Maas, Raymond E. Daly, Peter T. Pham, Dan Huang, Andrew Y. Ng, and Christopher Potts. Learning word vectors for sentiment analysis. In ACL, 2011.</li>
<li>Rajpurkar et al. [2016] Pranav Rajpurkar, Jian Zhang, Konstantin Lopyrev, and Percy Liang. Squad: 100, 000+ questions for machine comprehension of text. In EMNLP, 2016.</li>
<li>Tang et al. [2019] Raphael Tang, Yao Lu, Linqing Liu, Lili Mou, Olga Vechtomova, and Jimmy Lin. Distilling task-specific knowledge from bert into simple neural networks. ArXiv, abs/1903.12136, 2019.</li>
<li>Tang et al. [2019] Debajyoti Chatterjee. Making neural machine reading comprehension faster. ArXiv, abs/1904.00796, 2019.</li>
<li>Turc et al. [2019] Iulia Turc, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. Well-read students learn better: The impact of student initialization on knowledge distillation. ArXiv, abs/1908.08962, 2019.</li>
<li>Yang et al. [2019] Ze Yang, Linjun Shou, Ming Gong, Wutao Lin, and Daxin Jiang. Model compression with multi-task knowledge distillation for web-scale question answering system. ArXiv, abs/1904.09636, 2019.</li>
<li>Tsai et al. [2019] Henry Tsai, Jason Riesa, Melvin Johnson, Naveen Arivazhagan, Xin Li, and Amelia Archer. Small and practical bert models for sequence labeling. In EMNLP-IJCNLP, 2019.</li>
<li>Michel et al. [2019] Paul Michel, Omer Levy, and Graham Neubig. Are sixteen heads really better than one? In NeurIPS, 2019.</li>
<li>Gupta et al. [2015] Suyog Gupta, Ankur Agrawal, Kailash Gopalakrishnan, and Pritish Narayanan. Deep learning with limited numerical precision. In ICML, 2015.</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{5} \mathrm{https}: / /$ github.com/huggingface/swift-coreml-transformers&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>