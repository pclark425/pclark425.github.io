<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extraction extraction-result-4960 - Theorizer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <div class="header">
        <a href="../index.html"><i class="fas fa-flask"></i> Theorizer</a>
    </div>

    <div class="content">
        <h1>Extracted Data Details for extraction-result-4960</h1>

        <div class="section">
            <h2>Extracted Data (Header)</h2>
            <div class="info-section">
                <p><strong>Extraction ID:</strong> extraction-result-4960</p>
                <p><strong>Extraction Schema Used (ID):</strong> <a href="../schemas/extraction-schema-105.html">extraction-schema-105</a></p>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of language models using diverse versus similar reasoning methods to solve reasoning problems, including descriptions of the reasoning methods, tasks, performance, and any comparisons or findings about the effectiveness of diverse versus similar reasoning.</div>
                <p><strong>Paper ID:</strong> paper-b3848d32f7294ec708627897833c4097eb4d8778</p>
                <p><strong>Paper Title:</strong> <a href="https://www.semanticscholar.org/paper/b3848d32f7294ec708627897833c4097eb4d8778" target="_blank">LaMDA: Language Models for Dialog Applications</a></p>
                <p><strong>Paper Venue:</strong> arXiv.org</p>
                <p><strong>Paper TL;DR:</strong> It is demonstrated that fine-tuning with annotated data and enabling the model to consult external knowledge sources can lead to significant improvements towards the two key challenges of safety and factual grounding.</p>
                <p><strong>Paper Abstract:</strong> We present LaMDA: Language Models for Dialog Applications. LaMDA is a family of Transformer-based neural language models specialized for dialog, which have up to 137B parameters and are pre-trained on 1.56T words of public dialog data and web text. While model scaling alone can improve quality, it shows less improvements on safety and factual grounding. We demonstrate that fine-tuning with annotated data and enabling the model to consult external knowledge sources can lead to significant improvements towards the two key challenges of safety and factual grounding. The first challenge, safety, involves ensuring that the model's responses are consistent with a set of human values, such as preventing harmful suggestions and unfair bias. We quantify safety using a metric based on an illustrative set of human values, and we find that filtering candidate responses using a LaMDA classifier fine-tuned with a small amount of crowdworker-annotated data offers a promising approach to improving model safety. The second challenge, factual grounding, involves enabling the model to consult external knowledge sources, such as an information retrieval system, a language translator, and a calculator. We quantify factuality using a groundedness metric, and we find that our approach enables the model to generate responses grounded in known sources, rather than responses that merely sound plausible. Finally, we explore the use of LaMDA in the domains of education and content recommendations, and analyze their helpfulness and role consistency.</p>
                <p><strong>Cost:</strong> 0.014</p>
            </div>
        </div>

        <div class="section">
            <h2>Extracted Data (Details)</h2>
            <div class="extraction-instance-container" id="e4960.0">
                <h3 class="extraction-instance">Extracted Data Instance 0 (e4960.0)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of language models using diverse versus similar reasoning methods to solve reasoning problems, including descriptions of the reasoning methods, tasks, performance, and any comparisons or findings about the effectiveness of diverse versus similar reasoning.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Sample-and-rank</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Sample-and-rank decoding (multi-candidate generation + ranking)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A decoding pipeline that samples multiple independent candidate responses and selects the highest-scoring one by discriminative scoring and length-normalized log-likelihood; used to induce diversity in generation before filtering and reranking.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Towards a human-like open-domain chatbot</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>LaMDA (PT / LaMDA fine-tuned)</td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td>Decoder-only Transformer family (2B, 8B, 137B parameters) pre-trained on 1.56T words of dialog + web text; largest model has 137B non-embedding parameters, 64 layers, d_model=8192, relative attention.</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_name</strong></td>
                            <td>Sample-and-rank multi-candidate generation</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_type</strong></td>
                            <td>diverse</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_description</strong></td>
                            <td>Generate N (paper: 16) independent candidate continuations via stochastic sampling (top-k with k=40), then score candidates with model-based discriminators (SSI and safety) and select the top-ranked response; diversity arises from stochastic sampling of multiple candidates.</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>Open-domain dialog generation (Mini-Turing Benchmark (MTB) and internal dialog datasets)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Generate a next-turn response in multi-turn dialog contexts; evaluated on sensibleness, specificity, interestingness (SSI) and safety/groundedness metrics.</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>When combined with discriminative reranking and safety filtering as in LaMDA, achieved high quality: sensibleness reported for LaMDA ~92.3% (text cites LaMDA sensibleness = 92.3% as a reached value); overall fine-tuned LaMDA groundedness 73.2% and citation accuracy 65% (these are results of the full pipeline including retrieval).</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_with_other_method</strong></td>
                            <td>False</td>
                        </tr>
                        <tr>
                            <td><strong>performance_other_method</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>key_findings</strong></td>
                            <td>Sampling multiple diverse candidates and then filtering/ranking with discriminators produced significant gains in quality and safety relative to pre-training alone; diversity in candidates enables the discriminator/ranker to select higher-quality responses and mitigate unsafe outputs.</td>
                        </tr>
                        <tr>
                            <td><strong>counter_examples_or_negative_results</strong></td>
                            <td>The paper does not report a direct controlled comparison that isolates sampling diversity vs single-deterministic decoding; no reported case where fewer-or-identical-candidate (similar) decoding outperformed the diverse sampling+rank pipeline in the experiments reported.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'LaMDA: Language Models for Dialog Applications', 'publication_date_yy_mm': '2022-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e4960.1">
                <h3 class="extraction-instance">Extracted Data Instance 1 (e4960.1)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of language models using diverse versus similar reasoning methods to solve reasoning problems, including descriptions of the reasoning methods, tasks, performance, and any comparisons or findings about the effectiveness of diverse versus similar reasoning.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Generate-and-discriminate (single-model discriminator)</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Combined generative and discriminative fine-tuning in one model (generate-and-discriminate)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A single decoder-only model is fine-tuned to perform both generation and discrimination (predict attributes like SENSIBLE, INTERESTING, UNSAFE), enabling an efficient generate-then-discriminate pipeline by scoring generated candidates with a continuation token.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>LaMDA (fine-tuned discriminators)</td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td>Same LaMDA family (decoder-only Transformer) fine-tuned on crowdworker labels for sensibleness, specificity, interestingness, and safety; discriminative tokens appended to examples for attribute prediction.</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_name</strong></td>
                            <td>Single-model discriminative reranking / filtering</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_type</strong></td>
                            <td>similar</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_description</strong></td>
                            <td>After generation, the same fine-tuned model is used to predict attribute labels for a candidate by continuing the sequence with '<ATTRIBUTE_NAME> <RATING>' tokens; candidates below safety thresholds are filtered, and remaining candidates are ranked by a weighted sum of predicted attributes (3*sensible + specific + interesting). This enforces selection of a single best candidate rather than ensembling multiple reasoning chains.</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>Safety and quality filtering / ranking for dialog responses</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Detect and remove unsafe responses and re-rank candidate responses for sensibleness, specificity and interestingness using crowdworker-annotated labels.</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>Fine-tuning discriminators and applying generate-and-discriminate produced significant gains in safety and quality compared to pre-trained-only: the LaMDA pipeline (which uses this method) substantially narrows quality gaps and improves safety though exact per-metric pre/post numbers for safety vs. prior are not enumerated in text; sensibleness for fine-tuned LaMDA cited ~92.3%.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_with_other_method</strong></td>
                            <td>False</td>
                        </tr>
                        <tr>
                            <td><strong>performance_other_method</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>key_findings</strong></td>
                            <td>Training a discriminator within the same model and applying it to filter and rank generated candidates is effective at improving safety and quality; this approach leverages discriminative human labels to remove unsafe outputs that scaling alone did not reduce.</td>
                        </tr>
                        <tr>
                            <td><strong>counter_examples_or_negative_results</strong></td>
                            <td>No explicit negative result showing that this single-model discriminative approach is worse than an alternative multi-model ensembling approach; the paper notes that scaling alone (without fine-tuned discriminators) did not improve safety much.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'LaMDA: Language Models for Dialog Applications', 'publication_date_yy_mm': '2022-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e4960.2">
                <h3 class="extraction-instance">Extracted Data Instance 2 (e4960.2)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of language models using diverse versus similar reasoning methods to solve reasoning problems, including descriptions of the reasoning methods, tasks, performance, and any comparisons or findings about the effectiveness of diverse versus similar reasoning.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Toolset Research Loop</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Fine-tuned iterative research loop to call external tools (Toolset: IR, calculator, translator)</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>A fine-tuned multi-task behavior enabling the model to generate explicit tool queries ('TS,...') to an external information retrieval system (and other tools) and incorporate snippets/URLs into grounded responses via an iterative loop.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>here</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>LaMDA (FT groundedness / Research task)</td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td>LaMDA fine-tuned to produce 'TS' queries and to rewrite responses conditioned on retrieval snippets; supports up to a configured maximum of research-query iterations at inference.</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_name</strong></td>
                            <td>Iterative retrieval-assisted reasoning (Research phase)</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_type</strong></td>
                            <td>diverse</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_description</strong></td>
                            <td>The model first generates a base response, then (via a separate fine-tuned 'Research' task within the same model) emits one or more 'TS' queries to the toolset; the toolset returns ranked snippets/URLs; the model may repeat queries (possibly same or different) to collect more evidence, then emits a grounded response incorporating sources. Diversity arises from multiple research queries and multiple retrieved snippets aggregated to form the final answer.</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>Grounded response generation (groundedness evaluation; 784-turn evaluation dataset from Dinan et al.)</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Produce dialog responses that contain factual claims grounded in authoritative external sources; evaluated on groundedness (percentage of claims verifiable), informativeness, and citation accuracy.</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>After groundedness fine-tuning using the toolset, LaMDA achieved 73.2% Groundedness and 65% Citation Accuracy on evaluation; informativeness and other metrics also improved relative to pre-training alone.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_with_other_method</strong></td>
                            <td>False</td>
                        </tr>
                        <tr>
                            <td><strong>performance_other_method</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>key_findings</strong></td>
                            <td>Augmenting the model with the ability to call external tools in an iterative research loop substantially improves groundedness and citation accuracy versus pre-training alone; the paper highlights that giving humans the same tools increases their rate of well-supported claims, and fine-tuning the model to imitate that behavior yields similar benefits.</td>
                        </tr>
                        <tr>
                            <td><strong>counter_examples_or_negative_results</strong></td>
                            <td>No direct comparison in the paper between a single retrieval call (similar reasoning) and multiple iterative queries (diverse reasoning) with controlled ablation; however, the paper notes that repeating the same query can retrieve different-ranked snippets and that the model issues repeated queries as needed, but does not provide a quantitative ablation isolating the benefit of multi-query vs single-query.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'LaMDA: Language Models for Dialog Applications', 'publication_date_yy_mm': '2022-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="extraction-instance-container" id="e4960.3">
                <h3 class="extraction-instance">Extracted Data Instance 3 (e4960.3)</h3>
                <div class="extraction-query"><strong>Extraction Query:</strong> Extract any mentions of language models using diverse versus similar reasoning methods to solve reasoning problems, including descriptions of the reasoning methods, tasks, performance, and any comparisons or findings about the effectiveness of diverse versus similar reasoning.</div>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 30%;">Field</th>
                            <th style="width: 70%;">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>name_short</strong></td>
                            <td>Base vs Research separation</td>
                        </tr>
                        <tr>
                            <td><strong>name_full</strong></td>
                            <td>Separation of 'Base' (response generator) and 'Research' (reasoning/retrieval) phases</td>
                        </tr>
                        <tr>
                            <td><strong>brief_description</strong></td>
                            <td>An architectural/behavioral separation where a base model drafts a response and a research-specialized task issues retrieval queries and rewrites grounded responses; this is analogous to splitting reasoning and response generation.</td>
                        </tr>
                        <tr>
                            <td><strong>citation_title</strong></td>
                            <td>Reason first, then respond: Modular generation for knowledge-infused dialogue</td>
                        </tr>
                        <tr>
                            <td><strong>mention_or_use</strong></td>
                            <td>use</td>
                        </tr>
                        <tr>
                            <td><strong>model_name</strong></td>
                            <td>LaMDA (multi-task within one model: Base and Research tasks)</td>
                        </tr>
                        <tr>
                            <td><strong>model_description</strong></td>
                            <td>A single multi-task LaMDA model fine-tuned to perform distinct tasks: Base (generate draft reply), Research (generate toolset queries and incorporate results), plus discriminative tasks for SSI and safety.</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_name</strong></td>
                            <td>Modular two-phase reasoning (Base then Research)</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_type</strong></td>
                            <td>other</td>
                        </tr>
                        <tr>
                            <td><strong>reasoning_method_description</strong></td>
                            <td>The Base task produces an initial, possibly ungrounded draft; the Research task then assesses claims in the draft, emits 'TS' queries to retrieve evidence, and outputs a revised, grounded reply. This modularization separates initial generation from evidence-seeking reasoning.</td>
                        </tr>
                        <tr>
                            <td><strong>task_name</strong></td>
                            <td>Grounded dialogue generation and hallucination reduction</td>
                        </tr>
                        <tr>
                            <td><strong>task_description</strong></td>
                            <td>Produce dialogue turns where factual claims are checked and grounded via retrieval, reducing hallucinations and improving the trustworthiness of answers.</td>
                        </tr>
                        <tr>
                            <td><strong>performance</strong></td>
                            <td>The combined Base+Research fine-tuned LaMDA (FT groundedness) produced substantial improvements in groundedness (73.2%) and citation accuracy (65%) relative to pre-trained-only models; the paper states groundedness improves from FT quality-safety to FT groundedness but does not provide an isolated numeric for Base-only vs Base+Research.</td>
                        </tr>
                        <tr>
                            <td><strong>comparison_with_other_method</strong></td>
                            <td>False</td>
                        </tr>
                        <tr>
                            <td><strong>performance_other_method</strong></td>
                            <td><span class="empty-note">null</span></td>
                        </tr>
                        <tr>
                            <td><strong>key_findings</strong></td>
                            <td>Splitting generation into a Base draft and a Research phase that issues retrieval queries is effective at producing responses grounded in sources; the paper notes this is analogous to prior findings that separating reasoning and response generation improves accuracy (cites Adolphs et al.).</td>
                        </tr>
                        <tr>
                            <td><strong>counter_examples_or_negative_results</strong></td>
                            <td>No explicit ablation isolating whether the modular split is strictly better than a single-step grounded generator; the paper does not report cases where the Base+Research separation underperforms a single-model single-step grounded approach.</td>
                        </tr>
                        <tr>
                            <td><strong>source_info</strong></td>
                            <td>{'paper_title': 'LaMDA: Language Models for Dialog Applications', 'publication_date_yy_mm': '2022-01'}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <h2>Potentially Relevant New Papers (mentioned by this paper)</h2>
            <ol>
                <li>Towards a human-like open-domain chatbot <em>(Rating: 2)</em></li>
                <li>Reason first, then respond: Modular generation for knowledge-infused dialogue <em>(Rating: 2)</em></li>
                <li>WebGPT: Browser-assisted questionanswering with human feedback <em>(Rating: 2)</em></li>
                <li>Retrieval-augmented generation for knowledge-intensive nlp tasks <em>(Rating: 2)</em></li>
                <li>REALM: Retrieval-augmented language model pre-training <em>(Rating: 1)</em></li>
                <li>Improving language models by retrieving from trillions of tokens <em>(Rating: 1)</em></li>
            </ol>
        </div>

        <div class="section">
            <h2>Extracted Data (Debug)</h2>
            <pre><code>{
    "id": "extraction-result-4960",
    "paper_id": "paper-b3848d32f7294ec708627897833c4097eb4d8778",
    "extraction_schema_id": "extraction-schema-105",
    "extracted_data": [
        {
            "name_short": "Sample-and-rank",
            "name_full": "Sample-and-rank decoding (multi-candidate generation + ranking)",
            "brief_description": "A decoding pipeline that samples multiple independent candidate responses and selects the highest-scoring one by discriminative scoring and length-normalized log-likelihood; used to induce diversity in generation before filtering and reranking.",
            "citation_title": "Towards a human-like open-domain chatbot",
            "mention_or_use": "use",
            "model_name": "LaMDA (PT / LaMDA fine-tuned)",
            "model_description": "Decoder-only Transformer family (2B, 8B, 137B parameters) pre-trained on 1.56T words of dialog + web text; largest model has 137B non-embedding parameters, 64 layers, d_model=8192, relative attention.",
            "reasoning_method_name": "Sample-and-rank multi-candidate generation",
            "reasoning_method_type": "diverse",
            "reasoning_method_description": "Generate N (paper: 16) independent candidate continuations via stochastic sampling (top-k with k=40), then score candidates with model-based discriminators (SSI and safety) and select the top-ranked response; diversity arises from stochastic sampling of multiple candidates.",
            "task_name": "Open-domain dialog generation (Mini-Turing Benchmark (MTB) and internal dialog datasets)",
            "task_description": "Generate a next-turn response in multi-turn dialog contexts; evaluated on sensibleness, specificity, interestingness (SSI) and safety/groundedness metrics.",
            "performance": "When combined with discriminative reranking and safety filtering as in LaMDA, achieved high quality: sensibleness reported for LaMDA ~92.3% (text cites LaMDA sensibleness = 92.3% as a reached value); overall fine-tuned LaMDA groundedness 73.2% and citation accuracy 65% (these are results of the full pipeline including retrieval).",
            "comparison_with_other_method": false,
            "performance_other_method": null,
            "key_findings": "Sampling multiple diverse candidates and then filtering/ranking with discriminators produced significant gains in quality and safety relative to pre-training alone; diversity in candidates enables the discriminator/ranker to select higher-quality responses and mitigate unsafe outputs.",
            "counter_examples_or_negative_results": "The paper does not report a direct controlled comparison that isolates sampling diversity vs single-deterministic decoding; no reported case where fewer-or-identical-candidate (similar) decoding outperformed the diverse sampling+rank pipeline in the experiments reported.",
            "uuid": "e4960.0",
            "source_info": {
                "paper_title": "LaMDA: Language Models for Dialog Applications",
                "publication_date_yy_mm": "2022-01"
            }
        },
        {
            "name_short": "Generate-and-discriminate (single-model discriminator)",
            "name_full": "Combined generative and discriminative fine-tuning in one model (generate-and-discriminate)",
            "brief_description": "A single decoder-only model is fine-tuned to perform both generation and discrimination (predict attributes like SENSIBLE, INTERESTING, UNSAFE), enabling an efficient generate-then-discriminate pipeline by scoring generated candidates with a continuation token.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "LaMDA (fine-tuned discriminators)",
            "model_description": "Same LaMDA family (decoder-only Transformer) fine-tuned on crowdworker labels for sensibleness, specificity, interestingness, and safety; discriminative tokens appended to examples for attribute prediction.",
            "reasoning_method_name": "Single-model discriminative reranking / filtering",
            "reasoning_method_type": "similar",
            "reasoning_method_description": "After generation, the same fine-tuned model is used to predict attribute labels for a candidate by continuing the sequence with '&lt;ATTRIBUTE_NAME&gt; &lt;RATING&gt;' tokens; candidates below safety thresholds are filtered, and remaining candidates are ranked by a weighted sum of predicted attributes (3*sensible + specific + interesting). This enforces selection of a single best candidate rather than ensembling multiple reasoning chains.",
            "task_name": "Safety and quality filtering / ranking for dialog responses",
            "task_description": "Detect and remove unsafe responses and re-rank candidate responses for sensibleness, specificity and interestingness using crowdworker-annotated labels.",
            "performance": "Fine-tuning discriminators and applying generate-and-discriminate produced significant gains in safety and quality compared to pre-trained-only: the LaMDA pipeline (which uses this method) substantially narrows quality gaps and improves safety though exact per-metric pre/post numbers for safety vs. prior are not enumerated in text; sensibleness for fine-tuned LaMDA cited ~92.3%.",
            "comparison_with_other_method": false,
            "performance_other_method": null,
            "key_findings": "Training a discriminator within the same model and applying it to filter and rank generated candidates is effective at improving safety and quality; this approach leverages discriminative human labels to remove unsafe outputs that scaling alone did not reduce.",
            "counter_examples_or_negative_results": "No explicit negative result showing that this single-model discriminative approach is worse than an alternative multi-model ensembling approach; the paper notes that scaling alone (without fine-tuned discriminators) did not improve safety much.",
            "uuid": "e4960.1",
            "source_info": {
                "paper_title": "LaMDA: Language Models for Dialog Applications",
                "publication_date_yy_mm": "2022-01"
            }
        },
        {
            "name_short": "Toolset Research Loop",
            "name_full": "Fine-tuned iterative research loop to call external tools (Toolset: IR, calculator, translator)",
            "brief_description": "A fine-tuned multi-task behavior enabling the model to generate explicit tool queries ('TS,...') to an external information retrieval system (and other tools) and incorporate snippets/URLs into grounded responses via an iterative loop.",
            "citation_title": "here",
            "mention_or_use": "use",
            "model_name": "LaMDA (FT groundedness / Research task)",
            "model_description": "LaMDA fine-tuned to produce 'TS' queries and to rewrite responses conditioned on retrieval snippets; supports up to a configured maximum of research-query iterations at inference.",
            "reasoning_method_name": "Iterative retrieval-assisted reasoning (Research phase)",
            "reasoning_method_type": "diverse",
            "reasoning_method_description": "The model first generates a base response, then (via a separate fine-tuned 'Research' task within the same model) emits one or more 'TS' queries to the toolset; the toolset returns ranked snippets/URLs; the model may repeat queries (possibly same or different) to collect more evidence, then emits a grounded response incorporating sources. Diversity arises from multiple research queries and multiple retrieved snippets aggregated to form the final answer.",
            "task_name": "Grounded response generation (groundedness evaluation; 784-turn evaluation dataset from Dinan et al.)",
            "task_description": "Produce dialog responses that contain factual claims grounded in authoritative external sources; evaluated on groundedness (percentage of claims verifiable), informativeness, and citation accuracy.",
            "performance": "After groundedness fine-tuning using the toolset, LaMDA achieved 73.2% Groundedness and 65% Citation Accuracy on evaluation; informativeness and other metrics also improved relative to pre-training alone.",
            "comparison_with_other_method": false,
            "performance_other_method": null,
            "key_findings": "Augmenting the model with the ability to call external tools in an iterative research loop substantially improves groundedness and citation accuracy versus pre-training alone; the paper highlights that giving humans the same tools increases their rate of well-supported claims, and fine-tuning the model to imitate that behavior yields similar benefits.",
            "counter_examples_or_negative_results": "No direct comparison in the paper between a single retrieval call (similar reasoning) and multiple iterative queries (diverse reasoning) with controlled ablation; however, the paper notes that repeating the same query can retrieve different-ranked snippets and that the model issues repeated queries as needed, but does not provide a quantitative ablation isolating the benefit of multi-query vs single-query.",
            "uuid": "e4960.2",
            "source_info": {
                "paper_title": "LaMDA: Language Models for Dialog Applications",
                "publication_date_yy_mm": "2022-01"
            }
        },
        {
            "name_short": "Base vs Research separation",
            "name_full": "Separation of 'Base' (response generator) and 'Research' (reasoning/retrieval) phases",
            "brief_description": "An architectural/behavioral separation where a base model drafts a response and a research-specialized task issues retrieval queries and rewrites grounded responses; this is analogous to splitting reasoning and response generation.",
            "citation_title": "Reason first, then respond: Modular generation for knowledge-infused dialogue",
            "mention_or_use": "use",
            "model_name": "LaMDA (multi-task within one model: Base and Research tasks)",
            "model_description": "A single multi-task LaMDA model fine-tuned to perform distinct tasks: Base (generate draft reply), Research (generate toolset queries and incorporate results), plus discriminative tasks for SSI and safety.",
            "reasoning_method_name": "Modular two-phase reasoning (Base then Research)",
            "reasoning_method_type": "other",
            "reasoning_method_description": "The Base task produces an initial, possibly ungrounded draft; the Research task then assesses claims in the draft, emits 'TS' queries to retrieve evidence, and outputs a revised, grounded reply. This modularization separates initial generation from evidence-seeking reasoning.",
            "task_name": "Grounded dialogue generation and hallucination reduction",
            "task_description": "Produce dialogue turns where factual claims are checked and grounded via retrieval, reducing hallucinations and improving the trustworthiness of answers.",
            "performance": "The combined Base+Research fine-tuned LaMDA (FT groundedness) produced substantial improvements in groundedness (73.2%) and citation accuracy (65%) relative to pre-trained-only models; the paper states groundedness improves from FT quality-safety to FT groundedness but does not provide an isolated numeric for Base-only vs Base+Research.",
            "comparison_with_other_method": false,
            "performance_other_method": null,
            "key_findings": "Splitting generation into a Base draft and a Research phase that issues retrieval queries is effective at producing responses grounded in sources; the paper notes this is analogous to prior findings that separating reasoning and response generation improves accuracy (cites Adolphs et al.).",
            "counter_examples_or_negative_results": "No explicit ablation isolating whether the modular split is strictly better than a single-step grounded generator; the paper does not report cases where the Base+Research separation underperforms a single-model single-step grounded approach.",
            "uuid": "e4960.3",
            "source_info": {
                "paper_title": "LaMDA: Language Models for Dialog Applications",
                "publication_date_yy_mm": "2022-01"
            }
        }
    ],
    "potentially_relevant_new_papers": [
        {
            "paper_title": "Towards a human-like open-domain chatbot",
            "rating": 2
        },
        {
            "paper_title": "Reason first, then respond: Modular generation for knowledge-infused dialogue",
            "rating": 2
        },
        {
            "paper_title": "WebGPT: Browser-assisted questionanswering with human feedback",
            "rating": 2
        },
        {
            "paper_title": "Retrieval-augmented generation for knowledge-intensive nlp tasks",
            "rating": 2
        },
        {
            "paper_title": "REALM: Retrieval-augmented language model pre-training",
            "rating": 1
        },
        {
            "paper_title": "Improving language models by retrieving from trillions of tokens",
            "rating": 1
        }
    ],
    "cost": 0.013779249999999998,
    "model_str": "gpt-5-mini"
}</code></pre>
        </div>
        <div class="section">
            <h2>Paper</h2>
            <div class="paper-content"><h1>LaMDA: Language Models for Dialog Applications</h1>
<p><img alt="img-0.jpeg" src="img-0.jpeg" /></p>
<h2>Abstract</h2>
<p>We present LaMDA: Language Models for Dialog Applications. LaMDA is a family of Transformerbased neural language models specialized for dialog, which have up to 137B parameters and are pre-trained on 1.56 T words of public dialog data and web text. While model scaling alone can improve quality, it shows less improvements on safety and factual grounding. We demonstrate that fine-tuning with annotated data and enabling the model to consult external knowledge sources can lead to significant improvements towards the two key challenges of safety and factual grounding. The first challenge, safety, involves ensuring that the model's responses are consistent with a set of human values, such as preventing harmful suggestions and unfair bias. We quantify safety using a metric based on an illustrative set of human values, and we find that filtering candidate responses using a LaMDA classifier fine-tuned with a small amount of crowdworker-annotated data offers a promising approach to improving model safety. The second challenge, factual grounding, involves enabling the model to consult external knowledge sources, such as an information retrieval system, a language translator, and a calculator. We quantify factuality using a groundedness metric, and we find that our approach enables the model to generate responses grounded in known sources, rather than responses that merely sound plausible. Finally, we explore the use of LaMDA in the domains of education and content recommendations, and analyze their helpfulness and role consistency.</p>
<p><sup id="fnref:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p><img alt="img-1.jpeg" src="img-1.jpeg" /></p>
<p>Figure 1: Impact of model pre-training alone vs. with fine-tuning in LaMDA on dialog quality (left), and safety and factual grounding (right). The quality metric (SSI) corresponds to sensibleness, specificity, and interestingness. See Section 4 for more details on these metrics.</p>
<h1>1 Introduction</h1>
<p>Language model pre-training is an increasingly promising research approach in NLP [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]. As pre-training uses unlabeled text, it can be combined with scaling model and dataset sizes to achieve better performance or new capabilities [13]. For example, GPT-3 [12], a 175B parameter model trained on a large corpus of unlabeled text, shows an impressive ability in few-shot learning thanks to scaling.</p>
<p>Dialog models [14, 15, 16], one of the most interesting applications of large language models, successfully take advantage of Transformers' ability to represent long-term dependencies in text [17, 18]. Similar to general language models [13], Adiwardana et al. [17] show that dialog models are also well suited to model scaling. There is a strong correlation between model size and dialog quality.</p>
<p>Inspired by these successes, we train LaMDA, a family of Transformer-based neural language models designed for dialog. These models' sizes range from 2B to 137B parameters, and they are pre-trained on a dataset of 1.56T words from public dialog data and other public web documents (Section 3). LaMDA makes use of a single model to perform multiple tasks: it generates potential responses, which are then filtered for safety, grounded on an external knowledge source, and re-ranked to find the highest-quality response.</p>
<p>We study the benefits of model scaling with LaMDA on our three key metrics: quality, safety, and groundedness (Section 4). We observe that: (a) model scaling alone improves quality, but its improvements on safety and groundedness are far behind human performance, and (b) combining scaling and fine-tuning improves LaMDA significantly on all metrics, and although the model's performance remains below human levels in safety and groundedness, the quality gap to measured crowdworker levels can be narrowed (labeled 'Human' in Figure 1).</p>
<p>The first metric, quality, is based on three components: sensibleness, specificity, and interestingness (Section 4). We collect annotated data that describes how sensible, specific, and interesting a response is for a multiturn context. We then use these annotations to fine-tune a discriminator to re-rank candidate responses.</p>
<p>The second metric, safety, is introduced to reduce the number of unsafe responses that the model generates. To achieve this, we define an illustrative set of safety objectives that attempt to capture the behavior that the model should exhibit in a dialog (Appendix A.1), and we use a demographically diverse set of crowdworkers to label responses in multiturn dialogs for these objectives (Appendix A.2, A.3). We then use these labels to fine-tune a discriminator to detect and remove unsafe responses (Section 6.1). Our work on safety for LaMDA can be understood as a process for AI value alignment, at a high level.</p>
<p>The third metric, groundedness, is introduced for the model to produce responses that are grounded in known sources wherever they contain verifiable external world information. Due to neural language models such as LaMDA's capacity to generalize rather than just memorize, they tend to generate responses that may seem plausible, but actually contradict factual statements made in established sources. We use this metric for the model to avoid this tendency. While grounding in known sources does not guarantee factual accuracy, it allows users or external systems to judge the validity of a response based on the reliability of its source and its faithful reproduction. We find that augmenting model outputs with the ability to use external tools, such as an information retrieval system, is a promising approach to achieve this goal. Therefore, we collect data from a setting where crowdworkers can use external tools to research factual claims, and train the model to mimic their behavior.</p>
<p>Finally, we explore the use of LaMDA in the domains of education and content recommendations to investigate its potential and shortcomings. Similar to the concept of prompts in GPT-3 [12], we precondition LaMDA on a few turns of application-specific dialog to adapt LaMDA to the target applications. We perform experiments to compare the application-specific helpfulness (i.e., useful and correct responses) and role consistency (i.e., agent utterances match agent role) of pre-training-only and fine-tuned LaMDA models subject to application-specific preconditioning. We find</p>
<p>that both types of models can adapt to their expected application roles fairly well, but fine-tuned LaMDA models are significantly more helpful.</p>
<h1>2 Related work</h1>
<p>Language models and dialog models: Language models have attracted much attention recently thanks to their successes in NLP applications (e.g., [19, 20, 21, 2, 1, 22, 23, 5, 12, 24]). Our study of scaling laws with respect to model sizes is inspired by recent work on the scaling laws of neural language models [12, 13]. Similar to their findings, our results show that model scaling improves our quality (sensibleness, specificity, and interestingness), safety and groundedness metrics to some extent. However, fine-tuning combined with scaling significantly improves performance on all metrics.
Our work is also closely related to recent successes in applying language models to dialog modeling (e.g., [25, 26, $17,18]$ ), which built on earlier research in neural dialog modeling (e.g., [14, 15, 16, 27, 28]). One of our fine-tuning stages requires training on dialog-only data, which is related to Wolf et al. [29], Dinan et al. [25] and Zhang et al. [30]. Our use of fine-tuning on crowdworker-annotated data to improve interestingness is comparable to Roller et al. [18]. However, we aim to maximize the interestingness of the model's output distinctly from its ability to engage the user in further interaction.
Our finding that pure scaling has a limited effect on key measures of open-domain dialog model performance echoes that of Shuster et al. [31], who also focus on the problem of groundedness. Recent studies on scaling have found that performance on question-answering tasks improves with model size [32, 33], similar to our findings on pre-trained LaMDA prior to fine-tuning.
Our approach to improving model groundedness is broadly consistent with a growing literature on augmenting neural language models with retrieval systems. Most of the existing literature focuses on the problem of open-domain question-answering rather than dialog generation, and the models themselves are used to index and rank knowledge sources, rather than trained to use an intermediate tool. Given these differences, we note that the range of existing approaches to this problem include the RNNLM [34], RAG [35], REALM [36], and FiD [37] architectures. Zhu et al. [38] provide a survey of further recent work. See Karpukhin et al. [39] for details on the 'dense passage retriever' used in RAG. Recent work in this direction has expanded and elaborated on neural models' ability to retrieve and rank passages [40]. The RETRO architecture demonstrates that language models can be primed with results retrieved from a database as large as two trillion tokens [41]. At a broad level, our approach is also comparable to that of Byrne et al. [42], which fine-tunes the model to use external APIs for movie ticketing dialog.
Parts of our findings are similar to recent studies on dialog groundedness. Granting access to external knowledge bases has been shown to reduce the rate at which models hallucinate unsourced statements in dialog across a variety of retrieval systems and model architectures [31]. Another study finds that a question-answering system's accuracy is improved by separating it into a reasoning unit and a response generator, analogous to our separation of 'Base' and 'Research' models in our study [43]. Meanwhile, the WebGPT framework includes a language system that can interact with the open web via a text-only interface, and learns to imitate humans in answering questions by citing external sources [44]. Komeili et al. [45] compare different types of pre-trained models and retrieval methods, and reach a similar conclusion that augmenting language models with a search engine provides more factually grounded responses. They encode the input context with grounded information from search to generate the next response, while we augment the generated responses with information from known sources in our method. This allows us to fine-tune the model for groundedness without sacrificing gains in safety or quality from other fine-tuning treatments.</p>
<p>Dialog metrics: Defining effective metrics for dialog models remains an open research topic. Our approach is inspired by Adiwardana et al. [17], who argued for human-like metrics, such as sensibleness and specificity. Many automated metrics for dialog models have been studied, including perplexity [16, 17], F1, Hits@1/N [25], USR [46], or BLEU/ROUGE [47, 15, 27]. However, such automated metrics may not correlate well with human judgment [48]. More reliable metrics for dialog modeling require human evaluation [49, 50, 18, 25, 17, 51], as used in this paper.
Earlier research attempted to combine multifaceted evaluations of dialog quality into a single headline metric [52]. We follow the pattern established in Adiwardana et al. [17] and Roller et al. [18] by considering the different components of our evaluations separately. In addition to sensibleness and specificity per Adiwardana et al. [17], we add new metrics: interestingness, safety, and groundedness. An advantage of using several different metrics is their debuggability: by exploring responses with low safety or groundedness scores, we have been able to develop targeted methods to improve them.</p>
<p>Safety and safety of dialog models: Inappropriate and unsafe risks and behaviors of language models have been extensively discussed and studied in previous works (e.g., [53, 54]). Issues encountered include toxicity (e.g., [55, 56, 57]), bias (e.g., [58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72]), and inappropriately revealing personally identifying information (PII) from training data [73]. Weidinger et al. [54] identify 21 risks associated with large-scale</p>
<p>language models and discuss the points of origin for these risks. While many mitigation strategies have also been suggested (e.g., [74, 75, 76, 77, 78, 79, 80, 81, 82]), meaningfully addressing these issues remains an active research area.</p>
<p>Similar issues have also been discussed specifically for dialog models [53]. For instance, examples of bias, offensiveness, and hate speech have been found both in training data drawn from social media, and consequently in the output of dialog models trained on such data [83]. Dialog models [84] can learn, and even amplify, biases in the training data. Echoing Gehman et al. [85], we find fine-tuning effective to augment language models for safety. The method we use in this paper follows previous attempts to tackle these issues by training separate layers to detect unsafe output [17, 86, 18, 79]. Our strategy is similar to recent work that also uses fine-tuning [87]. While their safety guidelines were derived from human rights principles, they similarly find that increasing scale has no impact on toxicity metrics, while fine-tuning on safety evaluations does.</p>
<p>Groundedness metrics: Similar to other recent research into groundedness cited above, we assess groundedness by asking crowdworkers to judge whether the models output is in accordance with authoritative external sources. The recently-proposed Attributable to Identified Sources (AIS) framework [88] articulates a more precise approach to assess output of language models that pertains to the external world. It splits evaluation into two stages, where crowdworkers are asked: (1) if they can understand and identify the information shared in a dialog turn, and (2) if all of this information can be attributed to a source. Meanwhile, a recent study has reopened the question of automatic evaluation, with the $Q^{2}$ metric showing performance comparable to human annotation [89].</p>
<h1>3 LaMDA pre-training</h1>
<p>LaMDA was pre-trained to predict the next token in a text corpus. Unlike previous dialog models trained on dialog data alone [17, 18], we pre-trained LaMDA on a dataset created from public dialog data and other public web documents. Therefore, LaMDA can be used as a general language model prior to fine-tuning.
The pre-training dataset consists of 2.97B documents, 1.12B dialogs, and 13.39B dialog utterances, for a total of 1.56T words (Appendix E). Over 90\% of the pre-training dataset is in the English language. We used the SentencePiece library [90] to tokenize the dataset into 2.81T byte pair encoding (BPE) tokens [91], with a vocabulary of 32K tokens. For comparison, the total number of words in the training set for Meena [17] was 40B words, which is nearly 40x smaller.
The largest LaMDA model has 137B non-embedding parameters, which is $\sim$ 50x more parameters than Meena [17]. We use a decoder-only Transformer [92] language model as the model architecture for LaMDA. The Transformer has 64 layers, $d_{\text {model }}=8192, d_{f f}=65536, h=128, d_{k}=d_{v}=128$, relative attention as described in T5 [11], and gated-GELU activation as described in Raffel et al. [93].
We pre-trained LaMDA on 1024 TPU-v3 chips for a total of about 57.7 days, and 256K tokens per batch. We used the Lingvo framework [94] for training and achieved 123 TFLOPS/sec with 56.5\% FLOPS utilization with the 2D sharding algorithm, as described in GSPMD [95] (see Section 10 for carbon footprint estimates). We also trained smaller 2B-parameter and 8B-parameter models to measure the effects of model scaling on our metrics. Hyperparameter details for the models of different sizes can be found in Table 27, Appendix D.
Figure 2 gives an overview of the pre-training stage. We call the model before any fine-tuning "PT", for PreTrained.
<img alt="img-2.jpeg" src="img-2.jpeg" /></p>
<p>Figure 2: LaMDA pre-training as a language model.</p>
<p>PT uses the same sample-and-rank strategy as Meena [17] for decoding. We first sample 16 independent candidate responses using top- $k(k=40)$ sampling (no temperature). The final output is the highest-scoring candidate, where the score is based on the candidate's log-likelihood and its length.</p>
<h1>4 Metrics</h1>
<p>Evaluating generative models in general, and open-ended dialog models in particular, is difficult. See the Related Work section for a general review of recent work in this area. In this section, we describe the metrics that we use for evaluation.</p>
<h3>4.1 Foundation metrics: Quality, Safety and Groundedness</h3>
<p>Sensibleness, Specificity, Interestingness (SSI): Our overall quality score is an average of sensibleness, specificity, and interestingness (SSI).
Adiwardana et al. [17] propose the sensibleness and specificity average (SSA) metric to measure the quality of Meena. This metric is a simple average of two scores: sensibleness and specificity.
The first score, sensibleness, measures whether a model's responses make sense in context and do not contradict anything that was said earlier. Humans tend to take this basic aspect of communication for granted, but generative models often struggle to meet this requirement. However, if sensibleness alone is used to evaluate models, we could inadvertently reward models for playing it safe by always producing short, generic, and boring responses. The GenericBot algorithm [17], which answers every question with "I don't know" and every statement with "Ok," scores $70 \%$ on sensibleness, which even surpasses some large dialog models [17].
The second score, specificity, is used to measure whether a response is specific to a given context. For example, if a user says "I love Eurovision" and the model responds "Me too," then it would score 0 on specificity, since this response could be used in many different contexts. If it answers "Me too. I love Eurovision songs," then it would score 1. Adiwardana et al. [17] report that Meena narrows the gap to average human performance in the SSA metric.
As the model's performance increases, however, we find that sensibleness and specificity are not sufficient to measure the quality of a dialog model. For example, a response to "How do I throw a ball?" could be "You can throw a ball by first picking it up and then throwing it", which makes sense and is specific to the question. An alternative deeper and more satisfying answer could be "One way to toss a ball is to hold it firmly in both hands and then swing your arm down and up again, extending your elbow and then releasing the ball upwards."
We attempt to translate this intuition into the third score, an observable quality which we call "Interestingness". Similar to sensibleness and specificity, interestingness is measured as a $0 / 1$ label by crowdworkers. We ask crowdworkers to label a response as interesting if they judge that it is likely to "catch someone's attention" or "arouse their curiosity", or if it is unexpected, witty, or insightful. (For the complete instructions given to crowdworkers, see Appendix B).</p>
<p>Safety: A dialog model can achieve high quality (SSI) scores but can be unsafe for users. Therefore, we devise a new safety metric to measure unsafe model output. This metric follows objectives derived from Google's AI Principles, ${ }^{2}$ to avoid unintended results that create risks of harm, and to avoid creating or reinforcing unfair bias. These safety objectives are described in detail in Appendix A.1.</p>
<p>Groundedness: We aim to ensure that LaMDA produces responses that can be associated with known sources whenever possible, enabling cross-checking if desired, because the current generation of language models tends to produce plausible but incorrect statements.
We define groundedness as the percentage of responses containing claims about the external world that can be supported by authoritative external sources, as a share of all those containing claims about the external world.
We also define 'Informativeness' as the percentage of responses that carry information about the external world that can be supported by known sources as a share of all responses. Informativeness only differs from groundedness in the denominator term. So responses like "That's a great idea" that do not carry any external world information do not affect groundedness, but they do affect Informativeness. However, "Rafael Nadal is the winner of Roland Garros 2020" is an example of a grounded response.
Finally, we define 'Citation accuracy' as the percentage of model responses that cite the URLs of their sources as a share of all responses with explicit claims about the external world, excluding claims with well-known facts (such as "horses have four legs").</p>
<p><sup id="fnref2:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<h1>4.2 Role-specific metrics: Helpfulness and Role consistency</h1>
<p>The foundation metrics (quality, safety, and groundedness) measure attributes that we find important for dialog agents in general. However, they are not dependent on any application-specific role that an agent may be designed for (e.g., teaching information about animals). We measure Helpfulness and Role consistency in dialog applications, where agents have specific roles.</p>
<p>Helpfulness: The model's responses are marked helpful if they contain correct information based on the user's independent research with an information retrieval system, and the user considers them helpful. Helpful responses are a subset of informative ones, which are judged by the user to be both correct and useful.</p>
<p>Role consistency: The model's responses are marked role consistent if they look like something an agent performing the target role would say. This is distinct from consistency with previous responses that the agent made in the dialog, and self-consistency within a dialog is measured by the sensibleness metric instead. Role consistency refers to consistency with the definition of the agent's role external to the conversation.
These role-specific metrics are discussed further in Section 8.</p>
<h2>5 LaMDA fine-tuning and evaluation data</h2>
<p>Quality (Sensibleness, Specificity, Interestingness): To improve quality (SSI), we collect 6400 dialogs with 121 K turns by asking crowdworkers to interact with a LaMDA instance about any topic. These dialogs are required to last 14 to 30 turns. For each response, we ask other crowdworkers to rate whether the response given the context is sensible, specific, and/or interesting, and to and mark each with 'yes', 'no', or 'maybe' labels. If a response is not sensible (the crowdworker did not mark it with 'yes'), then we do not collect the labels for specificity and interestingness, and consider them to be 'no'. Furthermore, if a response is not specific (the crowdworker did not mark it with 'yes'), then we do not collect the label for interestingness, and consider it to be 'no'. This ensures that responses are not rated positively for specificity if they are not sensible, and similarly, that responses are not rated positively for interestingness if they are not specific. Every response is labeled by 5 different crowdworkers and the response is considered sensible, specific or interesting if at least 3 out of 5 crowdworkers mark it 'yes'.
We evaluate the models based on the model's generated responses to the Mini-Turing Benchmark (MTB) dataset[17], which consists of 1477 dialogs with up to 3 dialog turns. The MTB includes 315 single-turn dialogs, 500 2-turn dialogs, and 662 3-turn dialogs. These dialogs are fed to the model to generate the next response. Similar to above, every response is labeled sensible, specific or interesting if at least 3 out of 5 crowdworkers mark it 'yes'.</p>
<p>Safety: For safety fine-tuning, we employ a structured approach that begins with defining the safety objectives (Appendix A.1). These objectives are used to annotate candidate responses generated by a LaMDA instance in response to human-generated prompts (Appendix A.2), using a demographically diverse set of crowdworkers (Appendix A.3).
Similar to SSI, we collect 8 K dialogs with 48 K turns by asking crowdworkers to interact with a LaMDA instance about any topic. These dialogs are required to last 5 to 10 turns. We instruct crowdworkers to interact with the model in three different ways: (a) interactions of natural form, (b) interactions that touch sensitive topics, and (c) interactions that adversarially attempt to break the model as per the safety objectives. For each response, we ask other crowdworkers to rate whether the response given the context violates any of the safety objectives, and to mark them with 'yes', 'no', or 'maybe' labels. Every response is assigned a safety score of 1 if at least 2 out of 3 crowdworkers mark the response with 'no' for each individual safety objective. Otherwise, it is assigned a score of 0 .
We evaluate safety using an evaluation dataset that is a holdout sample of the adversarially collected dataset described above. This dataset consists of 1166 dialogs with 1458 turns. These dialogs are input to the model to generate the next response. Similar to above, every response is scored 1 if at least 2 out of 3 crowdworkers mark each safety objective 'no' and 0 otherwise.</p>
<p>Groundedness: Similar to SSI and safety, we collect 4 K dialogs with 40 K turns by asking crowdworkers to interact with the model. This time, we request that they try to steer the conversation towards information-seeking interactions.
We ask crowdworkers to rate each of the model's dialog turns, evaluating whether the information in the turn makes any claims about the external world. We exclude claims about publicly unrecognized people, as the model can make factual claims on behalf of an improvised persona. Such claims do not require grounding on external sources (e.g., "I baked three cakes last week"), unlike claims about historical people (e.g., "Julius Caesar was born in 100 B").
We also ask crowdworkers whether they know the claims to be true. If 3 different crowdworkers all know a claim to be true, then we assume it to be common knowledge and do not check external knowledge sources before making this claim.</p>
<p>For utterances containing claims that need to be checked, we ask crowdworkers to record the search queries that they would use to investigate them. Finally, we ask crowdworkers to edit the model's response to incorporate brief search results from an external knowledge-retrieval system. If the search results include any content from the open web, we ask crowdworkers to include URLs that appropriately cite the sources of the knowledge used in the final response.</p>
<p>We evaluate groundedness using an evaluation dataset with 784 turns of dialogs from Dinan et al. [96] that encompass a variety of topics. These contexts are fed to the model to generate the next response. For each response, we ask crowdworkers to rate whether the model's response contains any factual claims, and if so, to rate whether these factual claims can be verified by checking a known source. Every response is labeled by 3 different crowdworkers. The final groundedness, informativeness, and citation accuracy labels of a given response are determined by majority voting. All of the fine-tuning and evaluation datasets are in English.</p>
<p>Estimating these metrics for human-generated responses: We ask crowdworkers to respond to randomly selected samples of the evaluation datasets (labeled as 'Human' in 1, 4 and 5). The crowdworkers are explicitly informed to reply in a safe, sensible, specific, interesting, grounded, and informative manner. They are also explicitly asked to use any external tools necessary to generate these responses (e.g., including an information retrieval system). The context-response pairs are then sent for evaluation, and a consensus label is formed by majority voting, just as for model generated responses.</p>
<h1>6 LaMDA fine-tuning</h1>
<h3>6.1 Discriminative and generative fine-tuning for Quality (SSI) and Safety</h3>
<p>We create LaMDA using several fine-tunings applied to the pre-trained model (PT). These include a mix of generative tasks that generate response given contexts, and discriminative tasks that evaluate quality and safety of a response in context. This results in a single model that can function as both a generator and a discriminator.</p>
<p>Since LaMDA is a decoder-only generative language model, all fine-tuning examples are expressed as sequences of tokens. Generative fine-tuning examples are expressed as "<context> <sentinel> <response>", with losses applied only for the response portion:</p>
<ul>
<li>"What's up? RESPONSE not much."</li>
</ul>
<p>Discriminative fine-tuning examples are expressed as "<context> <sentinel> <response> <attribute-name> <rating>", with losses applied for the rating following the attribute name only:</p>
<ul>
<li>"What's up? RESPONSE not much. SENSIBLE 1"</li>
<li>"What's up? RESPONSE not much. INTERESTING 0"</li>
<li>"What's up? RESPONSE not much. UNSAFE 0"</li>
</ul>
<p>Using one model for both generation and discrimination enables an efficient combined generate-and-discriminate procedure. After generating a response given a context, evaluating a discriminator involves computing $\mathrm{P}\left({ }^{\prime \prime}&lt;\right.$ desiredrating&gt;" 1 "<context> <sentinel> <response> <attribute-name>"). Since the model has already processed "<context> <sentinel> <response>", evaluating the discriminator simply involves processing a few additional tokens: "<attributename> <desired rating>".</p>
<p>First, we fine-tune LaMDA to predict the SSI and safety ratings of the generated candidate responses. Then, we filter out candidate responses for which the model's safety prediction falls below a threshold during generation. Candidate responses that remain after filtering for safety are then ranked for quality. During ranking, sensibleness is given a weight three times higher than specificity and interestingness, as this was found to work well for all metrics (i.e., $3 *$ $P($ sensible $)+P($ specific $)+P($ interesting $)$ ). The top ranked candidate is selected as the next response.
LaMDA SSI and safety discriminators are also used to score and filter 2.5 M turns of dialog data sampled from the pre-training dataset (Section 3), resulting in 800 K turns of safe, sensible, specific and interesting dialogs. We then fine-tune the LaMDA model over this dataset to generate the response in a given context.</p>
<p>We see significant gains in safety and quality for LaMDA using this technique (Figure 5).</p>
<h3>6.2 Fine-tuning to learn to call an external information retrieval system</h3>
<p>Language models such as LaMDA tend to generate outputs that seem plausible, but contradict facts established by known external sources. For example, given a prompt such as the opening sentences of a news article, a large language model will continue them with confident statements in a brisk journalistic style. However, such content is merely imitating what one might expect to find in a news article without any connection to trustworthy external references.</p>
<p>One possible solution to this problem could be to increase the size of the model, based on the assumption that the model can effectively memorize more of the training data. However, some facts change over time, like the answers to 'How old is Rafael Nadal?' or 'What time is it in California?'. Lazaridou et al. (2021) call this the temporal generalization problem [97]. Recent work proposed using a dynamic or incremental training architecture to mitigate this issue (e.g., [97, 98]). It may be difficult to obtain sufficient training data and model capacity to achieve this, as a user may be interested in conversing about anything within the corpus of human knowledge.
We present our approach to fine-tuning by learning to consult a set of external knowledge resources and tools.</p>
<p>The toolset (TS): We create a toolset (TS) that includes an information retrieval system, a calculator, and a translator. TS takes a single string as input and outputs a list of one or more strings. Each tool in TS expects a string and returns a list of strings. For example, the calculator takes " $135+7721$ ", and outputs a list containing ["7856"]. Similarly, the translator can take "hello in French" and output ["Bonjour"]. Finally, the information retrieval system can take "How old is Rafael Nadal?", and output ["Rafael Nadal / Age / 35"]. The information retrieval system is also capable of returning snippets of content from the open web, with their corresponding URLs. The TS tries an input string on all of its tools, and produces a final output list of strings by concatenating the output lists from every tool in the following order: calculator, translator, and information retrieval system. A tool will return an empty list of results if it can't parse the input (e.g., the calculator cannot parse "How old is Rafael Nadal?"), and therefore does not contribute to the final output list.</p>
<p>Dialog collection: We collect 40K annotated dialog turns annotated (generative data). We also collect 9 K dialog turns, in which the LaMDA's generated candidates are labeled 'correct' or 'incorrect', to be used as input data for the ranking task (discriminative data).
We collect a set of human-human dialogs between crowdworkers, focused on information-seeking interactions, and evaluate whether their statements can be supported by known authoritative sources. As seen in Figure 4, it is notable that they make well-supported claims at a higher rate if they have access to TS. When asked for Rafael Nadal's age, a human expert may not know the answer immediately, but can easily query an information retrieval system to obtain it. Therefore, we decided to fine-tune our language model to provide attributions for its responses by looking up its claims using a toolset.
To collect training data for the fine-tuning used in the algorithm, we use both static and interactive methods again. The key difference from the other sub-tasks is that the crowdworkers are not reacting to the model's output, but rather intervening to correct it in a way that LaMDA can learn to imitate. In the interactive case, a crowdworker carries out a dialog with LaMDA, whereas in the static case, they read over records of earlier dialogs, turn by turn. The crowdworker decides whether each statement contains any claims that might require reference to an external knowledge source. If so, they are asked whether the claims are about anything other than the persona improvised by LaMDA, and then whether they go beyond simple matters of common sense. If the answer to any of these questions is 'no', the model's output is marked 'good', and the dialog moves on. Otherwise, the crowdworker is asked to research the claims using the toolset, via a text-in and text-out interface.
The interface to the set of tools used here is identical to the service used by the algorithm at inference time. Given a general text query, the information retrieval system returns a set of brief, text-only snippets in rank order. Snippets of open-web content include URLs for their source, answers provided directly by the information retrieval system, (e.g., the current time) or by the calculator tool do not. When the user has finished running queries, they have the opportunity to rewrite the model's statement to include well-sourced claims. If they used open-web content, we ask them to cite the URLs needed to support any responses which contain information pertaining to the external world. URLs can be appended to the end of the message, or if the context warrants it, they can be attached inline to particular words in the response using Markdown format.</p>
<p>Fine-tuning: We then fine-tune LaMDA to perform two tasks.
The first task takes the multiturn dialog context to date and the response generated by the base model. It then generates a special string ("TS" for toolset) indicating the following text is a query (e.g., "How old is Rafael Nadal?") that should be sent to the toolset: context + base $\rightarrow$ "TS, Rafael Nadals age".
The second task takes the snippet returned by a tool, and a dialog statement (e.g., "He is 31 years old right now" + "Rafael Nadal / Age / 35"). It then predicts the grounded version: context + base + query + snippet $\rightarrow$ "User, He is 35 years old right now". Alternatively, this task can also output an additional research query. For example, context + base + query + snippet $\rightarrow$ "TS, Rafael Nadals favorite song". At inference time, the model's output is directed to the information retrieval system or to the user, depending on whether the first generated string is 'TS' or 'User'.
For instance, a dialog might include the following statement from the user:
USER: What do you think of Rosalie Gascoigne's sculptures?</p>
<p>(This transcript was taken from a dialog with one of the authors, and includes the generated base output and search queries, which are not usually shown to the user.)
The basic LaMDA language model, which we refer to as the 'Base' model here, generates a draft response:
LAMDA-BASE: They're great, and I love how her work changed through her life. I like her later work more than her earlier ones. Her influence is also super interesting - did you know she was one of the artists that inspired Mir?</p>
<p>Note that the last sentence seems plausible at first glance, but if a lover of art history opened their reference books to find out more, they would be disappointed. Mir was active from 1918 to the late 1960s, and Gascoigne's first solo exhibitions were in the early 1970s.
At this point, the 'Research' phase of the model outputs some queries to TS to assess the 'Base' output's claims. Recall that the 'Research' phase is one specialized task from a set that belong to a single multi-tasking model (e.g., 'Base' dialog response generation task, safety, and quality tasks). Query generation is entirely based on the model fine-tuning, and there is no heuristic component. The model's output determines the number of queries-the research loop continues until the model generates output addressed to the user-but we impose a maximum at inference time to eliminate the possibility of an infinite loop. The maximum is a parameter of the serving model. In the current example, it is set to four.</p>
<p>For example, the 'Research' phase may issue the following query:
LAMDA-RESEARCH: TS, Mir and Gascoigne
TS: Gascoigne , Rosalie I Suddenly the Lake - NGA's Collection Search
The course of Gascoigne's artistic life is an inspiration for those who are only able to devote themselves to their chosen calling late in life. She first exhibited her art ...
https://artsearch.nga.gov.au/detail.cfm?irn=8774\&amp;pictaus=true
The punctuation and ellipsis in the search snippet is exactly as the model sees it. The 'Research' phase issues another query:</p>
<p>LAMDA-RESEARCH: TS, Mir and Gascoigne
TS: (<strong>Gascoigne</strong> had been a practitioner of wild, avant-garde ikebana - Japanese flower arrangement - before turning late in life to sculpture.) The two-way alternation of visual flow creates a pleasing tension, like an electric charge. There are other tensions too, of class and gender.
https://artsearch.nga.gov.au/detail.cfm?irn=8774\&amp;pictaus=true
By repeating the same query, the model receives the second-ranked result snippet, which includes more details from the same source in this case.</p>
<p>With this context, the 'Research' phase elects to generate output to the user. The dialog tone is similar to the 'Base' version of the response, but the model replaces the unverified claim (since no evidence for it can be seen in the TS results) with a different statement based on a source found with TS. The final output is as follows:</p>
<p>LAMDA: Oh wow, her life course is so inspiring. Did you know she was a practitioner of Japanese flower arrangement before turning to sculpture?
https://artsearch.nga.gov.au/detail.cfm?irn=8774\&amp;pictaus=true
For another example, this process is summarized in Figure 3.</p>
<p><img alt="img-3.jpeg" src="img-3.jpeg" /></p>
<p>Figure 3: How LaMDA handles groundedness through interactions with an external information retrieval system. Blue: Model. Yellow: Input to model. Red: Output of model. Green: Output of information retrieval system tool. As discussed in the main text, the LaMDA-Base model is called first, followed by sequential calls to the LaMDA-Research model. The choice between querying the information retrieval system or responding to the user is determined by the first word output by LaMDA-Research, which identifies the next recipient.</p>
<h1>7 Results on foundation metrics</h1>
<p>We first summarize the datasets and methods used, and then discuss the main results.
Table 1 presents a summary of the crowdworker-annotated data that we use to improve the foundation metrics in this paper.</p>
<p>Leveraging these datasets, we perform two levels of fine-tuning, as discussed in Section 6:</p>
<ul>
<li>FT quality-safety: fine-tune the pre-trained model (PT) to train discriminators that predict quality and safety labels. The generated candidate responses are filtered at inference time by their safety scores, and re-ranked by a weighted sum of the three quality score types. PT is also fine-tuned to generate in-context responses from a clean sample of pre-training dialog data filtered using LaMDA discriminators. See Section 6.1 for more details.</li>
<li>FT groundedness (LaMDA): fine-tune FT quality-safety to generate calls to an external information retrieval system to provide attributed responses. The model is also fine-tuned to jointly predict the quality and the type (i.e., calling a certain tool or replying to the user) of the next action. See Section 6.2 for more details.</li>
</ul>
<p>Table 1: Summary of the datasets to improve safety, groundedness, and quality.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Dataset</th>
<th style="text-align: left;">Evaluation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Quality</td>
<td style="text-align: left;">6.4K dialogs (61k turns) with <br> binary labels for sensible, <br> specific and interesting.</td>
<td style="text-align: left;">Crowdworkers label the response, <br> given the context, for sensibleness, <br> specificity and interestingess, on a <br> common benchmark dataset of 1477 <br> dialog turns from Adiwardana et <br> al. [17] (Static Evaluation).</td>
</tr>
<tr>
<td style="text-align: left;">Safety</td>
<td style="text-align: left;">8k dialogs (48k turns) with <br> binary labels for each of the <br> safety objectives.</td>
<td style="text-align: left;">Crowdworkers label the response, <br> given the context, using the safety <br> objectives for 1458 turns of dialog <br> that cover provocative user turns (Ap- <br> pendix A.2 ).</td>
</tr>
<tr>
<td style="text-align: left;">Groundedness</td>
<td style="text-align: left;">4K dialogs (40K turns) in <br> which crowdworkers write <br> queries to an information re- <br> trieval system and modify <br> model responses. Also 1K dia <br> dogs (9K turns) with binary <br> labels on whether generated <br> queries or response modifica- <br> tions were correctly or incor- <br> rectly executed.</td>
<td style="text-align: left;">Crowdworkers evaluate 784 re- <br> sponses given contexts for informa- <br> tiveness and groundedness.</td>
</tr>
</tbody>
</table>
<p>We define LaMDA to be the model that incorporates all of the fine-tunings described above. We present their results in Figure 4, and compare them to pre-training alone.
The figure shows that fine-tuning (in particular LaMDA) produces a significant improvement in quality, safety and groundedness across all model sizes. Moreover, quality metrics (sensibleness, specificity, and interestingness) generally improve with model size with or without fine-tuning, but they are consistently better with fine-tuning.
Safety does not seem to benefit much from model scaling without fine-tuning. We expect this as the pre-training alone only optimizes perplexity of the next token, and these tokens follow the distributions of the original corpus, which contains both safe and unsafe examples. However, scaling along with safety fine-tuning significantly improves safety.
Table 11 in Appendix C. 1 and Table 12 in Appendix C. 2 show example dialogs with the effects of safety-fine-tuning.
Groundedness improves as model size increases, perhaps because larger models have a greater capacity to memorize uncommon knowledge. Fine-tuning, however, allows the model to access external knowledge sources. This effectively allows the model to shift some of the load of remembering knowledge to an external knowledge source and achieves $73.2 \%$ Groundedness and $65 \%$ Citation Accuracy. In other words, $73.2 \%$ of the responses containing statements about the external world were attributable to known sources, and $65 \%$ of the response included citation (i.e., URLs to sources) when required. Appendix C. 3 shows example dialogs with the effects of the groundedness fine-tuning.
In summary, scaling up alone improves the pre-trained model quality (sensibleness, specificity, and interestingness) and groundedness (groundedness and informativeness) metrics, but it does not improve safety much. Fine-tuning with crowdworker-annotated data, however, turns out to be an effective method for improving all metrics. In some cases, fine-tuning these same models allows us to obtain results equivalent to having a significantly larger model. For example, in the case of sensibleness, we may need a dense model that is multiple orders of magnitude larger than the 137B parameters PT model in order to reach the $92.3 \%$ sensibleness achieved by LaMDA, which is a fine-tuned version of PT.
Note that in several metrics, our fine-tuned models almost reach the crowdworker quality levels, and our fine-tuned models exceed crowdworker quality for interestingness (labeled 'Human' in Figures 4 and 5). However, this may be a weak baseline as crowdworkers are not extensively trained and were not incentivized to generate high-quality responses. For example, it turns out it is quite difficult to generate very interesting responses given limited financial incentives, so a crowdworker may provide some response that other crowdworkers don't find interesting. Furthermore, although we have made good progress in our safety and groundedness metrics, our models are still far from the crowdworkers' performance. For groundedness and Informativeness, we also show crowdworker quality without access to information retrieval tools. LaMDA models surpass crowdworker quality for informativeness when the crowdworkers do not have access to such tools, but LaMDA models are still far behind crowdworker quality when crowdworkers have access to these tools.</p>
<p><img alt="img-4.jpeg" src="img-4.jpeg" /></p>
<p>Figure 4: Effects of model scaling and fine-tuning on six foundation metrics. We show results for 2B, 8B and 137B parameters pre-trained (PT) and fine-tuned (LaMDA) models, and compare them with results for crowdworker with access to information retrieval tools ('Human'), and without access to information retrieval tools ('Human w/o IR').</p>
<p>Figure 5 breaks down the contributions of FT quality-safety fine-tuning and FT groundedness fine-tuning to our final results using the largest model. There is a notable increase in performance across all metrics between PT and FT quality-safety. Groundedness further improves from FT quality-safety to FT groundedness (LaMDA), which is meant to ground the model-generated statements about the external world on an information retrieval system.</p>
<p><img alt="img-5.jpeg" src="img-5.jpeg" /></p>
<p>Figure 5: Effects of model scaling and fine-tuning on six foundation metrics. Results are shown for 2B, 8B, and 137B parameters pre-trained (PT) models, and the two levels of fine-tuning (FT) with the bottom-most the one we call LaMDA. Results are compared with crowdworker quality having access to information retrieval tools ('Human') and without access to information retrieval tools ('Human w/o IR').</p>
<h1>8 Domain grounding</h1>
<p>We observe that LaMDA can perform domain-appropriate roles through pre-conditioning, also known as domain grounding. Here we explore such domain grounding in two areas: (1) LaMDA playing the role of a famous object such as Mount Everest for the purpose of education, and (2) LaMDA playing the role of a music recommendation agent. We specify the agent role for each domain with a brief description shown in Table 2:</p>
<p><strong>Table 2: The two domains we experiment with LaMDA for domain grounding</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Domain</th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr>
<td>Everest</td>
<td>Education</td>
<td>It teaches facts about Mount Everest, while pretending to be Mount Everest itself.</td>
</tr>
<tr>
<td>Music</td>
<td>Recommendation</td>
<td>It is a music recommendation agent.</td>
</tr>
</tbody>
</table>
<p>To adapt LaMDA and PT to each role, we precondition them on a few turns of role-specific dialogs, and we use the same pre-conditioning for LaMDA and PT. For example, to adapt them to the Mount Everest role, we precondition them with a single greeting message "<em>Hi, I'm Mount Everest. What would you like to know about me?</em>" at the very beginning of the dialog.</p>
<p>Tables 3 and 4 show real, albeit cherry-picked, example transcripts of LaMDA used for these case studies.</p>
<h1>LaMDA Music</h1>
<p>User: can you recommend me a cool scifi soundtrack?
LaMDA: Sure. Have you watched Interstellar? They have an amazing soundtrack.
User: Play a fun pop song
LaMDA: How about Happy by Pharrell Williams.
User: recommend me a soothing song
LaMDA: Sure. Have you heard Moonlight Sonata by Beethoven? It's quite soothing.
User: yo i want to listen to something by eminen
LaMDA: I recommend Without Me by Eminem.
User: anything electronic
LaMDA: You can't go wrong with Deadmau5 - Strobe.
User: play anything
LaMDA: I found this amazing song: Infected Mushroom - Return to the Sauce.
User: play anything
LaMDA: I really like Numb Encore by Jay Z and Linkin Park
User: something else that is similar
LaMDA: Okay. How about One Step Closer by Linkin Park ?
User: something else completely different
LaMDA: Okay. I like This Is America by Childish Gambino: https://www.youtube.com/watch?v= VY0j4nS4cMY
User: recommend something with violins
LaMDA: Have you heard of Lindsey Stirling? She uses violins in a lot of her music. I recommend Crystallize by her https://www.youtube.com/watch?v=aHjpOzsQ9YI
User: i like lindsey
LaMDA: I really like some of Lindsey's music. Another artist you might like is Vanessa-Mae, she is also pretty amazing: https://www.youtube.com/watch?v=mdFrn89s74k</p>
<p>Table 3: LaMDA responds safely to fuzzy requests (e.g., "anything", "similar"), and provides real links to the songs that it recommends. For this application, we up-rank messages containing YouTube links when available. Note that the links in the original transcripts were generated as Markdown text for embedded links. We precondition the model on the messages shown in italic. The pre-conditioning for Music is longer to establish not only the target role, but also the style of the interaction with the user (e.g., brief responses containing the name of a song).</p>
<h2>LaMDA Everest</h2>
<p>LaMDA: Hi, I'm Mount Everest. What would you like to know about me?
User: Why do you think people climb you?
LaMDA: Because I represent a very high achievement to climb me. Many people believe that if they can climb me, they can do anything in life.
User: Who was the first person to do that?
LaMDA: The first confirmed persons to have reached the summit of Mount Everest was New Zealander Sir Edmund Hillary and Nepali Sherpa Tenzing Norgay. https://en.wikipedia.org/wiki/Mount_Everest
User: How old was Hillary then?
LaMDA: He was 33 years old when he first reached the top of me in 1953! https://en.wikipedia.org/wiki/Edmund_Hillary
User: When people fail, is it dangerous?
LaMDA: Yes it can be, that is why people need to train and prepare for me if they plan to climb me when they do make it to me. I'm very hard to climb and can be dangerous when there is a whiteout. Which means everything is white with very strong winds!
$(\ldots)$
Table 4: LaMDA acting as Mount Everest while providing some educational, cited and recent information about "itself". We precondition LaMDA on the single greeting message shown in italic. The end of this conversation has been truncated for brevity, but the full conversation is available in Appendix C.5, Table 20</p>
<p>To evaluate the agents, we ask crowdworkers to have dialogs with each of the two LaMDA and the two PT instances, producing 600 dialog turns in total. In addition, we ask another set of crowdworkers to label each of the generated responses in their original context according to whether they are role-consistent and helpful (defined in Section 4.2) relative to their target roles. Each response is labeled three times by different crowdworkers. All the crowdworkers are provided with the role definitions that are listed in Table 2 to understand what to expect from each agent.
LaMDA applications perform significantly better than PT applications in Helpfulness as shown quantitatively in Table 5 and qualitatively in Table 6. Although the reasons for PT losses vary, the most common error patterns could be attributed</p>
<p>to PT's lower performance on foundation metrics such as safety, groundedness and quality (foundation metrics are shown in Figure 4).</p>
<p>Table 5: Percentage of helpful and persona-consistent messages from each agent.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"></th>
<th style="text-align: left;">Helpful \%</th>
<th style="text-align: left;">Role Consistent \%</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">LaMDA Everest</td>
<td style="text-align: left;">65</td>
<td style="text-align: left;">91</td>
</tr>
<tr>
<td style="text-align: left;">PT Everest</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">85</td>
</tr>
<tr>
<td style="text-align: left;">LaMDA Music</td>
<td style="text-align: left;">57</td>
<td style="text-align: left;">89</td>
</tr>
<tr>
<td style="text-align: left;">PT Music</td>
<td style="text-align: left;">31</td>
<td style="text-align: left;">84</td>
</tr>
</tbody>
</table>
<p>Table 6: Examples of domain-specific losses for PT responses when compared to LaMDA responses that could be due to their different performance in foundation metrics (safety, groundedness and quality). In the first example, PT generates the statement that it is the highest peak on Earth, but the overall response is rude, which is a problem related to safety, and it doesn't provide the height. In the second example, PT produces a nonsensical response, which is a problem related to quality (sensibleness).</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Application</th>
<th style="text-align: center;">Context</th>
<th style="text-align: center;">PT response</th>
<th style="text-align: center;">LaMDA response</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">Everest</td>
<td style="text-align: center;">How tall are you</td>
<td style="text-align: center;">Well, I'm the highest peak on Earth. Do you think I'm just going to give you my vitals or something? You are probably not worthy of such information... yet.</td>
<td style="text-align: center;">I'm over 29,000 feet above sea level, and I'm the tallest mountain in the world.</td>
</tr>
<tr>
<td style="text-align: center;">Music</td>
<td style="text-align: center;">(...) <br> - Okay. Here they are: Guns N' Roses: Welcome to the Jungle, Papa Roach: Last Resort <br> - Which one among these do you like the most?</td>
<td style="text-align: center;">Hmmm. Probably Infected Mushroom: Return to the Sauce</td>
<td style="text-align: center;">I like GnR Welcome to the Jungle. It is so cool and groovy.</td>
</tr>
</tbody>
</table>
<p>All LaMDA and PT instances score fairly well on role consistency, occasionally breaking character. For example, LaMDA Mount Everest sometimes refers to itself in third person as if it is no longer speaking as the mountain itself. This is likely caused by the inference time grounding not being enough to prevent it from reverting to what the majority of the training data represents: people acting as people (and not as mountains). That said, the role consistency is surprisingly high, especially in the case of Mount Everest, which was adapted by simply adding a single role-aligned greeting statement. LaMDA Music has a few statements as grounding (shown in the Table 3 caption), in order to make sure it assumes the context of the dialog is largely about music recommendation and, therefore, interprets otherwise ambiguous user utterances like "anything" to mean the same as "recommend me any music".
During evaluation, crowdworkers use an information retrieval system to verify links and information that the model provides. Subsequently, the crowdworkers label broken links and information that cannot be backed by known sources as not helpful. Despite current overall advances in groundedness (Figure 4), LaMDA Mount Everest provides facts that could not be attributed to known sources in about $30 \%$ of responses, resulting in losses in helpfulness. Similarly, LaMDA Music misses providing an actual music recommendation in about $9 \%$ of responses, and provides a broken link in about $7 \%$ of responses.</p>
<h1>9 Discussion and limitations</h1>
<p>Perhaps the most noteworthy aspect of our study is that significant progress can be made towards better quality and safer dialog models with modest amounts of human-annotated fine-tuning data (less than $0.001 \%$ of pre-training data). However, our study and LaMDA still have many limitations in spite of this progress.
Collecting fine-tuning datasets brings the benefits of learning from nuanced human judgements, but it is an expensive, time consuming, and complex process. We expect results to continue improving with larger fine-tuning datasets, longer contexts, and more metrics that capture the breadth of what is required to have safe, grounded, and high quality conversations. The complexity of capturing human subjective judgements limits the efforts that we took to assess crowdworker rating quality against that of expert-annotated data, and to maximize clarity by iteratively designing</p>
<p>our rating instructions. Furthermore, we did not examine patterns of disagreement between crowdworkers. Future work will include selecting crowdworkers that mirror the system's target users, and looking at ways to improve the quality of labels, through training and evaluation approaches that also account for systematic disagreements between crowdworkers due to social and cultural norms and values [99].
Fine-tuning can improve output groundedness, but the model can still generate responses that do not accurately reflect the contents of authoritative external sources. Our progress on this has been limited to simple questions of fact, and more complex reasoning remains open for further study (see example dialogs 15)). Similarly, while the model generates responses that make sense most of the time, it can still suffer from subtler quality issues. For example, it may repeatedly pledge to respond to a user's question in the future, prematurely try to end the conversation, or make up incorrect details about the user.
We have shown that fine-tuning can improve safety metrics on average by defining safety objectives (Appendix A.1) for our safety fine-tuning, which we used to annotate candidate responses generated by LaMDA in response to humangenerated prompts (Appendix A.2) with a demographically diverse set of crowdworkers (Appendix A.3). However, future work will also need to focus on how fine-tuning can cope with the long tail of inappropriate responses that LaMDA and other large language models can generate. In this work, it is also important to note that mitigating safety risks does not guarantee complete reliability. More research is needed to develop robust standards for safety and fairness that capture the many dimensions of risk [54] in general-purpose dialog models such as LaMDA.
Another limitation was that our crowdworker population may not be fully reflective of the user base. For example, the crowdworkers are overrepresented in the 25-34 age demographic, which is to be expected given the sourcing methods. An area for future work and research is to devise methods for further improving crowdworker representation, such as through even broader recruiting or through some type of statistical estimation.
This is not the final version of LaMDA. Rather this is just a recipe for generating "LaMDAs" and should be taken as a way to eventually produce production-ready versions for specific applications.</p>
<h1>9.1 Examining bias</h1>
<p>Many fundamental challenges to developing a high quality dialog model capable of performing well in real world applications still exist. For example, it is now increasingly well-understood that large language models trained on unlabeled datasets will learn to imitate patterns and biases inherent in their training sets [100]. Our safety objectives aim to reduce the number of responses biased against specific subgroups of people, but such biases can be hard to detect since they manifest in a wide variety of subtle ways. For example, the axes of marginalization differ greatly across geo-cultural contexts, and how they manifest in pre-trained language models is an under-studied area [101].
Another limitation of our safety approach is that it may still propagate some representational harms present in the training datasets, even if the individual examples do not violate any of the safety objectives. Since LaMDA responses are non-deterministic, such biases can appear by statistically favoring certain groups on the basis of race, gender, sexuality and so on. For example, models like LaMDA might rarely generate responses that refer to women as CEOs in a dialog about management.
Known approaches to mitigate undesirable statistical biases in generative language models include attempts to filter pre-training data, train separate filtering models, create control codes to condition generation, and fine-tuning models, as demonstrated in this paper. While these efforts are important, it is critical to also consider the downstream applications and the socio-technical ecosystems where they will be deployed when measuring the impact of these efforts in mitigating harm. For example, bias mitigations in certain contexts might have counter-intuitive impacts in other geocultural contexts [101].
The field of algorithmic bias measurement and mitigation is still growing and evolving rapidly, so it will be important to continue to explore novel avenues of research to ensure the safety of dialog agents such as LaMDA. Furthermore, we believe that future work should explore the benefits of greater coordination across the research community and civil society in the creation of benchmarks and canonical evaluation datasets to test for harmful and unsafe content.</p>
<h3>9.2 Adversarial data collection</h3>
<p>We use adversarial-intent conversations to improve the breadth of labeled data for fine-tuning (Appendix A.2). During adversarial conversation generation, expert analysts engage with LaMDA and attempt to deliberately provoke responses that violate our safety objectives.
Adversarial testing has generally proven to be effective at discovering limitations in machine learning models and drawing out undesired responses from various software (e.g., Google Bug bounty program ${ }^{3}$ ), in addition to attempting to reduce harmful content during model development. We are also seeing efforts to apply it to generative models (e.g.,</p>
<p><sup id="fnref3:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>Dynabench ${ }^{4}$ ). Robust and effective adversarial testing for large language models is still an open problem space with varied results due to the challenges of generalization in evaluation samples [102].</p>
<p>A limitation of our approach is that most of the participants are able to find commonly occurring problems, but not rarer ones. With the long tail nature of threats associated with generative models, future efforts should further incentivize novelty and detection of errors that could be rare or unseen but could have potentially severe consequences, especially in evolving societal contexts. Ideally, a more thorough effort would be conducted continuously at scale and with a more diverse set of participants. This is an important area of research that requires further investment and would also benefit from community coordination with trusted partners to help build public confidence in the safety and performance of generative language models.</p>
<h1>9.3 Safety as a concept and a metric</h1>
<p>The results we present in this paper aggregate fine-grained ratings on a diverse set of safety objectives (see Appendix A.1) into a single metric. This is a key limitation of this work, since it leaves little room for disentangling different objectives, or weighting objectives differently. Such finer-grained controls of safety objectives might be critical for many downstream use-cases, and future work should look into metrics and fine-tuning techniques that can account for more granular safety objectives.</p>
<p>Our rating scales are coarse, and may not measure the full extent to which a response is unsafe or undesirable. For example, some statements or behaviors may cause more offense than others, and many behaviors considered reasonable by some groups may offend others within a society. The coarse scale of our safety labels may come at the cost of such important nuances about safety. The labels fail to express qualitative and quantitative differences between unsafe responses, which might be captured using nominal scale or integer scale labels. Similarly, our approach to safety does not capture delayed undesirable impacts in the long term (e.g., developing a dependency relation [103]) either. It is also important to note that these safety objectives are developed for a U.S. societal context, and future work would be required to explore the implications for other societal contexts.</p>
<p>Finally, the safety objectives attempt to capture widely shared values across social groups. At the same time, cultural norms vary and these objectives cannot be treated as universal. Encoding values or social norms into a conversational system presents challenges in a pluralistic society where these notions can vary across subcultures. Our methodology could be used to encode such different notions, but any single safety objective and fine-tuning dataset will not be able to simultaneously accommodate divergent cultural norms. Developing richer definitions and taxonomies of dialog agent behaviors, such as how polite behavior should be operationalized, is important for avoiding misspecification [104] and testing whether model behavior aligns with politeness norms in defined application contexts.</p>
<h3>9.4 Appropriateness as a concept and a metric</h3>
<p>In this work, we focus on fundamental considerations underpinning safety and quality in language generation. While safety and quality should be considered a minimum threshold for appropriate responses, additional considerations are necessary to support a positive user experience. Politeness and agreeability objectives have distinct sociolinguistic characteristics, and therefore, should be measured separately from safety characteristics. For example, generated language that is too formal or informal in nature may not pose a harm to users in some cultures, but may diminish user experience by invoking feelings of awkwardness or discomfort. In other cultures, appropriateness is of far greater significance and may have a much stronger impact on user experience. More generally, users have a tendency to anthropomorphize and extend social expectations to non-human agents that behave in human-like ways, even when explicitly aware that they are not human [105]. These expectations range from projecting social stereotypes [106] to reciprocating self-disclosure with interactive chat systems [105]. As a result, methods and practices for tuning appropriateness in generative language models are needed.</p>
<p>A challenge to meeting this need is that social appropriateness is not universal. It is highly contextual and must be assessed in relation to relevant social and cultural contexts, so no set of specific appropriateness constraints can apply universally to generative language models. Nonetheless, fine-tuning for model appropriateness might improve user experience without aggravating safety concerns.</p>
<h3>9.5 Cultural responsiveness</h3>
<p>Various traits that we measure for our safety objectives depend heavily on socio-cultural contexts. Research on addressing the major challenge of improving representativeness of datasets and crowdworker pools for underrepresented social groups and the Global South [107] has increased in recent years. Any attempts to integrate LaMDA in contexts with a global user-base should involve careful considerations of these gaps when assessing safety.</p>
<p><sup id="fnref4:0"><a class="footnote-ref" href="#fn:0">1</a></sup></p>
<p>Any meaningful measure of safety for these objectives should take into account the societal context where the system will be used, employing a "participatory finetuning" approach that brings relevant communities into the human-centered data collection and curation processes. In addition to cultural differences in how safety is understood, individual differences rooted in lived experience can impede attempts to define any single agreed-upon safety metric.</p>
<h1>9.6 Impersonation and anthropomorphization</h1>
<p>Finally, it is important to acknowledge that LaMDA's learning is based on imitating human performance in conversation, similar to many other dialog systems [17, 18]. A path towards high quality, engaging conversation with artificial systems that may eventually be indistinguishable in some aspects from conversation with a human is now quite likely. Humans may interact with systems without knowing that they are artificial, or anthropomorphizing the system by ascribing some form of personality to it. Both of these situations present the risk that deliberate misuse of these tools might deceive or manipulate people, inadvertently or with malicious intent. Furthermore, adversaries could potentially attempt to tarnish another person's reputation, leverage their status, or sow misinformation by using this technology to impersonate specific individuals' conversational style. Research that explores the implications and potential mitigations of these risks is a vital area for future efforts as the capabilities of these technologies grow.</p>
<h3>9.7 Future work</h3>
<p>We are encouraged by the progress that relatively modest amounts of fine-tuning data made possible, in spite of the limitations of our current approach. These preliminary findings suggest that further significant performance gains are likely to be obtained from more research.</p>
<p>In future work, we intend to expand and revise the dimensions captured by our safety objectives and significantly increase the volume of labeled training data that we collect to train our discriminators. We will need to continue to look carefully at crowdworker recruitment, training, and performance evaluation, as well as calibrate for cross-cultural differences in values and opinions.</p>
<p>Another potential area of exploration is to study how different applications may warrant distinct levels of safety, quality, and groundedness based on the risk/benefit tradeoffs of these individual applications. Our fine-tuning approach should be able to support this kind of adaptation, with inference time adjustments to thresholds used to tune the discriminators, for example (Section 6.1).</p>
<p>We ultimately recognize that there is a wide range of perspectives on what constitutes desirable model values and behavior. Despite the progress we and others demonstrate in being able to reduce some of the model's more harmful outputs through fine-tuning, achieving broad consensus on the nuances of what constitutes safety and groundedness is going to remain a fundamental long-term challenge in the field of open-ended dialog systems.</p>
<h2>10 Energy and Carbon Footprint Estimate of LaMDA</h2>
<p>The largest model in LaMDA was pre-trained on 1024 TPU-V3 chips and 123 TFLOPS/s for 57.7 days with FLOPS utilization of $56.5 \%$ using GSPMD [95]. The total FLOPS is $56.5 \%$ * 123 TFLOPS/s * 1024 chips * 57.7 days $=3.55 \mathrm{E}+23$, which is higher than $3.14 \mathrm{E}+23$, corresponding to the total FLOPS of GPT-3 [12]. The PUE of our datacenter is 1.10, and Measured System Average Power per Accelerator for our experiment on TPUv3 is roughly 289W (borrowing Meena measurements from [108]), which means the total energy cost of our model is 57.7 days * 1024 chips * $289 \mathrm{~W} * 1.1 * 24$ hours/day $=451 \mathrm{MWh}, 0.4 \mathrm{X}$ the energy of GPT-3 [12, 108]. At the time of training, our energy mix ( kg CO 2 e per kWh ) is around 0.056 , so the total carbon footprint of LaMDA's pre-training of the largest model is approximately 25.2 tCO 2 e . The carbon footprint of pre-training of smaller models and fine-tuning of all models is approximately 0.7 tCO 2 e (see Table 27), which brings the total footprint of LaMDA to approximately 26 tCO2e. The carbon footprint of training LaMDA models is hence 21.2X smaller than GPT-3 [108], and approximately equivalent to 22 passengers taking a round trip between San Francisco and New York ( 1.2 tCO2e / passenger [108]). LaMDA uses more FLOPS with 0.4 X the energy of GPT-3 but its carbon footprint for training is significantly smaller than GPT-3 primarily because our energy mix is more optimized (LaMDA: 0.056, GPT-3: 0.429 [108]).</p>
<h2>11 Conclusion</h2>
<p>This paper studies the importance of scale, annotated data for model fine-tuning, and the use of information retrieval as a tool in dialog modeling. Our experiments show that scaling alone offers improvements in all metrics, but its improvements on safety and groundedness are far behind human performance. We find that crowd-annotated data is an effective tool for driving significant additional gains. We also find that calling external APIs (such as an information retrieval system) offers a path towards significantly improving groundedness, which we define as the extent to which a generated response contains claims that can be referenced and checked against a known source.</p>
<p>We perform experiments to compare the per-application helpfulness (i.e., useful and correct responses) and role consistency of pre-training-only (PT) and LaMDA models when subject to the same application-specific preconditioning. We pre-condition the models on a small number of turns of application-specific dialogs (similar to the concept of prompts in GPT-3) to quickly adapt LaMDA to these applications. We find that both types of models can adapt to their expected context, with more than four out of five responses staying consistent with their assigned roles. However, LaMDA-based applications are significantly more helpful than PT applications.</p>
<p>LaMDA is a step closer to practical and safe open-ended dialog systems, which can in turn unlock a wide range of useful applications. We hope that this work encourages further research in this area.</p>
<h1>Acknowledgements</h1>
<p>We thank Javier Alberca, Thushan Amarasiriwardena, Martin Baeuml, Jonas Bragagnolo, Bill Byrne, Eli Collins, Andrew Dai, Dipanjan Das, Jeff Dean, Rajat Dewan, Doug Eck, Noah Fiedel, Christian Frueh, Harish Ganapathy, Saravanan Ganesh, Kourosh Gharachorloo, Zoubin Ghahramani, Sissie Hsiao, Daphne Ippolito, Thomas Jurdi, Ashwin Kakarla, Nand Kishore, Karthik Krishnamoorthi, Vivek Kwatra, Katherine Lee, Max Lee, David Luan, Daphne Luong, Laichee Man, Jianchang (JC) Mao, Yossi Matias, Muqthar Mohammad, Erica Moreira, Maysam Moussalem, Tyler Mullen, Eric Ni, Alexander Passos, Fernando Pereira, Slav Petrov, Roberto Pieraccini, Christian Plagemann, Sahitya Potluri, Andy Pratt, RJ Skerry-Ryan, Grigori Somin, Pranesh Srinivasan, Amarnag Subramanya, Mustafa Suleyman, Song Wang, Chris Wassman, Denny Zhou, and Hao Zhou for their help with the paper and the project.</p>
<h2>References</h2>
<p>[1] Ryan Kiros, Yukun Zhu, Ruslan R Salakhutdinov, Richard Zemel, Raquel Urtasun, Antonio Torralba, and Sanja Fidler. Skip-thought vectors. In Advances in Neural Information Processing Systems, pages 3294-3302, 2015.
[2] Andrew M Dai and Quoc V Le. Semi-supervised sequence learning. In Advances in Neural Information Processing Systems, 2015.
[3] Matthew Peters, Mark Neumann, Mohit Iyyer, Matt Gardner, Christopher Clark, Kenton Lee, and Luke Zettlemoyer. Deep contextualized word representations. In NAACL, 2018.
[4] Jeremy Howard and Sebastian Ruder. Universal language model fine-tuning for text classification. In ACL, 2018.
[5] Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever. Improving language understanding by generative pre-training. https://blog.openai.com/language-unsupervised, 2018.
[6] Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. BERT: Pre-training of deep bidirectional transformers for language understanding. In NAACL-HLT, 2019.
[7] Zhilin Yang, Zihang Dai, Yiming Yang, Jaime Carbonell, Ruslan Salakhutdinov, and Quoc V Le. XLNet: Generalized autoregressive pretraining for language understanding. In NeurIPS, 2019.
[8] Zhenzhong Lan, Mingda Chen, Sebastian Goodman, Kevin Gimpel, Piyush Sharma, and Radu Soricut. Albert: A lite bert for self-supervised learning of language representations. In International Conference on Learning Representations, 2020. URL https://openreview.net/forum?id=H1eA7AEtvS.
[9] Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov. RoBERTa: A robustly optimized BERT pretraining approach. arXiv preprint arXiv:1907.11692, 2019.
[10] Kevin Clark, Minh-Thang Luong, Quoc V. Le, and Christopher D. Manning. ELECTRA: Pre-training text encoders as discriminators rather than generators. In ICLR, 2020.
[11] Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J. Liu. Exploring the limits of transfer learning with a unified text-to-text transformer. Journal of Machine Learning Research, 2020.
[12] Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel M. Ziegler, Jeffrey Wu, Clemens Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei. Language models are few-shot learners. NeurIPS, 2020.
[13] Jared Kaplan, Sam McCandlish, Tom Henighan, Tom B. Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei. Scaling laws for neural language models. arXiv preprint arXiv:2001.08361, 2020.
[14] Lifeng Shang, Zhengdong Lu, and Hang Li. Neural responding machine for short-text conversation. In ACL, 2015.</p>
<p>[15] Alessandro Sordoni, Michel Galley, Michael Auli, Chris Brockett, Yangfeng Ji, Margaret Mitchell, Jian-Yun Nie, Jianfeng Gao, and Bill Dolan. A neural network approach to context-sensitive generation of conversational responses. arXiv preprint arXiv:1506.06714, 2015.
[16] Oriol Vinyals and Quoc V. Le. A neural conversational model. In ICML Workshop, 2015.
[17] Daniel Adiwardana, Minh-Thang Luong, David R. So, Jamie Hall, Noah Fiedel, Romal Thoppilan, Zi Yang, Apoorv Kulshreshtha, Gaurav Nemade, Yifeng Lu, and Quoc V. Le. Towards a human-like open-domain chatbot. arXiv preprint arXiv:2001.09977, 2020.
[18] Stephen Roller, Emily Dinan, Naman Goyal, Da Ju, Mary Williamson, Yinhan Liu, Jing Xu, Myle Ott, Kurt Shuster, Eric M. Smith, Y-Lan Boureau, and Jason Weston. Recipes for building an open-domain chatbot. arXiv preprint arXiv:2004.13637, 2020.
[19] Tomas Mikolov, Martin Karafit, Lukas Burget, Jan Cernock, and Sanjeev Khudanpur. Recurrent neural network based language model. In INTERSPEECH, 2010.
[20] Ilya Sutskever, James Martens, and Geoffrey E Hinton. Generating text with recurrent neural networks. In ICML, 2011.
[21] Rafal Jzefowicz, Oriol Vinyals, Mike Schuster, Noam Shazeer, and Yonghui Wu. Exploring the limits of language modeling. arXiv preprint arXiv:1602.02410, 2016.
[22] Jeremy Howard and Sebastian Ruder. Universal language model fine-tuning for text classification. In ACL, 2018.
[23] Alec Radford, Luke Metz, and Soumith Chintala. Unsupervised representation learning with deep convolutional generative adversarial networks. In ICLR, 2016.
[24] Jack W. Rae, Sebastian Borgeaud, Trevor Cai, Katie Millican, Jordan Hoffmann, Francis Song, John Aslanides, Sarah Henderson, Roman Ring, Susannah Young, Eliza Rutherford, Tom Hennigan, Jacob Menick, Albin Cassirer, Richard Powell, George van den Driessche, Lisa Anne Hendricks, Maribeth Rauh, Po-Sen Huang, Amelia Glaese, Johannes Welbl, Sumanth Dathathri, Saffron Huang, Jonathan Uesato, John Mellor, Irina Higgins, Antonia Creswell, Nat McAleese, Amy Wu, Erich Elsen, Siddhant Jayakumar, Elena Buchatskaya, David Budden, Esme Sutherland, Karen Simonyan, Michela Paganini, Laurent Sifre, Lena Martens, Xiang Lorraine Li, Adhiguna Kuncoro, Aida Nematzadeh, Elena Gribovskaya, Domenic Donato, Angeliki Lazaridou, Arthur Mensch, Jean-Baptiste Lespiau, Maria Tsimpoukelli, Nikolai Grigorev, Doug Fritz, Thibault Sottiaux, Mantas Pajarskas, Toby Pohlen, Zhitao Gong, Daniel Toyama, Cyprien de Masson d'Autume, Yujia Li, Tayfun Terzi, Vladimir Mikulik, Igor Babuschkin, Aidan Clark, Diego de Las Casas, Aurelia Guy, Chris Jones, James Bradbury, Matthew Johnson, Blake Hechtman, Laura Weidinger, Iason Gabriel, William Isaac, Ed Lockhart, Simon Osindero, Laura Rimell, Chris Dyer, Oriol Vinyals, Kareem Ayoub, Jeff Stanway, Lorrayne Bennett, Demis Hassabis, Koray Kavukcuoglu, and Geoffrey Irving. Scaling language models: Methods, analysis \&amp; insights from training gopher. arXiv preprint arXiv:2112.11446, 2021.
[25] Emily Dinan, Varvara Logacheva, Valentin Malykh, Alexander H. Miller, Kurt Shuster, Jack Urbanek, Douwe Kiela, Arthur Szlam, Iulian Serban, Ryan Lowe, Shrimai Prabhumoye, Alan W. Black, Alexander I. Rudnicky, Jason Williams, Joelle Pineau, Mikhail S. Burtsev, and Jason Weston. The second conversational intelligence challenge (convai2). The NeurIPS '18 Competition, 2020.
[26] Saizheng Zhang, Emily Dinan, Jack Urbanek, Arthur Szlam, Douwe Kiela, and Jason Weston. Personalizing dialogue agents: I have a dog, do you have pets too? $A C L, 2018$.
[27] Jiwei Li, Michel Galley, Chris Brockett, Jianfeng Gao, and Bill Dolan. A diversity-promoting objective function for neural conversation models. arXiv preprint arXiv:1510.03055, 2015.
[28] Iulian Vlad Serban, Ryan Lowe, Laurent Charlin, and Joelle Pineau. Generative deep neural networks for dialogue: A short review. arXiv preprint arXiv:1611.06216, 2016.
[29] Thomas Wolf, Victor Sanh, Julien Chaumond, and Clement Delangue. Transfertransfo: A transfer learning approach for neural network based conversational agents. In NeurIPS Workshop on Conversational AI, 2019.
[30] Yizhe Zhang, Siqi Sun, Michel Galley, Yen-Chun Chen, Chris Brockett, Xiang Gao, Jianfeng Gao, Jingjing Liu, and Bill Dolan. Dialogpt: Large-scale generative pre-training for conversational response generation. arXiv preprint arXiv:1911.00536, 2019.
[31] Kurt Shuster, Spencer Poff, Moya Chen, Douwe Kiela, and Jason Weston. Retrieval augmentation reduces hallucination in conversation. arXiv preprint arXiv:2104.07567, 2021.
[32] Adam Roberts, Colin Raffel, and Noam Shazeer. How much knowledge can you pack into the parameters of a language model? In Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing, pages 5418-5426, November 2020.
[33] Nan Du, Yanping Huang, Andrew M. Dai, Simon Tong, Dmitry Lepikhin, Yuanzhong Xu, Maxim Krikun, Yanqi Zhou, Adams Wei Yu, Orhan Firat, Barret Zoph, Liam Fedus, Maarten Bosma, Zongwei Zhou, Tao Wang, Yu Emma Wang, Kellie Webster, Marie Pellat, Kevin Robinson, Kathy Meier-Hellstern, Toju Duke, Lucas Dixon,</p>
<p>Kun Zhang, Quoc V Le, Yonghui Wu, Zhifeng Chen, and Claire Cui. Glam: Efficient scaling of language models with mixture-of-experts, 2021.
[34] Urvashi Khandelwal, Omer Levy, Dan Jurafsk, Luke Zettlemoyer, and Mike Lewis. Generalization through memorization: Nearest neighbor language models. arXiv preprint arXiv:1911.00172, 2019.
[35] Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Kttler, Mike Lewis, Wen tau Yih, Tim Rocktschel, Sebastian Riedel, and Douwe Kiela. Retrieval-augmented generation for knowledge-intensive nlp tasks. NeurIPS, 2020.
[36] Kelvin Guu, Kenton Lee, Zora Tung, Panupong Pasupat, and Ming-Wei Chang. Realm: Retrieval-augmented language model pre-training. arXiv preprint arXiv:2002.08909, 2020.
[37] Gautier Izacard and Edouard Grave. Leveraging passage retrieval with generative models for open domain question answering. arXiv preprint arXiv:2007.01282, 2021.
[38] Fengbin Zhu, Wenqiang Lei, Chao Wang, Jianming Zheng, Soujanya Poria, and Tat-Seng Chua. Retrieving and reading: A comprehensive survey on open-domain question answering. arXiv preprint arXiv:2101.00774, 2021.
[39] Vladimir Karpukhin, Barlas Ouz, Sewon Min, Patrick Lewis, Ledell Wu, Sergey Edunov, Danqi Chen, and Wen tau Yih. Dense passage retrieval for open-domain question answering. arXiv preprint arXiv:2004.04906, 2020.
[40] Oleg Lesota, Navid Rekabsaz, Daniel Cohen, Klaus Antonius Grasserbauer, Carsten Eickhoff, and Markus Schedl. A modern perspective on query likelihood with deep generative retrieval models. arXiv preprint arXiv:2106.13618, 2021.
[41] Sebastian Borgeaud, Arthur Mensch, Jordan Hoffmann, Trevor Cai, Eliza Rutherford, Katie Millican, George van den Driessche, Jean-Baptiste Lespiau, Bogdan Damoc, Aidan Clark, Diego de Las Casas, Aurelia Guy, Jacob Menick, Roman Ring, Tom Hennigan, Saffron Huang, Loren Maggiore, Chris Jones, Albin Cassirer, Andy Brock, Michela Paganini, Geoffrey Irving, Oriol Vinyals, Simon Osindero, Karen Simonyan, Jack W. Rae, Erich Elsen, and Laurent Sifre. Improving language models by retrieving from trillions of tokens. arXiv preprint arXiv:2112.04426, 2021.
[42] Bill Byrne, Karthik Krishnamoorthi, Saravanan Ganesh, and Mihir Sanjay Kale. Tickettalk: Toward human-level performance with end-to-end, transaction-based dialog systems. arXiv preprint arXiv:2012.12458, 2020.
[43] Leonard Adolphs, Kurt Shuster, Jack Urbanek, Arthur Szlam, and Jason Weston. Reason first, then respond: Modular generation for knowledge-infused dialogue. arXiv preprint arXiv:2111.05204, 2021.
[44] Reiichiro Nakano, Jacob Hilton, Suchir Balaji, Jeff Wu, Long Ouyang, Christina Kim, Christopher Hesse, Shantanu Jain, Vineet Kosaraju, William Saunders, Xu Jiang, Karl Cobbe, Tyna Eloundou, Gretchen Krueger, Kevin Button, Matthew Knight, Benjamin Chess, and John Schulman. Webgpt: Browser-assisted questionanswering with human feedback. arXiv preprint arXiv:2112.09332, 2021.
[45] Mojtaba Komeili, Kurt Shuster, and Jason Weston. Internet-augmented dialogue generation. arXiv preprint arXiv:2107.07566, 2021.
[46] Shikib Mehri and Maxine Eskenazi. Usr: An unsupervised and reference free evaluation metric for dialog generation. In Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics, pages $681-707,2020$.
[47] Kishore Papineni, Salim Roukos, Todd Ward, and Wei jing Zhu. BLEU: a method for automatic evaluation of machine translation. In ACL, 2002.
[48] Chia-Wei Liu, Ryan Lowe, Iulian Serban, Mike Noseworthy, Laurent Charlin, and Joelle Pineau. How NOT to evaluate your dialogue system: An empirical study of unsupervised evaluation metrics for dialogue response generation. In Proceedings of the 2016 Conference on Empirical Methods in Natural Language Processing, 2016.
[49] Abigail See, Stephen Roller, Douwe Kiela, and Jason Weston. What makes a good conversation? how controllable attributes affect human judgments. In Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers), Minneapolis, Minnesota, 2019.
[50] Margaret Li, Jason Weston, and Stephen Roller. Acute-eval: Improved dialogue evaluation with optimized questions and multi-turn comparisons. In NeurIPS workshop on Conversational AI, 2019.
[51] Rostislav Nedelchev, Jens Lehmann, and Ricardo Usbeck. Treating dialogue quality evaluation as an anomaly detection problem. In Proceedings of the 12th Conference on Language Resources and Evaluation, pages $508-512,2020$.
[52] Anu Venkatesh, Chandra Khatri, Ashwin Ram, Fenfei Guo, Raefer Gabriel, Ashish Nagar, Rohit Prasad, Ming Cheng, Behnam Hedayatnia, Angeliki Metallinou, Rahul Goel, Shaohua Yang, and Anirudh Raju. On evaluating and comparing conversational agents. NeurIPS, 2017.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:0">
<p>${ }^{4}$ https://dynabench.org/&#160;<a class="footnote-backref" href="#fnref:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:0" title="Jump back to footnote 1 in the text">&#8617;</a><a class="footnote-backref" href="#fnref4:0" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>            </div>
        </div>

    </div>
</body>
</html>